/*! For license information please see main.b9fac32a.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,s)=>{e.exports=s(202)},153:(e,t,s)=>{var a=s(43),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,s){var a,n={},d=null,c=null;for(a in void 0!==s&&(d=""+s),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)l.call(t,a)&&!o.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:r,type:e,key:d,ref:c,props:n,_owner:i.current}}t.Fragment=n,t.jsx=d,t.jsxs=d},202:(e,t)=>{var s=Symbol.for("react.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),h=Symbol.iterator;var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,b={};function g(e,t,s){this.props=e,this.context=t,this.refs=b,this.updater=s||x}function f(){}function y(e,t,s){this.props=e,this.context=t,this.refs=b,this.updater=s||x}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},f.prototype=g.prototype;var v=y.prototype=new f;v.constructor=y,p(v,g.prototype),v.isPureReactComponent=!0;var w=Array.isArray,j=Object.prototype.hasOwnProperty,N={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,a){var r,n={},l=null,i=null;if(null!=t)for(r in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(l=""+t.key),t)j.call(t,r)&&!S.hasOwnProperty(r)&&(n[r]=t[r]);var o=arguments.length-2;if(1===o)n.children=a;else if(1<o){for(var d=Array(o),c=0;c<o;c++)d[c]=arguments[c+2];n.children=d}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===n[r]&&(n[r]=o[r]);return{$$typeof:s,type:e,key:l,ref:i,props:n,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===s}var A=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,r,n,l){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var o=!1;if(null===e)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case s:case a:o=!0}}if(o)return l=l(o=e),e=""===n?"."+_(o,0):n,w(l)?(r="",null!=e&&(r=e.replace(A,"$&/")+"/"),P(l,t,r,"",function(e){return e})):null!=l&&(C(l)&&(l=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(l,r+(!l.key||o&&o.key===l.key?"":(""+l.key).replace(A,"$&/")+"/")+e)),t.push(l)),1;if(o=0,n=""===n?".":n+":",w(e))for(var d=0;d<e.length;d++){var c=n+_(i=e[d],d);o+=P(i,t,r,c,l)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),d=0;!(i=e.next()).done;)o+=P(i=i.value,t,r,c=n+_(i,d++),l);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function T(e,t,s){if(null==e)return e;var a=[],r=0;return P(e,a,"","",function(e){return t.call(s,e,r++)}),a}function E(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},R={transition:null},D={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:R,ReactCurrentOwner:N};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,s){T(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=r,t.Profiler=l,t.PureComponent=y,t.StrictMode=n,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=O,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=p({},e.props),n=e.key,l=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(l=t.ref,i=N.current),void 0!==t.key&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(d in t)j.call(t,d)&&!S.hasOwnProperty(d)&&(r[d]=void 0===t[d]&&void 0!==o?o[d]:t[d])}var d=arguments.length-2;if(1===d)r.children=a;else if(1<d){o=Array(d);for(var c=0;c<d;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:s,type:e.type,key:n,ref:l,props:r,_owner:i}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:E}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,s){return I.current.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,s){return I.current.useReducer(e,t,s)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,s){return I.current.useSyncExternalStore(e,t,s)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function s(e,t){var s=e.length;e.push(t);e:for(;0<s;){var a=s-1>>>1,r=e[a];if(!(0<n(r,t)))break e;e[a]=t,e[s]=r,s=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var a=0,r=e.length,l=r>>>1;a<l;){var i=2*(a+1)-1,o=e[i],d=i+1,c=e[d];if(0>n(o,s))d<r&&0>n(c,o)?(e[a]=c,e[d]=s,a=d):(e[a]=o,e[i]=s,a=i);else{if(!(d<r&&0>n(c,s)))break e;e[a]=c,e[d]=s,a=d}}}return t}function n(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;t.unstable_now=function(){return l.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var d=[],c=[],u=1,m=null,h=3,x=!1,p=!1,b=!1,g="function"===typeof setTimeout?setTimeout:null,f="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=a(c);null!==t;){if(null===t.callback)r(c);else{if(!(t.startTime<=e))break;r(c),t.sortIndex=t.expirationTime,s(d,t)}t=a(c)}}function w(e){if(b=!1,v(e),!p)if(null!==a(d))p=!0,R(j);else{var t=a(c);null!==t&&D(w,t.startTime-e)}}function j(e,s){p=!1,b&&(b=!1,f(C),C=-1),x=!0;var n=h;try{for(v(s),m=a(d);null!==m&&(!(m.expirationTime>s)||e&&!P());){var l=m.callback;if("function"===typeof l){m.callback=null,h=m.priorityLevel;var i=l(m.expirationTime<=s);s=t.unstable_now(),"function"===typeof i?m.callback=i:m===a(d)&&r(d),v(s)}else r(d);m=a(d)}if(null!==m)var o=!0;else{var u=a(c);null!==u&&D(w,u.startTime-s),o=!1}return o}finally{m=null,h=n,x=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,S=!1,k=null,C=-1,A=5,_=-1;function P(){return!(t.unstable_now()-_<A)}function T(){if(null!==k){var e=t.unstable_now();_=e;var s=!0;try{s=k(!0,e)}finally{s?N():(S=!1,k=null)}}else S=!1}if("function"===typeof y)N=function(){y(T)};else if("undefined"!==typeof MessageChannel){var E=new MessageChannel,I=E.port2;E.port1.onmessage=T,N=function(){I.postMessage(null)}}else N=function(){g(T,0)};function R(e){k=e,S||(S=!0,N())}function D(e,s){C=g(function(){e(t.unstable_now())},s)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||x||(p=!0,R(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return a(d)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var s=h;h=t;try{return e()}finally{h=s}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=h;h=e;try{return t()}finally{h=s}},t.unstable_scheduleCallback=function(e,r,n){var l=t.unstable_now();switch("object"===typeof n&&null!==n?n="number"===typeof(n=n.delay)&&0<n?l+n:l:n=l,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:n,expirationTime:i=n+i,sortIndex:-1},n>l?(e.sortIndex=n,s(c,e),null===a(d)&&e===a(c)&&(b?(f(C),C=-1):b=!0,D(w,n-l))):(e.sortIndex=i,s(d,e),p||x||(p=!0,R(j))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=h;return function(){var s=h;h=t;try{return e.apply(this,arguments)}finally{h=s}}}},391:(e,t,s)=>{var a=s(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},555:(e,t,s)=>{function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function r(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function n(e,t,s){return(t=r(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)}return s}function i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach(function(t){n(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}s.d(t,{A:()=>i})},579:(e,t,s)=>{e.exports=s(153)},730:(e,t,s)=>{var a=s(43),r=s(853);function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,i={};function o(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(i[e]=t,e=0;e<t.length;e++)l.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},x={};function p(e,t,s,a,r,n,l){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=l}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){b[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];b[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){b[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){b[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){b[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){b[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){b[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){b[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){b[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var g=/[\-:]([a-z])/g;function f(e){return e[1].toUpperCase()}function y(e,t,s,a){var r=b.hasOwnProperty(t)?b[t]:null;(null!==r?0!==r.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,a){if(null===t||"undefined"===typeof t||function(e,t,s,a){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,a))return!0;if(a)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,r,a)&&(s=null),a||null===r?function(e){return!!u.call(x,e)||!u.call(h,e)&&(m.test(e)?x[e]=!0:(h[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):r.mustUseProperty?e[r.propertyName]=null===s?3!==r.type&&"":s:(t=r.attributeName,a=r.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(r=r.type)||4===r&&!0===s?"":""+s,a?e.setAttributeNS(a,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(g,f);b[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(g,f);b[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(g,f);b[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){b[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),b.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){b[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var v=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),j=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),A=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var L,F=Object.assign;function M(e){if(void 0===L)try{throw Error()}catch(ha){var t=ha.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var B=!1;function q(e,t){if(!e||B)return"";B=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(da){var a=da}Reflect.construct(e,[],t)}else{try{t.call()}catch(da){a=da}e.call(t.prototype)}else{try{throw Error()}catch(da){a=da}e()}}catch(da){if(da&&a&&"string"===typeof da.stack){for(var r=da.stack.split("\n"),n=a.stack.split("\n"),l=r.length-1,i=n.length-1;1<=l&&0<=i&&r[l]!==n[i];)i--;for(;1<=l&&0<=i;l--,i--)if(r[l]!==n[i]){if(1!==l||1!==i)do{if(l--,0>--i||r[l]!==n[i]){var o="\n"+r[l].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=l&&0<=i);break}}}finally{B=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?M(e):""}function U(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=q(e.type,!1);case 11:return e=q(e.type.render,!1);case 1:return e=q(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case j:return"Portal";case k:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return z(e(t))}catch(ha){}}return null}function K(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof s&&"function"===typeof s.get&&"function"===typeof s.set){var r=s.get,n=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){a=""+e,n.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),a="";return e&&(a=H(e)?e.checked?"true":"false":e.value),(e=a)!==s&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var s=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function Y(e,t){var s=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;s=W(null!=t.value?t.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Z(e,t){$(e,t);var s=W(t.value),a=t.type;if(null!=s)"number"===a?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,s):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function ee(e,t,s){"number"===t&&Q(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var te=Array.isArray;function se(e,t,s,a){if(e=e.options,t){t={};for(var r=0;r<s.length;r++)t["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=t.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&a&&(e[s].defaultSelected=!0)}else{for(s=""+W(s),t=null,r=0;r<e.length;r++){if(e[r].value===s)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(n(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(n(92));if(te(s)){if(1<s.length)throw Error(n(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:W(s)}}function ne(e,t){var s=W(t.value),a=W(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=a&&(e.defaultValue=""+a)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var de,ce=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,s,a,r){MSApp.execUnsafeLocalFunction(function(){return e(t,s)})}:e}(function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((de=de||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=de.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ue(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function xe(e,t,s){return null==t||"boolean"===typeof t||""===t?"":s||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function pe(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var a=0===s.indexOf("--"),r=xe(s,t[s],a);"float"===s&&(s="cssFloat"),a?e.setProperty(s,r):e[s]=r}}Object.keys(me).forEach(function(e){he.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var be=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(be[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(n(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(n(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(n(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(n(62))}}function fe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function ve(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,je=null,Ne=null;function Se(e){if(e=Ar(e)){if("function"!==typeof we)throw Error(n(280));var t=e.stateNode;t&&(t=Pr(t),we(e.stateNode,e.type,t))}}function ke(e){je?Ne?Ne.push(e):Ne=[e]:je=e}function Ce(){if(je){var e=je,t=Ne;if(Ne=je=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ae(e,t){return e(t)}function _e(){}var Pe=!1;function Te(e,t,s){if(Pe)return e(t,s);Pe=!0;try{return Ae(e,t,s)}finally{Pe=!1,(null!==je||null!==Ne)&&(_e(),Ce())}}function Ee(e,t){var s=e.stateNode;if(null===s)return null;var a=Pr(s);if(null===a)return null;s=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(s&&"function"!==typeof s)throw Error(n(231,t,typeof s));return s}var Ie=!1;if(c)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ca){Ie=!1}function De(e,t,s,a,r,n,l,i,o){var d=Array.prototype.slice.call(arguments,3);try{t.apply(s,d)}catch(c){this.onError(c)}}var Oe=!1,Le=null,Fe=!1,Me=null,Be={onError:function(e){Oe=!0,Le=e}};function qe(e,t,s,a,r,n,l,i,o){Oe=!1,Le=null,De.apply(Be,arguments)}function Ue(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ke(e){if(Ue(e)!==e)throw Error(n(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(n(188));return t!==e?null:e}for(var s=e,a=t;;){var r=s.return;if(null===r)break;var l=r.alternate;if(null===l){if(null!==(a=r.return)){s=a;continue}break}if(r.child===l.child){for(l=r.child;l;){if(l===s)return Ke(r),e;if(l===a)return Ke(r),t;l=l.sibling}throw Error(n(188))}if(s.return!==a.return)s=r,a=l;else{for(var i=!1,o=r.child;o;){if(o===s){i=!0,s=r,a=l;break}if(o===a){i=!0,a=r,s=l;break}o=o.sibling}if(!i){for(o=l.child;o;){if(o===s){i=!0,s=l,a=r;break}if(o===a){i=!0,a=l,s=r;break}o=o.sibling}if(!i)throw Error(n(189))}}if(s.alternate!==a)throw Error(n(190))}if(3!==s.tag)throw Error(n(188));return s.stateNode.current===s?e:t}(e),null!==e?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ve=r.unstable_scheduleCallback,Je=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Ge=r.unstable_requestPaint,Ye=r.unstable_now,$e=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,Xe=r.unstable_UserBlockingPriority,et=r.unstable_NormalPriority,tt=r.unstable_LowPriority,st=r.unstable_IdlePriority,at=null,rt=null;var nt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lt(e)/it|0)|0},lt=Math.log,it=Math.LN2;var ot=64,dt=4194304;function ct(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var s=e.pendingLanes;if(0===s)return 0;var a=0,r=e.suspendedLanes,n=e.pingedLanes,l=268435455&s;if(0!==l){var i=l&~r;0!==i?a=ct(i):0!==(n&=l)&&(a=ct(n))}else 0!==(l=s&~r)?a=ct(l):0!==n&&(a=ct(n));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&r)&&((r=a&-a)>=(n=t&-t)||16===r&&0!==(4194240&n)))return t;if(0!==(4&a)&&(a|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)r=1<<(s=31-nt(t)),a|=e[s],t&=~r;return a}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function xt(){var e=ot;return 0===(4194240&(ot<<=1))&&(ot=64),e}function pt(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function bt(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-nt(t)]=s}function gt(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var a=31-nt(s),r=1<<a;r&t|e[a]&t&&(e[a]|=t),s&=~r}}var ft=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var vt,wt,jt,Nt,St,kt=!1,Ct=[],At=null,_t=null,Pt=null,Tt=new Map,Et=new Map,It=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Et.delete(t.pointerId)}}function Ot(e,t,s,a,r,n){return null===e||e.nativeEvent!==n?(e={blockedOn:t,domEventName:s,eventSystemFlags:a,nativeEvent:n,targetContainers:[r]},null!==t&&(null!==(t=Ar(t))&&wt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=Cr(e.target);if(null!==t){var s=Ue(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=ze(s)))return e.blockedOn=t,void St(e.priority,function(){jt(s)})}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=Ar(s))&&wt(t),e.blockedOn=s,!1;var a=new(s=e.nativeEvent).constructor(s.type,s);ye=a,s.target.dispatchEvent(a),ye=null,t.shift()}return!0}function Mt(e,t,s){Ft(e)&&s.delete(t)}function Bt(){kt=!1,null!==At&&Ft(At)&&(At=null),null!==_t&&Ft(_t)&&(_t=null),null!==Pt&&Ft(Pt)&&(Pt=null),Tt.forEach(Mt),Et.forEach(Mt)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bt)))}function Ut(e){function t(t){return qt(t,e)}if(0<Ct.length){qt(Ct[0],e);for(var s=1;s<Ct.length;s++){var a=Ct[s];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==At&&qt(At,e),null!==_t&&qt(_t,e),null!==Pt&&qt(Pt,e),Tt.forEach(t),Et.forEach(t),s=0;s<It.length;s++)(a=It[s]).blockedOn===e&&(a.blockedOn=null);for(;0<It.length&&null===(s=It[0]).blockedOn;)Lt(s),null===s.blockedOn&&It.shift()}var zt=v.ReactCurrentBatchConfig,Kt=!0;function Wt(e,t,s,a){var r=ft,n=zt.transition;zt.transition=null;try{ft=1,Vt(e,t,s,a)}finally{ft=r,zt.transition=n}}function Ht(e,t,s,a){var r=ft,n=zt.transition;zt.transition=null;try{ft=4,Vt(e,t,s,a)}finally{ft=r,zt.transition=n}}function Vt(e,t,s,a){if(Kt){var r=Qt(e,t,s,a);if(null===r)$a(e,t,a,Jt,s),Dt(e,a);else if(function(e,t,s,a,r){switch(t){case"focusin":return At=Ot(At,e,t,s,a,r),!0;case"dragenter":return _t=Ot(_t,e,t,s,a,r),!0;case"mouseover":return Pt=Ot(Pt,e,t,s,a,r),!0;case"pointerover":var n=r.pointerId;return Tt.set(n,Ot(Tt.get(n)||null,e,t,s,a,r)),!0;case"gotpointercapture":return n=r.pointerId,Et.set(n,Ot(Et.get(n)||null,e,t,s,a,r)),!0}return!1}(r,e,t,s,a))a.stopPropagation();else if(Dt(e,a),4&t&&-1<Rt.indexOf(e)){for(;null!==r;){var n=Ar(r);if(null!==n&&vt(n),null===(n=Qt(e,t,s,a))&&$a(e,t,a,Jt,s),n===r)break;r=n}null!==r&&a.stopPropagation()}else $a(e,t,a,null,s)}}var Jt=null;function Qt(e,t,s,a){if(Jt=null,null!==(e=Cr(e=ve(a))))if(null===(t=Ue(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case Xe:return 4;case et:case tt:return 16;case st:return 536870912;default:return 16}default:return 16}}var Yt=null,$t=null,Zt=null;function Xt(){if(Zt)return Zt;var e,t,s=$t,a=s.length,r="value"in Yt?Yt.value:Yt.textContent,n=r.length;for(e=0;e<a&&s[e]===r[e];e++);var l=a-e;for(t=1;t<=l&&s[a-t]===r[n-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function es(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ts(){return!0}function ss(){return!1}function as(e){function t(t,s,a,r,n){for(var l in this._reactName=t,this._targetInst=a,this.type=s,this.nativeEvent=r,this.target=n,this.currentTarget=null,e)e.hasOwnProperty(l)&&(t=e[l],this[l]=t?t(r):r[l]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ts:ss,this.isPropagationStopped=ss,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ts)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ts)},persist:function(){},isPersistent:ts}),t}var rs,ns,ls,is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},os=as(is),ds=F({},is,{view:0,detail:0}),cs=as(ds),us=F({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ns,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ls&&(ls&&"mousemove"===e.type?(rs=e.screenX-ls.screenX,ns=e.screenY-ls.screenY):ns=rs=0,ls=e),rs)},movementY:function(e){return"movementY"in e?e.movementY:ns}}),ms=as(us),hs=as(F({},us,{dataTransfer:0})),xs=as(F({},ds,{relatedTarget:0})),ps=as(F({},is,{animationName:0,elapsedTime:0,pseudoElement:0})),bs=F({},is,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gs=as(bs),fs=as(F({},is,{data:0})),ys={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ws={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function js(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ws[e])&&!!t[e]}function Ns(){return js}var Ss=F({},ds,{key:function(e){if(e.key){var t=ys[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=es(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?vs[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ns,charCode:function(e){return"keypress"===e.type?es(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?es(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ks=as(Ss),Cs=as(F({},us,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),As=as(F({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ns})),_s=as(F({},is,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ps=F({},us,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ts=as(Ps),Es=[9,13,27,32],Is=c&&"CompositionEvent"in window,Rs=null;c&&"documentMode"in document&&(Rs=document.documentMode);var Ds=c&&"TextEvent"in window&&!Rs,Os=c&&(!Is||Rs&&8<Rs&&11>=Rs),Ls=String.fromCharCode(32),Fs=!1;function Ms(e,t){switch(e){case"keyup":return-1!==Es.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bs(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qs=!1;var Us={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zs(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Us[e.type]:"textarea"===t}function Ks(e,t,s,a){ke(a),0<(t=Xa(t,"onChange")).length&&(s=new os("onChange","change",null,s,a),e.push({event:s,listeners:t}))}var Ws=null,Hs=null;function Vs(e){Ha(e,0)}function Js(e){if(J(_r(e)))return e}function Qs(e,t){if("change"===e)return t}var Gs=!1;if(c){var Ys;if(c){var $s="oninput"in document;if(!$s){var Zs=document.createElement("div");Zs.setAttribute("oninput","return;"),$s="function"===typeof Zs.oninput}Ys=$s}else Ys=!1;Gs=Ys&&(!document.documentMode||9<document.documentMode)}function Xs(){Ws&&(Ws.detachEvent("onpropertychange",ea),Hs=Ws=null)}function ea(e){if("value"===e.propertyName&&Js(Hs)){var t=[];Ks(t,Hs,e,ve(e)),Te(Vs,t)}}function ta(e,t,s){"focusin"===e?(Xs(),Hs=s,(Ws=t).attachEvent("onpropertychange",ea)):"focusout"===e&&Xs()}function sa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Js(Hs)}function aa(e,t){if("click"===e)return Js(t)}function ra(e,t){if("input"===e||"change"===e)return Js(t)}var na="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function la(e,t){if(na(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var r=s[a];if(!u.call(t,r)||!na(e[r],t[r]))return!1}return!0}function ua(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ma(e,t){var s,a=ua(e);for(e=0;a;){if(3===a.nodeType){if(s=e+a.textContent.length,e<=t&&s>=t)return{node:a,offset:t-e};e=s}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ua(a)}}function xa(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?xa(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pa(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var s="string"===typeof t.contentWindow.location.href}catch(ga){s=!1}if(!s)break;t=Q((e=t.contentWindow).document)}return t}function ba(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ya(e){var t=pa(),s=e.focusedElem,a=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&xa(s.ownerDocument.documentElement,s)){if(null!==a&&ba(s))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=s.textContent.length,n=Math.min(a.start,r);a=void 0===a.end?n:Math.min(a.end,r),!e.extend&&n>a&&(r=a,a=n,n=r),r=ma(s,n);var l=ma(s,a);r&&l&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),n>a?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var wa=c&&"documentMode"in document&&11>=document.documentMode,ja=null,Na=null,Sa=null,ka=!1;function Ca(e,t,s){var a=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;ka||null==ja||ja!==Q(a)||("selectionStart"in(a=ja)&&ba(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},Sa&&la(Sa,a)||(Sa=a,0<(a=Xa(Na,"onSelect")).length&&(t=new os("onSelect","select",null,t,s),e.push({event:t,listeners:a}),t.target=ja)))}function Aa(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var _a={animationend:Aa("Animation","AnimationEnd"),animationiteration:Aa("Animation","AnimationIteration"),animationstart:Aa("Animation","AnimationStart"),transitionend:Aa("Transition","TransitionEnd")},Pa={},Ta={};function Ea(e){if(Pa[e])return Pa[e];if(!_a[e])return e;var t,s=_a[e];for(t in s)if(s.hasOwnProperty(t)&&t in Ta)return Pa[e]=s[t];return e}c&&(Ta=document.createElement("div").style,"AnimationEvent"in window||(delete _a.animationend.animation,delete _a.animationiteration.animation,delete _a.animationstart.animation),"TransitionEvent"in window||delete _a.transitionend.transition);var Ia=Ea("animationend"),Ra=Ea("animationiteration"),Da=Ea("animationstart"),Oa=Ea("transitionend"),La=new Map,Fa="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ma(e,t){La.set(e,t),o(t,[e])}for(var Ba=0;Ba<Fa.length;Ba++){var qa=Fa[Ba];Ma(qa.toLowerCase(),"on"+(qa[0].toUpperCase()+qa.slice(1)))}Ma(Ia,"onAnimationEnd"),Ma(Ra,"onAnimationIteration"),Ma(Da,"onAnimationStart"),Ma("dblclick","onDoubleClick"),Ma("focusin","onFocus"),Ma("focusout","onBlur"),Ma(Oa,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ka=new Set("cancel close invalid load scroll toggle".split(" ").concat(za));function Wa(e,t,s){var a=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,a,r,l,i,o,d){if(qe.apply(this,arguments),Oe){if(!Oe)throw Error(n(198));var c=Le;Oe=!1,Le=null,Fe||(Fe=!0,Me=c)}}(a,t,void 0,e),e.currentTarget=null}function Ha(e,t){t=0!==(4&t);for(var s=0;s<e.length;s++){var a=e[s],r=a.event;a=a.listeners;e:{var n=void 0;if(t)for(var l=a.length-1;0<=l;l--){var i=a[l],o=i.instance,d=i.currentTarget;if(i=i.listener,o!==n&&r.isPropagationStopped())break e;Wa(r,i,d),n=o}else for(l=0;l<a.length;l++){if(o=(i=a[l]).instance,d=i.currentTarget,i=i.listener,o!==n&&r.isPropagationStopped())break e;Wa(r,i,d),n=o}}}if(Fe)throw e=Me,Fe=!1,Me=null,e}function Va(e,t){var s=t[Nr];void 0===s&&(s=t[Nr]=new Set);var a=e+"__bubble";s.has(a)||(Ya(t,e,2,!1),s.add(a))}function Ja(e,t,s){var a=0;t&&(a|=4),Ya(s,e,a,t)}var Qa="_reactListening"+Math.random().toString(36).slice(2);function Ga(e){if(!e[Qa]){e[Qa]=!0,l.forEach(function(t){"selectionchange"!==t&&(Ka.has(t)||Ja(t,!1,e),Ja(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qa]||(t[Qa]=!0,Ja("selectionchange",!1,t))}}function Ya(e,t,s,a){switch(Gt(t)){case 1:var r=Wt;break;case 4:r=Ht;break;default:r=Vt}s=r.bind(null,t,s,e),r=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,s,{capture:!0,passive:r}):e.addEventListener(t,s,!0):void 0!==r?e.addEventListener(t,s,{passive:r}):e.addEventListener(t,s,!1)}function $a(e,t,s,a,r){var n=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var l=a.tag;if(3===l||4===l){var i=a.stateNode.containerInfo;if(i===r||8===i.nodeType&&i.parentNode===r)break;if(4===l)for(l=a.return;null!==l;){var o=l.tag;if((3===o||4===o)&&((o=l.stateNode.containerInfo)===r||8===o.nodeType&&o.parentNode===r))return;l=l.return}for(;null!==i;){if(null===(l=Cr(i)))return;if(5===(o=l.tag)||6===o){a=n=l;continue e}i=i.parentNode}}a=a.return}Te(function(){var a=n,r=ve(s),l=[];e:{var i=La.get(e);if(void 0!==i){var o=os,d=e;switch(e){case"keypress":if(0===es(s))break e;case"keydown":case"keyup":o=ks;break;case"focusin":d="focus",o=xs;break;case"focusout":d="blur",o=xs;break;case"beforeblur":case"afterblur":o=xs;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=ms;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=hs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=As;break;case Ia:case Ra:case Da:o=ps;break;case Oa:o=_s;break;case"scroll":o=cs;break;case"wheel":o=Ts;break;case"copy":case"cut":case"paste":o=gs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=Cs}var c=0!==(4&t),u=!c&&"scroll"===e,m=c?null!==i?i+"Capture":null:i;c=[];for(var h,x=a;null!==x;){var p=(h=x).stateNode;if(5===h.tag&&null!==p&&(h=p,null!==m&&(null!=(p=Ee(x,m))&&c.push(Za(x,p,h)))),u)break;x=x.return}0<c.length&&(i=new o(i,d,null,s,r),l.push({event:i,listeners:c}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||s===ye||!(d=s.relatedTarget||s.fromElement)||!Cr(d)&&!d[jr])&&(o||i)&&(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=a,null!==(d=(d=s.relatedTarget||s.toElement)?Cr(d):null)&&(d!==(u=Ue(d))||5!==d.tag&&6!==d.tag)&&(d=null)):(o=null,d=a),o!==d)){if(c=ms,p="onMouseLeave",m="onMouseEnter",x="mouse","pointerout"!==e&&"pointerover"!==e||(c=Cs,p="onPointerLeave",m="onPointerEnter",x="pointer"),u=null==o?i:_r(o),h=null==d?i:_r(d),(i=new c(p,x+"leave",o,s,r)).target=u,i.relatedTarget=h,p=null,Cr(r)===a&&((c=new c(m,x+"enter",d,s,r)).target=h,c.relatedTarget=u,p=c),u=p,o&&d)e:{for(m=d,x=0,h=c=o;h;h=er(h))x++;for(h=0,p=m;p;p=er(p))h++;for(;0<x-h;)c=er(c),x--;for(;0<h-x;)m=er(m),h--;for(;x--;){if(c===m||null!==m&&c===m.alternate)break e;c=er(c),m=er(m)}c=null}else c=null;null!==o&&tr(l,i,o,c,!1),null!==d&&null!==u&&tr(l,u,d,c,!0)}if("select"===(o=(i=a?_r(a):window).nodeName&&i.nodeName.toLowerCase())||"input"===o&&"file"===i.type)var b=Qs;else if(zs(i))if(Gs)b=ra;else{b=sa;var g=ta}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(b=aa);switch(b&&(b=b(e,a))?Ks(l,b,s,r):(g&&g(e,i,a),"focusout"===e&&(g=i._wrapperState)&&g.controlled&&"number"===i.type&&ee(i,"number",i.value)),g=a?_r(a):window,e){case"focusin":(zs(g)||"true"===g.contentEditable)&&(ja=g,Na=a,Sa=null);break;case"focusout":Sa=Na=ja=null;break;case"mousedown":ka=!0;break;case"contextmenu":case"mouseup":case"dragend":ka=!1,Ca(l,s,r);break;case"selectionchange":if(wa)break;case"keydown":case"keyup":Ca(l,s,r)}var f;if(Is)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else qs?Ms(e,s)&&(y="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(y="onCompositionStart");y&&(Os&&"ko"!==s.locale&&(qs||"onCompositionStart"!==y?"onCompositionEnd"===y&&qs&&(f=Xt()):($t="value"in(Yt=r)?Yt.value:Yt.textContent,qs=!0)),0<(g=Xa(a,y)).length&&(y=new fs(y,e,null,s,r),l.push({event:y,listeners:g}),f?y.data=f:null!==(f=Bs(s))&&(y.data=f))),(f=Ds?function(e,t){switch(e){case"compositionend":return Bs(t);case"keypress":return 32!==t.which?null:(Fs=!0,Ls);case"textInput":return(e=t.data)===Ls&&Fs?null:e;default:return null}}(e,s):function(e,t){if(qs)return"compositionend"===e||!Is&&Ms(e,t)?(e=Xt(),Zt=$t=Yt=null,qs=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Os&&"ko"!==t.locale?null:t.data}}(e,s))&&(0<(a=Xa(a,"onBeforeInput")).length&&(r=new fs("onBeforeInput","beforeinput",null,s,r),l.push({event:r,listeners:a}),r.data=f))}Ha(l,t)})}function Za(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Xa(e,t){for(var s=t+"Capture",a=[];null!==e;){var r=e,n=r.stateNode;5===r.tag&&null!==n&&(r=n,null!=(n=Ee(e,s))&&a.unshift(Za(e,n,r)),null!=(n=Ee(e,t))&&a.push(Za(e,n,r))),e=e.return}return a}function er(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function tr(e,t,s,a,r){for(var n=t._reactName,l=[];null!==s&&s!==a;){var i=s,o=i.alternate,d=i.stateNode;if(null!==o&&o===a)break;5===i.tag&&null!==d&&(i=d,r?null!=(o=Ee(s,n))&&l.unshift(Za(s,o,i)):r||null!=(o=Ee(s,n))&&l.push(Za(s,o,i))),s=s.return}0!==l.length&&e.push({event:t,listeners:l})}var sr=/\r\n?/g,ar=/\u0000|\uFFFD/g;function nr(e){return("string"===typeof e?e:""+e).replace(sr,"\n").replace(ar,"")}function lr(e,t,s){if(t=nr(t),nr(e)!==t&&s)throw Error(n(425))}function ir(){}var or=null,dr=null;function cr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ur="function"===typeof setTimeout?setTimeout:void 0,mr="function"===typeof clearTimeout?clearTimeout:void 0,hr="function"===typeof Promise?Promise:void 0,xr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof hr?function(e){return hr.resolve(null).then(e).catch(pr)}:ur;function pr(e){setTimeout(function(){throw e})}function br(e,t){var s=t,a=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&8===r.nodeType)if("/$"===(s=r.data)){if(0===a)return e.removeChild(r),void Ut(t);a--}else"$"!==s&&"$?"!==s&&"$!"!==s||a++;s=r}while(s);Ut(t)}function gr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function fr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var yr=Math.random().toString(36).slice(2),vr="__reactFiber$"+yr,wr="__reactProps$"+yr,jr="__reactContainer$"+yr,Nr="__reactEvents$"+yr,Sr="__reactListeners$"+yr,kr="__reactHandles$"+yr;function Cr(e){var t=e[vr];if(t)return t;for(var s=e.parentNode;s;){if(t=s[jr]||s[vr]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=fr(e);null!==e;){if(s=e[vr])return s;e=fr(e)}return t}s=(e=s).parentNode}return null}function Ar(e){return!(e=e[vr]||e[jr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _r(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(n(33))}function Pr(e){return e[wr]||null}var Tr=[],Er=-1;function Ir(e){return{current:e}}function Rr(e){0>Er||(e.current=Tr[Er],Tr[Er]=null,Er--)}function Dr(e,t){Er++,Tr[Er]=e.current,e.current=t}var Or={},Lr=Ir(Or),Fr=Ir(!1),Mr=Or;function Br(e,t){var s=e.type.contextTypes;if(!s)return Or;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var r,n={};for(r in s)n[r]=t[r];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function qr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ur(){Rr(Fr),Rr(Lr)}function zr(e,t,s){if(Lr.current!==Or)throw Error(n(168));Dr(Lr,t),Dr(Fr,s)}function Kr(e,t,s){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return s;for(var r in a=a.getChildContext())if(!(r in t))throw Error(n(108,K(e)||"Unknown",r));return F({},s,a)}function Wr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Or,Mr=Lr.current,Dr(Lr,e),Dr(Fr,Fr.current),!0}function Hr(e,t,s){var a=e.stateNode;if(!a)throw Error(n(169));s?(e=Kr(e,t,Mr),a.__reactInternalMemoizedMergedChildContext=e,Rr(Fr),Rr(Lr),Dr(Lr,e)):Rr(Fr),Dr(Fr,s)}var Vr=null,Jr=!1,Qr=!1;function Gr(e){null===Vr?Vr=[e]:Vr.push(e)}function Yr(){if(!Qr&&null!==Vr){Qr=!0;var e=0,t=ft;try{var s=Vr;for(ft=1;e<s.length;e++){var a=s[e];do{a=a(!0)}while(null!==a)}Vr=null,Jr=!1}catch(ia){throw null!==Vr&&(Vr=Vr.slice(e+1)),Ve(Ze,Yr),ia}finally{ft=t,Qr=!1}}return null}var $r=[],Zr=0,Xr=null,en=0,tn=[],sn=0,an=null,rn=1,nn="";function ln(e,t){$r[Zr++]=en,$r[Zr++]=Xr,Xr=e,en=t}function on(e,t,s){tn[sn++]=rn,tn[sn++]=nn,tn[sn++]=an,an=e;var a=rn;e=nn;var r=32-nt(a)-1;a&=~(1<<r),s+=1;var n=32-nt(t)+r;if(30<n){var l=r-r%5;n=(a&(1<<l)-1).toString(32),a>>=l,r-=l,rn=1<<32-nt(t)+r|s<<r|a,nn=n+e}else rn=1<<n|s<<r|a,nn=e}function dn(e){null!==e.return&&(ln(e,1),on(e,1,0))}function cn(e){for(;e===Xr;)Xr=$r[--Zr],$r[Zr]=null,en=$r[--Zr],$r[Zr]=null;for(;e===an;)an=tn[--sn],tn[sn]=null,nn=tn[--sn],tn[sn]=null,rn=tn[--sn],tn[sn]=null}var un=null,mn=null,hn=!1,xn=null;function pn(e,t){var s=qd(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function bn(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,un=e,mn=gr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,un=e,mn=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==an?{id:rn,overflow:nn}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=qd(18,null,null,0)).stateNode=t,s.return=e,e.child=s,un=e,mn=null,!0);default:return!1}}function gn(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function fn(e){if(hn){var t=mn;if(t){var s=t;if(!bn(e,t)){if(gn(e))throw Error(n(418));t=gr(s.nextSibling);var a=un;t&&bn(e,t)?pn(a,s):(e.flags=-4097&e.flags|2,hn=!1,un=e)}}else{if(gn(e))throw Error(n(418));e.flags=-4097&e.flags|2,hn=!1,un=e}}}function yn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;un=e}function vn(e){if(e!==un)return!1;if(!hn)return yn(e),hn=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!cr(e.type,e.memoizedProps)),t&&(t=mn)){if(gn(e))throw wn(),Error(n(418));for(;t;)pn(e,t),t=gr(t.nextSibling)}if(yn(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(n(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){mn=gr(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}mn=null}}else mn=un?gr(e.stateNode.nextSibling):null;return!0}function wn(){for(var e=mn;e;)e=gr(e.nextSibling)}function jn(){mn=un=null,hn=!1}function Nn(e){null===xn?xn=[e]:xn.push(e)}var Sn=v.ReactCurrentBatchConfig;function kn(e,t,s){if(null!==(e=s.ref)&&"function"!==typeof e&&"object"!==typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(n(309));var a=s.stateNode}if(!a)throw Error(n(147,e));var r=a,l=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===l?t.ref:(t=function(e){var t=r.refs;null===e?delete t[l]:t[l]=e},t._stringRef=l,t)}if("string"!==typeof e)throw Error(n(284));if(!s._owner)throw Error(n(290,e))}return e}function Cn(e,t){throw e=Object.prototype.toString.call(t),Error(n(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function An(e){return(0,e._init)(e._payload)}function _n(e){function t(t,s){if(e){var a=t.deletions;null===a?(t.deletions=[s],t.flags|=16):a.push(s)}}function s(s,a){if(!e)return null;for(;null!==a;)t(s,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=zd(e,t)).index=0,e.sibling=null,e}function l(t,s,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<s?(t.flags|=2,s):a:(t.flags|=2,s):(t.flags|=1048576,s)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,s,a){return null===t||6!==t.tag?((t=Vd(s,e.mode,a)).return=e,t):((t=r(t,s)).return=e,t)}function d(e,t,s,a){var n=s.type;return n===N?u(e,t,s.props.children,a,s.key):null!==t&&(t.elementType===n||"object"===typeof n&&null!==n&&n.$$typeof===I&&An(n)===t.type)?((a=r(t,s.props)).ref=kn(e,t,s),a.return=e,a):((a=Kd(s.type,s.key,s.props,null,e.mode,a)).ref=kn(e,t,s),a.return=e,a)}function c(e,t,s,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=Jd(s,e.mode,a)).return=e,t):((t=r(t,s.children||[])).return=e,t)}function u(e,t,s,a,n){return null===t||7!==t.tag?((t=Wd(s,e.mode,a,n)).return=e,t):((t=r(t,s)).return=e,t)}function m(e,t,s){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Vd(""+t,e.mode,s)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(s=Kd(t.type,t.key,t.props,null,e.mode,s)).ref=kn(e,null,t),s.return=e,s;case j:return(t=Jd(t,e.mode,s)).return=e,t;case I:return m(e,(0,t._init)(t._payload),s)}if(te(t)||O(t))return(t=Wd(t,e.mode,s,null)).return=e,t;Cn(e,t)}return null}function h(e,t,s,a){var r=null!==t?t.key:null;if("string"===typeof s&&""!==s||"number"===typeof s)return null!==r?null:o(e,t,""+s,a);if("object"===typeof s&&null!==s){switch(s.$$typeof){case w:return s.key===r?d(e,t,s,a):null;case j:return s.key===r?c(e,t,s,a):null;case I:return h(e,t,(r=s._init)(s._payload),a)}if(te(s)||O(s))return null!==r?null:u(e,t,s,a,null);Cn(e,s)}return null}function x(e,t,s,a,r){if("string"===typeof a&&""!==a||"number"===typeof a)return o(t,e=e.get(s)||null,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case w:return d(t,e=e.get(null===a.key?s:a.key)||null,a,r);case j:return c(t,e=e.get(null===a.key?s:a.key)||null,a,r);case I:return x(e,t,s,(0,a._init)(a._payload),r)}if(te(a)||O(a))return u(t,e=e.get(s)||null,a,r,null);Cn(t,a)}return null}function p(r,n,i,o){for(var d=null,c=null,u=n,p=n=0,b=null;null!==u&&p<i.length;p++){u.index>p?(b=u,u=null):b=u.sibling;var g=h(r,u,i[p],o);if(null===g){null===u&&(u=b);break}e&&u&&null===g.alternate&&t(r,u),n=l(g,n,p),null===c?d=g:c.sibling=g,c=g,u=b}if(p===i.length)return s(r,u),hn&&ln(r,p),d;if(null===u){for(;p<i.length;p++)null!==(u=m(r,i[p],o))&&(n=l(u,n,p),null===c?d=u:c.sibling=u,c=u);return hn&&ln(r,p),d}for(u=a(r,u);p<i.length;p++)null!==(b=x(u,r,p,i[p],o))&&(e&&null!==b.alternate&&u.delete(null===b.key?p:b.key),n=l(b,n,p),null===c?d=b:c.sibling=b,c=b);return e&&u.forEach(function(e){return t(r,e)}),hn&&ln(r,p),d}function b(r,i,o,d){var c=O(o);if("function"!==typeof c)throw Error(n(150));if(null==(o=c.call(o)))throw Error(n(151));for(var u=c=null,p=i,b=i=0,g=null,f=o.next();null!==p&&!f.done;b++,f=o.next()){p.index>b?(g=p,p=null):g=p.sibling;var y=h(r,p,f.value,d);if(null===y){null===p&&(p=g);break}e&&p&&null===y.alternate&&t(r,p),i=l(y,i,b),null===u?c=y:u.sibling=y,u=y,p=g}if(f.done)return s(r,p),hn&&ln(r,b),c;if(null===p){for(;!f.done;b++,f=o.next())null!==(f=m(r,f.value,d))&&(i=l(f,i,b),null===u?c=f:u.sibling=f,u=f);return hn&&ln(r,b),c}for(p=a(r,p);!f.done;b++,f=o.next())null!==(f=x(p,r,b,f.value,d))&&(e&&null!==f.alternate&&p.delete(null===f.key?b:f.key),i=l(f,i,b),null===u?c=f:u.sibling=f,u=f);return e&&p.forEach(function(e){return t(r,e)}),hn&&ln(r,b),c}return function e(a,n,l,o){if("object"===typeof l&&null!==l&&l.type===N&&null===l.key&&(l=l.props.children),"object"===typeof l&&null!==l){switch(l.$$typeof){case w:e:{for(var d=l.key,c=n;null!==c;){if(c.key===d){if((d=l.type)===N){if(7===c.tag){s(a,c.sibling),(n=r(c,l.props.children)).return=a,a=n;break e}}else if(c.elementType===d||"object"===typeof d&&null!==d&&d.$$typeof===I&&An(d)===c.type){s(a,c.sibling),(n=r(c,l.props)).ref=kn(a,c,l),n.return=a,a=n;break e}s(a,c);break}t(a,c),c=c.sibling}l.type===N?((n=Wd(l.props.children,a.mode,o,l.key)).return=a,a=n):((o=Kd(l.type,l.key,l.props,null,a.mode,o)).ref=kn(a,n,l),o.return=a,a=o)}return i(a);case j:e:{for(c=l.key;null!==n;){if(n.key===c){if(4===n.tag&&n.stateNode.containerInfo===l.containerInfo&&n.stateNode.implementation===l.implementation){s(a,n.sibling),(n=r(n,l.children||[])).return=a,a=n;break e}s(a,n);break}t(a,n),n=n.sibling}(n=Jd(l,a.mode,o)).return=a,a=n}return i(a);case I:return e(a,n,(c=l._init)(l._payload),o)}if(te(l))return p(a,n,l,o);if(O(l))return b(a,n,l,o);Cn(a,l)}return"string"===typeof l&&""!==l||"number"===typeof l?(l=""+l,null!==n&&6===n.tag?(s(a,n.sibling),(n=r(n,l)).return=a,a=n):(s(a,n),(n=Vd(l,a.mode,o)).return=a,a=n),i(a)):s(a,n)}}var Pn=_n(!0),Tn=_n(!1),En=Ir(null),In=null,Rn=null,Dn=null;function On(){Dn=Rn=In=null}function Ln(e){var t=En.current;Rr(En),e._currentValue=t}function Fn(e,t,s){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===s)break;e=e.return}}function Mn(e,t){In=e,Dn=Rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ai=!0),e.firstContext=null)}function Bn(e){var t=e._currentValue;if(Dn!==e)if(e={context:e,memoizedValue:t,next:null},null===Rn){if(null===In)throw Error(n(308));Rn=e,In.dependencies={lanes:0,firstContext:e}}else Rn=Rn.next=e;return t}var qn=null;function Un(e){null===qn?qn=[e]:qn.push(e)}function zn(e,t,s,a){var r=t.interleaved;return null===r?(s.next=s,Un(t)):(s.next=r.next,r.next=s),t.interleaved=s,Kn(e,a)}function Kn(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var Wn=!1;function Hn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Jn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qn(e,t,s){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Fo)){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,Kn(e,s)}return null===(r=a.interleaved)?(t.next=t,Un(a)):(t.next=r.next,r.next=t),a.interleaved=t,Kn(e,s)}function Gn(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&s))){var a=t.lanes;s|=a&=e.pendingLanes,t.lanes=s,gt(e,s)}}function Yn(e,t){var s=e.updateQueue,a=e.alternate;if(null!==a&&s===(a=a.updateQueue)){var r=null,n=null;if(null!==(s=s.firstBaseUpdate)){do{var l={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===n?r=n=l:n=n.next=l,s=s.next}while(null!==s);null===n?r=n=t:n=n.next=t}else r=n=t;return s={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:n,shared:a.shared,effects:a.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function $n(e,t,s,a){var r=e.updateQueue;Wn=!1;var n=r.firstBaseUpdate,l=r.lastBaseUpdate,i=r.shared.pending;if(null!==i){r.shared.pending=null;var o=i,d=o.next;o.next=null,null===l?n=d:l.next=d,l=o;var c=e.alternate;null!==c&&((i=(c=c.updateQueue).lastBaseUpdate)!==l&&(null===i?c.firstBaseUpdate=d:i.next=d,c.lastBaseUpdate=o))}if(null!==n){var u=r.baseState;for(l=0,c=d=o=null,i=n;;){var m=i.lane,h=i.eventTime;if((a&m)===m){null!==c&&(c=c.next={eventTime:h,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var x=e,p=i;switch(m=t,h=s,p.tag){case 1:if("function"===typeof(x=p.payload)){u=x.call(h,u,m);break e}u=x;break e;case 3:x.flags=-65537&x.flags|128;case 0:if(null===(m="function"===typeof(x=p.payload)?x.call(h,u,m):x)||void 0===m)break e;u=F({},u,m);break e;case 2:Wn=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(m=r.effects)?r.effects=[i]:m.push(i))}else h={eventTime:h,lane:m,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===c?(d=c=h,o=u):c=c.next=h,l|=m;if(null===(i=i.next)){if(null===(i=r.shared.pending))break;i=(m=i).next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}if(null===c&&(o=u),r.baseState=o,r.firstBaseUpdate=d,r.lastBaseUpdate=c,null!==(t=r.shared.interleaved)){r=t;do{l|=r.lane,r=r.next}while(r!==t)}else null===n&&(r.shared.lanes=0);Ho|=l,e.lanes=l,e.memoizedState=u}}function Zn(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],r=a.callback;if(null!==r){if(a.callback=null,a=s,"function"!==typeof r)throw Error(n(191,r));r.call(a)}}}var Xn={},el=Ir(Xn),tl=Ir(Xn),sl=Ir(Xn);function al(e){if(e===Xn)throw Error(n(174));return e}function rl(e,t){switch(Dr(sl,t),Dr(tl,e),Dr(el,Xn),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Rr(el),Dr(el,t)}function nl(){Rr(el),Rr(tl),Rr(sl)}function ll(e){al(sl.current);var t=al(el.current),s=oe(t,e.type);t!==s&&(Dr(tl,e),Dr(el,s))}function il(e){tl.current===e&&(Rr(el),Rr(tl))}var ol=Ir(0);function dl(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cl=[];function ul(){for(var e=0;e<cl.length;e++)cl[e]._workInProgressVersionPrimary=null;cl.length=0}var ml=v.ReactCurrentDispatcher,hl=v.ReactCurrentBatchConfig,xl=0,pl=null,bl=null,gl=null,fl=!1,yl=!1,vl=0,wl=0;function jl(){throw Error(n(321))}function Nl(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!na(e[s],t[s]))return!1;return!0}function Sl(e,t,s,a,r,l){if(xl=l,pl=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ml.current=null===e||null===e.memoizedState?ii:oi,e=s(a,r),yl){l=0;do{if(yl=!1,vl=0,25<=l)throw Error(n(301));l+=1,gl=bl=null,t.updateQueue=null,ml.current=di,e=s(a,r)}while(yl)}if(ml.current=li,t=null!==bl&&null!==bl.next,xl=0,gl=bl=pl=null,fl=!1,t)throw Error(n(300));return e}function kl(){var e=0!==vl;return vl=0,e}function Cl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===gl?pl.memoizedState=gl=e:gl=gl.next=e,gl}function Al(){if(null===bl){var e=pl.alternate;e=null!==e?e.memoizedState:null}else e=bl.next;var t=null===gl?pl.memoizedState:gl.next;if(null!==t)gl=t,bl=e;else{if(null===e)throw Error(n(310));e={memoizedState:(bl=e).memoizedState,baseState:bl.baseState,baseQueue:bl.baseQueue,queue:bl.queue,next:null},null===gl?pl.memoizedState=gl=e:gl=gl.next=e}return gl}function _l(e,t){return"function"===typeof t?t(e):t}function Pl(e){var t=Al(),s=t.queue;if(null===s)throw Error(n(311));s.lastRenderedReducer=e;var a=bl,r=a.baseQueue,l=s.pending;if(null!==l){if(null!==r){var i=r.next;r.next=l.next,l.next=i}a.baseQueue=r=l,s.pending=null}if(null!==r){l=r.next,a=a.baseState;var o=i=null,d=null,c=l;do{var u=c.lane;if((xl&u)===u)null!==d&&(d=d.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),a=c.hasEagerState?c.eagerState:e(a,c.action);else{var m={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===d?(o=d=m,i=a):d=d.next=m,pl.lanes|=u,Ho|=u}c=c.next}while(null!==c&&c!==l);null===d?i=a:d.next=o,na(a,t.memoizedState)||(Ai=!0),t.memoizedState=a,t.baseState=i,t.baseQueue=d,s.lastRenderedState=a}if(null!==(e=s.interleaved)){r=e;do{l=r.lane,pl.lanes|=l,Ho|=l,r=r.next}while(r!==e)}else null===r&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function Tl(e){var t=Al(),s=t.queue;if(null===s)throw Error(n(311));s.lastRenderedReducer=e;var a=s.dispatch,r=s.pending,l=t.memoizedState;if(null!==r){s.pending=null;var i=r=r.next;do{l=e(l,i.action),i=i.next}while(i!==r);na(l,t.memoizedState)||(Ai=!0),t.memoizedState=l,null===t.baseQueue&&(t.baseState=l),s.lastRenderedState=l}return[l,a]}function El(){}function Il(e,t){var s=pl,a=Al(),r=t(),l=!na(a.memoizedState,r);if(l&&(a.memoizedState=r,Ai=!0),a=a.queue,Wl(Ol.bind(null,s,a,e),[e]),a.getSnapshot!==t||l||null!==gl&&1&gl.memoizedState.tag){if(s.flags|=2048,Bl(9,Dl.bind(null,s,a,r,t),void 0,null),null===Mo)throw Error(n(349));0!==(30&xl)||Rl(s,t,r)}return r}function Rl(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=pl.updateQueue)?(t={lastEffect:null,stores:null},pl.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function Dl(e,t,s,a){t.value=s,t.getSnapshot=a,Ll(t)&&Fl(e)}function Ol(e,t,s){return s(function(){Ll(t)&&Fl(e)})}function Ll(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!na(e,s)}catch(ga){return!0}}function Fl(e){var t=Kn(e,1);null!==t&&ud(t,e,1,-1)}function Ml(e){var t=Cl();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:e},t.queue=e,e=e.dispatch=si.bind(null,pl,e),[t.memoizedState,e]}function Bl(e,t,s,a){return e={tag:e,create:t,destroy:s,deps:a,next:null},null===(t=pl.updateQueue)?(t={lastEffect:null,stores:null},pl.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,t.lastEffect=e),e}function ql(){return Al().memoizedState}function Ul(e,t,s,a){var r=Cl();pl.flags|=e,r.memoizedState=Bl(1|t,s,void 0,void 0===a?null:a)}function zl(e,t,s,a){var r=Al();a=void 0===a?null:a;var n=void 0;if(null!==bl){var l=bl.memoizedState;if(n=l.destroy,null!==a&&Nl(a,l.deps))return void(r.memoizedState=Bl(t,s,n,a))}pl.flags|=e,r.memoizedState=Bl(1|t,s,n,a)}function Kl(e,t){return Ul(8390656,8,e,t)}function Wl(e,t){return zl(2048,8,e,t)}function Hl(e,t){return zl(4,2,e,t)}function Vl(e,t){return zl(4,4,e,t)}function Jl(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ql(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,zl(4,4,Jl.bind(null,t,e),s)}function Gl(){}function Yl(e,t){var s=Al();t=void 0===t?null:t;var a=s.memoizedState;return null!==a&&null!==t&&Nl(t,a[1])?a[0]:(s.memoizedState=[e,t],e)}function $l(e,t){var s=Al();t=void 0===t?null:t;var a=s.memoizedState;return null!==a&&null!==t&&Nl(t,a[1])?a[0]:(e=e(),s.memoizedState=[e,t],e)}function Zl(e,t,s){return 0===(21&xl)?(e.baseState&&(e.baseState=!1,Ai=!0),e.memoizedState=s):(na(s,t)||(s=xt(),pl.lanes|=s,Ho|=s,e.baseState=!0),t)}function Xl(e,t){var s=ft;ft=0!==s&&4>s?s:4,e(!0);var a=hl.transition;hl.transition={};try{e(!1),t()}finally{ft=s,hl.transition=a}}function ei(){return Al().memoizedState}function ti(e,t,s){var a=cd(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},ai(e))ri(t,s);else if(null!==(s=zn(e,t,s,a))){ud(s,e,a,dd()),ni(s,t,a)}}function si(e,t,s){var a=cd(e),r={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(ai(e))ri(t,r);else{var n=e.alternate;if(0===e.lanes&&(null===n||0===n.lanes)&&null!==(n=t.lastRenderedReducer))try{var l=t.lastRenderedState,i=n(l,s);if(r.hasEagerState=!0,r.eagerState=i,na(i,l)){var o=t.interleaved;return null===o?(r.next=r,Un(t)):(r.next=o.next,o.next=r),void(t.interleaved=r)}}catch(da){}null!==(s=zn(e,t,r,a))&&(ud(s,e,a,r=dd()),ni(s,t,a))}}function ai(e){var t=e.alternate;return e===pl||null!==t&&t===pl}function ri(e,t){yl=fl=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function ni(e,t,s){if(0!==(4194240&s)){var a=t.lanes;s|=a&=e.pendingLanes,t.lanes=s,gt(e,s)}}var li={readContext:Bn,useCallback:jl,useContext:jl,useEffect:jl,useImperativeHandle:jl,useInsertionEffect:jl,useLayoutEffect:jl,useMemo:jl,useReducer:jl,useRef:jl,useState:jl,useDebugValue:jl,useDeferredValue:jl,useTransition:jl,useMutableSource:jl,useSyncExternalStore:jl,useId:jl,unstable_isNewReconciler:!1},ii={readContext:Bn,useCallback:function(e,t){return Cl().memoizedState=[e,void 0===t?null:t],e},useContext:Bn,useEffect:Kl,useImperativeHandle:function(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Ul(4194308,4,Jl.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Ul(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ul(4,2,e,t)},useMemo:function(e,t){var s=Cl();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var a=Cl();return t=void 0!==s?s(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=ti.bind(null,pl,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},Cl().memoizedState=e},useState:Ml,useDebugValue:Gl,useDeferredValue:function(e){return Cl().memoizedState=e},useTransition:function(){var e=Ml(!1),t=e[0];return e=Xl.bind(null,e[1]),Cl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var a=pl,r=Cl();if(hn){if(void 0===s)throw Error(n(407));s=s()}else{if(s=t(),null===Mo)throw Error(n(349));0!==(30&xl)||Rl(a,t,s)}r.memoizedState=s;var l={value:s,getSnapshot:t};return r.queue=l,Kl(Ol.bind(null,a,l,e),[e]),a.flags|=2048,Bl(9,Dl.bind(null,a,l,s,t),void 0,null),s},useId:function(){var e=Cl(),t=Mo.identifierPrefix;if(hn){var s=nn;t=":"+t+"R"+(s=(rn&~(1<<32-nt(rn)-1)).toString(32)+s),0<(s=vl++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=wl++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oi={readContext:Bn,useCallback:Yl,useContext:Bn,useEffect:Wl,useImperativeHandle:Ql,useInsertionEffect:Hl,useLayoutEffect:Vl,useMemo:$l,useReducer:Pl,useRef:ql,useState:function(){return Pl(_l)},useDebugValue:Gl,useDeferredValue:function(e){return Zl(Al(),bl.memoizedState,e)},useTransition:function(){return[Pl(_l)[0],Al().memoizedState]},useMutableSource:El,useSyncExternalStore:Il,useId:ei,unstable_isNewReconciler:!1},di={readContext:Bn,useCallback:Yl,useContext:Bn,useEffect:Wl,useImperativeHandle:Ql,useInsertionEffect:Hl,useLayoutEffect:Vl,useMemo:$l,useReducer:Tl,useRef:ql,useState:function(){return Tl(_l)},useDebugValue:Gl,useDeferredValue:function(e){var t=Al();return null===bl?t.memoizedState=e:Zl(t,bl.memoizedState,e)},useTransition:function(){return[Tl(_l)[0],Al().memoizedState]},useMutableSource:El,useSyncExternalStore:Il,useId:ei,unstable_isNewReconciler:!1};function ci(e,t){if(e&&e.defaultProps){for(var s in t=F({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function ui(e,t,s,a){s=null===(s=s(a,t=e.memoizedState))||void 0===s?t:F({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var mi={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var a=dd(),r=cd(e),n=Jn(a,r);n.payload=t,void 0!==s&&null!==s&&(n.callback=s),null!==(t=Qn(e,n,r))&&(ud(t,e,r,a),Gn(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var a=dd(),r=cd(e),n=Jn(a,r);n.tag=1,n.payload=t,void 0!==s&&null!==s&&(n.callback=s),null!==(t=Qn(e,n,r))&&(ud(t,e,r,a),Gn(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=dd(),a=cd(e),r=Jn(s,a);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Qn(e,r,a))&&(ud(t,e,a,s),Gn(t,e,a))}};function hi(e,t,s,a,r,n,l){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,n,l):!t.prototype||!t.prototype.isPureReactComponent||(!la(s,a)||!la(r,n))}function xi(e,t,s){var a=!1,r=Or,n=t.contextType;return"object"===typeof n&&null!==n?n=Bn(n):(r=qr(t)?Mr:Lr.current,n=(a=null!==(a=t.contextTypes)&&void 0!==a)?Br(e,r):Or),t=new t(s,n),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=mi,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=n),t}function pi(e,t,s,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,a),t.state!==e&&mi.enqueueReplaceState(t,t.state,null)}function bi(e,t,s,a){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},Hn(e);var n=t.contextType;"object"===typeof n&&null!==n?r.context=Bn(n):(n=qr(t)?Mr:Lr.current,r.context=Br(e,n)),r.state=e.memoizedState,"function"===typeof(n=t.getDerivedStateFromProps)&&(ui(e,t,n,s),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&mi.enqueueReplaceState(r,r.state,null),$n(e,s,r,a),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function gi(e,t){try{var s="",a=t;do{s+=U(a),a=a.return}while(a);var r=s}catch(fa){r="\nError generating stack: "+fa.message+"\n"+fa.stack}return{value:e,source:t,stack:r,digest:null}}function fi(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function yi(e,t){try{console.error(t.value)}catch(ha){setTimeout(function(){throw ha})}}var vi="function"===typeof WeakMap?WeakMap:Map;function wi(e,t,s){(s=Jn(-1,s)).tag=3,s.payload={element:null};var a=t.value;return s.callback=function(){Xo||(Xo=!0,ed=a),yi(0,t)},s}function ji(e,t,s){(s=Jn(-1,s)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var r=t.value;s.payload=function(){return a(r)},s.callback=function(){yi(0,t)}}var n=e.stateNode;return null!==n&&"function"===typeof n.componentDidCatch&&(s.callback=function(){yi(0,t),"function"!==typeof a&&(null===td?td=new Set([this]):td.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function Ni(e,t,s){var a=e.pingCache;if(null===a){a=e.pingCache=new vi;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(s)||(r.add(s),e=Dd.bind(null,e,t,s),t.then(e,e))}function Si(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ki(e,t,s,a,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=Jn(-1,1)).tag=2,Qn(s,t,1))),s.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var Ci=v.ReactCurrentOwner,Ai=!1;function _i(e,t,s,a){t.child=null===e?Tn(t,null,s,a):Pn(t,e.child,s,a)}function Pi(e,t,s,a,r){s=s.render;var n=t.ref;return Mn(t,r),a=Sl(e,t,s,a,n,r),s=kl(),null===e||Ai?(hn&&s&&dn(t),t.flags|=1,_i(e,t,a,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zi(e,t,r))}function Ti(e,t,s,a,r){if(null===e){var n=s.type;return"function"!==typeof n||Ud(n)||void 0!==n.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=Kd(s.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=n,Ei(e,t,n,a,r))}if(n=e.child,0===(e.lanes&r)){var l=n.memoizedProps;if((s=null!==(s=s.compare)?s:la)(l,a)&&e.ref===t.ref)return Zi(e,t,r)}return t.flags|=1,(e=zd(n,a)).ref=t.ref,e.return=t,t.child=e}function Ei(e,t,s,a,r){if(null!==e){var n=e.memoizedProps;if(la(n,a)&&e.ref===t.ref){if(Ai=!1,t.pendingProps=a=n,0===(e.lanes&r))return t.lanes=e.lanes,Zi(e,t,r);0!==(131072&e.flags)&&(Ai=!0)}}return Di(e,t,s,a,r)}function Ii(e,t,s){var a=t.pendingProps,r=a.children,n=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dr(zo,Uo),Uo|=s;else{if(0===(1073741824&s))return e=null!==n?n.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dr(zo,Uo),Uo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==n?n.baseLanes:s,Dr(zo,Uo),Uo|=a}else null!==n?(a=n.baseLanes|s,t.memoizedState=null):a=s,Dr(zo,Uo),Uo|=a;return _i(e,t,r,s),t.child}function Ri(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Di(e,t,s,a,r){var n=qr(s)?Mr:Lr.current;return n=Br(t,n),Mn(t,r),s=Sl(e,t,s,a,n,r),a=kl(),null===e||Ai?(hn&&a&&dn(t),t.flags|=1,_i(e,t,s,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zi(e,t,r))}function Oi(e,t,s,a,r){if(qr(s)){var n=!0;Wr(t)}else n=!1;if(Mn(t,r),null===t.stateNode)$i(e,t),xi(t,s,a),bi(t,s,a,r),a=!0;else if(null===e){var l=t.stateNode,i=t.memoizedProps;l.props=i;var o=l.context,d=s.contextType;"object"===typeof d&&null!==d?d=Bn(d):d=Br(t,d=qr(s)?Mr:Lr.current);var c=s.getDerivedStateFromProps,u="function"===typeof c||"function"===typeof l.getSnapshotBeforeUpdate;u||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(i!==a||o!==d)&&pi(t,l,a,d),Wn=!1;var m=t.memoizedState;l.state=m,$n(t,a,l,r),o=t.memoizedState,i!==a||m!==o||Fr.current||Wn?("function"===typeof c&&(ui(t,s,c,a),o=t.memoizedState),(i=Wn||hi(t,s,i,a,m,o,d))?(u||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||("function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"===typeof l.componentDidMount&&(t.flags|=4194308)):("function"===typeof l.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=o),l.props=a,l.state=o,l.context=d,a=i):("function"===typeof l.componentDidMount&&(t.flags|=4194308),a=!1)}else{l=t.stateNode,Vn(e,t),i=t.memoizedProps,d=t.type===t.elementType?i:ci(t.type,i),l.props=d,u=t.pendingProps,m=l.context,"object"===typeof(o=s.contextType)&&null!==o?o=Bn(o):o=Br(t,o=qr(s)?Mr:Lr.current);var h=s.getDerivedStateFromProps;(c="function"===typeof h||"function"===typeof l.getSnapshotBeforeUpdate)||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(i!==u||m!==o)&&pi(t,l,a,o),Wn=!1,m=t.memoizedState,l.state=m,$n(t,a,l,r);var x=t.memoizedState;i!==u||m!==x||Fr.current||Wn?("function"===typeof h&&(ui(t,s,h,a),x=t.memoizedState),(d=Wn||hi(t,s,d,a,m,x,o)||!1)?(c||"function"!==typeof l.UNSAFE_componentWillUpdate&&"function"!==typeof l.componentWillUpdate||("function"===typeof l.componentWillUpdate&&l.componentWillUpdate(a,x,o),"function"===typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(a,x,o)),"function"===typeof l.componentDidUpdate&&(t.flags|=4),"function"===typeof l.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof l.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=x),l.props=a,l.state=x,l.context=o,a=d):("function"!==typeof l.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),a=!1)}return Li(e,t,s,a,n,r)}function Li(e,t,s,a,r,n){Ri(e,t);var l=0!==(128&t.flags);if(!a&&!l)return r&&Hr(t,s,!1),Zi(e,t,n);a=t.stateNode,Ci.current=t;var i=l&&"function"!==typeof s.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&l?(t.child=Pn(t,e.child,null,n),t.child=Pn(t,null,i,n)):_i(e,t,i,n),t.memoizedState=a.state,r&&Hr(t,s,!0),t.child}function Fi(e){var t=e.stateNode;t.pendingContext?zr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&zr(0,t.context,!1),rl(e,t.containerInfo)}function Mi(e,t,s,a,r){return jn(),Nn(r),t.flags|=256,_i(e,t,s,a),t.child}var Bi,qi,Ui,zi,Ki={dehydrated:null,treeContext:null,retryLane:0};function Wi(e){return{baseLanes:e,cachePool:null,transitions:null}}function Hi(e,t,s){var a,r=t.pendingProps,l=ol.current,i=!1,o=0!==(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&0!==(2&l)),a?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(l|=1),Dr(ol,1&l),null===e)return fn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},0===(1&r)&&null!==i?(i.childLanes=0,i.pendingProps=o):i=Hd(o,r,0,null),e=Wd(e,r,s,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Wi(s),t.memoizedState=Ki,e):Vi(t,o));if(null!==(l=e.memoizedState)&&null!==(a=l.dehydrated))return function(e,t,s,a,r,l,i){if(s)return 256&t.flags?(t.flags&=-257,Ji(e,t,i,a=fi(Error(n(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(l=a.fallback,r=t.mode,a=Hd({mode:"visible",children:a.children},r,0,null),(l=Wd(l,r,i,null)).flags|=2,a.return=t,l.return=t,a.sibling=l,t.child=a,0!==(1&t.mode)&&Pn(t,e.child,null,i),t.child.memoizedState=Wi(i),t.memoizedState=Ki,l);if(0===(1&t.mode))return Ji(e,t,i,null);if("$!"===r.data){if(a=r.nextSibling&&r.nextSibling.dataset)var o=a.dgst;return a=o,Ji(e,t,i,a=fi(l=Error(n(419)),a,void 0))}if(o=0!==(i&e.childLanes),Ai||o){if(null!==(a=Mo)){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(a.suspendedLanes|i))?0:r)&&r!==l.retryLane&&(l.retryLane=r,Kn(e,r),ud(a,e,r,-1))}return Sd(),Ji(e,t,i,a=fi(Error(n(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ld.bind(null,e),r._reactRetry=t,null):(e=l.treeContext,mn=gr(r.nextSibling),un=t,hn=!0,xn=null,null!==e&&(tn[sn++]=rn,tn[sn++]=nn,tn[sn++]=an,rn=e.id,nn=e.overflow,an=t),t=Vi(t,a.children),t.flags|=4096,t)}(e,t,o,r,a,l,s);if(i){i=r.fallback,o=t.mode,a=(l=e.child).sibling;var d={mode:"hidden",children:r.children};return 0===(1&o)&&t.child!==l?((r=t.child).childLanes=0,r.pendingProps=d,t.deletions=null):(r=zd(l,d)).subtreeFlags=14680064&l.subtreeFlags,null!==a?i=zd(a,i):(i=Wd(i,o,s,null)).flags|=2,i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=null===(o=e.child.memoizedState)?Wi(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~s,t.memoizedState=Ki,r}return e=(i=e.child).sibling,r=zd(i,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=s),r.return=t,r.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=r,t.memoizedState=null,r}function Vi(e,t){return(t=Hd({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ji(e,t,s,a){return null!==a&&Nn(a),Pn(t,e.child,null,s),(e=Vi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Qi(e,t,s){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Fn(e.return,t,s)}function Gi(e,t,s,a,r){var n=e.memoizedState;null===n?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:r}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=a,n.tail=s,n.tailMode=r)}function Yi(e,t,s){var a=t.pendingProps,r=a.revealOrder,n=a.tail;if(_i(e,t,a.children,s),0!==(2&(a=ol.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Qi(e,s,t);else if(19===e.tag)Qi(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Dr(ol,a),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(s=t.child,r=null;null!==s;)null!==(e=s.alternate)&&null===dl(e)&&(r=s),s=s.sibling;null===(s=r)?(r=t.child,t.child=null):(r=s.sibling,s.sibling=null),Gi(t,!1,r,s,n);break;case"backwards":for(s=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===dl(e)){t.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}Gi(t,!0,s,null,n);break;case"together":Gi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $i(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zi(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),Ho|=t.lanes,0===(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(n(153));if(null!==t.child){for(s=zd(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=zd(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function Xi(e,t){if(!hn)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;null!==s;)null!==s.alternate&&(a=s),s=s.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function eo(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,a=0;if(t)for(var r=e.child;null!==r;)s|=r.lanes|r.childLanes,a|=14680064&r.subtreeFlags,a|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)s|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=s,t}function to(e,t,s){var a=t.pendingProps;switch(cn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return eo(t),null;case 1:case 17:return qr(t.type)&&Ur(),eo(t),null;case 3:return a=t.stateNode,nl(),Rr(Fr),Rr(Lr),ul(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(vn(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==xn&&(pd(xn),xn=null))),qi(e,t),eo(t),null;case 5:il(t);var r=al(sl.current);if(s=t.type,null!==e&&null!=t.stateNode)Ui(e,t,s,a,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(n(166));return eo(t),null}if(e=al(el.current),vn(t)){a=t.stateNode,s=t.type;var l=t.memoizedProps;switch(a[vr]=t,a[wr]=l,e=0!==(1&t.mode),s){case"dialog":Va("cancel",a),Va("close",a);break;case"iframe":case"object":case"embed":Va("load",a);break;case"video":case"audio":for(r=0;r<za.length;r++)Va(za[r],a);break;case"source":Va("error",a);break;case"img":case"image":case"link":Va("error",a),Va("load",a);break;case"details":Va("toggle",a);break;case"input":Y(a,l),Va("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!l.multiple},Va("invalid",a);break;case"textarea":re(a,l),Va("invalid",a)}for(var o in ge(s,l),r=null,l)if(l.hasOwnProperty(o)){var d=l[o];"children"===o?"string"===typeof d?a.textContent!==d&&(!0!==l.suppressHydrationWarning&&lr(a.textContent,d,e),r=["children",d]):"number"===typeof d&&a.textContent!==""+d&&(!0!==l.suppressHydrationWarning&&lr(a.textContent,d,e),r=["children",""+d]):i.hasOwnProperty(o)&&null!=d&&"onScroll"===o&&Va("scroll",a)}switch(s){case"input":V(a),X(a,l,!0);break;case"textarea":V(a),le(a);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(a.onclick=ir)}a=r,t.updateQueue=a,null!==a&&(t.flags|=4)}else{o=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=o.createElement(s,{is:a.is}):(e=o.createElement(s),"select"===s&&(o=e,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):e=o.createElementNS(e,s),e[vr]=t,e[wr]=a,Bi(e,t,!1,!1),t.stateNode=e;e:{switch(o=fe(s,a),s){case"dialog":Va("cancel",e),Va("close",e),r=a;break;case"iframe":case"object":case"embed":Va("load",e),r=a;break;case"video":case"audio":for(r=0;r<za.length;r++)Va(za[r],e);r=a;break;case"source":Va("error",e),r=a;break;case"img":case"image":case"link":Va("error",e),Va("load",e),r=a;break;case"details":Va("toggle",e),r=a;break;case"input":Y(e,a),r=G(e,a),Va("invalid",e);break;case"option":default:r=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},r=F({},a,{value:void 0}),Va("invalid",e);break;case"textarea":re(e,a),r=ae(e,a),Va("invalid",e)}for(l in ge(s,r),d=r)if(d.hasOwnProperty(l)){var c=d[l];"style"===l?pe(e,c):"dangerouslySetInnerHTML"===l?null!=(c=c?c.__html:void 0)&&ce(e,c):"children"===l?"string"===typeof c?("textarea"!==s||""!==c)&&ue(e,c):"number"===typeof c&&ue(e,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(i.hasOwnProperty(l)?null!=c&&"onScroll"===l&&Va("scroll",e):null!=c&&y(e,l,c,o))}switch(s){case"input":V(e),X(e,a,!1);break;case"textarea":V(e),le(e);break;case"option":null!=a.value&&e.setAttribute("value",""+W(a.value));break;case"select":e.multiple=!!a.multiple,null!=(l=a.value)?se(e,!!a.multiple,l,!1):null!=a.defaultValue&&se(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=ir)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return eo(t),null;case 6:if(e&&null!=t.stateNode)zi(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(n(166));if(s=al(sl.current),al(el.current),vn(t)){if(a=t.stateNode,s=t.memoizedProps,a[vr]=t,(l=a.nodeValue!==s)&&null!==(e=un))switch(e.tag){case 3:lr(a.nodeValue,s,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&lr(a.nodeValue,s,0!==(1&e.mode))}l&&(t.flags|=4)}else(a=(9===s.nodeType?s:s.ownerDocument).createTextNode(a))[vr]=t,t.stateNode=a}return eo(t),null;case 13:if(Rr(ol),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(hn&&null!==mn&&0!==(1&t.mode)&&0===(128&t.flags))wn(),jn(),t.flags|=98560,l=!1;else if(l=vn(t),null!==a&&null!==a.dehydrated){if(null===e){if(!l)throw Error(n(318));if(!(l=null!==(l=t.memoizedState)?l.dehydrated:null))throw Error(n(317));l[vr]=t}else jn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;eo(t),l=!1}else null!==xn&&(pd(xn),xn=null),l=!0;if(!l)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=s,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ol.current)?0===Ko&&(Ko=3):Sd())),null!==t.updateQueue&&(t.flags|=4),eo(t),null);case 4:return nl(),qi(e,t),null===e&&Ga(t.stateNode.containerInfo),eo(t),null;case 10:return Ln(t.type._context),eo(t),null;case 19:if(Rr(ol),null===(l=t.memoizedState))return eo(t),null;if(a=0!==(128&t.flags),null===(o=l.rendering))if(a)Xi(l,!1);else{if(0!==Ko||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=dl(e))){for(t.flags|=128,Xi(l,!1),null!==(a=o.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=s,s=t.child;null!==s;)e=a,(l=s).flags&=14680066,null===(o=l.alternate)?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,e=o.dependencies,l.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Dr(ol,1&ol.current|2),t.child}e=e.sibling}null!==l.tail&&Ye()>$o&&(t.flags|=128,a=!0,Xi(l,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=dl(o))){if(t.flags|=128,a=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),Xi(l,!0),null===l.tail&&"hidden"===l.tailMode&&!o.alternate&&!hn)return eo(t),null}else 2*Ye()-l.renderingStartTime>$o&&1073741824!==s&&(t.flags|=128,a=!0,Xi(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(null!==(s=l.last)?s.sibling=o:t.child=o,l.last=o)}return null!==l.tail?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Ye(),t.sibling=null,s=ol.current,Dr(ol,a?1&s|2:1&s),t):(eo(t),null);case 22:case 23:return vd(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Uo)&&(eo(t),6&t.subtreeFlags&&(t.flags|=8192)):eo(t),null;case 24:case 25:return null}throw Error(n(156,t.tag))}function so(e,t){switch(cn(t),t.tag){case 1:return qr(t.type)&&Ur(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return nl(),Rr(Fr),Rr(Lr),ul(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return il(t),null;case 13:if(Rr(ol),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(n(340));jn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Rr(ol),null;case 4:return nl(),null;case 10:return Ln(t.type._context),null;case 22:case 23:return vd(),null;default:return null}}Bi=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},qi=function(){},Ui=function(e,t,s,a){var r=e.memoizedProps;if(r!==a){e=t.stateNode,al(el.current);var n,l=null;switch(s){case"input":r=G(e,r),a=G(e,a),l=[];break;case"select":r=F({},r,{value:void 0}),a=F({},a,{value:void 0}),l=[];break;case"textarea":r=ae(e,r),a=ae(e,a),l=[];break;default:"function"!==typeof r.onClick&&"function"===typeof a.onClick&&(e.onclick=ir)}for(c in ge(s,a),s=null,r)if(!a.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var o=r[c];for(n in o)o.hasOwnProperty(n)&&(s||(s={}),s[n]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(i.hasOwnProperty(c)?l||(l=[]):(l=l||[]).push(c,null));for(c in a){var d=a[c];if(o=null!=r?r[c]:void 0,a.hasOwnProperty(c)&&d!==o&&(null!=d||null!=o))if("style"===c)if(o){for(n in o)!o.hasOwnProperty(n)||d&&d.hasOwnProperty(n)||(s||(s={}),s[n]="");for(n in d)d.hasOwnProperty(n)&&o[n]!==d[n]&&(s||(s={}),s[n]=d[n])}else s||(l||(l=[]),l.push(c,s)),s=d;else"dangerouslySetInnerHTML"===c?(d=d?d.__html:void 0,o=o?o.__html:void 0,null!=d&&o!==d&&(l=l||[]).push(c,d)):"children"===c?"string"!==typeof d&&"number"!==typeof d||(l=l||[]).push(c,""+d):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(i.hasOwnProperty(c)?(null!=d&&"onScroll"===c&&Va("scroll",e),l||o===d||(l=[])):(l=l||[]).push(c,d))}s&&(l=l||[]).push("style",s);var c=l;(t.updateQueue=c)&&(t.flags|=4)}},zi=function(e,t,s,a){s!==a&&(t.flags|=4)};var ao=!1,ro=!1,no="function"===typeof WeakSet?WeakSet:Set,lo=null;function io(e,t){var s=e.ref;if(null!==s)if("function"===typeof s)try{s(null)}catch(ga){Rd(e,t,ga)}else s.current=null}function oo(e,t,s){try{s()}catch(ga){Rd(e,t,ga)}}var co=!1;function uo(e,t,s){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var r=a=a.next;do{if((r.tag&e)===e){var n=r.destroy;r.destroy=void 0,void 0!==n&&oo(t,s,n)}r=r.next}while(r!==a)}}function mo(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==t)}}function ho(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"===typeof t?t(e):t.current=e}}function xo(e){var t=e.alternate;null!==t&&(e.alternate=null,xo(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[vr],delete t[wr],delete t[Nr],delete t[Sr],delete t[kr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function po(e){return 5===e.tag||3===e.tag||4===e.tag}function bo(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||po(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function go(e,t,s){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!==(s=s._reactRootContainer)&&void 0!==s||null!==t.onclick||(t.onclick=ir));else if(4!==a&&null!==(e=e.child))for(go(e,t,s),e=e.sibling;null!==e;)go(e,t,s),e=e.sibling}function fo(e,t,s){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==a&&null!==(e=e.child))for(fo(e,t,s),e=e.sibling;null!==e;)fo(e,t,s),e=e.sibling}var yo=null,vo=!1;function wo(e,t,s){for(s=s.child;null!==s;)jo(e,t,s),s=s.sibling}function jo(e,t,s){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(at,s)}catch(va){}switch(s.tag){case 5:ro||io(s,t);case 6:var a=yo,r=vo;yo=null,wo(e,t,s),vo=r,null!==(yo=a)&&(vo?(e=yo,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):yo.removeChild(s.stateNode));break;case 18:null!==yo&&(vo?(e=yo,s=s.stateNode,8===e.nodeType?br(e.parentNode,s):1===e.nodeType&&br(e,s),Ut(e)):br(yo,s.stateNode));break;case 4:a=yo,r=vo,yo=s.stateNode.containerInfo,vo=!0,wo(e,t,s),yo=a,vo=r;break;case 0:case 11:case 14:case 15:if(!ro&&(null!==(a=s.updateQueue)&&null!==(a=a.lastEffect))){r=a=a.next;do{var n=r,l=n.destroy;n=n.tag,void 0!==l&&(0!==(2&n)||0!==(4&n))&&oo(s,t,l),r=r.next}while(r!==a)}wo(e,t,s);break;case 1:if(!ro&&(io(s,t),"function"===typeof(a=s.stateNode).componentWillUnmount))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(va){Rd(s,t,va)}wo(e,t,s);break;case 21:wo(e,t,s);break;case 22:1&s.mode?(ro=(a=ro)||null!==s.memoizedState,wo(e,t,s),ro=a):wo(e,t,s);break;default:wo(e,t,s)}}function No(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new no),t.forEach(function(t){var a=Fd.bind(null,e,t);s.has(t)||(s.add(t),t.then(a,a))})}}function So(e,t){var s=t.deletions;if(null!==s)for(var a=0;a<s.length;a++){var r=s[a];try{var l=e,i=t,o=i;e:for(;null!==o;){switch(o.tag){case 5:yo=o.stateNode,vo=!1;break e;case 3:case 4:yo=o.stateNode.containerInfo,vo=!0;break e}o=o.return}if(null===yo)throw Error(n(160));jo(l,i,r),yo=null,vo=!1;var d=r.alternate;null!==d&&(d.return=null),r.return=null}catch(da){Rd(r,t,da)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ko(t,e),t=t.sibling}function ko(e,t){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(So(t,e),Co(e),4&a){try{uo(3,e,e.return),mo(3,e)}catch(oa){Rd(e,e.return,oa)}try{uo(5,e,e.return)}catch(oa){Rd(e,e.return,oa)}}break;case 1:So(t,e),Co(e),512&a&&null!==s&&io(s,s.return);break;case 5:if(So(t,e),Co(e),512&a&&null!==s&&io(s,s.return),32&e.flags){var r=e.stateNode;try{ue(r,"")}catch(oa){Rd(e,e.return,oa)}}if(4&a&&null!=(r=e.stateNode)){var l=e.memoizedProps,i=null!==s?s.memoizedProps:l,o=e.type,d=e.updateQueue;if(e.updateQueue=null,null!==d)try{"input"===o&&"radio"===l.type&&null!=l.name&&$(r,l),fe(o,i);var c=fe(o,l);for(i=0;i<d.length;i+=2){var u=d[i],m=d[i+1];"style"===u?pe(r,m):"dangerouslySetInnerHTML"===u?ce(r,m):"children"===u?ue(r,m):y(r,u,m,c)}switch(o){case"input":Z(r,l);break;case"textarea":ne(r,l);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!l.multiple;var x=l.value;null!=x?se(r,!!l.multiple,x,!1):h!==!!l.multiple&&(null!=l.defaultValue?se(r,!!l.multiple,l.defaultValue,!0):se(r,!!l.multiple,l.multiple?[]:"",!1))}r[wr]=l}catch(oa){Rd(e,e.return,oa)}}break;case 6:if(So(t,e),Co(e),4&a){if(null===e.stateNode)throw Error(n(162));r=e.stateNode,l=e.memoizedProps;try{r.nodeValue=l}catch(oa){Rd(e,e.return,oa)}}break;case 3:if(So(t,e),Co(e),4&a&&null!==s&&s.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(oa){Rd(e,e.return,oa)}break;case 4:default:So(t,e),Co(e);break;case 13:So(t,e),Co(e),8192&(r=e.child).flags&&(l=null!==r.memoizedState,r.stateNode.isHidden=l,!l||null!==r.alternate&&null!==r.alternate.memoizedState||(Yo=Ye())),4&a&&No(e);break;case 22:if(u=null!==s&&null!==s.memoizedState,1&e.mode?(ro=(c=ro)||u,So(t,e),ro=c):So(t,e),Co(e),8192&a){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!u&&0!==(1&e.mode))for(lo=e,u=e.child;null!==u;){for(m=lo=u;null!==lo;){switch(x=(h=lo).child,h.tag){case 0:case 11:case 14:case 15:uo(4,h,h.return);break;case 1:io(h,h.return);var p=h.stateNode;if("function"===typeof p.componentWillUnmount){a=h,s=h.return;try{t=a,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(oa){Rd(a,s,oa)}}break;case 5:io(h,h.return);break;case 22:if(null!==h.memoizedState){To(m);continue}}null!==x?(x.return=h,lo=x):To(m)}u=u.sibling}e:for(u=null,m=e;;){if(5===m.tag){if(null===u){u=m;try{r=m.stateNode,c?"function"===typeof(l=r.style).setProperty?l.setProperty("display","none","important"):l.display="none":(o=m.stateNode,i=void 0!==(d=m.memoizedProps.style)&&null!==d&&d.hasOwnProperty("display")?d.display:null,o.style.display=xe("display",i))}catch(oa){Rd(e,e.return,oa)}}}else if(6===m.tag){if(null===u)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(oa){Rd(e,e.return,oa)}}else if((22!==m.tag&&23!==m.tag||null===m.memoizedState||m===e)&&null!==m.child){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;null===m.sibling;){if(null===m.return||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:So(t,e),Co(e),4&a&&No(e);case 21:}}function Co(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(po(s)){var a=s;break e}s=s.return}throw Error(n(160))}switch(a.tag){case 5:var r=a.stateNode;32&a.flags&&(ue(r,""),a.flags&=-33),fo(e,bo(e),r);break;case 3:case 4:var l=a.stateNode.containerInfo;go(e,bo(e),l);break;default:throw Error(n(161))}}catch(Ua){Rd(e,e.return,Ua)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ao(e,t,s){lo=e,_o(e,t,s)}function _o(e,t,s){for(var a=0!==(1&e.mode);null!==lo;){var r=lo,n=r.child;if(22===r.tag&&a){var l=null!==r.memoizedState||ao;if(!l){var i=r.alternate,o=null!==i&&null!==i.memoizedState||ro;i=ao;var d=ro;if(ao=l,(ro=o)&&!d)for(lo=r;null!==lo;)o=(l=lo).child,22===l.tag&&null!==l.memoizedState?Eo(r):null!==o?(o.return=l,lo=o):Eo(r);for(;null!==n;)lo=n,_o(n,t,s),n=n.sibling;lo=r,ao=i,ro=d}Po(e)}else 0!==(8772&r.subtreeFlags)&&null!==n?(n.return=r,lo=n):Po(e)}}function Po(e){for(;null!==lo;){var t=lo;if(0!==(8772&t.flags)){var s=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:ro||mo(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!ro)if(null===s)a.componentDidMount();else{var r=t.elementType===t.type?s.memoizedProps:ci(t.type,s.memoizedProps);a.componentDidUpdate(r,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;null!==l&&Zn(t,l,a);break;case 3:var i=t.updateQueue;if(null!==i){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}Zn(t,i,s)}break;case 5:var o=t.stateNode;if(null===s&&4&t.flags){s=o;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&s.focus();break;case"img":d.src&&(s.src=d.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var m=u.dehydrated;null!==m&&Ut(m)}}}break;default:throw Error(n(163))}ro||512&t.flags&&ho(t)}catch(h){Rd(t,t.return,h)}}if(t===e){lo=null;break}if(null!==(s=t.sibling)){s.return=t.return,lo=s;break}lo=t.return}}function To(e){for(;null!==lo;){var t=lo;if(t===e){lo=null;break}var s=t.sibling;if(null!==s){s.return=t.return,lo=s;break}lo=t.return}}function Eo(e){for(;null!==lo;){var t=lo;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{mo(4,t)}catch(Ua){Rd(t,s,Ua)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var r=t.return;try{a.componentDidMount()}catch(Ua){Rd(t,r,Ua)}}var n=t.return;try{ho(t)}catch(Ua){Rd(t,n,Ua)}break;case 5:var l=t.return;try{ho(t)}catch(Ua){Rd(t,l,Ua)}}}catch(Ua){Rd(t,t.return,Ua)}if(t===e){lo=null;break}var i=t.sibling;if(null!==i){i.return=t.return,lo=i;break}lo=t.return}}var Io,Ro=Math.ceil,Do=v.ReactCurrentDispatcher,Oo=v.ReactCurrentOwner,Lo=v.ReactCurrentBatchConfig,Fo=0,Mo=null,Bo=null,qo=0,Uo=0,zo=Ir(0),Ko=0,Wo=null,Ho=0,Vo=0,Jo=0,Qo=null,Go=null,Yo=0,$o=1/0,Zo=null,Xo=!1,ed=null,td=null,sd=!1,ad=null,rd=0,nd=0,ld=null,id=-1,od=0;function dd(){return 0!==(6&Fo)?Ye():-1!==id?id:id=Ye()}function cd(e){return 0===(1&e.mode)?1:0!==(2&Fo)&&0!==qo?qo&-qo:null!==Sn.transition?(0===od&&(od=xt()),od):0!==(e=ft)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function ud(e,t,s,a){if(50<nd)throw nd=0,ld=null,Error(n(185));bt(e,s,a),0!==(2&Fo)&&e===Mo||(e===Mo&&(0===(2&Fo)&&(Vo|=s),4===Ko&&bd(e,qo)),md(e,a),1===s&&0===Fo&&0===(1&t.mode)&&($o=Ye()+500,Jr&&Yr()))}function md(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,n=e.pendingLanes;0<n;){var l=31-nt(n),i=1<<l,o=r[l];-1===o?0!==(i&s)&&0===(i&a)||(r[l]=mt(i,t)):o<=t&&(e.expiredLanes|=i),n&=~i}}(e,t);var a=ut(e,e===Mo?qo:0);if(0===a)null!==s&&Je(s),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=s&&Je(s),1===t)0===e.tag?function(e){Jr=!0,Gr(e)}(gd.bind(null,e)):Gr(gd.bind(null,e)),xr(function(){0===(6&Fo)&&Yr()}),s=null;else{switch(yt(a)){case 1:s=Ze;break;case 4:s=Xe;break;case 16:default:s=et;break;case 536870912:s=st}s=Md(s,hd.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function hd(e,t){if(id=-1,od=0,0!==(6&Fo))throw Error(n(327));var s=e.callbackNode;if(Ed()&&e.callbackNode!==s)return null;var a=ut(e,e===Mo?qo:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=kd(e,a);else{t=a;var r=Fo;Fo|=2;var l=Nd();for(Mo===e&&qo===t||(Zo=null,$o=Ye()+500,wd(e,t));;)try{Ad();break}catch(va){jd(e,va)}On(),Do.current=l,Fo=r,null!==Bo?t=0:(Mo=null,qo=0,t=Ko)}if(0!==t){if(2===t&&(0!==(r=ht(e))&&(a=r,t=xd(e,r))),1===t)throw s=Wo,wd(e,0),bd(e,a),md(e,Ye()),s;if(6===t)bd(e,a);else{if(r=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var a=0;a<s.length;a++){var r=s[a],n=r.getSnapshot;r=r.value;try{if(!na(n(),r))return!1}catch(i){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=kd(e,a))&&(0!==(l=ht(e))&&(a=l,t=xd(e,l))),1===t))throw s=Wo,wd(e,0),bd(e,a),md(e,Ye()),s;switch(e.finishedWork=r,e.finishedLanes=a,t){case 0:case 1:throw Error(n(345));case 2:case 5:Td(e,Go,Zo);break;case 3:if(bd(e,a),(130023424&a)===a&&10<(t=Yo+500-Ye())){if(0!==ut(e,0))break;if(((r=e.suspendedLanes)&a)!==a){dd(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ur(Td.bind(null,e,Go,Zo),t);break}Td(e,Go,Zo);break;case 4:if(bd(e,a),(4194240&a)===a)break;for(t=e.eventTimes,r=-1;0<a;){var i=31-nt(a);l=1<<i,(i=t[i])>r&&(r=i),a&=~l}if(a=r,10<(a=(120>(a=Ye()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Ro(a/1960))-a)){e.timeoutHandle=ur(Td.bind(null,e,Go,Zo),a);break}Td(e,Go,Zo);break;default:throw Error(n(329))}}}return md(e,Ye()),e.callbackNode===s?hd.bind(null,e):null}function xd(e,t){var s=Qo;return e.current.memoizedState.isDehydrated&&(wd(e,t).flags|=256),2!==(e=kd(e,t))&&(t=Go,Go=s,null!==t&&pd(t)),e}function pd(e){null===Go?Go=e:Go.push.apply(Go,e)}function bd(e,t){for(t&=~Jo,t&=~Vo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-nt(t),a=1<<s;e[s]=-1,t&=~a}}function gd(e){if(0!==(6&Fo))throw Error(n(327));Ed();var t=ut(e,0);if(0===(1&t))return md(e,Ye()),null;var s=kd(e,t);if(0!==e.tag&&2===s){var a=ht(e);0!==a&&(t=a,s=xd(e,a))}if(1===s)throw s=Wo,wd(e,0),bd(e,t),md(e,Ye()),s;if(6===s)throw Error(n(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Td(e,Go,Zo),md(e,Ye()),null}function fd(e,t){var s=Fo;Fo|=1;try{return e(t)}finally{0===(Fo=s)&&($o=Ye()+500,Jr&&Yr())}}function yd(e){null!==ad&&0===ad.tag&&0===(6&Fo)&&Ed();var t=Fo;Fo|=1;var s=Lo.transition,a=ft;try{if(Lo.transition=null,ft=1,e)return e()}finally{ft=a,Lo.transition=s,0===(6&(Fo=t))&&Yr()}}function vd(){Uo=zo.current,Rr(zo)}function wd(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,mr(s)),null!==Bo)for(s=Bo.return;null!==s;){var a=s;switch(cn(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Ur();break;case 3:nl(),Rr(Fr),Rr(Lr),ul();break;case 5:il(a);break;case 4:nl();break;case 13:case 19:Rr(ol);break;case 10:Ln(a.type._context);break;case 22:case 23:vd()}s=s.return}if(Mo=e,Bo=e=zd(e.current,null),qo=Uo=t,Ko=0,Wo=null,Jo=Vo=Ho=0,Go=Qo=null,null!==qn){for(t=0;t<qn.length;t++)if(null!==(a=(s=qn[t]).interleaved)){s.interleaved=null;var r=a.next,n=s.pending;if(null!==n){var l=n.next;n.next=r,a.next=l}s.pending=a}qn=null}return e}function jd(e,t){for(;;){var s=Bo;try{if(On(),ml.current=li,fl){for(var a=pl.memoizedState;null!==a;){var r=a.queue;null!==r&&(r.pending=null),a=a.next}fl=!1}if(xl=0,gl=bl=pl=null,yl=!1,vl=0,Oo.current=null,null===s||null===s.return){Ko=1,Wo=t,Bo=null;break}e:{var l=e,i=s.return,o=s,d=t;if(t=qo,o.flags|=32768,null!==d&&"object"===typeof d&&"function"===typeof d.then){var c=d,u=o,m=u.tag;if(0===(1&u.mode)&&(0===m||11===m||15===m)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var x=Si(i);if(null!==x){x.flags&=-257,ki(x,i,o,0,t),1&x.mode&&Ni(l,c,t),d=c;var p=(t=x).updateQueue;if(null===p){var b=new Set;b.add(d),t.updateQueue=b}else p.add(d);break e}if(0===(1&t)){Ni(l,c,t),Sd();break e}d=Error(n(426))}else if(hn&&1&o.mode){var g=Si(i);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ki(g,i,o,0,t),Nn(gi(d,o));break e}}l=d=gi(d,o),4!==Ko&&(Ko=2),null===Qo?Qo=[l]:Qo.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,Yn(l,wi(0,d,t));break e;case 1:o=d;var f=l.type,y=l.stateNode;if(0===(128&l.flags)&&("function"===typeof f.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===td||!td.has(y)))){l.flags|=65536,t&=-t,l.lanes|=t,Yn(l,ji(l,o,t));break e}}l=l.return}while(null!==l)}Pd(s)}catch(v){t=v,Bo===s&&null!==s&&(Bo=s=s.return);continue}break}}function Nd(){var e=Do.current;return Do.current=li,null===e?li:e}function Sd(){0!==Ko&&3!==Ko&&2!==Ko||(Ko=4),null===Mo||0===(268435455&Ho)&&0===(268435455&Vo)||bd(Mo,qo)}function kd(e,t){var s=Fo;Fo|=2;var a=Nd();for(Mo===e&&qo===t||(Zo=null,wd(e,t));;)try{Cd();break}catch(ia){jd(e,ia)}if(On(),Fo=s,Do.current=a,null!==Bo)throw Error(n(261));return Mo=null,qo=0,Ko}function Cd(){for(;null!==Bo;)_d(Bo)}function Ad(){for(;null!==Bo&&!Qe();)_d(Bo)}function _d(e){var t=Io(e.alternate,e,Uo);e.memoizedProps=e.pendingProps,null===t?Pd(e):Bo=t,Oo.current=null}function Pd(e){var t=e;do{var s=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(s=to(s,t,Uo)))return void(Bo=s)}else{if(null!==(s=so(s,t)))return s.flags&=32767,void(Bo=s);if(null===e)return Ko=6,void(Bo=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Bo=t);Bo=t=e}while(null!==t);0===Ko&&(Ko=5)}function Td(e,t,s){var a=ft,r=Lo.transition;try{Lo.transition=null,ft=1,function(e,t,s,a){do{Ed()}while(null!==ad);if(0!==(6&Fo))throw Error(n(327));s=e.finishedWork;var r=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(n(177));e.callbackNode=null,e.callbackPriority=0;var l=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-nt(s),n=1<<r;t[r]=0,a[r]=-1,e[r]=-1,s&=~n}}(e,l),e===Mo&&(Bo=Mo=null,qo=0),0===(2064&s.subtreeFlags)&&0===(2064&s.flags)||sd||(sd=!0,Md(et,function(){return Ed(),null})),l=0!==(15990&s.flags),0!==(15990&s.subtreeFlags)||l){l=Lo.transition,Lo.transition=null;var i=ft;ft=1;var o=Fo;Fo|=4,Oo.current=null,function(e,t){if(or=Kt,ba(e=pa())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(a&&0!==a.rangeCount){s=a.anchorNode;var r=a.anchorOffset,l=a.focusNode;a=a.focusOffset;try{s.nodeType,l.nodeType}catch(rr){s=null;break e}var i=0,o=-1,d=-1,c=0,u=0,m=e,h=null;t:for(;;){for(var x;m!==s||0!==r&&3!==m.nodeType||(o=i+r),m!==l||0!==a&&3!==m.nodeType||(d=i+a),3===m.nodeType&&(i+=m.nodeValue.length),null!==(x=m.firstChild);)h=m,m=x;for(;;){if(m===e)break t;if(h===s&&++c===r&&(o=i),h===l&&++u===a&&(d=i),null!==(x=m.nextSibling))break;h=(m=h).parentNode}m=x}s=-1===o||-1===d?null:{start:o,end:d}}else s=null}s=s||{start:0,end:0}}else s=null;for(dr={focusedElem:e,selectionRange:s},Kt=!1,lo=t;null!==lo;)if(e=(t=lo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,lo=e;else for(;null!==lo;){t=lo;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var b=p.memoizedProps,g=p.memoizedState,f=t.stateNode,y=f.getSnapshotBeforeUpdate(t.elementType===t.type?b:ci(t.type,b),g);f.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(n(163))}}catch(rr){Rd(t,t.return,rr)}if(null!==(e=t.sibling)){e.return=t.return,lo=e;break}lo=t.return}p=co,co=!1}(e,s),ko(s,e),ya(dr),Kt=!!or,dr=or=null,e.current=s,Ao(s,e,r),Ge(),Fo=o,ft=i,Lo.transition=l}else e.current=s;if(sd&&(sd=!1,ad=e,rd=r),l=e.pendingLanes,0===l&&(td=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(s.stateNode),md(e,Ye()),null!==t)for(a=e.onRecoverableError,s=0;s<t.length;s++)r=t[s],a(r.value,{componentStack:r.stack,digest:r.digest});if(Xo)throw Xo=!1,e=ed,ed=null,e;0!==(1&rd)&&0!==e.tag&&Ed(),l=e.pendingLanes,0!==(1&l)?e===ld?nd++:(nd=0,ld=e):nd=0,Yr()}(e,t,s,a)}finally{Lo.transition=r,ft=a}return null}function Ed(){if(null!==ad){var e=yt(rd),t=Lo.transition,s=ft;try{if(Lo.transition=null,ft=16>e?16:e,null===ad)var a=!1;else{if(e=ad,ad=null,rd=0,0!==(6&Fo))throw Error(n(331));var r=Fo;for(Fo|=4,lo=e.current;null!==lo;){var l=lo,i=l.child;if(0!==(16&lo.flags)){var o=l.deletions;if(null!==o){for(var d=0;d<o.length;d++){var c=o[d];for(lo=c;null!==lo;){var u=lo;switch(u.tag){case 0:case 11:case 15:uo(8,u,l)}var m=u.child;if(null!==m)m.return=u,lo=m;else for(;null!==lo;){var h=(u=lo).sibling,x=u.return;if(xo(u),u===c){lo=null;break}if(null!==h){h.return=x,lo=h;break}lo=x}}}var p=l.alternate;if(null!==p){var b=p.child;if(null!==b){p.child=null;do{var g=b.sibling;b.sibling=null,b=g}while(null!==b)}}lo=l}}if(0!==(2064&l.subtreeFlags)&&null!==i)i.return=l,lo=i;else e:for(;null!==lo;){if(0!==(2048&(l=lo).flags))switch(l.tag){case 0:case 11:case 15:uo(9,l,l.return)}var f=l.sibling;if(null!==f){f.return=l.return,lo=f;break e}lo=l.return}}var y=e.current;for(lo=y;null!==lo;){var v=(i=lo).child;if(0!==(2064&i.subtreeFlags)&&null!==v)v.return=i,lo=v;else e:for(i=y;null!==lo;){if(0!==(2048&(o=lo).flags))try{switch(o.tag){case 0:case 11:case 15:mo(9,o)}}catch(j){Rd(o,o.return,j)}if(o===i){lo=null;break e}var w=o.sibling;if(null!==w){w.return=o.return,lo=w;break e}lo=o.return}}if(Fo=r,Yr(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(at,e)}catch(j){}a=!0}return a}finally{ft=s,Lo.transition=t}}return!1}function Id(e,t,s){e=Qn(e,t=wi(0,t=gi(s,t),1),1),t=dd(),null!==e&&(bt(e,1,t),md(e,t))}function Rd(e,t,s){if(3===e.tag)Id(e,e,s);else for(;null!==t;){if(3===t.tag){Id(t,e,s);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===td||!td.has(a))){t=Qn(t,e=ji(t,e=gi(s,e),1),1),e=dd(),null!==t&&(bt(t,1,e),md(t,e));break}}t=t.return}}function Dd(e,t,s){var a=e.pingCache;null!==a&&a.delete(t),t=dd(),e.pingedLanes|=e.suspendedLanes&s,Mo===e&&(qo&s)===s&&(4===Ko||3===Ko&&(130023424&qo)===qo&&500>Ye()-Yo?wd(e,0):Jo|=s),md(e,t)}function Od(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var s=dd();null!==(e=Kn(e,t))&&(bt(e,t,s),md(e,s))}function Ld(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),Od(e,s)}function Fd(e,t){var s=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;null!==r&&(s=r.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(n(314))}null!==a&&a.delete(t),Od(e,s)}function Md(e,t){return Ve(e,t)}function Bd(e,t,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qd(e,t,s,a){return new Bd(e,t,s,a)}function Ud(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zd(e,t){var s=e.alternate;return null===s?((s=qd(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Kd(e,t,s,a,r,l){var i=2;if(a=e,"function"===typeof e)Ud(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case N:return Wd(s.children,r,l,t);case S:i=8,r|=8;break;case k:return(e=qd(12,s,t,2|r)).elementType=k,e.lanes=l,e;case P:return(e=qd(13,s,t,r)).elementType=P,e.lanes=l,e;case T:return(e=qd(19,s,t,r)).elementType=T,e.lanes=l,e;case R:return Hd(s,r,l,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:i=10;break e;case A:i=9;break e;case _:i=11;break e;case E:i=14;break e;case I:i=16,a=null;break e}throw Error(n(130,null==e?e:typeof e,""))}return(t=qd(i,s,t,r)).elementType=e,t.type=a,t.lanes=l,t}function Wd(e,t,s,a){return(e=qd(7,e,a,t)).lanes=s,e}function Hd(e,t,s,a){return(e=qd(22,e,a,t)).elementType=R,e.lanes=s,e.stateNode={isHidden:!1},e}function Vd(e,t,s){return(e=qd(6,e,null,t)).lanes=s,e}function Jd(e,t,s){return(t=qd(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qd(e,t,s,a,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pt(0),this.expirationTimes=pt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.identifierPrefix=a,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Gd(e,t,s,a,r,n,l,i,o){return e=new Qd(e,t,s,i,o),1===t?(t=1,!0===n&&(t|=8)):t=0,n=qd(3,null,null,t),e.current=n,n.stateNode=e,n.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hn(n),e}function Yd(e){if(!e)return Or;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(n(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(qr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(n(171))}if(1===e.tag){var s=e.type;if(qr(s))return Kr(e,s,t)}return t}function $d(e,t,s,a,r,n,l,i,o){return(e=Gd(s,a,!0,e,0,n,0,i,o)).context=Yd(null),s=e.current,(n=Jn(a=dd(),r=cd(s))).callback=void 0!==t&&null!==t?t:null,Qn(s,n,r),e.current.lanes=r,bt(e,r,a),md(e,a),e}function Zd(e,t,s,a){var r=t.current,n=dd(),l=cd(r);return s=Yd(s),null===t.context?t.context=s:t.pendingContext=s,(t=Jn(n,l)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=Qn(r,t,l))&&(ud(e,r,l,n),Gn(e,r,l)),l}function Xd(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function ec(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function tc(e,t){ec(e,t),(e=e.alternate)&&ec(e,t)}Io=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||Fr.current)Ai=!0;else{if(0===(e.lanes&s)&&0===(128&t.flags))return Ai=!1,function(e,t,s){switch(t.tag){case 3:Fi(t),jn();break;case 5:ll(t);break;case 1:qr(t.type)&&Wr(t);break;case 4:rl(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,r=t.memoizedProps.value;Dr(En,a._currentValue),a._currentValue=r;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Dr(ol,1&ol.current),t.flags|=128,null):0!==(s&t.child.childLanes)?Hi(e,t,s):(Dr(ol,1&ol.current),null!==(e=Zi(e,t,s))?e.sibling:null);Dr(ol,1&ol.current);break;case 19:if(a=0!==(s&t.childLanes),0!==(128&e.flags)){if(a)return Yi(e,t,s);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Dr(ol,ol.current),a)break;return null;case 22:case 23:return t.lanes=0,Ii(e,t,s)}return Zi(e,t,s)}(e,t,s);Ai=0!==(131072&e.flags)}else Ai=!1,hn&&0!==(1048576&t.flags)&&on(t,en,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;$i(e,t),e=t.pendingProps;var r=Br(t,Lr.current);Mn(t,s),r=Sl(null,t,a,e,r,s);var l=kl();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,qr(a)?(l=!0,Wr(t)):l=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Hn(t),r.updater=mi,t.stateNode=r,r._reactInternals=t,bi(t,a,e,s),t=Li(null,t,a,!0,l,s)):(t.tag=0,hn&&l&&dn(t),_i(null,t,r,s),t=t.child),t;case 16:a=t.elementType;e:{switch($i(e,t),e=t.pendingProps,a=(r=a._init)(a._payload),t.type=a,r=t.tag=function(e){if("function"===typeof e)return Ud(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===_)return 11;if(e===E)return 14}return 2}(a),e=ci(a,e),r){case 0:t=Di(null,t,a,e,s);break e;case 1:t=Oi(null,t,a,e,s);break e;case 11:t=Pi(null,t,a,e,s);break e;case 14:t=Ti(null,t,a,ci(a.type,e),s);break e}throw Error(n(306,a,""))}return t;case 0:return a=t.type,r=t.pendingProps,Di(e,t,a,r=t.elementType===a?r:ci(a,r),s);case 1:return a=t.type,r=t.pendingProps,Oi(e,t,a,r=t.elementType===a?r:ci(a,r),s);case 3:e:{if(Fi(t),null===e)throw Error(n(387));a=t.pendingProps,r=(l=t.memoizedState).element,Vn(e,t),$n(t,a,null,s);var i=t.memoizedState;if(a=i.element,l.isDehydrated){if(l={element:a,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=l,t.memoizedState=l,256&t.flags){t=Mi(e,t,a,s,r=gi(Error(n(423)),t));break e}if(a!==r){t=Mi(e,t,a,s,r=gi(Error(n(424)),t));break e}for(mn=gr(t.stateNode.containerInfo.firstChild),un=t,hn=!0,xn=null,s=Tn(t,null,a,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(jn(),a===r){t=Zi(e,t,s);break e}_i(e,t,a,s)}t=t.child}return t;case 5:return ll(t),null===e&&fn(t),a=t.type,r=t.pendingProps,l=null!==e?e.memoizedProps:null,i=r.children,cr(a,r)?i=null:null!==l&&cr(a,l)&&(t.flags|=32),Ri(e,t),_i(e,t,i,s),t.child;case 6:return null===e&&fn(t),null;case 13:return Hi(e,t,s);case 4:return rl(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=Pn(t,null,a,s):_i(e,t,a,s),t.child;case 11:return a=t.type,r=t.pendingProps,Pi(e,t,a,r=t.elementType===a?r:ci(a,r),s);case 7:return _i(e,t,t.pendingProps,s),t.child;case 8:case 12:return _i(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(a=t.type._context,r=t.pendingProps,l=t.memoizedProps,i=r.value,Dr(En,a._currentValue),a._currentValue=i,null!==l)if(na(l.value,i)){if(l.children===r.children&&!Fr.current){t=Zi(e,t,s);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var o=l.dependencies;if(null!==o){i=l.child;for(var d=o.firstContext;null!==d;){if(d.context===a){if(1===l.tag){(d=Jn(-1,s&-s)).tag=2;var c=l.updateQueue;if(null!==c){var u=(c=c.shared).pending;null===u?d.next=d:(d.next=u.next,u.next=d),c.pending=d}}l.lanes|=s,null!==(d=l.alternate)&&(d.lanes|=s),Fn(l.return,s,t),o.lanes|=s;break}d=d.next}}else if(10===l.tag)i=l.type===t.type?null:l.child;else if(18===l.tag){if(null===(i=l.return))throw Error(n(341));i.lanes|=s,null!==(o=i.alternate)&&(o.lanes|=s),Fn(i,s,t),i=l.sibling}else i=l.child;if(null!==i)i.return=l;else for(i=l;null!==i;){if(i===t){i=null;break}if(null!==(l=i.sibling)){l.return=i.return,i=l;break}i=i.return}l=i}_i(e,t,r.children,s),t=t.child}return t;case 9:return r=t.type,a=t.pendingProps.children,Mn(t,s),a=a(r=Bn(r)),t.flags|=1,_i(e,t,a,s),t.child;case 14:return r=ci(a=t.type,t.pendingProps),Ti(e,t,a,r=ci(a.type,r),s);case 15:return Ei(e,t,t.type,t.pendingProps,s);case 17:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:ci(a,r),$i(e,t),t.tag=1,qr(a)?(e=!0,Wr(t)):e=!1,Mn(t,s),xi(t,a,r),bi(t,a,r,s),Li(null,t,a,!0,e,s);case 19:return Yi(e,t,s);case 22:return Ii(e,t,s)}throw Error(n(156,t.tag))};var sc="function"===typeof reportError?reportError:function(e){console.error(e)};function ac(e){this._internalRoot=e}function rc(e){this._internalRoot=e}function nc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function lc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ic(){}function oc(e,t,s,a,r){var n=s._reactRootContainer;if(n){var l=n;if("function"===typeof r){var i=r;r=function(){var e=Xd(l);i.call(e)}}Zd(t,l,e,r)}else l=function(e,t,s,a,r){if(r){if("function"===typeof a){var n=a;a=function(){var e=Xd(l);n.call(e)}}var l=$d(t,a,e,0,null,!1,0,"",ic);return e._reactRootContainer=l,e[jr]=l.current,Ga(8===e.nodeType?e.parentNode:e),yd(),l}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof a){var i=a;a=function(){var e=Xd(o);i.call(e)}}var o=Gd(e,0,!1,null,0,!1,0,"",ic);return e._reactRootContainer=o,e[jr]=o.current,Ga(8===e.nodeType?e.parentNode:e),yd(function(){Zd(t,o,s,a)}),o}(s,t,e,r,a);return Xd(l)}rc.prototype.render=ac.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(n(409));Zd(e,t,null,null)},rc.prototype.unmount=ac.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;yd(function(){Zd(null,e,null,null)}),t[jr]=null}},rc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var s=0;s<It.length&&0!==t&&t<It[s].priority;s++);It.splice(s,0,e),0===s&&Lt(e)}},vt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ct(t.pendingLanes);0!==s&&(gt(t,1|s),md(t,Ye()),0===(6&Fo)&&($o=Ye()+500,Yr()))}break;case 13:yd(function(){var t=Kn(e,1);if(null!==t){var s=dd();ud(t,e,1,s)}}),tc(e,1)}},wt=function(e){if(13===e.tag){var t=Kn(e,134217728);if(null!==t)ud(t,e,134217728,dd());tc(e,134217728)}},jt=function(e){if(13===e.tag){var t=cd(e),s=Kn(e,t);if(null!==s)ud(s,e,t,dd());tc(e,t)}},Nt=function(){return ft},St=function(e,t){var s=ft;try{return ft=e,t()}finally{ft=s}},we=function(e,t,s){switch(t){case"input":if(Z(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var a=s[t];if(a!==e&&a.form===e.form){var r=Pr(a);if(!r)throw Error(n(90));J(a),Z(a,r)}}}break;case"textarea":ne(e,s);break;case"select":null!=(t=s.value)&&se(e,!!s.multiple,t,!1)}},Ae=fd,_e=yd;var dc={usingClientEntryPoint:!1,Events:[Ar,_r,Pr,ke,Ce,fd]},cc={findFiberByHostInstance:Cr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uc={bundleType:cc.bundleType,version:cc.version,rendererPackageName:cc.rendererPackageName,rendererConfig:cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:cc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mc.isDisabled&&mc.supportsFiber)try{at=mc.inject(uc),rt=mc}catch(ca){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dc,t.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nc(t))throw Error(n(200));return function(e,t,s){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==a?null:""+a,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},t.createRoot=function(e,t){if(!nc(e))throw Error(n(299));var s=!1,a="",r=sc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Gd(e,1,!1,null,0,s,0,a,r),e[jr]=t.current,Ga(8===e.nodeType?e.parentNode:e),new ac(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(n(188));throw e=Object.keys(e).join(","),Error(n(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return yd(e)},t.hydrate=function(e,t,s){if(!lc(t))throw Error(n(200));return oc(null,e,t,!0,s)},t.hydrateRoot=function(e,t,s){if(!nc(e))throw Error(n(405));var a=null!=s&&s.hydratedSources||null,r=!1,l="",i=sc;if(null!==s&&void 0!==s&&(!0===s.unstable_strictMode&&(r=!0),void 0!==s.identifierPrefix&&(l=s.identifierPrefix),void 0!==s.onRecoverableError&&(i=s.onRecoverableError)),t=$d(t,null,e,1,null!=s?s:null,r,0,l,i),e[jr]=t.current,Ga(e),a)for(e=0;e<a.length;e++)r=(r=(s=a[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,r]:t.mutableSourceEagerHydrationData.push(s,r);return new rc(t)},t.render=function(e,t,s){if(!lc(t))throw Error(n(200));return oc(null,e,t,!1,s)},t.unmountComponentAtNode=function(e){if(!lc(e))throw Error(n(40));return!!e._reactRootContainer&&(yd(function(){oc(null,null,e,!1,function(){e._reactRootContainer=null,e[jr]=null})}),!0)},t.unstable_batchedUpdates=fd,t.unstable_renderSubtreeIntoContainer=function(e,t,s,a){if(!lc(s))throw Error(n(200));if(null==e||void 0===e._reactInternals)throw Error(n(38));return oc(e,t,s,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,s)=>{e.exports=s(234)},950:(e,t,s)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=s(730)},980:(e,t,s)=>{s.d(t,{AT:()=>l,Dv:()=>j,IX:()=>u,KG:()=>g,Od:()=>o,Ox:()=>v,R2:()=>i,Re:()=>h,Yt:()=>f,Zl:()=>m,bM:()=>y,bS:()=>d,h2:()=>N,ie:()=>S,iw:()=>p,oA:()=>b,o_:()=>w,rj:()=>c,staffAPI:()=>x,z5:()=>n});var a=s(555);const r={USER_ID:"userId",USER_EMAIL:"userEmail",USER_ROLE:"userRole",CLUB_ID:"clubId",TENANT_ID:"tenantId",AUTH_TOKEN:"authToken"},n=()=>{const e={"Content-Type":"application/json"},t=localStorage.getItem(r.USER_ID),s=localStorage.getItem(r.CLUB_ID),a=localStorage.getItem(r.TENANT_ID),n=localStorage.getItem(r.AUTH_TOKEN);return t&&(e["x-user-id"]=t),s&&(e["x-club-id"]=s),a&&(e["x-tenant-id"]=a),n&&(e.Authorization="Bearer ".concat(n)),e},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s="".concat("http://localhost:3333/api").concat(e),r=(0,a.A)((0,a.A)({},t),{},{headers:(0,a.A)((0,a.A)({},n()),t.headers)});try{const e=await fetch(s,r);if(!e.ok){let t;try{t=await e.json()}catch(ia){t={message:e.statusText||"API Error: ".concat(e.status)}}if(401===e.status)throw new Error(t.message||"Invalid email or password");throw new Error(t.message||"API Error: ".concat(e.status))}return 204===e.status?null:await e.json()}catch(l){throw console.error("API Request Error:",l),l}},i={login:async(e,t)=>{const s=await l("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});if(s.user)if(localStorage.setItem(r.USER_ID,s.user.id),localStorage.setItem(r.USER_EMAIL,s.user.email),localStorage.setItem("user",JSON.stringify({id:s.user.id,email:s.user.email,name:s.user.displayName||s.user.email,displayName:s.user.displayName,isMasterAdmin:s.user.isMasterAdmin||!1,staffId:s.user.staffId})),s.clubRoles&&s.clubRoles.length>0){const e=s.clubRoles[0];localStorage.setItem(r.USER_ROLE,e.role),localStorage.setItem(r.CLUB_ID,e.club.id),localStorage.setItem(r.TENANT_ID,e.club.tenantId)}else if(s.tenantRoles&&s.tenantRoles.length>0){const e=s.tenantRoles[0];localStorage.setItem(r.USER_ROLE,e.role),localStorage.setItem(r.TENANT_ID,e.tenant.id)}else s.user.isMasterAdmin&&localStorage.setItem(r.USER_ROLE,"MASTER_ADMIN");return s},logout:()=>{Object.values(r).forEach(e=>{localStorage.removeItem(e)})},getCurrentUser:()=>{const e=localStorage.getItem("user"),t=e?JSON.parse(e):{};return{userId:localStorage.getItem(r.USER_ID),email:localStorage.getItem(r.USER_EMAIL),role:localStorage.getItem(r.USER_ROLE),clubId:localStorage.getItem(r.CLUB_ID),tenantId:localStorage.getItem(r.TENANT_ID),isMasterAdmin:t.isMasterAdmin||!1,displayName:t.displayName||null}},isAuthenticated:()=>!!localStorage.getItem(r.USER_ID)},o={getClubs:async()=>await l("/clubs"),getClub:async e=>await l("/clubs/".concat(e)),getPlayer:async(e,t)=>await l("/clubs/".concat(e,"/players/").concat(t)),getClubRevenue:async e=>await l("/clubs/".concat(e,"/revenue")),createClub:async e=>await l("/clubs",{method:"POST",body:JSON.stringify(e)}),updateClub:async(e,t)=>await l("/clubs/".concat(e),{method:"PUT",body:JSON.stringify(t)}),getActiveTablesForRakeCollection:async e=>await l("/clubs/".concat(e,"/rake-collections/active-tables")),createRakeCollection:async(e,t)=>await l("/clubs/".concat(e,"/rake-collections"),{method:"POST",body:JSON.stringify(t)}),getRakeCollections:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return""!==s&&null!==s&&void 0!==s})),a=new URLSearchParams(s).toString();return await l("/clubs/".concat(e,"/rake-collections").concat(a?"?".concat(a):""))},getRakeCollectionStats:async(e,t,s)=>{const a=new URLSearchParams;return t&&a.append("startDate",t),s&&a.append("endDate",s),await l("/clubs/".concat(e,"/rake-collections/stats").concat(a.toString()?"?".concat(a.toString()):""))},getBuyOutRequests:async e=>await l("/clubs/".concat(e,"/buyout-requests")),approveBuyOutRequest:async(e,t,s)=>await l("/clubs/".concat(e,"/buyout-requests/").concat(t,"/approve"),{method:"POST",body:JSON.stringify(s)}),rejectBuyOutRequest:async(e,t,s)=>await l("/clubs/".concat(e,"/buyout-requests/").concat(t,"/reject"),{method:"POST",body:JSON.stringify(s)}),getBuyInRequests:async e=>await l("/clubs/".concat(e,"/buyin-requests")),approveBuyInRequest:async(e,t,s)=>await l("/clubs/".concat(e,"/buyin-requests/").concat(t,"/approve"),{method:"POST",body:JSON.stringify(s)}),rejectBuyInRequest:async(e,t,s)=>await l("/clubs/".concat(e,"/buyin-requests/").concat(t,"/reject"),{method:"POST",body:JSON.stringify(s)}),getAttendanceRecords:async(e,t,s,a)=>{const r=new URLSearchParams;return t&&r.append("startDate",t),s&&r.append("endDate",s),a&&r.append("staffId",a),await l("/clubs/".concat(e,"/attendance").concat(r.toString()?"?".concat(r.toString()):""))},getAttendanceStats:async(e,t,s)=>{const a=new URLSearchParams;return t&&a.append("startDate",t),s&&a.append("endDate",s),await l("/clubs/".concat(e,"/attendance/stats").concat(a.toString()?"?".concat(a.toString()):""))},getSalaryPayments:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return""!==s&&null!==s&&void 0!==s})),a=new URLSearchParams(s).toString();return await l("/clubs/".concat(e,"/payroll/salary").concat(a?"?".concat(a):""))},createAttendanceRecord:async(e,t)=>await l("/clubs/".concat(e,"/attendance"),{method:"POST",body:JSON.stringify(t)}),getDailyRoster:async(e,t)=>await l("/clubs/".concat(e,"/attendance/daily-roster?date=").concat(t)),bulkCreateAttendance:async(e,t)=>await l("/clubs/".concat(e,"/attendance/bulk"),{method:"POST",body:JSON.stringify({entries:t})})},d={getPlayers:async e=>await l("/clubs/".concat(e,"/players")),getPlayer:async(e,t)=>await l("/clubs/".concat(e,"/players/").concat(t)),createPlayer:async(e,t)=>await l("/clubs/".concat(e,"/players"),{method:"POST",body:JSON.stringify(t)}),updatePlayer:async(e,t,s)=>await l("/clubs/".concat(e,"/players/").concat(t),{method:"PUT",body:JSON.stringify(s)}),updateKycStatus:async(e,t,s,a)=>await l("/clubs/".concat(e,"/players/").concat(t,"/kyc-status"),{method:"PUT",body:JSON.stringify({kycStatus:s,approvedBy:a})}),getKycPending:async e=>(await l("/clubs/".concat(e,"/players"))).filter(e=>"pending"===e.kycStatus),getPendingApprovalPlayers:async e=>await l("/clubs/".concat(e,"/players-pending-approval")),getSuspendedPlayers:async e=>await l("/clubs/".concat(e,"/players-suspended"))},c={getTables:async e=>await l("/clubs/".concat(e,"/tables")),getTable:async(e,t)=>await l("/clubs/".concat(e,"/tables/").concat(t)),createTable:async(e,t)=>await l("/clubs/".concat(e,"/tables"),{method:"POST",body:JSON.stringify(t)}),updateTable:async(e,t,s)=>await l("/clubs/".concat(e,"/tables/").concat(t),{method:"PUT",body:JSON.stringify(s)}),deleteTable:async(e,t)=>await l("/clubs/".concat(e,"/tables/").concat(t),{method:"DELETE"}),assignSeat:async(e,t,s)=>await l("/clubs/".concat(e,"/tables/").concat(t,"/assign-seat"),{method:"POST",body:JSON.stringify(s)}),pauseSession:async(e,t)=>await l("/clubs/".concat(e,"/tables/").concat(t,"/pause-session"),{method:"POST"}),resumeSession:async(e,t)=>await l("/clubs/".concat(e,"/tables/").concat(t,"/resume-session"),{method:"POST"}),endSession:async(e,t)=>await l("/clubs/".concat(e,"/tables/").concat(t,"/end-session"),{method:"POST"}),getSeatedPlayersForTable:async(e,t)=>await l("/clubs/".concat(e,"/tables/").concat(t,"/seated-players")),settleAndEndSession:async(e,t,s)=>{const a=Array.isArray(s)?{settlements:s}:{settlements:s.settlements,rakeAmount:s.rakeAmount};return await l("/clubs/".concat(e,"/tables/").concat(t,"/settle-and-end"),{method:"POST",body:JSON.stringify(a)})},updateSessionParams:async(e,t,s)=>await l("/clubs/".concat(e,"/tables/").concat(t,"/session-params"),{method:"PATCH",body:JSON.stringify(s)})},u={getWaitlist:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=t?"?status=".concat(t):"";return await l("/clubs/".concat(e,"/waitlist").concat(s))},addToWaitlist:async(e,t)=>await l("/clubs/".concat(e,"/waitlist"),{method:"POST",body:JSON.stringify(t)}),updateWaitlist:async(e,t,s)=>await l("/clubs/".concat(e,"/waitlist/").concat(t),{method:"PUT",body:JSON.stringify(s)}),updateWaitlistEntry:async(e,t,s)=>await l("/clubs/".concat(e,"/waitlist/").concat(t),{method:"PUT",body:JSON.stringify(s)}),unseatPlayerFromTable:async(e,t)=>await l("/clubs/".concat(e,"/waitlist/").concat(t,"/unseat"),{method:"POST"}),seatPlayer:async(e,t,s,a)=>await l("/clubs/".concat(e,"/waitlist/").concat(t),{method:"PUT",body:JSON.stringify({status:"SEATED",tableNumber:s,seatedBy:a,seatedAt:(new Date).toISOString()})}),assignSeat:async(e,t,s)=>await l("/clubs/".concat(e,"/waitlist/").concat(t,"/assign-seat"),{method:"POST",body:JSON.stringify(s)}),cancelWaitlist:async(e,t)=>await l("/clubs/".concat(e,"/waitlist/").concat(t),{method:"DELETE"}),deleteWaitlistEntry:async(e,t)=>await l("/clubs/".concat(e,"/waitlist/").concat(t),{method:"DELETE"})},m={getMenu:async e=>await l("/clubs/".concat(e,"/fnb/menu")),createMenuItem:async(e,t)=>await l("/clubs/".concat(e,"/fnb/menu"),{method:"POST",body:JSON.stringify(t)}),updateMenuItem:async(e,t,s)=>await l("/clubs/".concat(e,"/fnb/menu/").concat(t),{method:"PATCH",body:JSON.stringify(s)}),getOrders:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;const r=new URLSearchParams;return t&&r.append("status",t),r.append("page",s.toString()),r.append("limit",a.toString()),await l("/clubs/".concat(e,"/fnb/orders?").concat(r.toString()))},createOrder:async(e,t)=>await l("/clubs/".concat(e,"/fnb/orders"),{method:"POST",body:JSON.stringify(t)}),updateOrderStatus:async(e,t,s,a)=>await l("/clubs/".concat(e,"/fnb/orders/").concat(t),{method:"PUT",body:JSON.stringify({status:s,processedBy:a})}),createKitchenStation:async(e,t)=>await l("/clubs/".concat(e,"/fnb/kitchen-stations"),{method:"POST",body:JSON.stringify(t)}),getKitchenStations:async function(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"?activeOnly=true":"";return await l("/clubs/".concat(e,"/fnb/kitchen-stations").concat(t))},getKitchenStation:async(e,t)=>await l("/clubs/".concat(e,"/fnb/kitchen-stations/").concat(t)),updateKitchenStation:async(e,t,s)=>await l("/clubs/".concat(e,"/fnb/kitchen-stations/").concat(t),{method:"PATCH",body:JSON.stringify(s)}),deleteKitchenStation:async(e,t)=>await l("/clubs/".concat(e,"/fnb/kitchen-stations/").concat(t),{method:"DELETE"}),getStationStatistics:async(e,t)=>await l("/clubs/".concat(e,"/fnb/kitchen-stations/").concat(t,"/statistics")),acceptOrder:async(e,t,s)=>await l("/clubs/".concat(e,"/fnb/orders/").concat(t,"/accept"),{method:"POST",body:JSON.stringify({stationId:s,isAccepted:!0})}),rejectOrder:async(e,t,s)=>await l("/clubs/".concat(e,"/fnb/orders/").concat(t,"/reject"),{method:"POST",body:JSON.stringify({rejectedReason:s,isAccepted:!1})}),markOrderReady:async(e,t)=>await l("/clubs/".concat(e,"/fnb/orders/").concat(t,"/ready"),{method:"POST"}),markOrderDelivered:async(e,t)=>await l("/clubs/".concat(e,"/fnb/orders/").concat(t,"/delivered"),{method:"POST"}),getAllMenuCategories:async e=>await l("/clubs/".concat(e,"/fnb/categories/all")),createMenuCategory:async(e,t)=>await l("/clubs/".concat(e,"/fnb/categories"),{method:"POST",body:JSON.stringify({categoryName:t})}),deleteMenuCategory:async(e,t)=>await l("/clubs/".concat(e,"/fnb/categories/").concat(t),{method:"DELETE"}),getInventory:async e=>await l("/clubs/".concat(e,"/fnb/inventory")),createInventoryItem:async(e,t)=>await l("/clubs/".concat(e,"/fnb/inventory"),{method:"POST",body:JSON.stringify(t)}),updateInventory:async(e,t,s)=>await l("/clubs/".concat(e,"/fnb/inventory/").concat(t),{method:"PATCH",body:JSON.stringify(s)}),getSuppliers:async function(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"?activeOnly=true":"";return await l("/clubs/".concat(e,"/fnb/suppliers").concat(t))},createSupplier:async(e,t)=>await l("/clubs/".concat(e,"/fnb/suppliers"),{method:"POST",body:JSON.stringify(t)}),updateSupplier:async(e,t,s)=>await l("/clubs/".concat(e,"/fnb/suppliers/").concat(t),{method:"PATCH",body:JSON.stringify(s)}),deleteSupplier:async(e,t)=>await l("/clubs/".concat(e,"/fnb/suppliers/").concat(t),{method:"DELETE"}),deleteMenuItem:async(e,t)=>await l("/clubs/".concat(e,"/fnb/menu/").concat(t),{method:"DELETE"})},h={getTournaments:async e=>{const t=await l("/clubs/".concat(e,"/tournaments"));return(null===t||void 0===t?void 0:t.tournaments)||t||[]},getTournamentById:async(e,t)=>{const s=await l("/clubs/".concat(e,"/tournaments/").concat(t));return(null===s||void 0===s?void 0:s.tournament)||s},createTournament:async(e,t)=>await l("/clubs/".concat(e,"/tournaments"),{method:"POST",body:JSON.stringify(t)}),updateTournament:async(e,t,s)=>await l("/clubs/".concat(e,"/tournaments/").concat(t),{method:"PUT",body:JSON.stringify(s)}),deleteTournament:async(e,t)=>await l("/clubs/".concat(e,"/tournaments/").concat(t),{method:"DELETE"}),startTournament:async(e,t)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/start"),{method:"POST"}),endTournament:async(e,t,s)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/end"),{method:"POST",body:JSON.stringify(s)}),getTournamentPlayers:async(e,t)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/players")),getTournamentWinners:async(e,t)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/winners")),pauseTournament:async(e,t)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/pause"),{method:"POST"}),resumeTournament:async(e,t)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/resume"),{method:"POST"}),stopTournament:async(e,t)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/stop"),{method:"POST"}),exitTournamentPlayer:async(e,t,s)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/exit-player"),{method:"POST",body:JSON.stringify(s)}),rebuyTournamentPlayer:async(e,t,s)=>await l("/clubs/".concat(e,"/tournaments/").concat(t,"/rebuy"),{method:"POST",body:JSON.stringify(s)})},x={getStaff:async e=>await l("/clubs/".concat(e,"/staff")),createStaff:async(e,t)=>await l("/clubs/".concat(e,"/staff"),{method:"POST",body:JSON.stringify(t)}),getAllStaffMembers:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new URLSearchParams;t.role&&s.append("role",t.role),t.status&&s.append("status",t.status),t.search&&s.append("search",t.search),t.sortBy&&s.append("sortBy",t.sortBy),t.sortOrder&&s.append("sortOrder",t.sortOrder);const a=s.toString();return await l("/clubs/".concat(e,"/staff-management").concat(a?"?"+a:""))},createStaffMember:async(e,t)=>await l("/clubs/".concat(e,"/staff-management/create"),{method:"POST",body:JSON.stringify(t)}),getStaffMember:async(e,t)=>await l("/clubs/".concat(e,"/staff-management/").concat(t)),updateStaffMember:async(e,t,s)=>await l("/clubs/".concat(e,"/staff-management/").concat(t),{method:"PUT",body:JSON.stringify(s)}),updateStaffSalary:async(e,t,s)=>await l("/clubs/".concat(e,"/staff-management/").concat(t,"/salary"),{method:"PUT",body:JSON.stringify(s)}),suspendStaffMember:async(e,t,s)=>await l("/clubs/".concat(e,"/staff-management/").concat(t,"/suspend"),{method:"POST",body:JSON.stringify({reason:s})}),reactivateStaffMember:async(e,t)=>await l("/clubs/".concat(e,"/staff-management/").concat(t,"/reactivate"),{method:"POST"}),deleteStaffMember:async(e,t)=>await l("/clubs/".concat(e,"/staff-management/").concat(t),{method:"DELETE"}),resetStaffPassword:async(e,t)=>await l("/clubs/".concat(e,"/staff-management/").concat(t,"/reset-password"),{method:"POST"}),updateStaff:async(e,t,s)=>await l("/clubs/".concat(e,"/staff/").concat(t),{method:"PUT",body:JSON.stringify(s)}),getAllChatableUsers:async e=>await l("/clubs/".concat(e,"/chat/chatable-users"))},p={getShifts:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/shifts").concat(t?"?"+t:""))},getShiftById:async(e,t)=>await l("/clubs/".concat(e,"/shifts/").concat(t)),createShift:async(e,t)=>await l("/clubs/".concat(e,"/shifts"),{method:"POST",body:JSON.stringify(t)}),updateShift:async(e,t,s)=>await l("/clubs/".concat(e,"/shifts/").concat(t),{method:"PATCH",body:JSON.stringify(s)}),deleteShift:async(e,t)=>await l("/clubs/".concat(e,"/shifts/").concat(t),{method:"DELETE"}),copyShifts:async(e,t)=>await l("/clubs/".concat(e,"/shifts/copy"),{method:"POST",body:JSON.stringify(t)}),getDealers:async(e,t)=>{const s=t?"?date=".concat(t):"";return await l("/clubs/".concat(e,"/shifts-dealers").concat(s))},getAvailableDealersForDate:async(e,t)=>await l("/clubs/".concat(e,"/shifts/available-dealers?date=").concat(t)),deleteMultipleShifts:async(e,t)=>await l("/clubs/".concat(e,"/shifts/delete-multiple"),{method:"POST",body:JSON.stringify({shiftIds:t})})},b={processSalary:async(e,t)=>await l("/clubs/".concat(e,"/payroll/salary"),{method:"POST",body:JSON.stringify(t)}),getSalaryPayments:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/payroll/salary").concat(t?"?"+t:""))},getSalaryPaymentById:async(e,t)=>await l("/clubs/".concat(e,"/payroll/salary/").concat(t)),getAllStaffForPayroll:async e=>await l("/clubs/".concat(e,"/payroll/staff")),getDealersForPayroll:async e=>await l("/clubs/".concat(e,"/payroll/dealers")),getTipSettings:async(e,t)=>{const s=t?"?dealerId=".concat(t):"";return await l("/clubs/".concat(e,"/payroll/tips/settings").concat(s))},updateTipSettings:async(e,t,s)=>{const a=s?"?dealerId=".concat(s):"";return await l("/clubs/".concat(e,"/payroll/tips/settings").concat(a),{method:"POST",body:JSON.stringify(t)})},processDealerTips:async(e,t)=>await l("/clubs/".concat(e,"/payroll/tips"),{method:"POST",body:JSON.stringify(t)}),getDealerTips:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/payroll/tips").concat(t?"?"+t:""))},getDealerTipsSummary:async function(e,t){const s=new URLSearchParams(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).toString();return await l("/clubs/".concat(e,"/payroll/tips/").concat(t,"/summary").concat(s?"?"+s:""))},processDealerCashout:async(e,t)=>await l("/clubs/".concat(e,"/payroll/cashout"),{method:"POST",body:JSON.stringify(t)}),getDealerCashouts:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/payroll/cashout").concat(t?"?"+t:""))},getManagersForPayroll:async e=>await l("/clubs/".concat(e,"/payroll/managers")),getManagerTipBalance:async(e,t)=>await l("/clubs/".concat(e,"/payroll/manager-tips/").concat(t,"/balance")),processManagerCashout:async(e,t)=>await l("/clubs/".concat(e,"/payroll/manager-cashout"),{method:"POST",body:JSON.stringify(t)}),getManagerCashouts:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/payroll/manager-cashout").concat(t?"?"+t:""))},getClubTipSummary:async e=>await l("/clubs/".concat(e,"/payroll/tips/club-summary"))},g={processPlayerBonus:async(e,t)=>await l("/clubs/".concat(e,"/bonuses/players"),{method:"POST",body:JSON.stringify(t)}),getPlayerBonuses:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/bonuses/players").concat(t?"?"+t:""))},getPlayersForBonus:async(e,t)=>{const s=t?"?search=".concat(encodeURIComponent(t)):"";return await l("/clubs/".concat(e,"/bonuses/players/list").concat(s))},processStaffBonus:async(e,t)=>await l("/clubs/".concat(e,"/bonuses/staff"),{method:"POST",body:JSON.stringify(t)}),getStaffBonuses:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/bonuses/staff").concat(t?"?"+t:""))},getStaffForBonus:async(e,t)=>{const s=t?"?search=".concat(encodeURIComponent(t)):"";return await l("/clubs/".concat(e,"/bonuses/staff/list").concat(s))}},f={getAffiliates:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/affiliates").concat(t?"?"+t:""))},getAffiliateReferrals:async function(e,t){const s=new URLSearchParams(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).toString();return await l("/clubs/".concat(e,"/affiliates/").concat(t,"/referrals").concat(s?"?"+s:""))},processAffiliatePayment:async(e,t)=>await l("/clubs/".concat(e,"/affiliates/payments"),{method:"POST",body:JSON.stringify(t)}),getAffiliateTransactions:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/affiliates/transactions").concat(t?"?"+t:""))},overrideAffiliateTransaction:async(e,t,s)=>await l("/clubs/".concat(e,"/affiliates/transactions/").concat(t,"/override"),{method:"PUT",body:JSON.stringify(s)})},y={getAllTransactions:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/financial-overrides/transactions").concat(t?"?"+t:""))},editTransaction:async(e,t,s)=>await l("/clubs/".concat(e,"/financial-overrides/transactions/").concat(t,"/edit"),{method:"PUT",body:JSON.stringify(s)}),cancelTransaction:async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return await l("/clubs/".concat(e,"/financial-overrides/transactions/").concat(t,"/cancel"),{method:"POST",body:JSON.stringify(s)})}},v={getTenants:async()=>await l("/tenants"),getTenant:async e=>await l("/tenants/".concat(e),{method:"GET"}),createTenant:async e=>{const t="string"===typeof e?{name:e}:e;return await l("/tenants",{method:"POST",body:JSON.stringify(t)})},createSuperAdmin:async(e,t,s)=>await l("/tenants/".concat(e,"/super-admins"),{method:"POST",body:JSON.stringify({email:t,displayName:s})}),setupTenant:async(e,t)=>await l("/tenants/".concat(e,"/setup"),{method:"POST",body:JSON.stringify(t)}),createClub:async(e,t)=>await l("/tenants/".concat(e,"/clubs"),{method:"POST",body:JSON.stringify(t)}),createClubWithBranding:async(e,t)=>{const s={name:t.name};return t.description&&(s.description=t.description),t.skinColor&&(s.skinColor=t.skinColor),t.gradient&&(s.gradient=t.gradient),t.logoUrl&&(s.logoUrl=t.logoUrl),t.videoUrl&&(s.videoUrl=t.videoUrl),void 0!==t.pokerEnabled&&(s.pokerEnabled=t.pokerEnabled),void 0!==t.rummyEnabled&&(s.rummyEnabled=t.rummyEnabled),await l("/tenants/".concat(e,"/clubs"),{method:"POST",body:JSON.stringify(s)})},getLogoUploadUrl:async(e,t)=>await l("/tenants/".concat(e,"/clubs/").concat(t,"/logo-upload-url"),{method:"POST"}),uploadLogo:async(e,t)=>{const s=await fetch(e,{method:"PUT",headers:{"Content-Type":"image/png"},body:t});if(!s.ok)throw new Error("Failed to upload logo");return s},getLogoPublicUrl:async(e,t)=>(await l("/tenants/".concat(e,"/clubs/").concat(t,"/logo-url"))).logoUrl},w={getCurrentUser:async()=>{const e=localStorage.getItem(r.USER_ID);if(!e)throw new Error("User not logged in");return await l("/users/".concat(e))},getAllClubs:async()=>await l("/clubs/master-admin/all"),updateClubStatus:async(e,t,s)=>await l("/clubs/".concat(e,"/status"),{method:"PUT",body:JSON.stringify({status:t,reason:s})}),updateClubDetails:async(e,t)=>await l("/clubs/".concat(e,"/master-admin/details"),{method:"PUT",body:JSON.stringify(t)}),updateClubSubscription:async(e,t)=>await l("/clubs/".concat(e,"/subscription"),{method:"PUT",body:JSON.stringify(t)}),updateClubTerms:async(e,t)=>await l("/clubs/".concat(e,"/terms"),{method:"PUT",body:JSON.stringify({termsAndConditions:t})}),updateClubRummyEnabled:async(e,t)=>await l("/clubs/".concat(e,"/rummy-enabled"),{method:"PUT",body:JSON.stringify({rummyEnabled:t})}),updateClubGameAccess:async(e,t)=>await l("/clubs/".concat(e,"/game-access"),{method:"PUT",body:JSON.stringify(t)}),getClubGameAccess:async e=>await l("/clubs/".concat(e,"/game-access")),createTenantWithClub:async e=>await l("/tenants/with-club",{method:"POST",body:JSON.stringify(e)}),getDashboardStats:async()=>{try{const e=await w.getAllClubs(),t=await v.getTenants(),s=e.length,a=e.filter(e=>"active"===e.status).length,r=e.filter(e=>"suspended"===e.status).length,n=e.filter(e=>"killed"===e.status).length,l=e.reduce((e,t)=>e+(parseFloat(t.subscriptionPrice)||0),0);return{totalTenants:t.length,totalClubs:s,activeClubs:a,suspendedClubs:r,killedClubs:n,monthlyRevenue:l,clubs:e,tenants:t}}catch(e){return console.error("Error loading dashboard stats:",e),{totalTenants:0,totalClubs:0,activeClubs:0,suspendedClubs:0,killedClubs:0,monthlyRevenue:0,clubs:[],tenants:[]}}}},j={getClubs:async()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("superadminuser")||"{}"),s=e.id||t.userId;if(!s)throw new Error("User not logged in");return await l("/users/".concat(s,"/clubs"))},getClub:async e=>await l("/clubs/".concat(e)),getClubRevenue:async e=>await l("/clubs/".concat(e,"/revenue")),getAllPlayers:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/players?").concat(t))},createPlayer:async(e,t)=>await l("/clubs/".concat(e,"/players"),{method:"POST",body:JSON.stringify(t)}),getPendingApprovalPlayers:async e=>await l("/clubs/".concat(e,"/players-pending-approval")),approvePlayer:async(e,t,s)=>await l("/clubs/".concat(e,"/players/").concat(t,"/approve"),{method:"POST",body:JSON.stringify({notes:s})}),rejectPlayer:async(e,t,s)=>await l("/clubs/".concat(e,"/players/").concat(t,"/reject"),{method:"POST",body:JSON.stringify({reason:s})}),suspendPlayer:async(e,t,s)=>await l("/clubs/".concat(e,"/players/").concat(t,"/suspend"),{method:"POST",body:JSON.stringify(s)}),unsuspendPlayer:async(e,t)=>await l("/clubs/".concat(e,"/players/").concat(t,"/unsuspend"),{method:"POST"}),getSuspendedPlayers:async e=>await l("/clubs/".concat(e,"/players-suspended")),getPlayer:async(e,t)=>await l("/clubs/".concat(e,"/players/").concat(t)),getPlayers:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/players?").concat(t))},getPlayerBalance:async(e,t)=>await l("/clubs/".concat(e,"/players/").concat(t,"/balance")),getSeatedPlayers:async e=>await l("/clubs/".concat(e,"/seated-players")),getTransactions:async function(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString();return await l("/clubs/".concat(e,"/transactions").concat(t?"?"+t:""))},createTransaction:async(e,t)=>await l("/clubs/".concat(e,"/transactions"),{method:"POST",body:JSON.stringify(t)}),getCreditRequests:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=t?"?status=".concat(t):"";return await l("/clubs/".concat(e,"/credit-requests").concat(s))},approveCreditRequest:async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return await l("/clubs/".concat(e,"/credit-requests/").concat(t,"/approve"),{method:"POST",body:JSON.stringify(s)})},rejectCreditRequest:async(e,t,s)=>await l("/clubs/".concat(e,"/credit-requests/").concat(t,"/deny"),{method:"POST",body:JSON.stringify(s)}),unlockCredit:async(e,t,s)=>await l("/clubs/".concat(e,"/players/").concat(t,"/enable-credit"),{method:"POST",body:JSON.stringify(s)}),updateCreditLimit:async(e,t,s)=>await l("/clubs/".concat(e,"/players/").concat(t,"/credit-limit"),{method:"PATCH",body:JSON.stringify(s)}),getVipProducts:async e=>await l("/clubs/".concat(e,"/vip-products")),createVipProduct:async(e,t)=>await l("/clubs/".concat(e,"/vip-products"),{method:"POST",body:JSON.stringify(t)}),updateVipProduct:async(e,t,s)=>await l("/clubs/".concat(e,"/vip-products/").concat(t),{method:"PUT",body:JSON.stringify(s)}),deleteVipProduct:async(e,t)=>await l("/clubs/".concat(e,"/vip-products/").concat(t),{method:"DELETE"}),getVipPurchases:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return await l("/clubs/".concat(e,"/vip-purchases?page=").concat(t,"&limit=").concat(s))},createVipProductImageUploadUrl:async(e,t)=>await l("/clubs/".concat(e,"/vip-products/upload-url"),{method:"POST",body:JSON.stringify({filename:t})}),uploadToSignedUrl:async(e,t)=>{try{const s=await fetch(e,{method:"PUT",body:t,headers:{"Content-Type":t.type||"image/png","Cache-Control":"3600"}});if(!s.ok){const t=await s.text().catch(()=>"Unknown error");throw console.error("Upload failed:",{status:s.status,statusText:s.statusText,error:t,url:e.substring(0,100)+"..."}),new Error("Upload failed (".concat(s.status,"): ").concat(s.statusText))}return s}catch(s){throw console.error("Upload error:",s),s}},getPushNotifications:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=t?"?notificationType=".concat(t):"";return await l("/clubs/".concat(e,"/push-notifications").concat(s))},createPushNotification:async(e,t)=>await l("/clubs/".concat(e,"/push-notifications"),{method:"POST",body:JSON.stringify(t)}),updatePushNotification:async(e,t,s)=>await l("/clubs/".concat(e,"/push-notifications/").concat(t),{method:"PUT",body:JSON.stringify(s)}),deletePushNotification:async(e,t)=>await l("/clubs/".concat(e,"/push-notifications/").concat(t),{method:"DELETE"}),createPushNotificationUploadUrl:async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return await l("/clubs/".concat(e,"/push-notifications/upload-url"),{method:"POST",body:JSON.stringify({filename:t,isVideo:s})})},sendPushNotification:async(e,t)=>await l("/clubs/".concat(e,"/push-notifications/").concat(t,"/send"),{method:"POST"}),getNotificationInbox:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"staff",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;const r=JSON.parse(localStorage.getItem("user")||"{}").id;if(!r)throw new Error("User ID not found");return await l("/clubs/".concat(e,"/notifications/inbox?recipientType=").concat(t,"&page=").concat(s,"&limit=").concat(a),{headers:{"x-user-id":r}})},getUnreadNotificationCount:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"staff";const s=JSON.parse(localStorage.getItem("user")||"{}").id;if(!s)throw new Error("User ID not found");return await l("/clubs/".concat(e,"/notifications/unread-count?recipientType=").concat(t),{headers:{"x-user-id":s}})},markNotificationAsRead:async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"staff";const a=JSON.parse(localStorage.getItem("user")||"{}").id;if(!a)throw new Error("User ID not found");return await l("/clubs/".concat(e,"/notifications/").concat(t,"/mark-read"),{method:"POST",headers:{"x-user-id":a},body:JSON.stringify({recipientType:s})})},markAllNotificationsAsRead:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"staff";const s=JSON.parse(localStorage.getItem("user")||"{}").id;if(!s)throw new Error("User ID not found");return await l("/clubs/".concat(e,"/notifications/mark-all-read"),{method:"POST",headers:{"x-user-id":s},body:JSON.stringify({recipientType:t})})},getPlayerFeedback:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return await l("/clubs/".concat(e,"/player-feedback?page=").concat(t,"&limit=").concat(s))},getFieldUpdateRequests:async e=>await l("/clubs/".concat(e,"/player-field-updates/pending")),approveFieldUpdate:async(e,t)=>await l("/clubs/".concat(e,"/player-field-updates/").concat(t,"/approve"),{method:"POST"}),getPlayerDocuments:async(e,t)=>await l("/clubs/".concat(e,"/players/").concat(t,"/documents")),rejectFieldUpdate:async(e,t,s)=>await l("/clubs/".concat(e,"/player-field-updates/").concat(t,"/reject"),{method:"POST",body:JSON.stringify({reason:s})})},N={createStaffChatSession:async(e,t,s)=>await l("/clubs/".concat(e,"/chat/staff/sessions"),{method:"POST",body:JSON.stringify({recipientStaffId:t,subject:s})}),getStaffChatSessions:async function(e){let{page:t=1,limit:s=10,search:a,role:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new URLSearchParams;n.append("page",t.toString()),n.append("limit",s.toString()),a&&n.append("search",a),r&&n.append("role",r);const i=localStorage.getItem("userId"),o=i?{"x-user-id":i}:{};return await l("/clubs/".concat(e,"/chat/staff/sessions?").concat(n.toString()),{headers:o})},createPlayerChatSession:async(e,t,s)=>await l("/clubs/".concat(e,"/chat/player/sessions"),{method:"POST",body:JSON.stringify({playerId:t,subject:s})}),getPlayerChatSessions:async function(e){let{page:t=1,limit:s=10,status:a,search:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new URLSearchParams;return n.append("page",t.toString()),n.append("limit",s.toString()),a&&n.append("status",a),r&&n.append("search",r),await l("/clubs/".concat(e,"/chat/player/sessions?").concat(n.toString()))},sendMessage:async(e,t,s)=>await l("/clubs/".concat(e,"/chat/sessions/").concat(t,"/messages"),{method:"POST",body:JSON.stringify({message:s})}),getSessionMessages:async function(e,t){let{page:s=1,limit:a=50}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new URLSearchParams;return r.append("page",s.toString()),r.append("limit",a.toString()),await l("/clubs/".concat(e,"/chat/sessions/").concat(t,"/messages?").concat(r.toString()))},updateChatSession:async(e,t,s)=>await l("/clubs/".concat(e,"/chat/sessions/").concat(t),{method:"PATCH",body:JSON.stringify(s)}),getUnreadCounts:async e=>await l("/clubs/".concat(e,"/chat/unread-counts")),getChatableUsers:async function(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"?excludeExisting=true":"";return await l("/clubs/".concat(e,"/chat/chatable-users").concat(t))},archiveChatSession:async(e,t)=>await l("/clubs/".concat(e,"/chat/sessions/").concat(t),{method:"DELETE"})},S={getLeavePolicies:async e=>await l("/clubs/".concat(e,"/leave-policies")),createLeavePolicy:async(e,t)=>await l("/clubs/".concat(e,"/leave-policies"),{method:"POST",body:JSON.stringify(t)}),updateLeavePolicy:async(e,t,s)=>await l("/clubs/".concat(e,"/leave-policies/").concat(encodeURIComponent(t)),{method:"PUT",body:JSON.stringify(s)}),deleteLeavePolicy:async(e,t)=>await l("/clubs/".concat(e,"/leave-policies/").concat(encodeURIComponent(t)),{method:"DELETE"}),getMyLeaveApplications:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new URLSearchParams;t.status&&s.append("status",t.status),t.startDate&&s.append("startDate",t.startDate),t.endDate&&s.append("endDate",t.endDate),t.page&&s.append("page",t.page.toString()),t.limit&&s.append("limit",t.limit.toString());const a=s.toString();return await l("/clubs/".concat(e,"/leave-applications/my-leaves").concat(a?"?"+a:""))},getLeaveBalance:async e=>await l("/clubs/".concat(e,"/leave-applications/balance")),getPendingLeaveApplications:async e=>await l("/clubs/".concat(e,"/leave-applications/pending")),getLeaveApplicationsForApproval:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new URLSearchParams;t.status&&s.append("status",t.status),t.role&&s.append("role",t.role),t.startDate&&s.append("startDate",t.startDate),t.endDate&&s.append("endDate",t.endDate),t.search&&s.append("search",t.search),t.page&&s.append("page",t.page.toString()),t.limit&&s.append("limit",t.limit.toString());const a=s.toString();return await l("/clubs/".concat(e,"/leave-applications/for-approval").concat(a?"?"+a:""))},createLeaveApplication:async(e,t)=>await l("/clubs/".concat(e,"/leave-applications"),{method:"POST",body:JSON.stringify(t)}),approveLeaveApplication:async(e,t)=>await l("/clubs/".concat(e,"/leave-applications/").concat(t,"/approve"),{method:"POST"}),rejectLeaveApplication:async(e,t,s)=>await l("/clubs/".concat(e,"/leave-applications/").concat(t,"/reject"),{method:"POST",body:JSON.stringify({rejectionReason:s})}),cancelLeaveApplication:async(e,t)=>await l("/clubs/".concat(e,"/leave-applications/").concat(t,"/cancel"),{method:"POST"})}}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,s),n.exports}s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(ia){if("object"===typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};s.r(a),s.d(a,{Decoder:()=>Bu,Encoder:()=>Mu,PacketType:()=>Fu,isPacketValid:()=>Ku,protocol:()=>Lu});var r=s(43),n=s(391);function l(e,t){if(null==e)return{};var s,a,r=function(e,t){if(null==e)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;s[a]=e[a]}return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)s=n[a],-1===t.indexOf(s)&&{}.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}var i=s(555);const o=["sri"],d=["page"],c=["page","matches"],u=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],m=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],h=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var x="popstate";function p(){return j(function(e,t){let{pathname:s,search:a,hash:r}=e.location;return y("",{pathname:s,search:a,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:v(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function b(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function g(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(ia){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function y(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return(0,i.A)((0,i.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?w(t):t),{},{state:s,key:t&&t.key||a||Math.random().toString(36).substring(2,10)})}function v(e){let{pathname:t="/",search:s="",hash:a=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function w(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substring(s),e=e.substring(0,s));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function j(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:n=!1}=a,l=r.history,o="POP",d=null,c=u();function u(){return(l.state||{idx:null}).idx}function m(){o="POP";let e=u(),t=null==e?null:e-c;c=e,d&&d({action:o,location:p.location,delta:t})}function h(e){return N(e)}null==c&&(c=0,l.replaceState((0,i.A)((0,i.A)({},l.state),{},{idx:c}),""));let p={get action(){return o},get location(){return e(r,l)},listen(e){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(x,m),d=e,()=>{r.removeEventListener(x,m),d=null}},createHref:e=>t(r,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let a=y(p.location,e,t);s&&s(a,e),c=u()+1;let i=f(a,c),m=p.createHref(a);try{l.pushState(i,"",m)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;r.location.assign(m)}n&&d&&d({action:o,location:p.location,delta:1})},replace:function(e,t){o="REPLACE";let a=y(p.location,e,t);s&&s(a,e),c=u();let r=f(a,c),i=p.createHref(a);l.replaceState(r,"",i),n&&d&&d({action:o,location:p.location,delta:0})},go:e=>l.go(e)};return p}function N(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s="http://localhost";"undefined"!==typeof window&&(s="null"!==window.location.origin?window.location.origin:window.location.href),b(s,"No window.location.(origin|href) available to create URL");let a="string"===typeof e?e:v(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=s+a),new URL(a,s)}new WeakMap;function S(e,t){return k(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function k(e,t,s,a){let r=q(("string"===typeof t?w(t):t).pathname||"/",s);if(null==r)return null;let n=C(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s]);return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(n);let l=null;for(let i=0;null==l&&i<n.length;++i){let e=B(r);l=L(n[i],e,a)}return l}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=function(e,n){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,i=arguments.length>3?arguments[3]:void 0,o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};if(o.relativePath.startsWith("/")){if(!o.relativePath.startsWith(a)&&l)return;b(o.relativePath.startsWith(a),'Absolute route path "'.concat(o.relativePath,'" nested under path "').concat(a,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),o.relativePath=o.relativePath.slice(a.length)}let d=H([a,o.relativePath]),c=s.concat(o);e.children&&e.children.length>0&&(b(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(d,'".')),C(e.children,t,c,d,l)),(null!=e.path||e.index)&&t.push({path:d,score:O(d,e.index),routesMeta:c})};return e.forEach((e,t)=>{var s;if(""!==e.path&&null!==(s=e.path)&&void 0!==s&&s.includes("?"))for(let a of A(e.path))n(e,t,!0,a);else n(e,t)}),t}function A(e){let t=e.split("/");if(0===t.length)return[];let[s,...a]=t,r=s.endsWith("?"),n=s.replace(/\?$/,"");if(0===a.length)return r?[n,""]:[n];let l=A(a.join("/")),i=[];return i.push(...l.map(e=>""===e?n:[n,e].join("/"))),r&&i.push(...l),i.map(t=>e.startsWith("/")&&""===t?"/":t)}var _=/^:[\w-]+$/,P=3,T=2,E=1,I=10,R=-2,D=e=>"*"===e;function O(e,t){let s=e.split("/"),a=s.length;return s.some(D)&&(a+=R),t&&(a+=T),s.filter(e=>!D(e)).reduce((e,t)=>e+(_.test(t)?P:""===t?E:I),a)}function L(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:a}=e,r={},n="/",l=[];for(let i=0;i<a.length;++i){let e=a[i],o=i===a.length-1,d="/"===n?t:t.slice(n.length)||"/",c=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},d),u=e.route;if(!c&&o&&s&&!a[a.length-1].route.index&&(c=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},d)),!c)return null;Object.assign(r,c.params),l.push({params:r,pathname:H([n,c.pathname]),pathnameBase:V(H([n,c.pathnameBase])),route:u}),"/"!==c.pathnameBase&&(n=H([n,c.pathnameBase]))}return l}function F(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=M(e.path,e.caseSensitive,e.end),r=t.match(s);if(!r)return null;let n=r[0],l=n.replace(/(.)\/+$/,"$1"),i=r.slice(1),o=a.reduce((e,t,s)=>{let{paramName:a,isOptional:r}=t;if("*"===a){let e=i[s]||"";l=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const o=i[s];return e[a]=r&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{});return{params:o,pathname:n,pathnameBase:l,pattern:e}}function M(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];g("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(a.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function B(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return g(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function q(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,a=e.charAt(s);return a&&"/"!==a?null:e.slice(s)||"/"}function U(e,t,s,a){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(a),"].  Please separate it out to the `to.").concat(s,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function z(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function K(e){let t=z(e);return t.map((e,s)=>s===t.length-1?e.pathname:e.pathnameBase)}function W(e,t,s){let a,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?a=w(e):(a=(0,i.A)({},e),b(!a.pathname||!a.pathname.includes("?"),U("?","pathname","search",a)),b(!a.pathname||!a.pathname.includes("#"),U("#","pathname","hash",a)),b(!a.search||!a.search.includes("#"),U("#","search","hash",a)));let n,l=""===e||""===a.pathname,o=l?"/":a.pathname;if(null==o)n=s;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}n=e>=0?t[e]:"/"}let d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:s,search:a="",hash:r=""}="string"===typeof e?w(e):e,n=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:n,search:J(a),hash:Q(r)}}(a,n),c=o&&"/"!==o&&o.endsWith("/"),u=(l||"."===o)&&s.endsWith("/");return d.pathname.endsWith("/")||!c&&!u||(d.pathname+="/"),d}var H=e=>e.join("/").replace(/\/\/+/g,"/"),V=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),J=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function G(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Y=["POST","PUT","PATCH","DELETE"],$=(new Set(Y),["GET",...Y]);new Set($),Symbol("ResetLoaderData");var Z=r.createContext(null);Z.displayName="DataRouter";var X=r.createContext(null);X.displayName="DataRouterState";var ee=r.createContext(!1);var te=r.createContext({isTransitioning:!1});te.displayName="ViewTransition";var se=r.createContext(new Map);se.displayName="Fetchers";var ae=r.createContext(null);ae.displayName="Await";var re=r.createContext(null);re.displayName="Navigation";var ne=r.createContext(null);ne.displayName="Location";var le=r.createContext({outlet:null,matches:[],isDataRoute:!1});le.displayName="Route";var ie=r.createContext(null);ie.displayName="RouteError";function oe(){return null!=r.useContext(ne)}function de(){return b(oe(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(ne).location}var ce="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ue(e){r.useContext(re).static||r.useLayoutEffect(e)}function me(){let{isDataRoute:e}=r.useContext(le);return e?function(){let{router:e}=we("useNavigate"),t=Ne("useNavigate"),s=r.useRef(!1);ue(()=>{s.current=!0});let a=r.useCallback(async function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(s.current,ce),s.current&&("number"===typeof a?e.navigate(a):await e.navigate(a,(0,i.A)({fromRouteId:t},r)))},[e,t]);return a}():function(){b(oe(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext(Z),{basename:t,navigator:s}=r.useContext(re),{matches:a}=r.useContext(le),{pathname:n}=de(),l=JSON.stringify(K(a)),i=r.useRef(!1);ue(()=>{i.current=!0});let o=r.useCallback(function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(g(i.current,ce),!i.current)return;if("number"===typeof a)return void s.go(a);let o=W(a,JSON.parse(l),n,"path"===r.relative);null==e&&"/"!==t&&(o.pathname="/"===o.pathname?t:H([t,o.pathname])),(r.replace?s.replace:s.push)(o,r.state,r)},[t,s,l,n,e]);return o}()}r.createContext(null);function he(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:s}=r.useContext(le),{pathname:a}=de(),n=JSON.stringify(K(s));return r.useMemo(()=>W(e,JSON.parse(n),a,"path"===t),[e,n,a,t])}function xe(e,t,s,a,n){b(oe(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=r.useContext(re),{matches:o}=r.useContext(le),d=o[o.length-1],c=d?d.params:{},u=d?d.pathname:"/",m=d?d.pathnameBase:"/",h=d&&d.route;{let e=h&&h.path||"";Ce(u,!h||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let x,p=de();if(t){var f;let e="string"===typeof t?w(t):t;b("/"===m||(null===(f=e.pathname)||void 0===f?void 0:f.startsWith(m)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(m,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),x=e}else x=p;let y=x.pathname||"/",v=y;if("/"!==m){let e=m.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let j=S(e,{pathname:v});g(h||null!=j,'No routes matched location "'.concat(x.pathname).concat(x.search).concat(x.hash,'" ')),g(null==j||void 0!==j[j.length-1].route.element||void 0!==j[j.length-1].route.Component||void 0!==j[j.length-1].route.lazy,'Matched leaf route at location "'.concat(x.pathname).concat(x.search).concat(x.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let N=ye(j&&j.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:H([m,l.encodeLocation?l.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?m:H([m,l.encodeLocation?l.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),o,s,a,n);return t&&N?r.createElement(ne.Provider,{value:{location:(0,i.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:"POP"}},N):N}function pe(){let e=Se(),t=G(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=r.createElement(r.Fragment,null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:l},"ErrorBoundary")," or"," ",r.createElement("code",{style:l},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),s?r.createElement("pre",{style:n},s):null,i)}var be=r.createElement(pe,null),ge=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?r.createElement(le.Provider,{value:this.props.routeContext},r.createElement(ie.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fe(e){let{routeContext:t,match:s,children:a}=e,n=r.useContext(Z);return n&&n.static&&n.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=s.route.id),r.createElement(le.Provider,{value:t},a)}function ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!s)return null;if(s.errors)e=s.matches;else{if(0!==t.length||s.initialized||!(s.matches.length>0))return null;e=s.matches}}let n=e,l=null===s||void 0===s?void 0:s.errors;if(null!=l){let e=n.findIndex(e=>e.route.id&&void 0!==(null===l||void 0===l?void 0:l[e.route.id]));b(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(l).join(","))),n=n.slice(0,Math.min(n.length,e+1))}let i=!1,o=-1;if(s)for(let r=0;r<n.length;r++){let e=n[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(o=r),e.route.id){let{loaderData:t,errors:a}=s,r=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!a||void 0===a[e.route.id]);if(e.route.lazy||r){i=!0,n=o>=0?n.slice(0,o+1):[n[0]];break}}}return n.reduceRight((e,d,c)=>{let u,m=!1,h=null,x=null;s&&(u=l&&d.route.id?l[d.route.id]:void 0,h=d.route.errorElement||be,i&&(o<0&&0===c?(Ce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,x=null):o===c&&(m=!0,x=d.route.hydrateFallbackElement||null)));let p=t.concat(n.slice(0,c+1)),b=()=>{let t;return t=u?h:m?x:d.route.Component?r.createElement(d.route.Component,null):d.route.element?d.route.element:e,r.createElement(fe,{match:d,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(d.route.ErrorBoundary||d.route.errorElement||0===c)?r.createElement(ge,{location:s.location,revalidation:s.revalidation,component:h,error:u,children:b(),routeContext:{outlet:null,matches:p,isDataRoute:!0},unstable_onError:a}):b()},null)}function ve(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function we(e){let t=r.useContext(Z);return b(t,ve(e)),t}function je(e){let t=r.useContext(X);return b(t,ve(e)),t}function Ne(e){let t=function(e){let t=r.useContext(le);return b(t,ve(e)),t}(e),s=t.matches[t.matches.length-1];return b(s.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),s.route.id}function Se(){var e;let t=r.useContext(ie),s=je("useRouteError"),a=Ne("useRouteError");return void 0!==t?t:null===(e=s.errors)||void 0===e?void 0:e[a]}var ke={};function Ce(e,t,s){t||ke[e]||(ke[e]=!0,g(!1,s))}var Ae={};function _e(e,t){e||Ae[t]||(Ae[t]=!0,console.warn(t))}r.memo(function(e){let{routes:t,future:s,state:a,unstable_onError:r}=e;return xe(t,void 0,a,r,s)});function Pe(e){let{to:t,replace:s,state:a,relative:n}=e;b(oe(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=r.useContext(re);g(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=r.useContext(le),{pathname:o}=de(),d=me(),c=W(t,K(i),o,"path"===n),u=JSON.stringify(c);return r.useEffect(()=>{d(JSON.parse(u),{replace:s,state:a,relative:n})},[d,u,n,s,a]),null}function Te(e){b(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ee(e){let{basename:t="/",children:s=null,location:a,navigationType:n="POP",navigator:l,static:i=!1}=e;b(!oe(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),d=r.useMemo(()=>({basename:o,navigator:l,static:i,future:{}}),[o,l,i]);"string"===typeof a&&(a=w(a));let{pathname:c="/",search:u="",hash:m="",state:h=null,key:x="default"}=a,p=r.useMemo(()=>{let e=q(c,o);return null==e?null:{location:{pathname:e,search:u,hash:m,state:h,key:x},navigationType:n}},[o,c,u,m,h,x,n]);return g(null!=p,'<Router basename="'.concat(o,'"> is not able to match the URL "').concat(c).concat(u).concat(m,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==p?null:r.createElement(re.Provider,{value:d},r.createElement(ne.Provider,{children:s,value:p}))}function Ie(e){let{children:t,location:s}=e;return xe(Re(t),s)}r.Component;function Re(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=[];return r.Children.forEach(e,(e,a)=>{if(!r.isValidElement(e))return;let n=[...t,a];if(e.type===r.Fragment)return void s.push.apply(s,Re(e.props.children,n));b(e.type===Te,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),b(!e.props.index||!e.props.children,"An index route cannot have child routes.");let l={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(l.children=Re(e.props.children,n)),s.push(l)}),s}var De="get",Oe="application/x-www-form-urlencoded";function Le(e){return null!=e&&"string"===typeof e.tagName}var Fe=null;var Me=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Be(e){return null==e||Me.has(e)?e:(g(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Oe,'"')),null)}function qe(e,t){let s,a,r,n,l;if(Le(i=e)&&"form"===i.tagName.toLowerCase()){let l=e.getAttribute("action");a=l?q(l,t):null,s=e.getAttribute("method")||De,r=Be(e.getAttribute("enctype"))||Oe,n=new FormData(e)}else if(function(e){return Le(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Le(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let l=e.form;if(null==l)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let i=e.getAttribute("formaction")||l.getAttribute("action");if(a=i?q(i,t):null,s=e.getAttribute("formmethod")||l.getAttribute("method")||De,r=Be(e.getAttribute("formenctype"))||Be(l.getAttribute("enctype"))||Oe,n=new FormData(l,e),!function(){if(null===Fe)try{new FormData(document.createElement("form"),0),Fe=!1}catch(ia){Fe=!0}return Fe}()){let{name:t,type:s,value:a}=e;if("image"===s){let e=t?"".concat(t,"."):"";n.append("".concat(e,"x"),"0"),n.append("".concat(e,"y"),"0")}else t&&n.append(t,a)}}else{if(Le(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=De,a=null,r=Oe,l=e}var i;return n&&"text/plain"===r&&(l=n,n=void 0),{action:a,method:s.toLowerCase(),encType:r,formData:n,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function Ue(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function ze(e,t,s){let a="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===a.pathname?a.pathname="_root.".concat(s):t&&"/"===q(a.pathname,t)?a.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(s):a.pathname="".concat(a.pathname.replace(/\/$/,""),".").concat(s),a}async function Ke(e,t){if(e.id in t)return t[e.id];try{let s=await import(e.module);return t[e.id]=s,s}catch(s){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function We(e){return null!=e&&"string"===typeof e.page}function He(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ve(e,t,s,a,r,n){let l=(e,t)=>!s[t]||e.route.id!==s[t].route.id,i=(e,t)=>{var a;return s[t].pathname!==e.pathname||(null===(a=s[t].route.path)||void 0===a?void 0:a.endsWith("*"))&&s[t].params["*"]!==e.params["*"]};return"assets"===n?t.filter((e,t)=>l(e,t)||i(e,t)):"data"===n?t.filter((t,n)=>{let o=a.routes[t.route.id];if(!o||!o.hasLoader)return!1;if(l(t,n)||i(t,n))return!0;if(t.route.shouldRevalidate){var d;let a=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(d=s[0])||void 0===d?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof a)return a}return!0}):[]}function Je(e,t){let{includeHydrateFallback:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a=e.map(e=>{let a=t.routes[e.route.id];if(!a)return[];let r=[a.module];return a.clientActionModule&&(r=r.concat(a.clientActionModule)),a.clientLoaderModule&&(r=r.concat(a.clientLoaderModule)),s&&a.hydrateFallbackModule&&(r=r.concat(a.hydrateFallbackModule)),a.imports&&(r=r.concat(a.imports)),r}).flat(1),[...new Set(a)];var a}function Qe(e,t){let s=new Set,a=new Set(t);return e.reduce((e,r)=>{if(t&&!We(r)&&"script"===r.as&&r.href&&a.has(r.href))return e;let n=JSON.stringify(function(e){let t={},s=Object.keys(e).sort();for(let a of s)t[a]=e[a];return t}(r));return s.has(n)||(s.add(n),e.push({key:n,link:r})),e},[])}function Ge(e,t){return"lazy"===e.mode&&!0===t}function Ye(){let e=r.useContext(Z);return Ue(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function $e(){let e=r.useContext(X);return Ue(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Ze=r.createContext(void 0);function Xe(){let e=r.useContext(Ze);return Ue(e,"You must render this element inside a <HydratedRouter> element"),e}function et(e,t){return s=>{e&&e(s),s.defaultPrevented||t(s)}}function tt(e,t,s){if(s&&!nt)return[e[0]];if(t){let s=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,s+1)}return e}Ze.displayName="FrameworkContext";function st(e){let{page:t}=e,s=l(e,d),{router:a}=Ye(),n=r.useMemo(()=>S(a.routes,t,a.basename),[a.routes,t,a.basename]);return n?r.createElement(rt,(0,i.A)({page:t,matches:n},s)):null}function at(e){let{manifest:t,routeModules:s}=Xe(),[a,n]=r.useState([]);return r.useEffect(()=>{let a=!1;return async function(e,t,s){return Qe((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await Ke(a,s);return e.links?e.links():[]}return[]}))).flat(1).filter(He).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?(0,i.A)((0,i.A)({},e),{},{rel:"prefetch",as:"style"}):(0,i.A)((0,i.A)({},e),{},{rel:"prefetch"})))}(e,t,s).then(e=>{a||n(e)}),()=>{a=!0}},[e,t,s]),a}function rt(e){let{page:t,matches:s}=e,a=l(e,c),n=de(),{manifest:o,routeModules:d}=Xe(),{basename:u}=Ye(),{loaderData:m,matches:h}=$e(),x=r.useMemo(()=>Ve(t,s,h,o,n,"data"),[t,s,h,o,n]),p=r.useMemo(()=>Ve(t,s,h,o,n,"assets"),[t,s,h,o,n]),b=r.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let e=new Set,a=!1;if(s.forEach(t=>{var s;let r=o.routes[t.route.id];r&&r.hasLoader&&(!x.some(e=>e.route.id===t.route.id)&&t.route.id in m&&null!==(s=d[t.route.id])&&void 0!==s&&s.shouldRevalidate||r.hasClientLoader?a=!0:e.add(t.route.id))}),0===e.size)return[];let r=ze(t,u,"data");return a&&e.size>0&&r.searchParams.set("_routes",s.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[r.pathname+r.search]},[u,m,n,o,x,s,t,d]),g=r.useMemo(()=>Je(p,o),[p,o]),f=at(p);return r.createElement(r.Fragment,null,b.map(e=>r.createElement("link",(0,i.A)({key:e,rel:"prefetch",as:"fetch",href:e},a))),g.map(e=>r.createElement("link",(0,i.A)({key:e,rel:"modulepreload",href:e},a))),f.map(e=>{let{key:t,link:s}=e;return r.createElement("link",(0,i.A)({key:t,nonce:a.nonce},s))}))}var nt=!1;function lt(e){let{manifest:t,serverHandoffString:s,isSpaMode:a,renderMeta:n,routeDiscovery:d,ssr:c}=Xe(),{router:u,static:m,staticContext:h}=Ye(),{matches:x}=$e(),p=r.useContext(ee),b=Ge(d,c);n&&(n.didRenderScripts=!0);let g=tt(x,null,a);r.useEffect(()=>{nt=!0},[]);let f=r.useMemo(()=>{var a;if(p)return null;let n=h?"window.__reactRouterContext = ".concat(s,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",d=m?"".concat(null!==(a=t.hmr)&&void 0!==a&&a.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(b?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(g.map((e,s)=>{let a="route".concat(s),r=t.routes[e.route.id];Ue(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:n,clientLoaderModule:l,clientMiddlewareModule:i,hydrateFallbackModule:o,module:d}=r,c=[...n?[{module:n,varName:"".concat(a,"_clientAction")}]:[],...l?[{module:l,varName:"".concat(a,"_clientLoader")}]:[],...i?[{module:i,varName:"".concat(a,"_clientMiddleware")}]:[],...o?[{module:o,varName:"".concat(a,"_HydrateFallback")}]:[],{module:d,varName:"".concat(a,"_main")}];return 1===c.length?"import * as ".concat(a," from ").concat(JSON.stringify(d),";"):[c.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(a," = {").concat(c.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(b?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:s}=e,a=l(e,o),r=new Set(t.state.matches.map(e=>e.route.id)),n=t.state.location.pathname.split("/").filter(Boolean),d=["/"];for(n.pop();n.length>0;)d.push("/".concat(n.join("/"))),n.pop();d.forEach(e=>{let s=S(t.routes,e,t.basename);s&&s.forEach(e=>r.add(e.route.id))});let c=[...r].reduce((e,t)=>Object.assign(e,{[t]:a.routes[t]}),{});return(0,i.A)((0,i.A)({},a),{},{routes:c,sri:!!s||void 0})}(t,u),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(g.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return r.createElement(r.Fragment,null,r.createElement("script",(0,i.A)((0,i.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:n},type:void 0})),r.createElement("script",(0,i.A)((0,i.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:d},type:"module",async:!0})))},[]),y=nt||p?[]:(v=t.entry.imports.concat(Je(g,t,{includeHydrateFallback:!0})),[...new Set(v)]);var v;let w="object"===typeof t.sri?t.sri:{};return _e(!p,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),nt||p?null:r.createElement(r.Fragment,null,"object"===typeof t.sri?r.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}}):null,b?null:r.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:w[t.url],suppressHydrationWarning:!0}),r.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:w[t.entry.module],suppressHydrationWarning:!0}),y.map(t=>r.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:w[t],suppressHydrationWarning:!0})),f)}function it(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}r.Component;function ot(e){let{error:t,isOutsideRemixApp:s}=e;console.error(t);let a,n=r.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(G(t))return r.createElement(dt,{title:"Unhandled Thrown Response!"},r.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),n);if(t instanceof Error)a=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);a=new Error(e)}return r.createElement(dt,{title:"Application Error!",isOutsideRemixApp:s},r.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),r.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},a.stack),n)}function dt(e){var t;let{title:s,renderScripts:a,isOutsideRemixApp:n,children:l}=e,{routeModules:i}=Xe();return null!==(t=i.root)&&void 0!==t&&t.Layout&&!n?l:r.createElement("html",{lang:"en"},r.createElement("head",null,r.createElement("meta",{charSet:"utf-8"}),r.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),r.createElement("title",null,s)),r.createElement("body",null,r.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},l,a?r.createElement(lt,null):null)))}var ct="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ct&&(window.__reactRouterVersion="7.9.4")}catch(ia){}function ut(e){let{basename:t,children:s,window:a}=e,n=r.useRef();null==n.current&&(n.current=p({window:a,v5Compat:!0}));let l=n.current,[i,o]=r.useState({action:l.action,location:l.location}),d=r.useCallback(e=>{r.startTransition(()=>o(e))},[o]);return r.useLayoutEffect(()=>l.listen(d),[l,d]),r.createElement(Ee,{basename:t,children:s,location:i.location,navigationType:i.action,navigator:l})}var mt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ht=r.forwardRef(function(e,t){let s,{onClick:a,discover:n="render",prefetch:o="none",relative:d,reloadDocument:c,replace:m,state:h,target:x,to:p,preventScrollReset:f,viewTransition:y}=e,w=l(e,u),{basename:j}=r.useContext(re),N="string"===typeof p&&mt.test(p),S=!1;if("string"===typeof p&&N&&(s=p,ct))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),s=q(t.pathname,j);t.origin===e.origin&&null!=s?p=s+t.search+t.hash:S=!0}catch(ia){g(!1,'<Link to="'.concat(p,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let k=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(oe(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:a}=r.useContext(re),{hash:n,pathname:l,search:i}=he(e,{relative:t}),o=l;return"/"!==s&&(o="/"===l?s:H([s,l])),a.createHref({pathname:o,search:i,hash:n})}(p,{relative:d}),[C,A,_]=function(e,t){let s=r.useContext(Ze),[a,n]=r.useState(!1),[l,i]=r.useState(!1),{onFocus:o,onBlur:d,onMouseEnter:c,onMouseLeave:u,onTouchStart:m}=t,h=r.useRef(null);r.useEffect(()=>{if("render"===e&&i(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{i(e.isIntersecting)})},{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}},[e]),r.useEffect(()=>{if(a){let e=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(e)}}},[a]);let x=()=>{n(!0)},p=()=>{n(!1),i(!1)};return s?"intent"!==e?[l,h,{}]:[l,h,{onFocus:et(o,x),onBlur:et(d,p),onMouseEnter:et(c,x),onMouseLeave:et(u,p),onTouchStart:et(m,x)}]:[!1,h,{}]}(o,w),P=function(e){let{target:t,replace:s,state:a,preventScrollReset:n,relative:l,viewTransition:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=me(),d=de(),c=he(e,{relative:l});return r.useCallback(r=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(r,t)){r.preventDefault();let t=void 0!==s?s:v(d)===v(c);o(e,{replace:t,state:a,preventScrollReset:n,relative:l,viewTransition:i})}},[d,o,c,s,a,t,e,n,l,i])}(p,{replace:m,state:h,target:x,preventScrollReset:f,relative:d,viewTransition:y});let T=r.createElement("a",(0,i.A)((0,i.A)((0,i.A)({},w),_),{},{href:s||k,onClick:S||c?a:function(e){a&&a(e),e.defaultPrevented||P(e)},ref:it(t,A),target:x,"data-discover":N||"render"!==n?void 0:"true"}));return C&&!N?r.createElement(r.Fragment,null,T,r.createElement(st,{page:k})):T});ht.displayName="Link",r.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:a=!1,className:n="",end:o=!1,style:d,to:c,viewTransition:u,children:h}=e,x=l(e,m),p=he(c,{relative:x.relative}),g=de(),f=r.useContext(X),{navigator:y,basename:v}=r.useContext(re),w=null!=f&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.useContext(te);b(null!=s,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=bt("useViewTransitionState"),n=he(e,{relative:t});if(!s.isTransitioning)return!1;let l=q(s.currentLocation.pathname,a)||s.currentLocation.pathname,i=q(s.nextLocation.pathname,a)||s.nextLocation.pathname;return null!=F(n.pathname,i)||null!=F(n.pathname,l)}(p)&&!0===u,j=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,N=g.pathname,S=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;a||(N=N.toLowerCase(),S=S?S.toLowerCase():null,j=j.toLowerCase()),S&&v&&(S=q(S,v)||S);const k="/"!==j&&j.endsWith("/")?j.length-1:j.length;let C,A=N===j||!o&&N.startsWith(j)&&"/"===N.charAt(k),_=null!=S&&(S===j||!o&&S.startsWith(j)&&"/"===S.charAt(j.length)),P={isActive:A,isPending:_,isTransitioning:w},T=A?s:void 0;C="function"===typeof n?n(P):[n,A?"active":null,_?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let E="function"===typeof d?d(P):d;return r.createElement(ht,(0,i.A)((0,i.A)({},x),{},{"aria-current":T,className:C,ref:t,style:E,to:c,viewTransition:u}),"function"===typeof h?h(P):h)}).displayName="NavLink";var xt=r.forwardRef((e,t)=>{let{discover:s="render",fetcherKey:a,navigate:n,reloadDocument:o,replace:d,state:c,method:u=De,action:m,onSubmit:x,relative:p,preventScrollReset:g,viewTransition:f}=e,y=l(e,h),w=yt(),j=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:s}=r.useContext(re),a=r.useContext(le);b(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),l=(0,i.A)({},he(e||".",{relative:t})),o=de();if(null==e){l.search=o.search;let e=new URLSearchParams(l.search),t=e.getAll("index"),s=t.some(e=>""===e);if(s){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let s=e.toString();l.search=s?"?".concat(s):""}}e&&"."!==e||!n.route.index||(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index");"/"!==s&&(l.pathname="/"===l.pathname?s:H([s,l.pathname]));return v(l)}(m,{relative:p}),N="get"===u.toLowerCase()?"get":"post",S="string"===typeof m&&mt.test(m);return r.createElement("form",(0,i.A)((0,i.A)({ref:t,method:N,action:j,onSubmit:o?x:e=>{if(x&&x(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,s=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;w(t||e.currentTarget,{fetcherKey:a,method:s,navigate:n,replace:d,state:c,relative:p,preventScrollReset:g,viewTransition:f})}},y),{},{"data-discover":S||"render"!==s?void 0:"true"}))});function pt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function bt(e){let t=r.useContext(Z);return b(t,pt(e)),t}xt.displayName="Form";var gt=0,ft=()=>"__".concat(String(++gt),"__");function yt(){let{router:e}=bt("useSubmit"),{basename:t}=r.useContext(re),s=Ne("useRouteId");return r.useCallback(async function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:n,method:l,encType:i,formData:o,body:d}=qe(a,t);if(!1===r.navigate){let t=r.fetcherKey||ft();await e.fetch(t,s,r.action||n,{preventScrollReset:r.preventScrollReset,formData:o,body:d,formMethod:r.method||l,formEncType:r.encType||i,flushSync:r.flushSync})}else await e.navigate(r.action||n,{preventScrollReset:r.preventScrollReset,formData:o,body:d,formMethod:r.method||l,formEncType:r.encType||i,replace:r.replace,state:r.state,fromRouteId:s,flushSync:r.flushSync,viewTransition:r.viewTransition})},[e,t,s])}var vt,wt;function jt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nt(e,t,s){jt(e,t),t.set(e,s)}function St(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}function kt(e,t){return e.get(St(e,t))}function Ct(e,t,s){return e.set(St(e,t),s),s}var At={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},_t=new(vt=new WeakMap,wt=new WeakMap,class{constructor(){Nt(this,vt,At),Nt(this,wt,!1)}setTimeoutProvider(e){Ct(vt,this,e)}setTimeout(e,t){return kt(vt,this).setTimeout(e,t)}clearTimeout(e){kt(vt,this).clearTimeout(e)}setInterval(e,t){return kt(vt,this).setInterval(e,t)}clearInterval(e){kt(vt,this).clearInterval(e)}});var Pt="undefined"===typeof window||"Deno"in globalThis;function Tt(){}function Et(e){return"number"===typeof e&&e>=0&&e!==1/0}function It(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Rt(e,t){return"function"===typeof e?e(t):e}function Dt(e,t){return"function"===typeof e?e(t):e}function Ot(e,t){const{type:s="all",exact:a,fetchStatus:r,predicate:n,queryKey:l,stale:i}=e;if(l)if(a){if(t.queryHash!==Ft(l,t.options))return!1}else if(!Bt(t.queryKey,l))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return("boolean"!==typeof i||t.isStale()===i)&&((!r||r===t.state.fetchStatus)&&!(n&&!n(t)))}function Lt(e,t){const{exact:s,status:a,predicate:r,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(s){if(Mt(t.options.mutationKey)!==Mt(n))return!1}else if(!Bt(t.options.mutationKey,n))return!1}return(!a||t.state.status===a)&&!(r&&!r(t))}function Ft(e,t){return((null===t||void 0===t?void 0:t.queryKeyHashFn)||Mt)(e)}function Mt(e){return JSON.stringify(e,(e,t)=>Wt(t)?Object.keys(t).sort().reduce((e,s)=>(e[s]=t[s],e),{}):t)}function Bt(e,t){return e===t||typeof e===typeof t&&(!(!e||!t||"object"!==typeof e||"object"!==typeof t)&&Object.keys(t).every(s=>Bt(e[s],t[s])))}var qt=Object.prototype.hasOwnProperty;function Ut(e,t){if(e===t)return e;const s=Kt(e)&&Kt(t);if(!s&&(!Wt(e)||!Wt(t)))return t;const a=(s?e:Object.keys(e)).length,r=s?t:Object.keys(t),n=r.length,l=s?new Array(n):{};let i=0;for(let o=0;o<n;o++){const n=s?o:r[o],d=e[n],c=t[n];if(d===c){l[n]=d,(s?o<a:qt.call(e,n))&&i++;continue}if(null===d||null===c||"object"!==typeof d||"object"!==typeof c){l[n]=c;continue}const u=Ut(d,c);l[n]=u,u===d&&i++}return a===n&&i===a?e:l}function zt(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function Kt(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Wt(e){if(!Ht(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!Ht(s)&&(!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function Ht(e){return"[object Object]"===Object.prototype.toString.call(e)}function Vt(e,t,s){return"function"===typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?Ut(e,t):t}function Jt(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=[...e,t];return s&&a.length>s?a.slice(1):a}function Qt(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=[t,...e];return s&&a.length>s?a.slice(0,-1):a}var Gt=Symbol();function Yt(e,t){return!e.queryFn&&null!==t&&void 0!==t&&t.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==Gt?e.queryFn:()=>Promise.reject(new Error("Missing queryFn: '".concat(e.queryHash,"'")))}function $t(e,t){return"function"===typeof e?e(...t):!!e}function Zt(e,t){jt(e,t),t.add(e)}var Xt=function(e){setTimeout(e,0)};var es,ts,ss,as,rs,ns,ls=function(){let e=[],t=0,s=e=>{e()},a=e=>{e()},r=Xt;const n=a=>{t?e.push(a):r(()=>{s(a)})};return{batch:n=>{let l;t++;try{l=n()}finally{t--,t||(()=>{const t=e;e=[],t.length&&r(()=>{a(()=>{t.forEach(e=>{s(e)})})})})()}return l},batchCalls:e=>function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];n(()=>{e(...s)})},schedule:n,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{a=e},setScheduler:e=>{r=e}}}(),is=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},os=new(es=new WeakMap,ts=new WeakMap,ss=new WeakMap,class extends is{constructor(){super(),Nt(this,es,void 0),Nt(this,ts,void 0),Nt(this,ss,void 0),Ct(ss,this,e=>{if(!Pt&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){kt(ts,this)||this.setEventListener(kt(ss,this))}onUnsubscribe(){var e;this.hasListeners()||(null===(e=kt(ts,this))||void 0===e||e.call(this),Ct(ts,this,void 0))}setEventListener(e){var t;Ct(ss,this,e),null===(t=kt(ts,this))||void 0===t||t.call(this),Ct(ts,this,e(e=>{"boolean"===typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){kt(es,this)!==e&&(Ct(es,this,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return"boolean"===typeof kt(es,this)?kt(es,this):"hidden"!==(null===(e=globalThis.document)||void 0===e?void 0:e.visibilityState)}}),ds=new(as=new WeakMap,rs=new WeakMap,ns=new WeakMap,class extends is{constructor(){super(),Nt(this,as,!0),Nt(this,rs,void 0),Nt(this,ns,void 0),Ct(ns,this,e=>{if(!Pt&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}})}onSubscribe(){kt(rs,this)||this.setEventListener(kt(ns,this))}onUnsubscribe(){var e;this.hasListeners()||(null===(e=kt(rs,this))||void 0===e||e.call(this),Ct(rs,this,void 0))}setEventListener(e){var t;Ct(ns,this,e),null===(t=kt(rs,this))||void 0===t||t.call(this),Ct(rs,this,e(this.setOnline.bind(this)))}setOnline(e){kt(as,this)!==e&&(Ct(as,this,e),this.listeners.forEach(t=>{t(e)}))}isOnline(){return kt(as,this)}});function cs(){let e,t;const s=new Promise((s,a)=>{e=s,t=a});function a(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch(()=>{}),s.resolve=t=>{a({status:"fulfilled",value:t}),e(t)},s.reject=e=>{a({status:"rejected",reason:e}),t(e)},s}function us(e){return Math.min(1e3*2**e,3e4)}function ms(e){return"online"!==(null!==e&&void 0!==e?e:"online")||ds.isOnline()}var hs,xs=class extends Error{constructor(e){super("CancelledError"),this.revert=null===e||void 0===e?void 0:e.revert,this.silent=null===e||void 0===e?void 0:e.silent}};function ps(e){let t,s=!1,a=0;const r=cs(),n=()=>"pending"!==r.status,l=()=>os.isFocused()&&("always"===e.networkMode||ds.isOnline())&&e.canRun(),i=()=>ms(e.networkMode)&&e.canRun(),o=e=>{var s;n()||(null===(s=t)||void 0===s||s(),r.resolve(e))},d=e=>{var s;n()||(null===(s=t)||void 0===s||s(),r.reject(e))},c=()=>new Promise(s=>{var a;t=e=>{(n()||l())&&s(e)},null===(a=e.onPause)||void 0===a||a.call(e)}).then(()=>{var s;(t=void 0,n())||(null===(s=e.onContinue)||void 0===s||s.call(e))}),u=()=>{if(n())return;let t;const r=0===a?e.initialPromise:void 0;try{t=null!==r&&void 0!==r?r:e.fn()}catch(i){t=Promise.reject(i)}Promise.resolve(t).then(o).catch(t=>{var r,i,o;if(n())return;const m=null!==(r=e.retry)&&void 0!==r?r:Pt?0:3,h=null!==(i=e.retryDelay)&&void 0!==i?i:us,x="function"===typeof h?h(a,t):h,p=!0===m||"number"===typeof m&&a<m||"function"===typeof m&&m(a,t);var b;!s&&p?(a++,null===(o=e.onFail)||void 0===o||o.call(e,a,t),(b=x,new Promise(e=>{_t.setTimeout(e,b)})).then(()=>l()?void 0:c()).then(()=>{s?d(t):u()})):d(t)})};return{promise:r,status:()=>r.status,cancel:t=>{if(!n()){var s;const a=new xs(t);d(a),null===(s=e.onCancel)||void 0===s||s.call(e,a)}},continue:()=>{var e;return null===(e=t)||void 0===e||e(),r},cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:i,start:()=>(i()?u():c().then(u),r)}}var bs,gs,fs,ys,vs,ws,js,Ns,Ss,ks=(hs=new WeakMap,class{constructor(){Nt(this,hs,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Et(this.gcTime)&&Ct(hs,this,_t.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,null!==e&&void 0!==e?e:Pt?1/0:3e5)}clearGcTimeout(){kt(hs,this)&&(_t.clearTimeout(kt(hs,this)),Ct(hs,this,void 0))}}),Cs=(bs=new WeakMap,gs=new WeakMap,fs=new WeakMap,ys=new WeakMap,vs=new WeakMap,ws=new WeakMap,js=new WeakMap,Ns=new WeakSet,class extends ks{constructor(e){var t;super(),Zt(this,Ns),Nt(this,bs,void 0),Nt(this,gs,void 0),Nt(this,fs,void 0),Nt(this,ys,void 0),Nt(this,vs,void 0),Nt(this,ws,void 0),Nt(this,js,void 0),Ct(js,this,!1),Ct(ws,this,e.defaultOptions),this.setOptions(e.options),this.observers=[],Ct(ys,this,e.client),Ct(fs,this,kt(ys,this).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Ct(bs,this,Ts(this.options)),this.state=null!==(t=e.state)&&void 0!==t?t:kt(bs,this),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return null===(e=kt(vs,this))||void 0===e?void 0:e.promise}setOptions(e){if(this.options=(0,i.A)((0,i.A)({},kt(ws,this)),e),this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=Ts(this.options);void 0!==e.data&&(this.setState(Ps(e.data,e.dataUpdatedAt)),Ct(bs,this,e))}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||kt(fs,this).remove(this)}setData(e,t){const s=Vt(this.state.data,e,this.options);return St(Ns,this,As).call(this,{data:s,type:"success",dataUpdatedAt:null===t||void 0===t?void 0:t.updatedAt,manual:null===t||void 0===t?void 0:t.manual}),s}setState(e,t){St(Ns,this,As).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var t,s;const a=null===(t=kt(vs,this))||void 0===t?void 0:t.promise;return null===(s=kt(vs,this))||void 0===s||s.cancel(e),a?a.then(Tt).catch(Tt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(kt(bs,this))}isActive(){return this.observers.some(e=>!1!==Dt(e.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Gt||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===Rt(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!It(this.state.dataUpdatedAt,e))}onFocus(){var e;const t=this.observers.find(e=>e.shouldFetchOnWindowFocus());null===t||void 0===t||t.refetch({cancelRefetch:!1}),null===(e=kt(vs,this))||void 0===e||e.continue()}onOnline(){var e;const t=this.observers.find(e=>e.shouldFetchOnReconnect());null===t||void 0===t||t.refetch({cancelRefetch:!1}),null===(e=kt(vs,this))||void 0===e||e.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),kt(fs,this).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(kt(vs,this)&&(kt(js,this)?kt(vs,this).cancel({revert:!0}):kt(vs,this).cancelRetry()),this.scheduleGc()),kt(fs,this).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||St(Ns,this,As).call(this,{type:"invalidate"})}async fetch(e,t){var s,a,r;if("idle"!==this.state.fetchStatus&&"rejected"!==(null===(s=kt(vs,this))||void 0===s?void 0:s.status()))if(void 0!==this.state.data&&null!==t&&void 0!==t&&t.cancelRefetch)this.cancel({silent:!0});else if(kt(vs,this))return kt(vs,this).continueRetry(),kt(vs,this).promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const n=new AbortController,l=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(Ct(js,this,!0),n.signal)})},o=()=>{const e=Yt(this.options,t),s=(()=>{const e={client:kt(ys,this),queryKey:this.queryKey,meta:this.meta};return l(e),e})();return Ct(js,this,!1),this.options.persister?this.options.persister(e,s,this):e(s)},d=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:kt(ys,this),state:this.state,fetchFn:o};return l(e),e})();var c;(null===(a=this.options.behavior)||void 0===a||a.onFetch(d,this),Ct(gs,this,this.state),"idle"===this.state.fetchStatus||this.state.fetchMeta!==(null===(r=d.fetchOptions)||void 0===r?void 0:r.meta))&&St(Ns,this,As).call(this,{type:"fetch",meta:null===(c=d.fetchOptions)||void 0===c?void 0:c.meta});Ct(vs,this,ps({initialPromise:null===t||void 0===t?void 0:t.initialPromise,fn:d.fetchFn,onCancel:e=>{e instanceof xs&&e.revert&&this.setState((0,i.A)((0,i.A)({},kt(gs,this)),{},{fetchStatus:"idle"})),n.abort()},onFail:(e,t)=>{St(Ns,this,As).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{St(Ns,this,As).call(this,{type:"pause"})},onContinue:()=>{St(Ns,this,As).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{var u,m,h,x;const e=await kt(vs,this).start();if(void 0===e)throw new Error("".concat(this.queryHash," data is undefined"));return this.setData(e),null===(u=(m=kt(fs,this).config).onSuccess)||void 0===u||u.call(m,e,this),null===(h=(x=kt(fs,this).config).onSettled)||void 0===h||h.call(x,e,this.state.error,this),e}catch(y){var p,b,g,f;if(y instanceof xs){if(y.silent)return kt(vs,this).promise;if(y.revert){if(void 0===this.state.data)throw y;return this.state.data}}throw St(Ns,this,As).call(this,{type:"error",error:y}),null===(p=(b=kt(fs,this).config).onError)||void 0===p||p.call(b,y,this),null===(g=(f=kt(fs,this).config).onSettled)||void 0===g||g.call(f,this.state.data,y,this),y}finally{this.scheduleGc()}}});function As(e){this.state=(t=>{var s;switch(e.type){case"failed":return(0,i.A)((0,i.A)({},t),{},{fetchFailureCount:e.failureCount,fetchFailureReason:e.error});case"pause":return(0,i.A)((0,i.A)({},t),{},{fetchStatus:"paused"});case"continue":return(0,i.A)((0,i.A)({},t),{},{fetchStatus:"fetching"});case"fetch":return(0,i.A)((0,i.A)((0,i.A)({},t),_s(t.data,this.options)),{},{fetchMeta:null!==(s=e.meta)&&void 0!==s?s:null});case"success":const a=(0,i.A)((0,i.A)((0,i.A)({},t),Ps(e.data,e.dataUpdatedAt)),{},{dataUpdateCount:t.dataUpdateCount+1},!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null});return Ct(gs,this,e.manual?a:void 0),a;case"error":const r=e.error;return(0,i.A)((0,i.A)({},t),{},{error:r,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"});case"invalidate":return(0,i.A)((0,i.A)({},t),{},{isInvalidated:!0});case"setState":return(0,i.A)((0,i.A)({},t),e.state)}})(this.state),ls.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),kt(fs,this).notify({query:this,type:"updated",action:e})})}function _s(e,t){return(0,i.A)({fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ms(t.networkMode)?"fetching":"paused"},void 0===e&&{error:null,status:"pending"})}function Ps(e,t){return{data:e,dataUpdatedAt:null!==t&&void 0!==t?t:Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ts(e){const t="function"===typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,a=s?"function"===typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?null!==a&&void 0!==a?a:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var Es,Is,Rs,Ds,Os,Ls,Fs,Ms,Bs=(Ss=new WeakMap,class extends is{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),Nt(this,Ss,void 0),this.config=e,Ct(Ss,this,new Map)}build(e,t,s){var a;const r=t.queryKey,n=null!==(a=t.queryHash)&&void 0!==a?a:Ft(r,t);let l=this.get(n);return l||(l=new Cs({client:e,queryKey:r,queryHash:n,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(l)),l}add(e){kt(Ss,this).has(e.queryHash)||(kt(Ss,this).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=kt(Ss,this).get(e.queryHash);t&&(e.destroy(),t===e&&kt(Ss,this).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){ls.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return kt(Ss,this).get(e)}getAll(){return[...kt(Ss,this).values()]}find(e){const t=(0,i.A)({exact:!0},e);return this.getAll().find(e=>Ot(t,e))}findAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>Ot(e,t)):t}notify(e){ls.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){ls.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){ls.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}}),qs=(Es=new WeakMap,Is=new WeakMap,Rs=new WeakMap,Ds=new WeakMap,Os=new WeakSet,class extends ks{constructor(e){super(),Zt(this,Os),Nt(this,Es,void 0),Nt(this,Is,void 0),Nt(this,Rs,void 0),Nt(this,Ds,void 0),Ct(Es,this,e.client),this.mutationId=e.mutationId,Ct(Rs,this,e.mutationCache),Ct(Is,this,[]),this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){kt(Is,this).includes(e)||(kt(Is,this).push(e),this.clearGcTimeout(),kt(Rs,this).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Ct(Is,this,kt(Is,this).filter(t=>t!==e)),this.scheduleGc(),kt(Rs,this).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){kt(Is,this).length||("pending"===this.state.status?this.scheduleGc():kt(Rs,this).remove(this))}continue(){var e,t;return null!==(e=null===(t=kt(Ds,this))||void 0===t?void 0:t.continue())&&void 0!==e?e:this.execute(this.state.variables)}async execute(e){var t;const s=()=>{St(Os,this,Us).call(this,{type:"continue"})},a={client:kt(Es,this),meta:this.options.meta,mutationKey:this.options.mutationKey};Ct(Ds,this,ps({fn:()=>this.options.mutationFn?this.options.mutationFn(e,a):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{St(Os,this,Us).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{St(Os,this,Us).call(this,{type:"pause"})},onContinue:s,retry:null!==(t=this.options.retry)&&void 0!==t?t:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>kt(Rs,this).canRun(this)}));const r="pending"===this.state.status,n=!kt(Ds,this).canStart();try{var l,i,o,d,c,u,m,h;if(r)s();else{var x,p,b,g;St(Os,this,Us).call(this,{type:"pending",variables:e,isPaused:n}),await(null===(x=(p=kt(Rs,this).config).onMutate)||void 0===x?void 0:x.call(p,e,this,a));const t=await(null===(b=(g=this.options).onMutate)||void 0===b?void 0:b.call(g,e,a));t!==this.state.context&&St(Os,this,Us).call(this,{type:"pending",context:t,variables:e,isPaused:n})}const t=await kt(Ds,this).start();return await(null===(l=(i=kt(Rs,this).config).onSuccess)||void 0===l?void 0:l.call(i,t,e,this.state.context,this,a)),await(null===(o=(d=this.options).onSuccess)||void 0===o?void 0:o.call(d,t,e,this.state.context,a)),await(null===(c=(u=kt(Rs,this).config).onSettled)||void 0===c?void 0:c.call(u,t,null,this.state.variables,this.state.context,this,a)),await(null===(m=(h=this.options).onSettled)||void 0===m?void 0:m.call(h,t,null,e,this.state.context,a)),St(Os,this,Us).call(this,{type:"success",data:t}),t}catch(C){try{var f,y,v,w,j,N,S,k;throw await(null===(f=(y=kt(Rs,this).config).onError)||void 0===f?void 0:f.call(y,C,e,this.state.context,this,a)),await(null===(v=(w=this.options).onError)||void 0===v?void 0:v.call(w,C,e,this.state.context,a)),await(null===(j=(N=kt(Rs,this).config).onSettled)||void 0===j?void 0:j.call(N,void 0,C,this.state.variables,this.state.context,this,a)),await(null===(S=(k=this.options).onSettled)||void 0===S?void 0:S.call(k,void 0,C,e,this.state.context,a)),C}finally{St(Os,this,Us).call(this,{type:"error",error:C})}}finally{kt(Rs,this).runNext(this)}}});function Us(e){this.state=(t=>{switch(e.type){case"failed":return(0,i.A)((0,i.A)({},t),{},{failureCount:e.failureCount,failureReason:e.error});case"pause":return(0,i.A)((0,i.A)({},t),{},{isPaused:!0});case"continue":return(0,i.A)((0,i.A)({},t),{},{isPaused:!1});case"pending":return(0,i.A)((0,i.A)({},t),{},{context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()});case"success":return(0,i.A)((0,i.A)({},t),{},{data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return(0,i.A)((0,i.A)({},t),{},{data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"})}})(this.state),ls.batch(()=>{kt(Is,this).forEach(t=>{t.onMutationUpdate(e)}),kt(Rs,this).notify({mutation:this,type:"updated",action:e})})}var zs,Ks,Ws,Hs,Vs,Js,Qs,Gs,Ys=(Ls=new WeakMap,Fs=new WeakMap,Ms=new WeakMap,class extends is{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),Nt(this,Ls,void 0),Nt(this,Fs,void 0),Nt(this,Ms,void 0),this.config=e,Ct(Ls,this,new Set),Ct(Fs,this,new Map),Ct(Ms,this,0)}build(e,t,s){var a;const r=new qs({client:e,mutationCache:this,mutationId:Ct(Ms,this,(a=kt(Ms,this),++a)),options:e.defaultMutationOptions(t),state:s});return this.add(r),r}add(e){kt(Ls,this).add(e);const t=$s(e);if("string"===typeof t){const s=kt(Fs,this).get(t);s?s.push(e):kt(Fs,this).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(kt(Ls,this).delete(e)){const t=$s(e);if("string"===typeof t){const s=kt(Fs,this).get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&kt(Fs,this).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=$s(e);if("string"===typeof t){const s=kt(Fs,this).get(t),a=null===s||void 0===s?void 0:s.find(e=>"pending"===e.state.status);return!a||a===e}return!0}runNext(e){const t=$s(e);if("string"===typeof t){var s,a;const r=null===(s=kt(Fs,this).get(t))||void 0===s?void 0:s.find(t=>t!==e&&t.state.isPaused);return null!==(a=null===r||void 0===r?void 0:r.continue())&&void 0!==a?a:Promise.resolve()}return Promise.resolve()}clear(){ls.batch(()=>{kt(Ls,this).forEach(e=>{this.notify({type:"removed",mutation:e})}),kt(Ls,this).clear(),kt(Fs,this).clear()})}getAll(){return Array.from(kt(Ls,this))}find(e){const t=(0,i.A)({exact:!0},e);return this.getAll().find(e=>Lt(t,e))}findAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getAll().filter(t=>Lt(e,t))}notify(e){ls.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return ls.batch(()=>Promise.all(e.map(e=>e.continue().catch(Tt))))}});function $s(e){var t;return null===(t=e.options.scope)||void 0===t?void 0:t.id}function Zs(e){return{onFetch:(t,s)=>{var a,r,n;const l=t.options,i=null===(a=t.fetchOptions)||void 0===a||null===(a=a.meta)||void 0===a||null===(a=a.fetchMore)||void 0===a?void 0:a.direction,o=(null===(r=t.state.data)||void 0===r?void 0:r.pages)||[],d=(null===(n=t.state.data)||void 0===n?void 0:n.pageParams)||[];let c={pages:[],pageParams:[]},u=0;const m=async()=>{let s=!1;const a=Yt(t.options,t.fetchOptions),r=async(e,r,n)=>{if(s)return Promise.reject();if(null==r&&e.pages.length)return Promise.resolve(e);const l=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:r,direction:n?"backward":"forward",meta:t.options.meta};var a;return a=e,Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(t.signal.aborted?s=!0:t.signal.addEventListener("abort",()=>{s=!0}),t.signal)}),e})(),i=await a(l),{maxPages:o}=t.options,d=n?Qt:Jt;return{pages:d(e.pages,i,o),pageParams:d(e.pageParams,r,o)}};if(i&&o.length){const e="backward"===i,t={pages:o,pageParams:d},s=(e?ea:Xs)(l,t);c=await r(t,s,e)}else{const t=null!==e&&void 0!==e?e:o.length;do{var n;const e=0===u?null!==(n=d[0])&&void 0!==n?n:l.initialPageParam:Xs(l,c);if(u>0&&null==e)break;c=await r(c,e),u++}while(u<t)}return c};t.options.persister?t.fetchFn=()=>{var e,a;return null===(e=(a=t.options).persister)||void 0===e?void 0:e.call(a,m,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=m}}}function Xs(e,t){let{pages:s,pageParams:a}=t;const r=s.length-1;return s.length>0?e.getNextPageParam(s[r],s,a[r],a):void 0}function ea(e,t){var s;let{pages:a,pageParams:r}=t;return a.length>0?null===(s=e.getPreviousPageParam)||void 0===s?void 0:s.call(e,a[0],a,r[0],r):void 0}var ta=(zs=new WeakMap,Ks=new WeakMap,Ws=new WeakMap,Hs=new WeakMap,Vs=new WeakMap,Js=new WeakMap,Qs=new WeakMap,Gs=new WeakMap,class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Nt(this,zs,void 0),Nt(this,Ks,void 0),Nt(this,Ws,void 0),Nt(this,Hs,void 0),Nt(this,Vs,void 0),Nt(this,Js,void 0),Nt(this,Qs,void 0),Nt(this,Gs,void 0),Ct(zs,this,e.queryCache||new Bs),Ct(Ks,this,e.mutationCache||new Ys),Ct(Ws,this,e.defaultOptions||{}),Ct(Hs,this,new Map),Ct(Vs,this,new Map),Ct(Js,this,0)}mount(){var e;Ct(Js,this,(e=kt(Js,this),e++,e)),1===kt(Js,this)&&(Ct(Qs,this,os.subscribe(async e=>{e&&(await this.resumePausedMutations(),kt(zs,this).onFocus())})),Ct(Gs,this,ds.subscribe(async e=>{e&&(await this.resumePausedMutations(),kt(zs,this).onOnline())})))}unmount(){var e,t,s;Ct(Js,this,(e=kt(Js,this),e--,e)),0===kt(Js,this)&&(null===(t=kt(Qs,this))||void 0===t||t.call(this),Ct(Qs,this,void 0),null===(s=kt(Gs,this))||void 0===s||s.call(this),Ct(Gs,this,void 0))}isFetching(e){return kt(zs,this).findAll((0,i.A)((0,i.A)({},e),{},{fetchStatus:"fetching"})).length}isMutating(e){return kt(Ks,this).findAll((0,i.A)((0,i.A)({},e),{},{status:"pending"})).length}getQueryData(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null===(t=kt(zs,this).get(s.queryHash))||void 0===t?void 0:t.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=kt(zs,this).build(this,t),a=s.state.data;return void 0===a?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(Rt(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return kt(zs,this).findAll(e).map(e=>{let{queryKey:t,state:s}=e;return[t,s.data]})}setQueryData(e,t,s){const a=this.defaultQueryOptions({queryKey:e}),r=kt(zs,this).get(a.queryHash),n=function(e,t){return"function"===typeof e?e(t):e}(t,null===r||void 0===r?void 0:r.state.data);if(void 0!==n)return kt(zs,this).build(this,a).setData(n,(0,i.A)((0,i.A)({},s),{},{manual:!0}))}setQueriesData(e,t,s){return ls.batch(()=>kt(zs,this).findAll(e).map(e=>{let{queryKey:a}=e;return[a,this.setQueryData(a,t,s)]}))}getQueryState(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null===(t=kt(zs,this).get(s.queryHash))||void 0===t?void 0:t.state}removeQueries(e){const t=kt(zs,this);ls.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const s=kt(zs,this);return ls.batch(()=>(s.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries((0,i.A)({type:"active"},e),t)))}cancelQueries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=(0,i.A)({revert:!0},t),a=ls.batch(()=>kt(zs,this).findAll(e).map(e=>e.cancel(s)));return Promise.all(a).then(Tt).catch(Tt)}invalidateQueries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ls.batch(()=>{var s,a;return kt(zs,this).findAll(e).forEach(e=>{e.invalidate()}),"none"===(null===e||void 0===e?void 0:e.refetchType)?Promise.resolve():this.refetchQueries((0,i.A)((0,i.A)({},e),{},{type:null!==(s=null!==(a=null===e||void 0===e?void 0:e.refetchType)&&void 0!==a?a:null===e||void 0===e?void 0:e.type)&&void 0!==s?s:"active"}),t)})}refetchQueries(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=(0,i.A)((0,i.A)({},s),{},{cancelRefetch:null===(t=s.cancelRefetch)||void 0===t||t}),r=ls.batch(()=>kt(zs,this).findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,a);return a.throwOnError||(t=t.catch(Tt)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(r).then(Tt)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=kt(zs,this).build(this,t);return s.isStaleByTime(Rt(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Tt).catch(Tt)}fetchInfiniteQuery(e){return e.behavior=Zs(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Tt).catch(Tt)}ensureInfiniteQueryData(e){return e.behavior=Zs(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return ds.isOnline()?kt(Ks,this).resumePausedMutations():Promise.resolve()}getQueryCache(){return kt(zs,this)}getMutationCache(){return kt(Ks,this)}getDefaultOptions(){return kt(Ws,this)}setDefaultOptions(e){Ct(Ws,this,e)}setQueryDefaults(e,t){kt(Hs,this).set(Mt(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...kt(Hs,this).values()],s={};return t.forEach(t=>{Bt(e,t.queryKey)&&Object.assign(s,t.defaultOptions)}),s}setMutationDefaults(e,t){kt(Vs,this).set(Mt(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...kt(Vs,this).values()],s={};return t.forEach(t=>{Bt(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t=(0,i.A)((0,i.A)((0,i.A)((0,i.A)({},kt(Ws,this).queries),this.getQueryDefaults(e.queryKey)),e),{},{_defaulted:!0});return t.queryHash||(t.queryHash=Ft(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Gt&&(t.enabled=!1),t}defaultMutationOptions(e){return null!==e&&void 0!==e&&e._defaulted?e:(0,i.A)((0,i.A)((0,i.A)((0,i.A)({},kt(Ws,this).mutations),(null===e||void 0===e?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey)),e),{},{_defaulted:!0})}clear(){kt(zs,this).clear(),kt(Ks,this).clear()}}),sa=s(579),aa=r.createContext(void 0),ra=e=>{const t=r.useContext(aa);if(e)return e;if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},na=e=>{let{client:t,children:s}=e;return r.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),(0,sa.jsx)(aa.Provider,{value:t,children:s})};function la(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}let ia={data:""},oa=e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||ia},da=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ca=/\/\*[^]*?\*\/|  +/g,ua=/\n+/g,ma=(e,t)=>{let s="",a="",r="";for(let n in e){let l=e[n];"@"==n[0]?"i"==n[1]?s=n+" "+l+";":a+="f"==n[1]?ma(l,n):n+"{"+ma(l,"k"==n[1]?"":t)+"}":"object"==typeof l?a+=ma(l,t?t.replace(/([^,])+/g,e=>n.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):n):null!=l&&(n=/^--/.test(n)?n:n.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=ma.p?ma.p(n,l):n+":"+l+";")}return s+(t&&r?t+"{"+r+"}":r)+a},ha={},xa=e=>{if("object"==typeof e){let t="";for(let s in e)t+=s+xa(e[s]);return t}return e},pa=(e,t,s,a,r)=>{let n=xa(e),l=ha[n]||(ha[n]=(e=>{let t=0,s=11;for(;t<e.length;)s=101*s+e.charCodeAt(t++)>>>0;return"go"+s})(n));if(!ha[l]){let t=n!==e?e:(e=>{let t,s,a=[{}];for(;t=da.exec(e.replace(ca,""));)t[4]?a.shift():t[3]?(s=t[3].replace(ua," ").trim(),a.unshift(a[0][s]=a[0][s]||{})):a[0][t[1]]=t[2].replace(ua," ").trim();return a[0]})(e);ha[l]=ma(r?{["@keyframes "+l]:t}:t,s?"":"."+l)}let i=s&&ha.g?ha.g:null;return s&&(ha.g=ha[l]),((e,t,s,a)=>{a?t.data=t.data.replace(a,e):-1===t.data.indexOf(e)&&(t.data=s?e+t.data:t.data+e)})(ha[l],t,a,i),l};function ba(e){let t=this||{},s=e.call?e(t.p):e;return pa(s.unshift?s.raw?((e,t,s)=>e.reduce((e,a,r)=>{let n=t[r];if(n&&n.call){let e=n(s),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;n=t?"."+t:e&&"object"==typeof e?e.props?"":ma(e,""):!1===e?"":e}return e+a+(null==n?"":n)},""))(s,[].slice.call(arguments,1),t.p):s.reduce((e,s)=>Object.assign(e,s&&s.call?s(t.p):s),{}):s,oa(t.target),t.g,t.o,t.k)}ba.bind({g:1});let ga,fa,ya,va=ba.bind({k:1});function wa(e,t){let s=this||{};return function(){let a=arguments;function r(n,l){let i=Object.assign({},n),o=i.className||r.className;s.p=Object.assign({theme:fa&&fa()},i),s.o=/ *go\d+/.test(o),i.className=ba.apply(s,a)+(o?" "+o:""),t&&(i.ref=l);let d=e;return e[0]&&(d=i.as||e,delete i.as),ya&&d[0]&&ya(i),ga(d,i)}return t?t(r):r}}var ja,Na,Sa,ka,Ca,Aa,_a,Pa,Ta,Ea,Ia,Ra,Da,Oa,La,Fa,Ma=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,Ba=(()=>{let e=0;return()=>(++e).toString()})(),qa=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Ua="default",za=(e,t)=>{let{toastLimit:s}=e.settings;switch(t.type){case 0:return(0,i.A)((0,i.A)({},e),{},{toasts:[t.toast,...e.toasts].slice(0,s)});case 1:return(0,i.A)((0,i.A)({},e),{},{toasts:e.toasts.map(e=>e.id===t.toast.id?(0,i.A)((0,i.A)({},e),t.toast):e)});case 2:let{toast:a}=t;return za(e,{type:e.toasts.find(e=>e.id===a.id)?1:0,toast:a});case 3:let{toastId:r}=t;return(0,i.A)((0,i.A)({},e),{},{toasts:e.toasts.map(e=>e.id===r||void 0===r?(0,i.A)((0,i.A)({},e),{},{dismissed:!0,visible:!1}):e)});case 4:return void 0===t.toastId?(0,i.A)((0,i.A)({},e),{},{toasts:[]}):(0,i.A)((0,i.A)({},e),{},{toasts:e.toasts.filter(e=>e.id!==t.toastId)});case 5:return(0,i.A)((0,i.A)({},e),{},{pausedAt:t.time});case 6:let n=t.time-(e.pausedAt||0);return(0,i.A)((0,i.A)({},e),{},{pausedAt:void 0,toasts:e.toasts.map(e=>(0,i.A)((0,i.A)({},e),{},{pauseDuration:e.pauseDuration+n}))})}},Ka=[],Wa={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},Ha={},Va=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ua;Ha[t]=za(Ha[t]||Wa,e),Ka.forEach(e=>{let[s,a]=e;s===t&&a(Ha[t])})},Ja=e=>Object.keys(Ha).forEach(t=>Va(e,t)),Qa=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ua;return t=>{Va(t,e)}},Ga={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Ya=e=>(t,s)=>{let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",s=arguments.length>2?arguments[2]:void 0;return(0,i.A)((0,i.A)({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0},s),{},{id:(null==s?void 0:s.id)||Ba()})}(t,e,s);return Qa(a.toasterId||(e=>Object.keys(Ha).find(t=>Ha[t].toasts.some(t=>t.id===e)))(a.id))({type:2,toast:a}),a.id},$a=(e,t)=>Ya("blank")(e,t);$a.error=Ya("error"),$a.success=Ya("success"),$a.loading=Ya("loading"),$a.custom=Ya("custom"),$a.dismiss=(e,t)=>{let s={type:3,toastId:e};t?Qa(t)(s):Ja(s)},$a.dismissAll=e=>$a.dismiss(void 0,e),$a.remove=(e,t)=>{let s={type:4,toastId:e};t?Qa(t)(s):Ja(s)},$a.removeAll=e=>$a.remove(void 0,e),$a.promise=(e,t,s)=>{let a=$a.loading(t.loading,(0,i.A)((0,i.A)({},s),null==s?void 0:s.loading));return"function"==typeof e&&(e=e()),e.then(e=>{let r=t.success?Ma(t.success,e):void 0;return r?$a.success(r,(0,i.A)((0,i.A)({id:a},s),null==s?void 0:s.success)):$a.dismiss(a),e}).catch(e=>{let r=t.error?Ma(t.error,e):void 0;r?$a.error(r,(0,i.A)((0,i.A)({id:a},s),null==s?void 0:s.error)):$a.dismiss(a)}),e};var Za=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",{toasts:s,pausedAt:a}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ua,[s,a]=(0,r.useState)(Ha[t]||Wa),n=(0,r.useRef)(Ha[t]);(0,r.useEffect)(()=>(n.current!==Ha[t]&&a(Ha[t]),Ka.push([t,a]),()=>{let e=Ka.findIndex(e=>{let[s]=e;return s===t});e>-1&&Ka.splice(e,1)}),[t]);let l=s.toasts.map(t=>{var s,a,r;return(0,i.A)((0,i.A)((0,i.A)((0,i.A)({},e),e[t.type]),t),{},{removeDelay:t.removeDelay||(null==(s=e[t.type])?void 0:s.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(a=e[t.type])?void 0:a.duration)||(null==e?void 0:e.duration)||Ga[t.type],style:(0,i.A)((0,i.A)((0,i.A)({},e.style),null==(r=e[t.type])?void 0:r.style),t.style)})});return(0,i.A)((0,i.A)({},s),{},{toasts:l})}(e,t),n=(0,r.useRef)(new Map).current,l=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(n.has(e))return;let s=setTimeout(()=>{n.delete(e),o({type:4,toastId:e})},t);n.set(e,s)},[]);(0,r.useEffect)(()=>{if(a)return;let e=Date.now(),r=s.map(s=>{if(s.duration===1/0)return;let a=(s.duration||0)+s.pauseDuration-(e-s.createdAt);if(!(a<0))return setTimeout(()=>$a.dismiss(s.id,t),a);s.visible&&$a.dismiss(s.id)});return()=>{r.forEach(e=>e&&clearTimeout(e))}},[s,a,t]);let o=(0,r.useCallback)(Qa(t),[t]),d=(0,r.useCallback)(()=>{o({type:5,time:Date.now()})},[o]),c=(0,r.useCallback)((e,t)=>{o({type:1,toast:{id:e,height:t}})},[o]),u=(0,r.useCallback)(()=>{a&&o({type:6,time:Date.now()})},[a,o]),m=(0,r.useCallback)((e,t)=>{let{reverseOrder:a=!1,gutter:r=8,defaultPosition:n}=t||{},l=s.filter(t=>(t.position||n)===(e.position||n)&&t.height),i=l.findIndex(t=>t.id===e.id),o=l.filter((e,t)=>t<i&&e.visible).length;return l.filter(e=>e.visible).slice(...a?[o+1]:[0,o]).reduce((e,t)=>e+(t.height||0)+r,0)},[s]);return(0,r.useEffect)(()=>{s.forEach(e=>{if(e.dismissed)l(e.id,e.removeDelay);else{let t=n.get(e.id);t&&(clearTimeout(t),n.delete(e.id))}})},[s,l]),{toasts:s,handlers:{updateHeight:c,startPause:d,endPause:u,calculateOffset:m}}},Xa=va(ja||(ja=la(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n transform: scale(1) rotate(45deg);\n  opacity: 1;\n}"]))),er=va(Na||(Na=la(["\nfrom {\n  transform: scale(0);\n  opacity: 0;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]))),tr=va(Sa||(Sa=la(["\nfrom {\n  transform: scale(0) rotate(90deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(90deg);\n\topacity: 1;\n}"]))),sr=wa("div")(ka||(ka=la(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n\n  &:after,\n  &:before {\n    content: '';\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 150ms;\n    position: absolute;\n    border-radius: 3px;\n    opacity: 0;\n    background: ",";\n    bottom: 9px;\n    left: 4px;\n    height: 2px;\n    width: 12px;\n  }\n\n  &:before {\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 180ms;\n    transform: rotate(90deg);\n  }\n"])),e=>e.primary||"#ff4b4b",Xa,er,e=>e.secondary||"#fff",tr),ar=va(Ca||(Ca=la(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),rr=wa("div")(Aa||(Aa=la(["\n  width: 12px;\n  height: 12px;\n  box-sizing: border-box;\n  border: 2px solid;\n  border-radius: 100%;\n  border-color: ",";\n  border-right-color: ",";\n  animation: "," 1s linear infinite;\n"])),e=>e.secondary||"#e0e0e0",e=>e.primary||"#616161",ar),nr=va(_a||(_a=la(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(45deg);\n\topacity: 1;\n}"]))),lr=va(Pa||(Pa=la(["\n0% {\n\theight: 0;\n\twidth: 0;\n\topacity: 0;\n}\n40% {\n  height: 0;\n\twidth: 6px;\n\topacity: 1;\n}\n100% {\n  opacity: 1;\n  height: 10px;\n}"]))),ir=wa("div")(Ta||(Ta=la(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n  &:after {\n    content: '';\n    box-sizing: border-box;\n    animation: "," 0.2s ease-out forwards;\n    opacity: 0;\n    animation-delay: 200ms;\n    position: absolute;\n    border-right: 2px solid;\n    border-bottom: 2px solid;\n    border-color: ",";\n    bottom: 6px;\n    left: 6px;\n    height: 10px;\n    width: 6px;\n  }\n"])),e=>e.primary||"#61d345",nr,lr,e=>e.secondary||"#fff"),or=wa("div")(Ea||(Ea=la(["\n  position: absolute;\n"]))),dr=wa("div")(Ia||(Ia=la(["\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-width: 20px;\n  min-height: 20px;\n"]))),cr=va(Ra||(Ra=la(["\nfrom {\n  transform: scale(0.6);\n  opacity: 0.4;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]))),ur=wa("div")(Da||(Da=la(["\n  position: relative;\n  transform: scale(0.6);\n  opacity: 0.4;\n  min-width: 20px;\n  animation: "," 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n"])),cr),mr=e=>{let{toast:t}=e,{icon:s,type:a,iconTheme:n}=t;return void 0!==s?"string"==typeof s?r.createElement(ur,null,s):s:"blank"===a?null:r.createElement(dr,null,r.createElement(rr,(0,i.A)({},n)),"loading"!==a&&r.createElement(or,null,"error"===a?r.createElement(sr,(0,i.A)({},n)):r.createElement(ir,(0,i.A)({},n))))},hr=e=>"\n0% {transform: translate3d(0,".concat(-200*e,"%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n"),xr=e=>"\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,".concat(-150*e,"%,-1px) scale(.6); opacity:0;}\n"),pr=wa("div")(Oa||(Oa=la(["\n  display: flex;\n  align-items: center;\n  background: #fff;\n  color: #363636;\n  line-height: 1.3;\n  will-change: transform;\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);\n  max-width: 350px;\n  pointer-events: auto;\n  padding: 8px 10px;\n  border-radius: 8px;\n"]))),br=wa("div")(La||(La=la(["\n  display: flex;\n  justify-content: center;\n  margin: 4px 10px;\n  color: inherit;\n  flex: 1 1 auto;\n  white-space: pre-line;\n"]))),gr=r.memo(e=>{let{toast:t,position:s,style:a,children:n}=e,l=t.height?((e,t)=>{let s=e.includes("top")?1:-1,[a,r]=qa()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[hr(s),xr(s)];return{animation:t?"".concat(va(a)," 0.35s cubic-bezier(.21,1.02,.73,1) forwards"):"".concat(va(r)," 0.4s forwards cubic-bezier(.06,.71,.55,1)")}})(t.position||s||"top-center",t.visible):{opacity:0},o=r.createElement(mr,{toast:t}),d=r.createElement(br,(0,i.A)({},t.ariaProps),Ma(t.message,t));return r.createElement(pr,{className:t.className,style:(0,i.A)((0,i.A)((0,i.A)({},l),a),t.style)},"function"==typeof n?n({icon:o,message:d}):r.createElement(r.Fragment,null,o,d))});!function(e,t,s,a){ma.p=t,ga=e,fa=s,ya=a}(r.createElement);var fr=e=>{let{id:t,className:s,style:a,onHeightUpdate:n,children:l}=e,i=r.useCallback(e=>{if(e){let s=()=>{let s=e.getBoundingClientRect().height;n(t,s)};s(),new MutationObserver(s).observe(e,{subtree:!0,childList:!0,characterData:!0})}},[t,n]);return r.createElement("div",{ref:i,className:s,style:a},l)},yr=ba(Fa||(Fa=la(["\n  z-index: 9999;\n  > * {\n    pointer-events: auto;\n  }\n"]))),vr=e=>{let{reverseOrder:t,position:s="top-center",toastOptions:a,gutter:n,children:l,toasterId:o,containerStyle:d,containerClassName:c}=e,{toasts:u,handlers:m}=Za(a,o);return r.createElement("div",{"data-rht-toaster":o||"",style:(0,i.A)({position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none"},d),className:c,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(e=>{let a=e.position||s,o=((e,t)=>{let s=e.includes("top"),a=s?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return(0,i.A)((0,i.A)({left:0,right:0,display:"flex",position:"absolute",transition:qa()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:"translateY(".concat(t*(s?1:-1),"px)")},a),r)})(a,m.calculateOffset(e,{reverseOrder:t,gutter:n,defaultPosition:s}));return r.createElement(fr,{id:e.id,key:e.id,onHeightUpdate:m.updateHeight,className:e.visible?yr:"",style:o},"custom"===e.type?Ma(e.message,e):l?l(e):r.createElement(gr,{toast:e,position:a}))}))},wr=$a,jr=s(980);const Nr={MASTER_ADMIN:"/master-admin",SUPER_ADMIN:"/super-admin",ADMIN:"/admin",MANAGER:"/manager",GRE:"/gre",CASHIER:"/cashier",HR:"/hr",FNB:"/fnb",STAFF:"/staff",DEALER:"/dealer",AFFILIATE:"/affiliate"},Sr=e=>{let{children:t,requiredRole:s}=e;const a=jr.R2.isAuthenticated(),r=jr.R2.getCurrentUser(),n=de();if(!a)return"MASTER_ADMIN"===s?(0,sa.jsx)(Pe,{to:"/master-admin/signin",state:{from:n},replace:!0}):"SUPER_ADMIN"===s?(0,sa.jsx)(Pe,{to:"/super-admin/signin",state:{from:n},replace:!0}):(0,sa.jsx)(Pe,{to:"/login",state:{from:n},replace:!0});if(s){if(!((null===r||void 0===r?void 0:r.isMasterAdmin)&&"MASTER_ADMIN"===s||(null===r||void 0===r?void 0:r.role)===s)){const e=(e=>{if(null!==e&&void 0!==e&&e.isMasterAdmin)return"/master-admin";const t=localStorage.getItem("user"),s=JSON.parse(localStorage.getItem("superadminuser")||"{}"),a=JSON.parse(localStorage.getItem("adminuser")||"{}"),r=JSON.parse(localStorage.getItem("masteradminuser")||"{}");let n=null===e||void 0===e?void 0:e.role;n||(s.userId||"SUPER_ADMIN"===s.role?n="SUPER_ADMIN":a.userId||"ADMIN"===a.role?n="ADMIN":r.userId||"MASTER_ADMIN"===r.role?n="MASTER_ADMIN":t&&(n=JSON.parse(t).role));if(!n){const e=jr.R2.getCurrentUser();n=null===e||void 0===e?void 0:e.role}return n&&Nr[n]?Nr[n]:"/login"})(r);return console.warn("Access denied. Required: ".concat(s,", Current: ").concat(null===r||void 0===r?void 0:r.role,". Redirecting to ").concat(e)),(0,sa.jsx)(Pe,{to:e,replace:!0})}}return t};function kr(){const e=me();return(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white flex items-center justify-center p-4",children:(0,sa.jsxs)("div",{className:"text-center max-w-md",children:[(0,sa.jsx)("div",{className:"text-9xl font-bold text-red-500 mb-4",children:"404"}),(0,sa.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Page Not Found"}),(0,sa.jsx)("p",{className:"text-gray-400 mb-6",children:"The page you're looking for doesn't exist or you don't have permission to access it."}),(0,sa.jsx)("button",{onClick:()=>e("/"),className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-lg font-medium transition-colors",children:"Go Back Home"})]})})}var Cr,Ar,_r,Pr,Tr,Er,Ir,Rr,Dr,Or,Lr,Fr,Mr,Br,qr,Ur,zr=(Cr=new WeakMap,Ar=new WeakMap,_r=new WeakMap,Pr=new WeakMap,Tr=new WeakMap,Er=new WeakMap,Ir=new WeakMap,Rr=new WeakMap,Dr=new WeakMap,Or=new WeakMap,Lr=new WeakMap,Fr=new WeakMap,Mr=new WeakMap,Br=new WeakMap,qr=new WeakMap,Ur=new WeakSet,class extends is{constructor(e,t){super(),Zt(this,Ur),Nt(this,Cr,void 0),Nt(this,Ar,void 0),Nt(this,_r,void 0),Nt(this,Pr,void 0),Nt(this,Tr,void 0),Nt(this,Er,void 0),Nt(this,Ir,void 0),Nt(this,Rr,void 0),Nt(this,Dr,void 0),Nt(this,Or,void 0),Nt(this,Lr,void 0),Nt(this,Fr,void 0),Nt(this,Mr,void 0),Nt(this,Br,void 0),Nt(this,qr,new Set),this.options=t,Ct(Cr,this,e),Ct(Rr,this,null),Ct(Ir,this,cs()),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(kt(Ar,this).addObserver(this),Zr(kt(Ar,this),this.options)?St(Ur,this,Kr).call(this):this.updateResult(),St(Ur,this,Jr).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Xr(kt(Ar,this),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Xr(kt(Ar,this),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,St(Ur,this,Qr).call(this),St(Ur,this,Gr).call(this),kt(Ar,this).removeObserver(this)}setOptions(e){const t=this.options,s=kt(Ar,this);if(this.options=kt(Cr,this).defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!==typeof this.options.enabled&&"function"!==typeof this.options.enabled&&"boolean"!==typeof Dt(this.options.enabled,kt(Ar,this)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");St(Ur,this,Yr).call(this),kt(Ar,this).setOptions(this.options),t._defaulted&&!zt(this.options,t)&&kt(Cr,this).getQueryCache().notify({type:"observerOptionsUpdated",query:kt(Ar,this),observer:this});const a=this.hasListeners();a&&en(kt(Ar,this),s,this.options,t)&&St(Ur,this,Kr).call(this),this.updateResult(),!a||kt(Ar,this)===s&&Dt(this.options.enabled,kt(Ar,this))===Dt(t.enabled,kt(Ar,this))&&Rt(this.options.staleTime,kt(Ar,this))===Rt(t.staleTime,kt(Ar,this))||St(Ur,this,Wr).call(this);const r=St(Ur,this,Hr).call(this);!a||kt(Ar,this)===s&&Dt(this.options.enabled,kt(Ar,this))===Dt(t.enabled,kt(Ar,this))&&r===kt(Br,this)||St(Ur,this,Vr).call(this,r)}getOptimisticResult(e){const t=kt(Cr,this).getQueryCache().build(kt(Cr,this),e),s=this.createResult(t,e);return function(e,t){if(!zt(e.getCurrentResult(),t))return!0;return!1}(this,s)&&(Ct(Pr,this,s),Ct(Er,this,this.options),Ct(Tr,this,kt(Ar,this).state)),s}getCurrentResult(){return kt(Pr,this)}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),null===t||void 0===t||t(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==kt(Ir,this).status||kt(Ir,this).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){kt(qr,this).add(e)}getCurrentQuery(){return kt(Ar,this)}refetch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return this.fetch((0,i.A)({},t))}fetchOptimistic(e){const t=kt(Cr,this).defaultQueryOptions(e),s=kt(Cr,this).getQueryCache().build(kt(Cr,this),t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){var t;return St(Ur,this,Kr).call(this,(0,i.A)((0,i.A)({},e),{},{cancelRefetch:null===(t=e.cancelRefetch)||void 0===t||t})).then(()=>(this.updateResult(),kt(Pr,this)))}createResult(e,t){const s=kt(Ar,this),a=this.options,r=kt(Pr,this),n=kt(Tr,this),l=kt(Er,this),o=e!==s?e.state:kt(_r,this),{state:d}=e;let c,u=(0,i.A)({},d),m=!1;if(t._optimisticResults){const r=this.hasListeners(),n=!r&&Zr(e,t),l=r&&en(e,s,t,a);(n||l)&&(u=(0,i.A)((0,i.A)({},u),_s(d.data,e.options))),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:h,errorUpdatedAt:x,status:p}=u;c=u.data;let b=!1;if(void 0!==t.placeholderData&&void 0===c&&"pending"===p){let e;var g;if(null!==r&&void 0!==r&&r.isPlaceholderData&&t.placeholderData===(null===l||void 0===l?void 0:l.placeholderData))e=r.data,b=!0;else e="function"===typeof t.placeholderData?t.placeholderData(null===(g=kt(Lr,this))||void 0===g?void 0:g.state.data,kt(Lr,this)):t.placeholderData;void 0!==e&&(p="success",c=Vt(null===r||void 0===r?void 0:r.data,e,t),m=!0)}if(t.select&&void 0!==c&&!b)if(r&&c===(null===n||void 0===n?void 0:n.data)&&t.select===kt(Dr,this))c=kt(Or,this);else try{Ct(Dr,this,t.select),c=t.select(c),c=Vt(null===r||void 0===r?void 0:r.data,c,t),Ct(Or,this,c),Ct(Rr,this,null)}catch(S){Ct(Rr,this,S)}kt(Rr,this)&&(h=kt(Rr,this),c=kt(Or,this),x=Date.now(),p="error");const f="fetching"===u.fetchStatus,y="pending"===p,v="error"===p,w=y&&f,j=void 0!==c,N={status:p,fetchStatus:u.fetchStatus,isPending:y,isSuccess:"success"===p,isError:v,isInitialLoading:w,isLoading:w,data:c,dataUpdatedAt:u.dataUpdatedAt,error:h,errorUpdatedAt:x,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>o.dataUpdateCount||u.errorUpdateCount>o.errorUpdateCount,isFetching:f,isRefetching:f&&!y,isLoadingError:v&&!j,isPaused:"paused"===u.fetchStatus,isPlaceholderData:m,isRefetchError:v&&j,isStale:tn(e,t),refetch:this.refetch,promise:kt(Ir,this),isEnabled:!1!==Dt(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===N.status?e.reject(N.error):void 0!==N.data&&e.resolve(N.data)},a=()=>{const e=Ct(Ir,this,N.promise=cs());t(e)},r=kt(Ir,this);switch(r.status){case"pending":e.queryHash===s.queryHash&&t(r);break;case"fulfilled":"error"!==N.status&&N.data===r.value||a();break;case"rejected":"error"===N.status&&N.error===r.reason||a()}}return N}updateResult(){const e=kt(Pr,this),t=this.createResult(kt(Ar,this),this.options);if(Ct(Tr,this,kt(Ar,this).state),Ct(Er,this,this.options),void 0!==kt(Tr,this).data&&Ct(Lr,this,kt(Ar,this)),zt(t,e))return;Ct(Pr,this,t);St(Ur,this,$r).call(this,{listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"===typeof t?t():t;if("all"===s||!s&&!kt(qr,this).size)return!0;const a=new Set(null!==s&&void 0!==s?s:kt(qr,this));return this.options.throwOnError&&a.add("error"),Object.keys(kt(Pr,this)).some(t=>{const s=t;return kt(Pr,this)[s]!==e[s]&&a.has(s)})})()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&St(Ur,this,Jr).call(this)}});function Kr(e){St(Ur,this,Yr).call(this);let t=kt(Ar,this).fetch(this.options,e);return null!==e&&void 0!==e&&e.throwOnError||(t=t.catch(Tt)),t}function Wr(){St(Ur,this,Qr).call(this);const e=Rt(this.options.staleTime,kt(Ar,this));if(Pt||kt(Pr,this).isStale||!Et(e))return;const t=It(kt(Pr,this).dataUpdatedAt,e)+1;Ct(Fr,this,_t.setTimeout(()=>{kt(Pr,this).isStale||this.updateResult()},t))}function Hr(){var e;return null!==(e="function"===typeof this.options.refetchInterval?this.options.refetchInterval(kt(Ar,this)):this.options.refetchInterval)&&void 0!==e&&e}function Vr(e){St(Ur,this,Gr).call(this),Ct(Br,this,e),!Pt&&!1!==Dt(this.options.enabled,kt(Ar,this))&&Et(kt(Br,this))&&0!==kt(Br,this)&&Ct(Mr,this,_t.setInterval(()=>{(this.options.refetchIntervalInBackground||os.isFocused())&&St(Ur,this,Kr).call(this)},kt(Br,this)))}function Jr(){St(Ur,this,Wr).call(this),St(Ur,this,Vr).call(this,St(Ur,this,Hr).call(this))}function Qr(){kt(Fr,this)&&(_t.clearTimeout(kt(Fr,this)),Ct(Fr,this,void 0))}function Gr(){kt(Mr,this)&&(_t.clearInterval(kt(Mr,this)),Ct(Mr,this,void 0))}function Yr(){const e=kt(Cr,this).getQueryCache().build(kt(Cr,this),this.options);if(e===kt(Ar,this))return;const t=kt(Ar,this);Ct(Ar,this,e),Ct(_r,this,e.state),this.hasListeners()&&(null===t||void 0===t||t.removeObserver(this),e.addObserver(this))}function $r(e){ls.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(kt(Pr,this))}),kt(Cr,this).getQueryCache().notify({query:kt(Ar,this),type:"observerResultsUpdated"})})}function Zr(e,t){return function(e,t){return!1!==Dt(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&Xr(e,t,t.refetchOnMount)}function Xr(e,t,s){if(!1!==Dt(t.enabled,e)&&"static"!==Rt(t.staleTime,e)){const a="function"===typeof s?s(e):s;return"always"===a||!1!==a&&tn(e,t)}return!1}function en(e,t,s,a){return(e!==t||!1===Dt(a.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&tn(e,s)}function tn(e,t){return!1!==Dt(t.enabled,e)&&e.isStaleByTime(Rt(t.staleTime,e))}function sn(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var an,rn,nn,ln,on,dn=r.createContext(sn()),cn=r.createContext(!1),un=(cn.Provider,(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()}));function mn(e,t,s){var a,n,l,i;const o=r.useContext(cn),d=r.useContext(dn),c=ra(s),u=c.defaultQueryOptions(e);null===(a=c.getDefaultOptions().queries)||void 0===a||null===(n=a._experimental_beforeQuery)||void 0===n||n.call(a,u),u._optimisticResults=o?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=1e3,s=e=>"static"===e?e:Math.max(null!==e&&void 0!==e?e:t,t),a=e.staleTime;e.staleTime="function"===typeof a?function(){return s(a(...arguments))}:s(a),"number"===typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}})(u),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(u,d),(e=>{r.useEffect(()=>{e.clearReset()},[e])})(d);const m=!c.getQueryCache().get(u.queryHash),[h]=r.useState(()=>new t(c,u)),x=h.getOptimisticResult(u),p=!o&&!1!==e.subscribed;if(r.useSyncExternalStore(r.useCallback(e=>{const t=p?h.subscribe(ls.batchCalls(e)):Tt;return h.updateResult(),t},[h,p]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),r.useEffect(()=>{h.setOptions(u)},[u,h]),((e,t)=>(null===e||void 0===e?void 0:e.suspense)&&t.isPending)(u,x))throw un(u,h,d);if((e=>{let{result:t,errorResetBoundary:s,throwOnError:a,query:r,suspense:n}=e;return t.isError&&!s.isReset()&&!t.isFetching&&r&&(n&&void 0===t.data||$t(a,[t.error,r]))})({result:x,errorResetBoundary:d,throwOnError:u.throwOnError,query:c.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw x.error;if(null===(l=c.getDefaultOptions().queries)||void 0===l||null===(i=l._experimental_afterQuery)||void 0===i||i.call(l,u,x),u.experimental_prefetchInRender&&!Pt&&((e,t)=>e.isLoading&&e.isFetching&&!t)(x,o)){var b;const e=m?un(u,h,d):null===(b=c.getQueryCache().get(u.queryHash))||void 0===b?void 0:b.promise;null===e||void 0===e||e.catch(Tt).finally(()=>{h.updateResult()})}return u.notifyOnChangeProps?x:h.trackResult(x)}function hn(e,t){return mn(e,zr,t)}var xn=(an=new WeakMap,rn=new WeakMap,nn=new WeakMap,ln=new WeakMap,on=new WeakSet,class extends is{constructor(e,t){super(),Zt(this,on),Nt(this,an,void 0),Nt(this,rn,void 0),Nt(this,nn,void 0),Nt(this,ln,void 0),Ct(an,this,e),this.setOptions(t),this.bindMethods(),St(on,this,pn).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var t;const s=this.options;this.options=kt(an,this).defaultMutationOptions(e),zt(this.options,s)||kt(an,this).getMutationCache().notify({type:"observerOptionsUpdated",mutation:kt(nn,this),observer:this}),null!==s&&void 0!==s&&s.mutationKey&&this.options.mutationKey&&Mt(s.mutationKey)!==Mt(this.options.mutationKey)?this.reset():"pending"===(null===(t=kt(nn,this))||void 0===t?void 0:t.state.status)&&kt(nn,this).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(null===(e=kt(nn,this))||void 0===e||e.removeObserver(this))}onMutationUpdate(e){St(on,this,pn).call(this),St(on,this,bn).call(this,e)}getCurrentResult(){return kt(rn,this)}reset(){var e;null===(e=kt(nn,this))||void 0===e||e.removeObserver(this),Ct(nn,this,void 0),St(on,this,pn).call(this),St(on,this,bn).call(this)}mutate(e,t){var s;return Ct(ln,this,t),null===(s=kt(nn,this))||void 0===s||s.removeObserver(this),Ct(nn,this,kt(an,this).getMutationCache().build(kt(an,this),this.options)),kt(nn,this).addObserver(this),kt(nn,this).execute(e)}});function pn(){var e,t;const s=null!==(e=null===(t=kt(nn,this))||void 0===t?void 0:t.state)&&void 0!==e?e:{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};Ct(rn,this,(0,i.A)((0,i.A)({},s),{},{isPending:"pending"===s.status,isSuccess:"success"===s.status,isError:"error"===s.status,isIdle:"idle"===s.status,mutate:this.mutate,reset:this.reset}))}function bn(e){ls.batch(()=>{if(kt(ln,this)&&this.hasListeners()){const d=kt(rn,this).variables,c=kt(rn,this).context,u={client:kt(an,this),meta:this.options.meta,mutationKey:this.options.mutationKey};var t,s,a,r;if("success"===(null===e||void 0===e?void 0:e.type))null===(t=(s=kt(ln,this)).onSuccess)||void 0===t||t.call(s,e.data,d,c,u),null===(a=(r=kt(ln,this)).onSettled)||void 0===a||a.call(r,e.data,null,d,c,u);else if("error"===(null===e||void 0===e?void 0:e.type)){var n,l,i,o;null===(n=(l=kt(ln,this)).onError)||void 0===n||n.call(l,e.error,d,c,u),null===(i=(o=kt(ln,this)).onSettled)||void 0===i||i.call(o,void 0,e.error,d,c,u)}}this.listeners.forEach(e=>{e(kt(rn,this))})})}function gn(e,t){const s=ra(t),[a]=r.useState(()=>new xn(s,e));r.useEffect(()=>{a.setOptions(e)},[a,e]);const n=r.useSyncExternalStore(r.useCallback(e=>a.subscribe(ls.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),l=r.useCallback((e,t)=>{a.mutate(e,t).catch(Tt)},[a]);if(n.error&&$t(a.options.throwOnError,[n.error]))throw n.error;return(0,i.A)((0,i.A)({},n),{},{mutate:l,mutateAsync:n.mutate})}var fn=s(950);function yn(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s}function vn(e,t,s,a){return new(s||(s=Promise))(function(r,n){function l(e){try{o(a.next(e))}catch(ia){n(ia)}}function i(e){try{o(a.throw(e))}catch(ia){n(ia)}}function o(e){e.done?r(e.value):function(e){return e instanceof s?e:new s(function(t){t(e)})}(e.value).then(l,i)}o((a=a.apply(e,t||[])).next())})}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;class wn extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",s=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=s}}class jn extends wn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Nn extends wn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Sn extends wn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var kn;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(kn||(kn={}));class Cn{constructor(e){let{headers:t={},customFetch:s,region:a=kn.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(s)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return vn(this,arguments,void 0,function(e){var t=this;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var a;let r,n;try{const{headers:l,method:i,body:o,signal:d,timeout:c}=s;let u={},{region:m}=s;m||(m=t.region);const h=new URL("".concat(t.url,"/").concat(e));let x;m&&"any"!==m&&(u["x-region"]=m,h.searchParams.set("forceFunctionRegion",m)),o&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?"undefined"!==typeof Blob&&o instanceof Blob||o instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",x=o):"string"===typeof o?(u["Content-Type"]="text/plain",x=o):"undefined"!==typeof FormData&&o instanceof FormData?x=o:(u["Content-Type"]="application/json",x=JSON.stringify(o)):x=!o||"string"===typeof o||"undefined"!==typeof Blob&&o instanceof Blob||o instanceof ArrayBuffer||"undefined"!==typeof FormData&&o instanceof FormData?o:JSON.stringify(o);let p=d;c&&(n=new AbortController,r=setTimeout(()=>n.abort(),c),d?(p=n.signal,d.addEventListener("abort",()=>n.abort())):p=n.signal);const b=yield t.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},u),t.headers),l),body:x,signal:p}).catch(e=>{throw new jn(e)}),g=b.headers.get("x-relay-error");if(g&&"true"===g)throw new Nn(b);if(!b.ok)throw new Sn(b);let f,y=(null!==(a=b.headers.get("Content-Type"))&&void 0!==a?a:"text/plain").split(";")[0].trim();return f="application/json"===y?yield b.json():"application/octet-stream"===y||"application/pdf"===y?yield b.blob():"text/event-stream"===y?b:"multipart/form-data"===y?yield b.formData():yield b.text(),{data:f,error:null,response:b}}catch(l){return{data:null,error:l,response:l instanceof Sn||l instanceof Nn?l.context:void 0}}finally{r&&clearTimeout(r)}}()})}}var An=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},_n=class{constructor(e){var t,s,a;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(s=e.isMaybeSingle)&&void 0!==s&&s,this.urlLengthLimit=null!==(a=e.urlLengthLimit)&&void 0!==a?a:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var s=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let a=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,a=null,r=null,n=e.status,l=e.statusText;if(e.ok){var i,o;if("HEAD"!==s.method){var d;const t=await e.text();""===t||(a="text/csv"===s.headers.get("Accept")||s.headers.get("Accept")&&(null===(d=s.headers.get("Accept"))||void 0===d?void 0:d.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const c=null===(i=s.headers.get("Prefer"))||void 0===i?void 0:i.match(/count=(exact|planned|estimated)/),u=null===(o=e.headers.get("content-range"))||void 0===o?void 0:o.split("/");c&&u&&u.length>1&&(r=parseInt(u[1])),s.isMaybeSingle&&"GET"===s.method&&Array.isArray(a)&&(a.length>1?(t={code:"PGRST116",details:"Results contain ".concat(a.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,r=null,n=406,l="Not Acceptable"):a=1===a.length?a[0]:null)}else{var c;const r=await e.text();try{t=JSON.parse(r),Array.isArray(t)&&404===e.status&&(a=[],t=null,n=200,l="OK")}catch(u){404===e.status&&""===r?(n=204,l="No Content"):t={message:r}}if(t&&s.isMaybeSingle&&(null===t||void 0===t||null===(c=t.details)||void 0===c?void 0:c.includes("0 rows"))&&(t=null,n=200,l="OK"),t&&s.shouldThrowOnError)throw new An(t)}return{error:t,data:a,count:r,status:n,statusText:l}});return this.shouldThrowOnError||(a=a.catch(e=>{var t;let s="",a="",r="";const n=null===e||void 0===e?void 0:e.cause;if(n){var l,i,o,d;const t=null!==(l=null===n||void 0===n?void 0:n.message)&&void 0!==l?l:"",a=null!==(i=null===n||void 0===n?void 0:n.code)&&void 0!==i?i:"";s="".concat(null!==(o=null===e||void 0===e?void 0:e.name)&&void 0!==o?o:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),s+="\n\nCaused by: ".concat(null!==(d=null===n||void 0===n?void 0:n.name)&&void 0!==d?d:"Error",": ").concat(t),a&&(s+=" (".concat(a,")")),(null===n||void 0===n?void 0:n.stack)&&(s+="\n".concat(n.stack))}else{var c;s=null!==(c=null===e||void 0===e?void 0:e.stack)&&void 0!==c?c:""}const u=this.url.toString().length;return"AbortError"===(null===e||void 0===e?void 0:e.name)||"ABORT_ERR"===(null===e||void 0===e?void 0:e.code)?(r="",a="Request was aborted (timeout or manual cancellation)",u>this.urlLengthLimit&&(a+=". Note: Your request URL is ".concat(u," characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side."))):"HeadersOverflowError"!==(null===n||void 0===n?void 0:n.name)&&"UND_ERR_HEADERS_OVERFLOW"!==(null===n||void 0===n?void 0:n.code)||(r="",a="HTTP headers exceeded server limits (typically 16KB)",u>this.urlLengthLimit&&(a+=". Your request URL is ".concat(u," characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead."))),{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:s,hint:a,code:r},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},Pn=class extends _n{select(e){let t=!1;const s=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:s,foreignTable:a,referencedTable:r=a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=r?"".concat(r,".order"):"order",l=this.url.searchParams.get(n);return this.url.searchParams.set(n,"".concat(l?"".concat(l,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===s?"":s?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="undefined"===typeof s?"limit":"".concat(s,".limit");return this.url.searchParams.set(a,"".concat(e)),this}range(e,t){let{foreignTable:s,referencedTable:a=s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r="undefined"===typeof a?"offset":"".concat(a,".offset"),n="undefined"===typeof a?"limit":"".concat(a,".limit");return this.url.searchParams.set(r,"".concat(e)),this.url.searchParams.set(n,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:a=!1,wal:r=!1,format:n="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var l;const i=[e?"analyze":null,t?"verbose":null,s?"settings":null,a?"buffers":null,r?"wal":null].filter(Boolean).join("|"),o=null!==(l=this.headers.get("Accept"))&&void 0!==l?l:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(n,'; for="').concat(o,'"; options=').concat(i,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}};const Tn=new RegExp("[,()]");var En=class extends Pn{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}regexMatch(e,t){return this.url.searchParams.append(e,"match.".concat(t)),this}regexIMatch(e,t){return this.url.searchParams.append(e,"imatch.".concat(t)),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}isDistinct(e,t){return this.url.searchParams.append(e,"isdistinct.".concat(t)),this}in(e,t){const s=Array.from(new Set(t)).map(e=>"string"===typeof e&&Tn.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(s,")")),this}notIn(e,t){const s=Array.from(new Set(t)).map(e=>"string"===typeof e&&Tn.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"not.in.(".concat(s,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:s,type:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="";"plain"===a?r="pl":"phrase"===a?r="ph":"websearch"===a&&(r="w");const n=void 0===s?"":"(".concat(s,")");return this.url.searchParams.append(e,"".concat(r,"fts").concat(n,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,s]=e;this.url.searchParams.append(t,"eq.".concat(s))}),this}not(e,t,s){return this.url.searchParams.append(e,"not.".concat(t,".").concat(s)),this}or(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=s?"".concat(s,".or"):"or";return this.url.searchParams.append(a,"(".concat(e,")")),this}filter(e,t,s){return this.url.searchParams.append(e,"".concat(t,".").concat(s)),this}},In=class{constructor(e,t){let{headers:s={},schema:a,fetch:r,urlLengthLimit:n=8e3}=t;this.url=e,this.headers=new Headers(s),this.schema=a,this.fetch=r,this.urlLengthLimit=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:s=!1,count:a}=null!==t&&void 0!==t?t:{},r=s?"HEAD":"GET";let n=!1;const l=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join(""),{url:i,headers:o}=this.cloneRequestState();return i.searchParams.set("select",l),a&&o.append("Prefer","count=".concat(a)),new En({method:r,url:i,headers:o,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e){let{count:t,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a;const{url:r,headers:n}=this.cloneRequestState();if(t&&n.append("Prefer","count=".concat(t)),s||n.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));r.searchParams.set("columns",e.join(","))}}return new En({method:"POST",url:r,headers:n,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e){let{onConflict:t,ignoreDuplicates:s=!1,count:a,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const{url:l,headers:i}=this.cloneRequestState();if(i.append("Prefer","resolution=".concat(s?"ignore":"merge","-duplicates")),void 0!==t&&l.searchParams.set("on_conflict",t),a&&i.append("Prefer","count=".concat(a)),r||i.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));l.searchParams.set("columns",e.join(","))}}return new En({method:"POST",url:l,headers:i,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch,urlLengthLimit:this.urlLengthLimit})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;const{url:a,headers:r}=this.cloneRequestState();return t&&r.append("Prefer","count=".concat(t)),new En({method:"PATCH",url:a,headers:r,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch,urlLengthLimit:this.urlLengthLimit})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const{url:s,headers:a}=this.cloneRequestState();return e&&a.append("Prefer","count=".concat(e)),new En({method:"DELETE",url:s,headers:a,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function Rn(e){return(Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e){var t=function(e,t){if("object"!=Rn(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=Rn(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Rn(t)?t:t+""}function On(e,t,s){return(t=Dn(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Ln(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)}return s}function Fn(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(s),!0).forEach(function(t){On(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ln(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var Mn=class e{constructor(e){let{headers:t={},schema:s,fetch:a,timeout:r,urlLengthLimit:n=8e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=s,this.urlLengthLimit=n;const l=null!==a&&void 0!==a?a:globalThis.fetch;this.fetch=void 0!==r&&r>0?(e,t)=>{const s=new AbortController,a=setTimeout(()=>s.abort(),r),n=null===t||void 0===t?void 0:t.signal;if(n){if(n.aborted)return clearTimeout(a),l(e,t);const r=()=>{clearTimeout(a),s.abort()};return n.addEventListener("abort",r,{once:!0}),l(e,Fn(Fn({},t),{},{signal:s.signal})).finally(()=>{clearTimeout(a),n.removeEventListener("abort",r)})}return l(e,Fn(Fn({},t),{},{signal:s.signal})).finally(()=>clearTimeout(a))}:l}from(e){if(!e||"string"!==typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new In(new URL("".concat(this.url,"/").concat(e)),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:s=!1,get:a=!1,count:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n;let l;const i=new URL("".concat(this.url,"/rpc/").concat(e));let o;const d=e=>null!==e&&"object"===typeof e&&(!Array.isArray(e)||e.some(d)),c=s&&Object.values(t).some(d);c?(l="POST",o=t):s||a?(l=s?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,s]=e;return void 0!==s}).map(e=>{let[t,s]=e;return[t,Array.isArray(s)?"{".concat(s.join(","),"}"):"".concat(s)]}).forEach(e=>{let[t,s]=e;i.searchParams.append(t,s)})):(l="POST",o=t);const u=new Headers(this.headers);return c?u.set("Prefer",r?"count=".concat(r,",return=minimal"):"return=minimal"):r&&u.set("Prefer","count=".concat(r)),new En({method:l,url:i,headers:u,schema:this.schemaName,body:o,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch,urlLengthLimit:this.urlLengthLimit})}};const Bn=class{constructor(){}static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof s.g&&"undefined"!==typeof s.g.WebSocket)return{type:"native",constructor:s.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node){const t=e.node,s=parseInt(t.replace(/^v/,"").split(".")[0]);return s>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(s," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(s," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},qn="realtime-js/".concat("2.95.3"),Un="2.0.0",zn=Un,Kn=1e4;var Wn,Hn,Vn,Jn,Qn,Gn;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(Wn||(Wn={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(Hn||(Hn={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Vn||(Vn={})),function(e){e.websocket="websocket"}(Jn||(Jn={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(Qn||(Qn={}));class Yn{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!==e&&void 0!==e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"===typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,s;const a=null!==(s=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==s?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,s;const a=null!==(s=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==s?s:{},r=(new TextEncoder).encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,r)}_encodeUserBroadcastPush(e,t,s){var a,r;const n=e.topic,l=null!==(a=e.ref)&&void 0!==a?a:"",i=null!==(r=e.join_ref)&&void 0!==r?r:"",o=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},c=0===Object.keys(d).length?"":JSON.stringify(d);if(i.length>255)throw new Error("joinRef length ".concat(i.length," exceeds maximum of 255"));if(l.length>255)throw new Error("ref length ".concat(l.length," exceeds maximum of 255"));if(n.length>255)throw new Error("topic length ".concat(n.length," exceeds maximum of 255"));if(o.length>255)throw new Error("userEvent length ".concat(o.length," exceeds maximum of 255"));if(c.length>255)throw new Error("metadata length ".concat(c.length," exceeds maximum of 255"));const u=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+l.length+n.length+o.length+c.length,m=new ArrayBuffer(this.HEADER_LENGTH+u);let h=new DataView(m),x=0;h.setUint8(x++,this.KINDS.userBroadcastPush),h.setUint8(x++,i.length),h.setUint8(x++,l.length),h.setUint8(x++,n.length),h.setUint8(x++,o.length),h.setUint8(x++,c.length),h.setUint8(x++,t),Array.from(i,e=>h.setUint8(x++,e.charCodeAt(0))),Array.from(l,e=>h.setUint8(x++,e.charCodeAt(0))),Array.from(n,e=>h.setUint8(x++,e.charCodeAt(0))),Array.from(o,e=>h.setUint8(x++,e.charCodeAt(0))),Array.from(c,e=>h.setUint8(x++,e.charCodeAt(0)));var p=new Uint8Array(m.byteLength+s.byteLength);return p.set(new Uint8Array(m),0),p.set(new Uint8Array(s),m.byteLength),p.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"===typeof e){const s=JSON.parse(e),[a,r,n,l,i]=s;return t({join_ref:a,ref:r,topic:n,event:l,payload:i})}return t({})}_binaryDecode(e){const t=new DataView(e),s=t.getUint8(0),a=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,a)}_decodeUserBroadcast(e,t,s){const a=t.getUint8(1),r=t.getUint8(2),n=t.getUint8(3),l=t.getUint8(4);let i=this.HEADER_LENGTH+4;const o=s.decode(e.slice(i,i+a));i+=a;const d=s.decode(e.slice(i,i+r));i+=r;const c=s.decode(e.slice(i,i+n));i+=n;const u=e.slice(i,e.byteLength),m=l===this.JSON_ENCODING?JSON.parse(s.decode(u)):u,h={type:this.BROADCAST_EVENT,event:d,payload:m};return n>0&&(h.meta=JSON.parse(c)),{join_ref:null,ref:null,topic:o,event:this.BROADCAST_EVENT,payload:h}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"===typeof e?Object.fromEntries(Object.entries(e).filter(e=>{let[s]=e;return t.includes(s)})):{}}}class $n{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Gn||(Gn={}));const Zn=function(e,t){var s;const a=null!==(s=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==s?s:[];return t?Object.keys(t).reduce((s,r)=>(s[r]=Xn(r,e,t,a),s),{}):{}},Xn=(e,t,s,a)=>{const r=t.find(t=>t.name===e),n=null===r||void 0===r?void 0:r.type,l=s[e];return n&&!a.includes(n)?el(n,l):tl(l)},el=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return nl(t,s)}switch(e){case Gn.bool:return sl(t);case Gn.float4:case Gn.float8:case Gn.int2:case Gn.int4:case Gn.int8:case Gn.numeric:case Gn.oid:return al(t);case Gn.json:case Gn.jsonb:return rl(t);case Gn.timestamp:return ll(t);case Gn.abstime:case Gn.date:case Gn.daterange:case Gn.int4range:case Gn.int8range:case Gn.money:case Gn.reltime:case Gn.text:case Gn.time:case Gn.timestamptz:case Gn.timetz:case Gn.tsrange:case Gn.tstzrange:default:return tl(t)}},tl=e=>e,sl=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},al=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},rl=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return e}return e},nl=(e,t)=>{if("string"!==typeof e)return e;const s=e.length-1,a=e[s];if("{"===e[0]&&"}"===a){let a;const r=e.slice(1,s);try{a=JSON.parse("["+r+"]")}catch(Ja){a=r?r.split(","):[]}return a.map(e=>el(t,e))}return e},ll=e=>"string"===typeof e?e.replace(" ","T"):e,il=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class ol{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kn;this.channel=e,this.event=t,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:s}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var dl,cl,ul,ml;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(dl||(dl={}));class hl{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{const{onJoin:t,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hl.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=hl.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},e=>{const{onJoin:t,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=hl.syncDiff(this.state,e,t,s),a())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,a){const r=this.cloneDeep(e),n=this.transformState(t),l={},i={};return this.map(r,(e,t)=>{n[e]||(i[e]=t)}),this.map(n,(e,t)=>{const s=r[e];if(s){const a=t.map(e=>e.presence_ref),r=s.map(e=>e.presence_ref),n=t.filter(e=>r.indexOf(e.presence_ref)<0),o=s.filter(e=>a.indexOf(e.presence_ref)<0);n.length>0&&(l[e]=n),o.length>0&&(i[e]=o)}else l[e]=t}),this.syncDiff(r,{joins:l,leaves:i},s,a)}static syncDiff(e,t,s,a){const{joins:r,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(r,(t,a)=>{var r;const n=null!==(r=e[t])&&void 0!==r?r:[];if(e[t]=this.cloneDeep(a),n.length>0){const s=e[t].map(e=>e.presence_ref),a=n.filter(e=>s.indexOf(e.presence_ref)<0);e[t].unshift(...a)}s(t,n,a)}),this.map(n,(t,s)=>{let r=e[t];if(!r)return;const n=s.map(e=>e.presence_ref);r=r.filter(e=>n.indexOf(e.presence_ref)<0),e[t]=r,a(t,r,s),0===r.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const a=e[s];return t[s]="metas"in a?a.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(cl||(cl={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(ul||(ul={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(ml||(ml={}));class xl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},s=arguments.length>2?arguments[2]:void 0;var a,r;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Hn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ol(this,Vn.join,this.params,this.timeout),this.rejoinTimer=new $n(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Hn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=Hn.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=Hn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=Hn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=Hn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vn.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new hl(this),this.broadcastEndpointURL=il(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(r=null===(a=this.params.config)||void 0===a?void 0:a.broadcast)||void 0===r?void 0:r.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var s,a,r;if(this.socket.isConnected()||this.socket.connect(),this.state==Hn.closed){const{config:{broadcast:n,presence:l,private:i}}=this.params,o=null!==(a=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==a?a:[],d=!!this.bindings[ul.PRESENCE]&&this.bindings[ul.PRESENCE].length>0||!0===(null===(r=this.params.config.presence)||void 0===r?void 0:r.enabled),c={},u={broadcast:n,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:o,private:i};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(ml.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(ml.CLOSED)),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:s}=t;var a;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==s){const t=this.bindings.postgres_changes,r=null!==(a=null===t||void 0===t?void 0:t.length)&&void 0!==a?a:0,n=[];for(let a=0;a<r;a++){const r=t[a],{filter:{event:l,schema:i,table:o,filter:d}}=r,c=s&&s[a];if(!(c&&c.event===l&&xl.isFilterValueEqual(c.schema,i)&&xl.isFilterValueEqual(c.table,o)&&xl.isFilterValueEqual(c.filter,d)))return this.unsubscribe(),this.state=Hn.errored,void(null===e||void 0===e||e(ml.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},r),{id:c.id}))}return this.bindings.postgres_changes=n,void(e&&e(ml.SUBSCRIBED))}null===e||void 0===e||e(ml.SUBSCRIBED)}).receive("error",t=>{this.state=Hn.errored,null===e||void 0===e||e(ml.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(ml.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===Hn.joined&&e===ul.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,s)}async httpSend(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var a;if(void 0===t||null===t)return Promise.reject("Payload is required for httpSend()");const r={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(r.Authorization="Bearer ".concat(this.socket.accessTokenValue));const n={method:"POST",headers:r,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,n,null!==(a=s.timeout)&&void 0!==a?a:this.timeout);if(202===l.status)return{success:!0};let i=l.statusText;try{const e=await l.json();i=e.error||e.message||i}catch(o){}return Promise.reject(new Error(i))}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,a;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var a,r,n;const l=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(r=null===(a=this.params)||void 0===a?void 0:a.config)||void 0===r?void 0:r.broadcast)||void 0===n?void 0:n.ack)||s("ok"),l.receive("ok",()=>s("ok")),l.receive("error",()=>s("error")),l.receive("timeout",()=>s("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:n,payload:l}=e,i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization="Bearer ".concat(this.socket.accessTokenValue));const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:l,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(a=e.body)||void 0===a?void 0:a.cancel()),e.ok?"ok":"error"}catch(r){return"AbortError"===r.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=Hn.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(Vn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new ol(this,Vn.leave,{},e),s.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null===s||void 0===s||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Hn.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const a=new AbortController,r=setTimeout(()=>a.abort(),s),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(r),n}_push(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let a=new ol(this,e,t,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var a,r;const n=e.toLocaleLowerCase(),{close:l,error:i,leave:o,join:d}=Vn;if(s&&[l,i,o,d].indexOf(n)>=0&&s!==this._joinRef())return;let c=this._onMessage(n,t,s);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(a=this.bindings.postgres_changes)||void 0===a||a.filter(e=>{var t,s,a;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(a=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===a?void 0:a.toLocaleLowerCase())===n}).map(e=>e.callback(c,s)):null===(r=this.bindings[n])||void 0===r||r.filter(e=>{var s,a,r,l,i,o;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,l=null===(s=e.filter)||void 0===s?void 0:s.event;return n&&(null===(a=t.ids)||void 0===a?void 0:a.includes(n))&&("*"===l||(null===l||void 0===l?void 0:l.toLocaleLowerCase())===(null===(r=t.data)||void 0===r?void 0:r.type.toLocaleLowerCase()))}{const s=null===(i=null===(l=null===e||void 0===e?void 0:e.filter)||void 0===l?void 0:l.event)||void 0===i?void 0:i.toLocaleLowerCase();return"*"===s||s===(null===(o=null===t||void 0===t?void 0:t.event)||void 0===o?void 0:o.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n}).map(e=>{if("object"===typeof c&&"ids"in c){const e=c.data,{schema:t,table:s,commit_timestamp:a,type:r,errors:n}=e,l={schema:t,table:s,commit_timestamp:a,eventType:r,new:{},old:{},errors:n};c=Object.assign(Object.assign({},l),this._getPayloadRecords(e))}e.callback(c,s)})}_isClosed(){return this.state===Hn.closed}_isJoined(){return this.state===Hn.joined}_isJoining(){return this.state===Hn.joining}_isLeaving(){return this.state===Hn.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,s){const a=e.toLocaleLowerCase(),r={type:a,filter:t,callback:s};return this.bindings[a]?this.bindings[a].push(r):this.bindings[a]=[r],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(e=>{var a;return!((null===(a=e.type)||void 0===a?void 0:a.toLocaleLowerCase())===s&&xl.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}static isFilterValueEqual(e,t){return(null!==e&&void 0!==e?e:void 0)===(null!==t&&void 0!==t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Vn.close,{},e)}_onError(e){this._on(Vn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Hn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Zn(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Zn(e.columns,e.old_record)),t}}const pl=()=>{},bl=25e3,gl=10,fl=100,yl=[1e3,2e3,5e3,1e4];class vl{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Kn,this.transport=null,this.heartbeatIntervalMs=bl,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=pl,this.ref=0,this.reconnectTimer=null,this.vsn=zn,this.logger=pl,this.conn=null,this.sendBuffer=[],this.serializer=new Yn,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},!(null===(s=null===t||void 0===t?void 0:t.params)||void 0===s?void 0:s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(Jn.websocket),this.httpEndpoint=il(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Bn.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},"function"===typeof this.conn.close&&(e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return"ok"===t&&this._remove(e),0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Wn.connecting:return Qn.Connecting;case Wn.open:return Qn.Open;case Wn.closing:return Qn.Closing;default:return Qn.Closed}}isConnected(){return this.connectionState()===Qn.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const s="realtime:".concat(e),a=this.getChannels().find(e=>e.topic===s);if(a)return a;{const s=new xl("realtime:".concat(e),t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:a,ref:r}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(s," (").concat(r,")"),a),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(ia){this.log("error","error in heartbeat callback",ia)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},fl)}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(ia){this.log("error","error in heartbeat callback",ia)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(ia){this.log("error","error in heartbeat callback",ia)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){const t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(ia){this.log("error","error in heartbeat callback",ia)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:t,event:s,payload:a,ref:r}=e,n=r?"(".concat(r,")"):"",l=a.status||"";this.log("receive","".concat(l," ").concat(t," ").concat(s," ").concat(n).trim(),a),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,a,r)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Wn.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Wn.open||this.conn.readyState===Wn.connecting)try{this.conn.close()}catch(ia){this.log("error","Error closing connection",ia)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL()));(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(ia){this.log("error","error in heartbeat callback",ia)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(Vn.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return"".concat(e).concat(s).concat(a)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=!1;if(t)e=t,s=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(ia){this.log("error","Error fetching access token from callback",ia),e=this.accessTokenValue}else e=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const s={access_token:e,version:qn};e&&t.updateJoinPayload(s),t.joinedOnce&&t._isJoined()&&t._push(Vn.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this._isManualToken()||this.setAuth().catch(t=>{this.log("error","Error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(ia){this.log("error","error in ".concat(e," callback"),ia)}})}catch(ia){this.log("error","error triggering ".concat(e," callbacks"),ia)}}_setupReconnectionTimer(){this.reconnectTimer=new $n(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gl)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,a,r,n,l,i,o,d,c,u,m;switch(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(s=null===e||void 0===e?void 0:e.timeout)&&void 0!==s?s:Kn,this.heartbeatIntervalMs=null!==(a=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==a?a:bl,this.worker=null!==(r=null===e||void 0===e?void 0:e.worker)&&void 0!==r&&r,this.accessToken=null!==(n=null===e||void 0===e?void 0:e.accessToken)&&void 0!==n?n:null,this.heartbeatCallback=null!==(l=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==l?l:pl,this.vsn=null!==(i=null===e||void 0===e?void 0:e.vsn)&&void 0!==i?i:zn,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(o=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==o?o:e=>yl[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!==(d=null===e||void 0===e?void 0:e.encode)&&void 0!==d?d:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null===e||void 0===e?void 0:e.decode)&&void 0!==c?c:(e,t)=>t(JSON.parse(e));break;case Un:this.encode=null!==(u=null===e||void 0===e?void 0:e.encode)&&void 0!==u?u:this.serializer.encode.bind(this.serializer),this.decode=null!==(m=null===e||void 0===e?void 0:e.decode)&&void 0!==m?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error("Unsupported serializer version: ".concat(this.vsn))}if(this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}var wl=class extends Error{constructor(e,t){var s;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===(null===(s=t.icebergType)||void 0===s?void 0:s.includes("CommitState"))}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function jl(e){var t;const s=null!==(t=e.fetchImpl)&&void 0!==t?t:globalThis.fetch;return{async request(t){let{method:a,path:r,query:n,body:l,headers:o}=t;const d=function(e,t,s){const a=new URL(t,e);if(s)for(const[r,n]of Object.entries(s))void 0!==n&&a.searchParams.set(r,n);return a.toString()}(e.baseUrl,r,n),c=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:"Bearer ".concat(e.token)}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),u=await s(d,{method:a,headers:(0,i.A)((0,i.A)((0,i.A)({},l?{"Content-Type":"application/json"}:{}),c),o),body:l?JSON.stringify(l):void 0}),m=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),x=h&&m?JSON.parse(m):m;if(!u.ok){var p;const e=h?x:void 0,t=null===e||void 0===e?void 0:e.error;throw new wl(null!==(p=null===t||void 0===t?void 0:t.message)&&void 0!==p?p:"Request failed with status ".concat(u.status),{status:u.status,icebergType:null===t||void 0===t?void 0:t.type,icebergCode:null===t||void 0===t?void 0:t.code,details:e})}return{status:u.status,headers:u.headers,data:x}}}}function Nl(e){return e.join("\x1f")}var Sl=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Nl(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces"),query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const s={namespace:e.namespace,properties:null===t||void 0===t?void 0:t.properties};return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces"),body:s})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(Nl(e.namespace))})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(Nl(e.namespace))})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(Nl(e.namespace))}),!0}catch(t){if(t instanceof wl&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(s){if(s instanceof wl&&409===s.status)return;throw s}}};function kl(e){return e.join("\x1f")}var Cl=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;this.client=e,this.prefix=t,this.accessDelegation=s}async listTables(e){return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(kl(e.namespace),"/tables")})).data.identifiers}async createTable(e,t){const s={};this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(kl(e.namespace),"/tables"),body:t,headers:s})).data.metadata}async updateTable(e,t){const s=await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(kl(e.namespace),"/tables/").concat(e.name),body:t});return{"metadata-location":s.data["metadata-location"],metadata:s.data.metadata}}async dropTable(e,t){var s;await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(kl(e.namespace),"/tables/").concat(e.name),query:{purgeRequested:String(null!==(s=null===t||void 0===t?void 0:t.purge)&&void 0!==s&&s)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(kl(e.namespace),"/tables/").concat(e.name),headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(kl(e.namespace),"/tables/").concat(e.name),headers:t}),!0}catch(s){if(s instanceof wl&&404===s.status)return!1;throw s}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(s){if(s instanceof wl&&409===s.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw s}}},Al=class{constructor(e){var t;let s="v1";e.catalogName&&(s+="/".concat(e.catalogName));const a=e.baseUrl.endsWith("/")?e.baseUrl:"".concat(e.baseUrl,"/");this.client=jl({baseUrl:a,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=null===(t=e.accessDelegation)||void 0===t?void 0:t.join(","),this.namespaceOps=new Sl(this.client,s),this.tableOps=new Cl(this.client,s,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};var _l=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"storage",s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=s,this.statusCode=a}};function Pl(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}var Tl=class extends _l{constructor(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";super(e,a,t,s),this.name="vectors"===a?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},El=class extends _l{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"storage";super(e,s),this.name="vectors"===s?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const Il=e=>{if(Array.isArray(e))return e.map(e=>Il(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[s,a]=e;const r=s.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=Il(a)}),t};function Rl(e){return(Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dl(e){var t=function(e,t){if("object"!=Rl(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=Rl(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Rl(t)?t:t+""}function Ol(e,t,s){return(t=Dl(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Ll(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)}return s}function Fl(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ll(Object(s),!0).forEach(function(t){Ol(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ll(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}const Ml=e=>{var t;return e.msg||e.message||e.error_description||("string"===typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},Bl=(e,t,s,a)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&a?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(a)?(r.headers=Fl({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,(null===t||void 0===t?void 0:t.duplex)&&(r.duplex=t.duplex),Fl(Fl({},r),s)):Fl(Fl({},r),s)};async function ql(e,t,s,a,r,n,l){return new Promise((i,o)=>{e(s,Bl(t,a,r,n)).then(e=>{if(!e.ok)throw e;if(null===a||void 0===a?void 0:a.noResolveJson)return e;if("vectors"===l){const t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status)return{};if(!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>i(e)).catch(e=>(async(e,t,s,a)=>{if(e&&"object"===typeof e&&"status"in e&&"ok"in e&&"number"===typeof e.status&&!(null===s||void 0===s?void 0:s.noResolveJson)){const s=e,r=s.status||500;if("function"===typeof s.json)s.json().then(e=>{const s=(null===e||void 0===e?void 0:e.statusCode)||(null===e||void 0===e?void 0:e.code)||r+"";t(new Tl(Ml(e),r,s,a))}).catch(()=>{if("vectors"===a){const e=r+"";t(new Tl(s.statusText||"HTTP ".concat(r," error"),r,e,a))}else{const e=r+"";t(new Tl(s.statusText||"HTTP ".concat(r," error"),r,e,a))}});else{const e=r+"";t(new Tl(s.statusText||"HTTP ".concat(r," error"),r,e,a))}}else t(new El(Ml(e),e,a))})(e,o,a,l))})}function Ul(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"storage";return{get:async(t,s,a,r)=>ql(t,"GET",s,a,r,void 0,e),post:async(t,s,a,r,n)=>ql(t,"POST",s,r,n,a,e),put:async(t,s,a,r,n)=>ql(t,"PUT",s,r,n,a,e),head:async(t,s,a,r)=>ql(t,"HEAD",s,Fl(Fl({},a),{},{noResolveJson:!0}),r,void 0,e),remove:async(t,s,a,r,n)=>ql(t,"DELETE",s,r,n,a,e)}}const zl=Ul("storage"),{get:Kl,post:Wl,put:Hl,head:Vl,remove:Jl}=zl,Ql=Ul("vectors");var Gl=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";var r;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=(r=s)?function(){return r(...arguments)}:function(){return fetch(...arguments)},this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Pl(t))return{data:null,error:t};throw t}}},Yl=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Pl(e))return{data:null,error:e};throw e}}};let $l;$l=Symbol.toStringTag;var Zl=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[$l]="BlobDownloadBuilder",this.promise=null}asStream(){return new Yl(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Pl(e))return{data:null,error:e};throw e}}};const Xl={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ei={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ti=class extends Gl{constructor(e){let t=arguments.length>2?arguments[2]:void 0;super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>3?arguments[3]:void 0,"storage"),this.bucketId=t}async uploadOrUpdate(e,t,s,a){var r=this;return r.handleOperation(async()=>{let n;const l=Fl(Fl({},ei),a);let i=Fl(Fl({},r.headers),"POST"===e&&{"x-upsert":String(l.upsert)});const o=l.metadata;"undefined"!==typeof Blob&&s instanceof Blob?(n=new FormData,n.append("cacheControl",l.cacheControl),o&&n.append("metadata",r.encodeMetadata(o)),n.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(n=s,n.has("cacheControl")||n.append("cacheControl",l.cacheControl),o&&!n.has("metadata")&&n.append("metadata",r.encodeMetadata(o))):(n=s,i["cache-control"]="max-age=".concat(l.cacheControl),i["content-type"]=l.contentType,o&&(i["x-metadata"]=r.toBase64(r.encodeMetadata(o))),("undefined"!==typeof ReadableStream&&n instanceof ReadableStream||n&&"object"===typeof n&&"pipe"in n&&"function"===typeof n.pipe)&&!l.duplex&&(l.duplex="half")),(null===a||void 0===a?void 0:a.headers)&&(i=Fl(Fl({},i),a.headers));const d=r._removeEmptyFolders(t),c=r._getFinalPath(d),u=await("PUT"==e?Hl:Wl)(r.fetch,"".concat(r.url,"/object/").concat(c),n,Fl({headers:i},(null===l||void 0===l?void 0:l.duplex)?{duplex:l.duplex}:{}));return{path:d,id:u.Id,fullPath:u.Key}})}async upload(e,t,s){return this.uploadOrUpdate("POST",e,t,s)}async uploadToSignedUrl(e,t,s,a){var r=this;const n=r._removeEmptyFolders(e),l=r._getFinalPath(n),i=new URL(r.url+"/object/upload/sign/".concat(l));return i.searchParams.set("token",t),r.handleOperation(async()=>{let e;const t=Fl({upsert:ei.upsert},a),l=Fl(Fl({},r.headers),{"x-upsert":String(t.upsert)});return"undefined"!==typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,l["cache-control"]="max-age=".concat(t.cacheControl),l["content-type"]=t.contentType),{path:n,fullPath:(await Hl(r.fetch,i.toString(),e,{headers:l})).Key}})}async createSignedUploadUrl(e,t){var s=this;return s.handleOperation(async()=>{let a=s._getFinalPath(e);const r=Fl({},s.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const n=await Wl(s.fetch,"".concat(s.url,"/object/upload/sign/").concat(a),{},{headers:r}),l=new URL(s.url+n.url),i=l.searchParams.get("token");if(!i)throw new _l("No token returned by API");return{signedUrl:l.toString(),path:e,token:i}})}async update(e,t,s){return this.uploadOrUpdate("PUT",e,t,s)}async move(e,t,s){var a=this;return a.handleOperation(async()=>await Wl(a.fetch,"".concat(a.url,"/object/move"),{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:a.headers}))}async copy(e,t,s){var a=this;return a.handleOperation(async()=>({path:(await Wl(a.fetch,"".concat(a.url,"/object/copy"),{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(e,t,s){var a=this;return a.handleOperation(async()=>{let r=a._getFinalPath(e),n=await Wl(a.fetch,"".concat(a.url,"/object/sign/").concat(r),Fl({expiresIn:t},(null===s||void 0===s?void 0:s.transform)?{transform:s.transform}:{}),{headers:a.headers});const l=(null===s||void 0===s?void 0:s.download)?"&download=".concat(!0===s.download?"":s.download):"";return{signedUrl:encodeURI("".concat(a.url).concat(n.signedURL).concat(l))}})}async createSignedUrls(e,t,s){var a=this;return a.handleOperation(async()=>{const r=await Wl(a.fetch,"".concat(a.url,"/object/sign/").concat(a.bucketId),{expiresIn:t,paths:e},{headers:a.headers}),n=(null===s||void 0===s?void 0:s.download)?"&download=".concat(!0===s.download?"":s.download):"";return r.map(e=>Fl(Fl({},e),{},{signedUrl:e.signedURL?encodeURI("".concat(a.url).concat(e.signedURL).concat(n)):null}))})}download(e,t,s){const a="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),n=r?"?".concat(r):"",l=this._getFinalPath(e);return new Zl(()=>Kl(this.fetch,"".concat(this.url,"/").concat(a,"/").concat(l).concat(n),{headers:this.headers,noResolveJson:!0},s),this.shouldThrowOnError)}async info(e){var t=this;const s=t._getFinalPath(e);return t.handleOperation(async()=>Il(await Kl(t.fetch,"".concat(t.url,"/object/info/").concat(s),{headers:t.headers})))}async exists(e){var t=this;const s=t._getFinalPath(e);try{return await Vl(t.fetch,"".concat(t.url,"/object/").concat(s),{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Pl(a)&&a instanceof El){const e=a.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const s=this._getFinalPath(e),a=[],r=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==r&&a.push(r);const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",l=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==l&&a.push(l);let i=a.join("&");return""!==i&&(i="?".concat(i)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(n,"/public/").concat(s).concat(i))}}}async remove(e){var t=this;return t.handleOperation(async()=>await Jl(t.fetch,"".concat(t.url,"/object/").concat(t.bucketId),{prefixes:e},{headers:t.headers}))}async list(e,t,s){var a=this;return a.handleOperation(async()=>{const r=Fl(Fl(Fl({},Xl),t),{},{prefix:e||""});return await Wl(a.fetch,"".concat(a.url,"/object/list/").concat(a.bucketId),r,{headers:a.headers},s)})}async listV2(e,t){var s=this;return s.handleOperation(async()=>{const a=Fl({},e);return await Wl(s.fetch,"".concat(s.url,"/object/list-v2/").concat(s.bucketId),a,{headers:s.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}};const si={"X-Client-Info":"storage-js/".concat("2.95.3")};var ai=class extends Gl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;const r=new URL(e);(null===a||void 0===a?void 0:a.useNewHostname)&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."));super(r.href.replace(/\/$/,""),Fl(Fl({},si),t),s,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const s=t.listBucketOptionsToQueryString(e);return await Kl(t.fetch,"".concat(t.url,"/bucket").concat(s),{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Kl(t.fetch,"".concat(t.url,"/bucket/").concat(e),{headers:t.headers}))}async createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};var s=this;return s.handleOperation(async()=>await Wl(s.fetch,"".concat(s.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:s.headers}))}async updateBucket(e,t){var s=this;return s.handleOperation(async()=>await Hl(s.fetch,"".concat(s.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:s.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await Wl(t.fetch,"".concat(t.url,"/bucket/").concat(e,"/empty"),{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Jl(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},ri=class extends Gl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Fl(Fl({},si),t),s,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Wl(t.fetch,"".concat(t.url,"/bucket"),{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const s=new URLSearchParams;void 0!==(null===e||void 0===e?void 0:e.limit)&&s.set("limit",e.limit.toString()),void 0!==(null===e||void 0===e?void 0:e.offset)&&s.set("offset",e.offset.toString()),(null===e||void 0===e?void 0:e.sortColumn)&&s.set("sortColumn",e.sortColumn),(null===e||void 0===e?void 0:e.sortOrder)&&s.set("sortOrder",e.sortOrder),(null===e||void 0===e?void 0:e.search)&&s.set("search",e.search);const a=s.toString(),r=a?"".concat(t.url,"/bucket?").concat(a):"".concat(t.url,"/bucket");return await Kl(t.fetch,r,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Jl(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}from(e){var t=this;if(!(e=>!(!e||"string"!==typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new _l("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const s=new Al({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(s,{get(e,t){const s=e[t];return"function"!==typeof s?s:async function(){try{for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{data:await s.apply(e,r),error:null}}catch(l){if(a)throw l;return{data:null,error:l}}}}})}},ni=class extends Gl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Fl(Fl({},si),{},{"Content-Type":"application/json"},t),s,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/CreateIndex"),e,{headers:t.headers})||{})}async getIndex(e,t){var s=this;return s.handleOperation(async()=>await Ql.post(s.fetch,"".concat(s.url,"/GetIndex"),{vectorBucketName:e,indexName:t},{headers:s.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/ListIndexes"),e,{headers:t.headers}))}async deleteIndex(e,t){var s=this;return s.handleOperation(async()=>await Ql.post(s.fetch,"".concat(s.url,"/DeleteIndex"),{vectorBucketName:e,indexName:t},{headers:s.headers})||{})}},li=class extends Gl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Fl(Fl({},si),{},{"Content-Type":"application/json"},t),s,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/PutVectors"),e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/GetVectors"),e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and ".concat(e.segmentCount-1))}return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/ListVectors"),e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/QueryVectors"),e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/DeleteVectors"),e,{headers:t.headers})||{})}},ii=class extends Gl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Fl(Fl({},si),{},{"Content-Type":"application/json"},t),s,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/CreateVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/GetVectorBucket"),{vectorBucketName:e},{headers:t.headers}))}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/ListVectorBuckets"),e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Ql.post(t.fetch,"".concat(t.url,"/DeleteVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}},oi=class extends ii{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t.headers||{},t.fetch)}from(e){return new di(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},di=class extends ni{constructor(e,t,s,a){super(e,t,a),this.vectorBucketName=s}async createIndex(e){return(()=>super.createIndex)().call(this,Fl(Fl({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listIndexes)().call(this,Fl(Fl({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new ci(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},ci=class extends li{constructor(e,t,s,a,r){super(e,t,r),this.vectorBucketName=s,this.indexName=a}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,Fl(Fl({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,Fl(Fl({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return(()=>super.listVectors)().call(t,Fl(Fl({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,Fl(Fl({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,Fl(Fl({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},ui=class extends ai{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new ti(this.url,this.headers,e,this.fetch)}get vectors(){return new oi(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ri(this.url+"/iceberg",this.headers,this.fetch)}};const mi="2.95.3",hi=3e4,xi=9e4,pi={"X-Client-Info":"gotrue-js/".concat(mi)},bi="X-Supabase-Api-Version",gi={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},fi=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class yi extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function vi(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class wi extends yi{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class ji extends yi{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ni extends yi{constructor(e,t,s,a){super(e,s,a),this.name=t,this.status=s}}class Si extends Ni{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ki(e){return vi(e)&&"AuthSessionMissingError"===e.name}class Ci extends Ni{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ai extends Ni{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class _i extends Ni{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pi extends Ni{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ti extends Ni{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ei extends Ni{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ii(e){return vi(e)&&"AuthRetryableFetchError"===e.name}class Ri extends Ni{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Di extends Ni{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Oi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Li=" \t\n\r=".split(""),Fi=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Li.length;t+=1)e[Li[t].charCodeAt(0)]=-2;for(let t=0;t<Oi.length;t+=1)e[Oi[t].charCodeAt(0)]=t;return e})();function Mi(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(Oi[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(Oi[e]),t.queuedBits-=6}}function Bi(e,t,s){const a=Fi[e];if(!(a>-1)){if(-2===a)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function qi(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},a={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},n=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(0===(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,a,s)};for(let l=0;l<e.length;l+=1)Bi(e.charCodeAt(l),r,n);return t.join("")}function Ui(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function zi(e,t){for(let s=0;s<e.length;s+=1){let a=e.charCodeAt(s);if(a>55295&&a<=56319){const t=1024*(a-55296)&65535;a=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}Ui(a,t)}}function Ki(e){const t=[],s={queue:0,queuedBits:0},a=e=>{t.push(e)};for(let r=0;r<e.length;r+=1)Bi(e.charCodeAt(r),s,a);return new Uint8Array(t)}function Wi(e){const t=[],s={queue:0,queuedBits:0},a=e=>{t.push(e)};return e.forEach(e=>Mi(e,s,a)),Mi(null,s,a),t.join("")}const Hi=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Vi={tested:!1,writable:!1},Ji=()=>{if(!Hi())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(ia){return!1}if(Vi.tested)return Vi.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vi.tested=!0,Vi.writable=!0}catch(ia){Vi.tested=!0,Vi.writable=!1}return Vi.writable};const Qi=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},Gi=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Yi=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(a){return s}},$i=async(e,t)=>{await e.removeItem(t)};class Zi{constructor(){this.promise=new Zi.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Xi(e){const t=e.split(".");if(3!==t.length)throw new Di("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!fi.test(t[s]))throw new Di("JWT not in base64url format");return{header:JSON.parse(qi(t[0])),payload:JSON.parse(qi(t[1])),signature:Ki(t[2]),raw:{header:t[0],payload:t[1]}}}function eo(e){return("0"+e.toString(16)).substr(-2)}async function to(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(s);return Array.from(a).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function so(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let a=0;a<56;a++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,eo).join("")}();let r=a;s&&(r+="/PASSWORD_RECOVERY"),await Gi(e,"".concat(t,"-code-verifier"),r);const n=await to(a);return[n,a===n?"plain":"s256"]}Zi.promiseConstructor=Promise;const ao=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const ro=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function no(e){if(!ro.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function lo(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function io(e){return JSON.parse(JSON.stringify(e))}const oo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),co=[502,503,504];async function uo(e){var t,s;if(!("object"===typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"===typeof s.json))throw new Ei(oo(e),0);if(co.includes(e.status))throw new Ei(oo(e),e.status);let a,r;try{a=await e.json()}catch(ia){throw new ji(oo(ia),ia)}const n=function(e){const t=e.headers.get(bi);if(!t)return null;if(!t.match(ao))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(ia){return null}}(e);if(n&&n.getTime()>=gi.timestamp&&"object"===typeof a&&a&&"string"===typeof a.code?r=a.code:"object"===typeof a&&a&&"string"===typeof a.error_code&&(r=a.error_code),r){if("weak_password"===r)throw new Ri(oo(a),e.status,(null===(t=a.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new Si}else if("object"===typeof a&&a&&"object"===typeof a.weak_password&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new Ri(oo(a),e.status,a.weak_password.reasons);throw new wi(oo(a),e.status||500,r)}async function mo(e,t,s,a){var r;const n=Object.assign({},null===a||void 0===a?void 0:a.headers);n[bi]||(n[bi]=gi.name),(null===a||void 0===a?void 0:a.jwt)&&(n.Authorization="Bearer ".concat(a.jwt));const l=null!==(r=null===a||void 0===a?void 0:a.query)&&void 0!==r?r:{};(null===a||void 0===a?void 0:a.redirectTo)&&(l.redirect_to=a.redirectTo);const i=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",o=await async function(e,t,s,a,r,n){const l=((e,t,s,a)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(a),Object.assign(Object.assign({},r),s))})(t,a,r,n);let i;try{i=await e(s,Object.assign({},l))}catch(ia){throw console.error(ia),new Ei(oo(ia),0)}i.ok||await uo(i);if(null===a||void 0===a?void 0:a.noResolveJson)return i;try{return await i.json()}catch(ia){await uo(ia)}}(e,t,s+i,{headers:n,noResolveJson:null===a||void 0===a?void 0:a.noResolveJson},{},null===a||void 0===a?void 0:a.body);return(null===a||void 0===a?void 0:a.xform)?null===a||void 0===a?void 0:a.xform(o):{data:Object.assign({},o),error:null}}function ho(e){var t;let s=null;var a;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(a=e.expires_in,Math.round(Date.now()/1e3)+a)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function xo(e){const t=ho(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function po(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function bo(e){return{data:e,error:null}}function go(e){const{action_link:t,email_otp:s,hashed_token:a,redirect_to:r,verification_type:n}=e,l=yn(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:a,redirect_to:r,verification_type:n},user:Object.assign({},l)},error:null}}function fo(e){return e}const yo=["global","local","others"];class vo{constructor(e){let{url:t="",headers:s={},fetch:a}=e;this.url=t,this.headers=s,this.fetch=Qi(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yo[0];if(yo.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(yo.join(", ")));try{return await mo(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(vi(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await mo(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:po})}catch(s){if(vi(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=yn(e,["options"]),a=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(a.new_email=null===s||void 0===s?void 0:s.newEmail,delete a.newEmail),await mo(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:a,headers:this.headers,xform:go,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(vi(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await mo(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:po})}catch(t){if(vi(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,a,r,n,l,i;try{const o={nextPage:null,lastPage:0,total:0},d=await mo(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(r=null===(a=null===e||void 0===e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==r?r:""},xform:fo});if(d.error)throw d.error;const c=await d.json(),u=null!==(n=d.headers.get("x-total-count"))&&void 0!==n?n:0,m=null!==(i=null===(l=d.headers.get("link"))||void 0===l?void 0:l.split(","))&&void 0!==i?i:[];return m.length>0&&(m.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);o["".concat(s,"Page")]=t}),o.total=parseInt(u)),{data:Object.assign(Object.assign({},c),o),error:null}}catch(o){if(vi(o))return{data:{users:[]},error:o};throw o}}async getUserById(e){no(e);try{return await mo(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:po})}catch(t){if(vi(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){no(e);try{return await mo(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:po})}catch(s){if(vi(s))return{data:{user:null},error:s};throw s}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];no(e);try{return await mo(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:po})}catch(s){if(vi(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){no(e.userId);try{const{data:t,error:s}=await mo(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(vi(t))return{data:null,error:t};throw t}}async _deleteFactor(e){no(e.userId),no(e.id);try{return{data:await mo(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(vi(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,a,r,n,l,i;try{const o={nextPage:null,lastPage:0,total:0},d=await mo(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(r=null===(a=null===e||void 0===e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==r?r:""},xform:fo});if(d.error)throw d.error;const c=await d.json(),u=null!==(n=d.headers.get("x-total-count"))&&void 0!==n?n:0,m=null!==(i=null===(l=d.headers.get("link"))||void 0===l?void 0:l.split(","))&&void 0!==i?i:[];return m.length>0&&(m.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);o["".concat(s,"Page")]=t}),o.total=parseInt(u)),{data:Object.assign(Object.assign({},c),o),error:null}}catch(o){if(vi(o))return{data:{clients:[]},error:o};throw o}}async _createOAuthClient(e){try{return await mo(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(vi(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await mo(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(vi(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await mo(this.fetch,"PUT","".concat(this.url,"/admin/oauth/clients/").concat(e),{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(s){if(vi(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await mo(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(vi(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await mo(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(vi(t))return{data:null,error:t};throw t}}}function wo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const jo=!!(globalThis&&Ji()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class No extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class So extends No{}async function ko(e,t,s){jo&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),jo&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async a=>{if(!a){if(0===t)throw jo&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new So('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(jo)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(ia){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",ia)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}jo&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await s()}finally{jo&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}))}function Co(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function Ao(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class _o extends Error{constructor(e){let{message:t,code:s,cause:a,name:r}=e;var n;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=null!==(n=null!==r&&void 0!==r?r:a instanceof Error?a.name:void 0)&&void 0!==n?n:"Unknown Error",this.code=s}}class Po extends _o{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function To(e){let{error:t,options:s}=e;var a,r,n;const{publicKey:l}=s;if(!l)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(s.signal instanceof AbortSignal)return new _o({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(a=l.authenticatorSelection)||void 0===a?void 0:a.requireResidentKey))return new _o({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===s.mediation&&"required"===(null===(r=l.authenticatorSelection)||void 0===r?void 0:r.userVerification))return new _o({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(n=l.authenticatorSelection)||void 0===n?void 0:n.userVerification))return new _o({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new _o({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new _o({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===l.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new _o({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new _o({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!Fo(e))return new _o({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(l.rp.id!==e)return new _o({message:'The RP ID "'.concat(l.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new _o({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new _o({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new _o({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Eo(e){let{error:t,options:s}=e;const{publicKey:a}=s;if(!a)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(s.signal instanceof AbortSignal)return new _o({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new _o({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!Fo(e))return new _o({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(a.rpId!==e)return new _o({message:'The RP ID "'.concat(a.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new _o({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new _o({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}const Io=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function Ro(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:s,excludeCredentials:a}=e,r=yn(e,["challenge","user","excludeCredentials"]),n=Ki(t).buffer,l=Object.assign(Object.assign({},s),{id:Ki(s.id).buffer}),i=Object.assign(Object.assign({},r),{challenge:n,user:l});if(a&&a.length>0){i.excludeCredentials=new Array(a.length);for(let e=0;e<a.length;e++){const t=a[e];i.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:Ki(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return i}function Do(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:s}=e,a=yn(e,["challenge","allowCredentials"]),r=Ki(t).buffer,n=Object.assign(Object.assign({},a),{challenge:r});if(s&&s.length>0){n.allowCredentials=new Array(s.length);for(let e=0;e<s.length;e++){const t=s[e];n.allowCredentials[e]=Object.assign(Object.assign({},t),{id:Ki(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return n}function Oo(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const s=e;return{id:e.id,rawId:e.id,response:{attestationObject:Wi(new Uint8Array(e.response.attestationObject)),clientDataJSON:Wi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=s.authenticatorAttachment)&&void 0!==t?t:void 0}}function Lo(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const s=e,a=e.getClientExtensionResults(),r=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Wi(new Uint8Array(r.authenticatorData)),clientDataJSON:Wi(new Uint8Array(r.clientDataJSON)),signature:Wi(new Uint8Array(r.signature)),userHandle:r.userHandle?Wi(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:null!==(t=s.authenticatorAttachment)&&void 0!==t?t:void 0}}function Fo(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Mo(){var e,t;return!!(Hi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const Bo={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},qo={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Uo(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),s={};for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];for(const l of r)if(l)for(const a in l){const r=l[a];if(void 0!==r)if(Array.isArray(r))s[a]=r;else if(t(r))s[a]=r;else if(e(r)){const t=s[a];e(t)?s[a]=Uo(t,r):s[a]=Uo(r)}else s[a]=r}return s}class zo{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:s,webauthn:a,friendlyName:r,signal:n}=e;var l;try{const{data:e,error:i}=await this.client.mfa.challenge({factorId:s,webauthn:a});if(!e)return{data:null,error:i};const o=null!==n&&void 0!==n?n:Io.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;if(!t.name){const e=r;if(e)t.name="".concat(t.id,":").concat(e);else{const e=(await this.client.getUser()).data.user,s=(null===(l=null===e||void 0===e?void 0:e.user_metadata)||void 0===l?void 0:l.name)||(null===e||void 0===e?void 0:e.email)||(null===e||void 0===e?void 0:e.id)||"User";t.name="".concat(t.id,":").concat(s)}}t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const a=function(e,t){return Uo(Bo,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:r,error:n}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Po("Browser returned unexpected credential type",t)}:{data:null,error:new Po("Empty credential response",t)}}catch(t){return{data:null,error:To({error:t,options:e})}}}({publicKey:a,signal:o});return r?{data:{factorId:s,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:n}}case"request":{const a=function(e,t){return Uo(qo,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:r,error:n}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Po("Browser returned unexpected credential type",t)}:{data:null,error:new Po("Empty credential response",t)}}catch(t){return{data:null,error:Eo({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:a,signal:o}));return r?{data:{factorId:s,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:n}}}}catch(i){return vi(i)?{data:null,error:i}:{data:null,error:new ji("Unexpected error in challenge",i)}}}async _verify(e){let{challengeId:t,factorId:s,webauthn:a}=e;return this.client.mfa.verify({factorId:s,challengeId:t,webauthn:a})}async _authenticate(e,t){let{factorId:s,webauthn:{rpId:a=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:n}={}}=e;if(!a)return{data:null,error:new yi("rpId is required for WebAuthn authentication")};try{if(!Mo())return{data:null,error:new ji("Browser does not support WebAuthn",null)};const{data:e,error:l}=await this.challenge({factorId:s,webauthn:{rpId:a,rpOrigins:r},signal:n},{request:t});if(!e)return{data:null,error:l};const{webauthn:i}=e;return this._verify({factorId:s,challengeId:e.challengeId,webauthn:{type:i.type,rpId:a,rpOrigins:r,credential_response:i.credential_response}})}catch(l){return vi(l)?{data:null,error:l}:{data:null,error:new ji("Unexpected error in authenticate",l)}}}async _register(e,t){let{friendlyName:s,webauthn:{rpId:a=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:n}={}}=e;if(!a)return{data:null,error:new yi("rpId is required for WebAuthn registration")};try{if(!Mo())return{data:null,error:new ji("Browser does not support WebAuthn",null)};const{data:e,error:l}=await this._enroll({friendlyName:s});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===s&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:l};const{data:i,error:o}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:a,rpOrigins:r},signal:n},{create:t});return i?this._verify({factorId:e.id,challengeId:i.challengeId,webauthn:{rpId:a,rpOrigins:r,type:i.webauthn.type,credential_response:i.webauthn.credential_response}}):{data:null,error:o}}catch(l){return vi(l)?{data:null,error:l}:{data:null,error:new ji("Unexpected error in register",l)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(ia){"undefined"!==typeof self&&(self.globalThis=self)}}();const Ko={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:pi,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Wo(e,t,s){return await s()}const Ho={};class Vo{get jwks(){var e,t;return null!==(t=null===(e=Ho[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Ho[this.storageKey]=Object.assign(Object.assign({},Ho[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Ho[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ho[this.storageKey]=Object.assign(Object.assign({},Ho[this.storageKey]),{cachedAt:e})}constructor(e){var t,s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},Ko),e);if(this.storageKey=r.storageKey,this.instanceID=null!==(t=Vo.nextInstanceID[this.storageKey])&&void 0!==t?t:0,Vo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.instanceID>0&&Hi()){const e="".concat(this._logPrefix()," Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new vo({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Qi(r.fetch),this.lock=r.lock||Wo,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,this.lockAcquireTimeout=r.lockAcquireTimeout,r.lock?this.lock=r.lock:this.persistSession&&Hi()&&(null===(s=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===s?void 0:s.locks)?this.lock=ko:this.lock=Wo,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new zo(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:Ji()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=wo(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=wo(this.memoryStorage)),Hi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(ia){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",ia)}null===(a=this.broadcastChannel)||void 0===a||a.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(t){this._debug("#broadcastChannel","error",t)}})}this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return"GoTrueClient@"+"".concat(this.storageKey,":").concat(this.instanceID," (").concat(mi,") ").concat((new Date).toISOString())}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.logger(this._logPrefix(),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},s="none";if(Hi()&&(t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(ia){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce")),Hi()&&this.detectSessionInUrl&&"none"!==s){const{data:a,error:r}=await this._getSessionFromURL(t,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return vi(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return{error:r}}const{session:n,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",n,"redirect type",l),await this._saveSession(n),setTimeout(async()=>{"recovery"===l?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return vi(t)?this._returnResult({error:t}):this._returnResult({error:new ji("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,a;try{const r=await mo(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(s=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken}},xform:ho}),{data:n,error:l}=r;if(l||!n)return this._returnResult({data:{user:null,session:null},error:l});const i=n.session,o=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",i)),this._returnResult({data:{user:o,session:i},error:null})}catch(r){if(vi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(e){var t,s,a;try{let r;if("email"in e){const{email:s,password:a,options:n}=e;let l=null,i=null;"pkce"===this.flowType&&([l,i]=await so(this.storage,this.storageKey)),r=await mo(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===n||void 0===n?void 0:n.emailRedirectTo,body:{email:s,password:a,data:null!==(t=null===n||void 0===n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},code_challenge:l,code_challenge_method:i},xform:ho})}else{if(!("phone"in e))throw new Ai("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:l}=e;r=await mo(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:n,data:null!==(s=null===l||void 0===l?void 0:l.data)&&void 0!==s?s:{},channel:null!==(a=null===l||void 0===l?void 0:l.channel)&&void 0!==a?a:"sms",gotrue_meta_security:{captcha_token:null===l||void 0===l?void 0:l.captchaToken}},xform:ho})}}const{data:n,error:l}=r;if(l||!n)return await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),this._returnResult({data:{user:null,session:null},error:l});const i=n.session,o=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",i)),this._returnResult({data:{user:o,session:i},error:null})}catch(r){if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),vi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:a,options:r}=e;t=await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:xo})}else{if(!("phone"in e))throw new Ai("You must provide either an email or phone number and a password");{const{phone:s,password:a,options:r}=e;t=await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:xo})}}const{data:s,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const e=new Ci;return this._returnResult({data:{user:null,session:null},error:e})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(t){if(vi(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,s,a,r;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,s,a,r,n,l,i,o,d,c,u;let m,h;if("message"in e)m=e.message,h=e.signature;else{const{chain:c,wallet:u,statement:x,options:p}=e;let b;if(Hi())if("object"===typeof u)b=u;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");b=e.ethereum}else{if("object"!==typeof u||!(null===p||void 0===p?void 0:p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=u}const g=new URL(null!==(t=null===p||void 0===p?void 0:p.url)&&void 0!==t?t:window.location.href),f=await b.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!f||0===f.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const y=Co(f[0]);let v=null===(s=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===s?void 0:s.chainId;if(!v){const e=await b.request({method:"eth_chainId"});v=parseInt(e,16)}m=function(e){var t;const{chainId:s,domain:a,expirationTime:r,issuedAt:n=new Date,nonce:l,notBefore:i,requestId:o,resources:d,scheme:c,uri:u,version:m}=e;if(!Number.isInteger(s))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(s));if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(l));if(!u)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==m)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(m));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const h=Co(e.address),x=c?"".concat(c,"://").concat(a):a,p=e.statement?"".concat(e.statement,"\n"):"",b="".concat(x," wants you to sign in with your Ethereum account:\n").concat(h,"\n\n").concat(p);let g="URI: ".concat(u,"\nVersion: ").concat(m,"\nChain ID: ").concat(s).concat(l?"\nNonce: ".concat(l):"","\nIssued At: ").concat(n.toISOString());if(r&&(g+="\nExpiration Time: ".concat(r.toISOString())),i&&(g+="\nNot Before: ".concat(i.toISOString())),o&&(g+="\nRequest ID: ".concat(o)),d){let e="\nResources:";for(const t of d){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}g+=e}return"".concat(b,"\n").concat(g)}({domain:g.host,address:y,statement:x,uri:g.href,version:"1",chainId:v,nonce:null===(a=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===a?void 0:a.nonce,issuedAt:null!==(n=null===(r=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===r?void 0:r.issuedAt)&&void 0!==n?n:new Date,expirationTime:null===(l=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===l?void 0:l.expirationTime,notBefore:null===(i=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===i?void 0:i.notBefore,requestId:null===(o=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===o?void 0:o.requestId,resources:null===(d=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===d?void 0:d.resources}),h=await b.request({method:"personal_sign",params:[Ao(m),y]})}try{const{data:t,error:s}=await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:h},(null===(c=e.options)||void 0===c?void 0:c.captchaToken)?{gotrue_meta_security:{captcha_token:null===(u=e.options)||void 0===u?void 0:u.captchaToken}}:null),xform:ho});if(s)throw s;if(!t||!t.session||!t.user){const e=new Ci;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:s})}catch(x){if(vi(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(e){var t,s,a,r,n,l,i,o,d,c,u,m;let h,x;if("message"in e)h=e.message,x=e.signature;else{const{chain:u,wallet:m,statement:p,options:b}=e;let g;if(Hi())if("object"===typeof m)g=m;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");g=e.solana}else{if("object"!==typeof m||!(null===b||void 0===b?void 0:b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=m}const f=new URL(null!==(t=null===b||void 0===b?void 0:b.url)&&void 0!==t?t:window.location.href);if("signIn"in g&&g.signIn){const e=await g.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===b||void 0===b?void 0:b.signInWithSolana),{version:"1",domain:f.host,uri:f.href}),p?{statement:p}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");h="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),x=t.signature}else{if(!("signMessage"in g)||"function"!==typeof g.signMessage||!("publicKey"in g)||"object"!==typeof g||!g.publicKey||!("toBase58"in g.publicKey)||"function"!==typeof g.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");h=["".concat(f.host," wants you to sign in with your Solana account:"),g.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1","URI: ".concat(f.href),"Issued At: ".concat(null!==(a=null===(s=null===b||void 0===b?void 0:b.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==a?a:(new Date).toISOString()),...(null===(r=null===b||void 0===b?void 0:b.signInWithSolana)||void 0===r?void 0:r.notBefore)?["Not Before: ".concat(b.signInWithSolana.notBefore)]:[],...(null===(n=null===b||void 0===b?void 0:b.signInWithSolana)||void 0===n?void 0:n.expirationTime)?["Expiration Time: ".concat(b.signInWithSolana.expirationTime)]:[],...(null===(l=null===b||void 0===b?void 0:b.signInWithSolana)||void 0===l?void 0:l.chainId)?["Chain ID: ".concat(b.signInWithSolana.chainId)]:[],...(null===(i=null===b||void 0===b?void 0:b.signInWithSolana)||void 0===i?void 0:i.nonce)?["Nonce: ".concat(b.signInWithSolana.nonce)]:[],...(null===(o=null===b||void 0===b?void 0:b.signInWithSolana)||void 0===o?void 0:o.requestId)?["Request ID: ".concat(b.signInWithSolana.requestId)]:[],...(null===(c=null===(d=null===b||void 0===b?void 0:b.signInWithSolana)||void 0===d?void 0:d.resources)||void 0===c?void 0:c.length)?["Resources",...b.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await g.signMessage((new TextEncoder).encode(h),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=e}}try{const{data:t,error:s}=await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:h,signature:Wi(x)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(m=e.options)||void 0===m?void 0:m.captchaToken}}:null),xform:ho});if(s)throw s;if(!t||!t.session||!t.user){const e=new Ci;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:s})}catch(p){if(vi(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async _exchangeCodeForSession(e){const t=await Yi(this.storage,"".concat(this.storageKey,"-code-verifier")),[s,a]=(null!==t&&void 0!==t?t:"").split("/");try{if(!s&&"pkce"===this.flowType)throw new Ti;const{data:t,error:r}=await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ho});if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),r)throw r;if(!t||!t.session||!t.user){const e=new Ci;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!==a&&void 0!==a?a:null}),error:r})}catch(r){if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),vi(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(e){try{const{options:t,provider:s,token:a,access_token:r,nonce:n}=e,l=await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:s,id_token:a,access_token:r,nonce:n,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:ho}),{data:i,error:o}=l;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!i||!i.session||!i.user){const e=new Ci;return this._returnResult({data:{user:null,session:null},error:e})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:i,error:o})}catch(t){if(vi(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,s,a,r,n;try{if("email"in e){const{email:a,options:r}=e;let n=null,l=null;"pkce"===this.flowType&&([n,l]=await so(this.storage,this.storageKey));const{error:i}=await mo(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:a,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},create_user:null===(s=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:n,code_challenge_method:l},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}if("phone"in e){const{phone:t,options:s}=e,{data:l,error:i}=await mo(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(a=null===s||void 0===s?void 0:s.data)&&void 0!==a?a:{},create_user:null===(r=null===s||void 0===s?void 0:s.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},channel:null!==(n=null===s||void 0===s?void 0:s.channel)&&void 0!==n?n:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null===l||void 0===l?void 0:l.message_id},error:i})}throw new Ai("You must provide either an email or phone number.")}catch(l){if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),vi(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,s;try{let a,r;"options"in e&&(a=null===(t=e.options)||void 0===t?void 0:t.redirectTo,r=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:n,error:l}=await mo(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:a,xform:ho});if(l)throw l;if(!n){throw new Error("An error occurred on token verification.")}const i=n.session,o=n.user;return(null===i||void 0===i?void 0:i.access_token)&&(await this._saveSession(i),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",i)),this._returnResult({data:{user:o,session:i},error:null})}catch(a){if(vi(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,s,a,r,n;try{let l=null,i=null;"pkce"===this.flowType&&([l,i]=await so(this.storage,this.storageKey));const o=await mo(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:i}),headers:this.headers,xform:bo});return(null===(r=o.data)||void 0===r?void 0:r.url)&&Hi()&&!(null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect)&&window.location.assign(o.data.url),this._returnResult(o)}catch(l){if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),vi(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Si;const{error:a}=await mo(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(vi(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:s,type:a,options:r}=e,{error:n}=await mo(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:n})}if("phone"in e){const{phone:s,type:a,options:r}=e,{data:n,error:l}=await mo(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null===n||void 0===n?void 0:n.message_id},error:l})}throw new Ai("You must provide either an email or phone number and a type")}catch(t){if(vi(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(ia){}})()),s}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(ia){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Yi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<xi;if(this._debug("#__loadSession()","session has".concat(s?"":" not"," expired"),"expires_at",e.expires_at),!s){if(this.userStorage){const t=await Yi(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=lo()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,s,a)=>{if("__isInsecureUserWarningProxy"===s)return!0;if("symbol"===typeof s){const t=s.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,s,a)}return t.value||"string"!==typeof s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,s,a)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await mo(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:po}):await this._useSession(async e=>{var t,s,a;const{data:r,error:n}=e;if(n)throw n;return(null===(t=r.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await mo(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(a=null===(s=r.session)||void 0===s?void 0:s.access_token)&&void 0!==a?a:void 0,xform:po}):{data:{user:null},error:new Si}})}catch(t){if(vi(t))return ki(t)&&(await this._removeSession(),await $i(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async s=>{const{data:a,error:r}=s;if(r)throw r;if(!a.session)throw new Si;const n=a.session;let l=null,i=null;"pkce"===this.flowType&&null!=e.email&&([l,i]=await so(this.storage,this.storageKey));const{data:o,error:d}=await mo(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:i}),jwt:n.access_token,xform:po});if(d)throw d;return n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),this._returnResult({data:{user:n.user},error:null})})}catch(s){if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),vi(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Si;const t=Date.now()/1e3;let s=t,a=!0,r=null;const{payload:n}=Xi(e.access_token);if(n.exp&&(s=n.exp,a=s<=t),a){const{data:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!t)return{data:{user:null,session:null},error:null};r=t}else{const{data:a,error:n}=await this._getUser(e.access_token);if(n)return this._returnResult({data:{user:null,session:null},error:n});r={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(t){if(vi(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:r}=t;if(r)throw r;e=null!==(s=a.session)&&void 0!==s?s:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Si;const{data:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(vi(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Hi())throw new _i("No browser detected.");if(e.error||e.error_description||e.error_code)throw new _i(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Pi("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new _i("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Pi("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const a=new URL(window.location.href);return a.searchParams.delete("code"),window.history.replaceState(window.history.state,"",a.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:r,refresh_token:n,expires_in:l,expires_at:i,token_type:o}=e;if(!r||!l||!n||!o)throw new _i("No session defined in URL");const d=Math.round(Date.now()/1e3),c=parseInt(l);let u=d+c;i&&(u=parseInt(i));const m=u-d;1e3*m<=hi&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(m,"s, should have been closer to ").concat(c,"s"));const h=u-c;d-h>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",h,u,d):d-h<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",h,u,d);const{data:x,error:p}=await this._getUser(r);if(p)throw p;const b={provider_token:s,provider_refresh_token:a,access_token:r,expires_in:c,expires_at:u,refresh_token:n,token_type:o,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:b,redirectType:e.type},error:null})}catch(s){if(vi(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return"function"===typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Yi(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var s;const{data:a,error:r}=t;if(r&&!ki(r))return this._returnResult({error:r});const n=null===(s=a.session)||void 0===s?void 0:s.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return vi(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status)&&!ki(t))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await $i(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,a;try{const{data:{session:a},error:r}=t;if(r)throw r;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(r){await(null===(a=this.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=null,a=null;"pkce"===this.flowType&&([s,a]=await so(this.storage,this.storageKey,!0));try{return await mo(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),vi(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:a}=await this._useSession(async t=>{var s,a,r,n,l;const{data:i,error:o}=t;if(o)throw o;const d=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(a=e.options)||void 0===a?void 0:a.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:!0});return await mo(this.fetch,"GET",d,{headers:this.headers,jwt:null!==(l=null===(n=i.session)||void 0===n?void 0:n.access_token)&&void 0!==l?l:void 0})});if(a)throw a;return Hi()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===s||void 0===s?void 0:s.url),this._returnResult({data:{provider:e.provider,url:null===s||void 0===s?void 0:s.url},error:null})}catch(s){if(vi(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:a,data:{session:r}}=t;if(a)throw a;const{options:n,provider:l,token:i,access_token:o,nonce:d}=e,c=await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(s=null===r||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0,body:{provider:l,id_token:i,access_token:o,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken}},xform:ho}),{data:u,error:m}=c;return m?this._returnResult({data:{user:null,session:null},error:m}):u&&u.session&&u.user?(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),this._returnResult({data:u,error:m})):this._returnResult({data:{user:null,session:null},error:new Ci})}catch(a){if(await $i(this.storage,"".concat(this.storageKey,"-code-verifier")),vi(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,a;const{data:r,error:n}=t;if(n)throw n;return await mo(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(a=null===(s=r.session)||void 0===s?void 0:s.access_token)&&void 0!==a?a:void 0})})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const s=Date.now();return await function(e,t){const s=new Promise((s,a)=>{(async()=>{for(let r=0;r<1/0;r++)try{const a=await e(r);if(!t(r,null,a))return void s(a)}catch(ia){if(!t(r,ia))return void a(ia)}})()});return s}(async s=>(s>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await mo(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:ho})),(e,t)=>{const a=200*Math.pow(2,e);return t&&Ii(t)&&Date.now()+a-s<hi})}catch(s){if(this._debug(t,"error",s),vi(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(t,"end")}}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Hi()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Yi(this.storage,this.storageKey);if(r&&this.userStorage){let t=await Yi(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:r.user},await Gi(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:lo()}else if(r&&!r.user&&!r.user){const e=await Yi(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await $i(this.storage,this.storageKey+"-user"),await Gi(this.storage,this.storageKey,r)):r.user=lo()}if(this._debug(s,"session from storage",r),!this._isValidSession(r))return this._debug(s,"session is not valid"),void(null!==r&&await this._removeSession());const n=1e3*(null!==(t=r.expires_at)&&void 0!==t?t:1/0)-Date.now()<xi;if(this._debug(s,"session has".concat(n?"":" not"," expired with margin of ").concat(xi,"s")),n){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),Ii(e)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(r.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(s,"error",r),void console.error(r)}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Si;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(a,"begin");try{this.refreshingDeferred=new Zi;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new Si;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const a={data:t.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(r){if(this._debug(a,"error",r),vi(r)){const e={data:null,error:r};return Ii(r)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a="#_notifyAllSubscribers(".concat(e,")");this._debug(a,"begin",t,"broadcast = ".concat(s));try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],r=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(ia){a.push(ia)}});if(await Promise.all(r),a.length>0){for(let e=0;e<a.length;e+=1)console.error(a[e]);throw a[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await $i(this.storage,"".concat(this.storageKey,"-code-verifier"));const t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await Gi(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const a=io(e);await Gi(this.storage,this.storageKey,a)}else{const e=io(t);await Gi(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await $i(this.storage,this.storageKey),await $i(this.storage,this.storageKey+"-code-verifier"),await $i(this.storage,this.storageKey+"-user"),this.userStorage&&await $i(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Hi()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(ia){console.error("removing visibilitychange callback failed",ia)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),hi);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"===typeof t&&"function"===typeof t.unref?t.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const a=Math.floor((1e3*s.expires_at-e)/hi);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(a," ticks, a tick lasts ").concat(hi,"ms, refresh threshold is ").concat(3," ticks")),a<=3&&await this._callRefreshToken(s.refresh_token)})}catch(ia){console.error("Auto refresh tick failed with error. This is likely a transient error.",ia)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(ia){if(!(ia.isAcquireTimeout||ia instanceof No))throw ia;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Hi()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const a=["provider=".concat(encodeURIComponent(t))];if((null===s||void 0===s?void 0:s.redirectTo)&&a.push("redirect_to=".concat(encodeURIComponent(s.redirectTo))),(null===s||void 0===s?void 0:s.scopes)&&a.push("scopes=".concat(encodeURIComponent(s.scopes))),"pkce"===this.flowType){const[e,t]=await so(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});a.push(s.toString())}if(null===s||void 0===s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);a.push(e.toString())}return(null===s||void 0===s?void 0:s.skipBrowserRedirect)&&a.push("skip_http_redirect=".concat(s.skipBrowserRedirect)),"".concat(e,"?").concat(a.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:a,error:r}=t;return r?this._returnResult({data:null,error:r}):await mo(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(s=null===a||void 0===a?void 0:a.session)||void 0===s?void 0:s.access_token})})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,a;const{data:r,error:n}=t;if(n)return this._returnResult({data:null,error:n});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:i,error:o}=await mo(this.fetch,"POST","".concat(this.url,"/factors"),{body:l,headers:this.headers,jwt:null===(s=null===r||void 0===r?void 0:r.session)||void 0===s?void 0:s.access_token});return o?this._returnResult({data:null,error:o}):("totp"===e.factorType&&"totp"===i.type&&(null===(a=null===i||void 0===i?void 0:i.totp)||void 0===a?void 0:a.qr_code)&&(i.totp.qr_code="data:image/svg+xml;utf-8,".concat(i.totp.qr_code)),this._returnResult({data:i,error:null}))})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:a,error:r}=t;if(r)return this._returnResult({data:null,error:r});const n=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?Oo(e.webauthn.credential_response):Lo(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:i}=await mo(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:n,headers:this.headers,jwt:null===(s=null===a||void 0===a?void 0:a.session)||void 0===s?void 0:s.access_token});return i?this._returnResult({data:null,error:i}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:i}))})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:a,error:r}=t;if(r)return this._returnResult({data:null,error:r});const n=await mo(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(s=null===a||void 0===a?void 0:a.session)||void 0===s?void 0:s.access_token});if(n.error)return n;const{data:l}=n;if("webauthn"!==l.type)return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ro(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Do(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const r of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])a.all.push(r),"verified"===r.status&&a[r.factor_type].push(r);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,s,a,r;if(e)try{const{payload:a}=Xi(e);let r=null;a.aal&&(r=a.aal);let n=r;const{data:{user:l},error:i}=await this.getUser(e);if(i)return this._returnResult({data:null,error:i});(null!==(s=null===(t=null===l||void 0===l?void 0:l.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(n="aal2");return{data:{currentLevel:r,nextLevel:n,currentAuthenticationMethods:a.amr||[]},error:null}}catch(c){if(vi(c))return this._returnResult({data:null,error:c});throw c}const{data:{session:n},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Xi(n.access_token);let o=null;i.aal&&(o=i.aal);let d=o;(null!==(r=null===(a=n.user.factors)||void 0===a?void 0:a.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(d="aal2");return{data:{currentLevel:o,nextLevel:d,currentAuthenticationMethods:i.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:s},error:a}=t;return a?this._returnResult({data:null,error:a}):s?await mo(this.fetch,"GET","".concat(this.url,"/oauth/authorizations/").concat(e),{headers:this.headers,jwt:s.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Si})})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:a},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!a)return this._returnResult({data:null,error:new Si});const n=await mo(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&Hi()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(s){if(vi(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:a},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!a)return this._returnResult({data:null,error:new Si});const n=await mo(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&Hi()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(s){if(vi(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;return s?this._returnResult({data:null,error:s}):t?await mo(this.fetch,"GET","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Si})})}catch(e){if(vi(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:s},error:a}=t;return a?this._returnResult({data:null,error:a}):s?(await mo(this.fetch,"DELETE","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Si})})}catch(t){if(vi(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const s=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>s)return t;const{data:a,error:r}=await mo(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(r)throw r;return a.keys&&0!==a.keys.length?(this.jwks=a,this.jwks_cached_at=s,t=a.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});s=e.session.access_token}const{header:a,payload:r,signature:n,raw:{header:l,payload:i}}=Xi(s);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(r.exp);const o=a.alg&&!a.alg.startsWith("HS")&&a.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(a.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!o){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:r,header:a,signature:n},error:null}}const d=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(a.alg),c=await crypto.subtle.importKey("jwk",o,d,!0,["verify"]);if(!await crypto.subtle.verify(d,c,n,function(e){const t=[];return zi(e,e=>t.push(e)),new Uint8Array(t)}("".concat(l,".").concat(i))))throw new Di("Invalid JWT signature");return{data:{claims:r,header:a,signature:n},error:null}}catch(s){if(vi(s))return this._returnResult({data:null,error:s});throw s}}}Vo.nextInstanceID={};const Jo=Vo;let Qo="";Qo="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Go={headers:{"X-Client-Info":"supabase-js-".concat(Qo,"/").concat("2.95.3")}},Yo={schema:"public"},$o={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Zo={};function Xo(e){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ed(e){var t=function(e,t){if("object"!=Xo(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=Xo(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xo(t)?t:t+""}function td(e,t,s){return(t=ed(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function sd(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)}return s}function ad(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?sd(Object(s),!0).forEach(function(t){td(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):sd(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}const rd=(e,t,s)=>{const a=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(s),r=Headers;return async(s,n)=>{var l;const i=null!==(l=await t())&&void 0!==l?l:e;let o=new r(null===n||void 0===n?void 0:n.headers);return o.has("apikey")||o.set("apikey",e),o.has("Authorization")||o.set("Authorization","Bearer ".concat(i)),a(s,ad(ad({},n),{},{headers:o}))}};var nd=class extends Jo{constructor(e){super(e)}},ld=class{constructor(e,t,s){var a,r;this.supabaseUrl=e,this.supabaseKey=t;const n=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(function(e){return e.endsWith("/")?e:e+"/"}(t))}catch(s){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",n),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",n),this.storageUrl=new URL("storage/v1",n),this.functionsUrl=new URL("functions/v1",n);const l="sb-".concat(n.hostname.split(".")[0],"-auth-token"),i=function(e,t){var s,a;const{db:r,auth:n,realtime:l,global:i}=e,{db:o,auth:d,realtime:c,global:u}=t,m={db:ad(ad({},o),r),auth:ad(ad({},d),n),realtime:ad(ad({},c),l),storage:{},global:ad(ad(ad({},u),i),{},{headers:ad(ad({},null!==(s=null===u||void 0===u?void 0:u.headers)&&void 0!==s?s:{}),null!==(a=null===i||void 0===i?void 0:i.headers)&&void 0!==a?a:{})}),accessToken:async()=>""};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}(null!==s&&void 0!==s?s:{},{db:Yo,realtime:Zo,auth:ad(ad({},$o),{},{storageKey:l}),global:Go});var o;(this.storageKey=null!==(a=i.auth.storageKey)&&void 0!==a?a:"",this.headers=null!==(r=i.global.headers)&&void 0!==r?r:{},i.accessToken)?(this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(o=i.auth)&&void 0!==o?o:{},this.headers,i.global.fetch);this.fetch=rd(t,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(ad({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new Mn(new URL("rest/v1",n).href,{headers:this.headers,schema:i.db.schema,fetch:this.fetch,timeout:i.db.timeout,urlLengthLimit:i.db.urlLengthLimit}),this.storage=new ui(this.storageUrl.href,this.headers,this.fetch,null===s||void 0===s?void 0:s.storage),i.accessToken||this._listenForAuthEvents()}get functions(){return new Cn(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{head:!1,get:!1,count:void 0};return this.rest.rpc(e,t,s)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,s=this;if(s.accessToken)return await s.accessToken();const{data:a}=await s.auth.getSession();return null!==(e=null===(t=a.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:s.supabaseKey}_initSupabaseAuthClient(e,t,s){let{autoRefreshToken:a,persistSession:r,detectSessionInUrl:n,storage:l,userStorage:i,storageKey:o,flowType:d,lock:c,debug:u,throwOnError:m}=e;const h={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new nd({url:this.authUrl.href,headers:ad(ad({},h),t),storageKey:o,autoRefreshToken:a,persistSession:r,detectSessionInUrl:n,storage:l,userStorage:i,flowType:d,lock:c,debug:u,throwOnError:m,fetch:s,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new vl(this.realtimeUrl.href,ad(ad({},e),{},{params:ad(ad({},{apikey:this.supabaseKey}),null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=s,this.realtime.setAuth(s))}};(function(){if("undefined"!==typeof window)return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(void 0===t||null===t)return!1;const s=t.match(/^v(\d+)\./);return!!s&&parseInt(s[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const id=((e,t,s)=>new ld(e,t,s))({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_SUPABASE_URL||"https://mvxqemhzciocszdjcmqs.supabase.co",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im12eHFlbWh6Y2lvY3N6ZGpjbXFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1MzYyMzQsImV4cCI6MjA3OTExMjIzNH0.N9Vcr1Epie06ud6x9p3sueY_8kVoI-p7Pj8vpNE_tMQ",{auth:{autoRefreshToken:!0,persistSession:!1}});function od(e){const t=ra();(0,r.useEffect)(()=>{if(!e)return;const s=[],a=id.channel("admin-credits-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"credit_requests",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["creditRequests",e]})}).subscribe();s.push(a);const r=id.channel("admin-leaves-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"leave_applications",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["pendingLeaveApplications",e]}),t.invalidateQueries({queryKey:["myApprovedLeaves",e]}),t.invalidateQueries({queryKey:["leavePolicies",e]})}).subscribe();s.push(r);const n=id.channel("admin-chats-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"chat_messages"},()=>{t.invalidateQueries({queryKey:["unreadChatCounts",e]})}).on("postgres_changes",{event:"*",schema:"public",table:"chat_sessions",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["unreadChatCounts",e]})}).subscribe();s.push(n);const l=id.channel("admin-notifs-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"push_notifications"},()=>{t.invalidateQueries({queryKey:["unreadNotificationCount",e,"staff"]}),t.invalidateQueries({queryKey:["notificationInbox"]})}).on("postgres_changes",{event:"*",schema:"public",table:"notification_read_status"},()=>{t.invalidateQueries({queryKey:["unreadNotificationCount",e,"staff"]})}).subscribe();s.push(l);const i=id.channel("admin-profile-requests-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"player_profile_change_requests",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["fieldUpdateRequests",e]})}).subscribe();s.push(i);const o=id.channel("admin-tournaments-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"tournaments",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["tournaments"]}),t.invalidateQueries({queryKey:["tournament-players"]})}).on("postgres_changes",{event:"*",schema:"public",table:"tournament_players"},()=>{t.invalidateQueries({queryKey:["tournament-players"]})}).subscribe();s.push(o);const d=id.channel("admin-txns-".concat(e)).on("postgres_changes",{event:"INSERT",schema:"public",table:"financial_transactions",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["clubRevenue",e]}),t.invalidateQueries({queryKey:["transactions"]})}).subscribe();s.push(d);const c=id.channel("admin-buyins-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"buyin_requests",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["buyInRequests",e]})}).subscribe();s.push(c);const u=id.channel("admin-buyouts-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"buyout_requests",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["buyOutRequests",e]})}).subscribe();s.push(u);const m=id.channel("admin-fnb-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"fnb_orders",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["fnbOrders"]})}).subscribe();s.push(m);const h=id.channel("admin-players-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"players",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["clubPlayers",e]})}).subscribe();s.push(h);const x=id.channel("admin-staff-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"staff",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["clubStaff",e]})}).subscribe();s.push(x);const p=id.channel("admin-tables-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"tables",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["tables"]}),t.invalidateQueries({queryKey:["seatedPlayers"]})}).on("postgres_changes",{event:"*",schema:"public",table:"waitlist_entries",filter:"club_id=eq.".concat(e)},()=>{t.invalidateQueries({queryKey:["waitlist"]}),t.invalidateQueries({queryKey:["seatedPlayers"]})}).subscribe();return s.push(p),()=>{s.forEach(e=>id.removeChannel(e))}},[e,t])}const dd=["Dashboard","Notifications","Player Management","Tables & Waitlist","Push Notifications","Tournaments","Chat"];function cd(e){let{activeItem:t,setActiveItem:s,menuItems:a=dd,onSignOut:n=null,clubInfo:l=null}=e;const[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(window.innerWidth<1024),[m,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),b=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useRef)(null),y=(0,r.useRef)(null),v=(null===l||void 0===l?void 0:l.rummyEnabled)||!1,w=!1!==(null===l||void 0===l?void 0:l.pokerEnabled);let j=a.filter(e=>!(!w&&["Tables & Waitlist","Tournaments"].includes(e)));v&&(j=[...j,"Rummy"]);const N=localStorage.getItem("clubId");od(N);const{data:S}=hn({queryKey:["unreadNotificationCount",N,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(N,"staff"),enabled:!!N}),{data:k}=hn({queryKey:["myApprovedLeaves",N],queryFn:()=>jr.ie.getMyLeaveApplications(N,{status:"Approved"}),enabled:!!N}),C=(null===k||void 0===k?void 0:k.total)||0,{data:A}=hn({queryKey:["unreadChatCounts",N],queryFn:()=>jr.h2.getUnreadCounts(N),enabled:!!N}),_=((null===A||void 0===A?void 0:A.staffChats)||0)+((null===A||void 0===A?void 0:A.playerChats)||0);(0,r.useEffect)(()=>{const e=(null===S||void 0===S?void 0:S.unreadCount)||0;if(null!==b.current&&e>b.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}b.current=e},[null===S||void 0===S?void 0:S.unreadCount]),(0,r.useEffect)(()=>{if(null!==g.current&&C>g.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e)),wr.success("\ud83c\udf89 Your leave request has been approved!",{duration:5e3})}g.current=C},[C]),(0,r.useEffect)(()=>{const e=(null===A||void 0===A?void 0:A.staffChats)||0;if(null!==f.current&&e>f.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}f.current=e},[null===A||void 0===A?void 0:A.staffChats]),(0,r.useEffect)(()=>{const e=(null===A||void 0===A?void 0:A.playerChats)||0;if(null!==y.current&&e>y.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}y.current=e},[null===A||void 0===A?void 0:A.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;u(e),e||d(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(o&&c){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[o,c]);const{data:P}=hn({queryKey:["club",N],queryFn:()=>jr.Od.getClub(N),enabled:!!N}),T=JSON.parse(localStorage.getItem("user")||"{}"),E=T.email||"manager@pokerroom.com",I=T.displayName||"Manager",R=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e)),h(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}});return(0,sa.jsxs)(sa.Fragment,{children:[c&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-yellow-500 to-green-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>d(!o),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),c&&o&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>d(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] bg-gradient-to-b from-yellow-500/20 via-green-600/30 to-emerald-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(c?o?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-green-300 to-teal-400 drop-shadow-lg mb-6",children:"Manager Portal"}),(0,sa.jsxs)("div",{onClick:()=>h(!0),className:"flex items-center text-white min-w-0 cursor-pointer hover:opacity-90 transition-opacity p-2 -m-2 rounded-lg",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-400 to-green-500 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:(0,sa.jsx)("span",{className:"text-gray-900 font-bold text-sm",children:"M"})}),(0,sa.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold truncate",children:I}),(0,sa.jsx)("div",{className:"text-sm opacity-80 truncate",children:E})]})]}),m&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]",onClick:()=>h(!1),children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full mx-4 border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Enter your current and new password"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),E?x.currentPassword&&x.newPassword&&x.confirmPassword?x.newPassword===x.confirmPassword?x.newPassword.length<8?wr.error("Password must be at least 8 characters"):R.mutate({email:E,currentPassword:x.currentPassword,newPassword:x.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:x.currentPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:x.newPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:x.confirmPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{h(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:R.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:R.isLoading?"Resetting...":"Reset Password"})]})]})]})}),document.body),P&&P.code&&(0,sa.jsx)("div",{className:"mb-6",children:(0,sa.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-300 font-semibold mb-1",children:"\ud83c\udfae Club Code"}),(0,sa.jsx)("div",{className:"text-emerald-100 font-mono text-lg font-bold tracking-wider text-center",children:P.code}),(0,sa.jsx)("div",{className:"text-xs text-emerald-400 mt-1 text-center",children:"Players use this to sign up"})]})})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:j.map((e,a)=>(0,sa.jsx)("button",{onClick:()=>{s(e),c&&d(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-yellow-400 to-yellow-600 text-gray-900 font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-yellow-400/20 hover:to-green-500/20 text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between",children:[(0,sa.jsx)("span",{className:"block truncate",children:e}),"Notifications"===e&&(null===S||void 0===S?void 0:S.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:S.unreadCount>9?"9+":S.unreadCount}),"Chat"===e&&_>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:_>9?"9+":_})]})},a))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})})]})}function ud(e){var t,s,a;let{selectedClubId:n,playersData:l,playersLoading:o,pendingPlayers:d,pendingLoading:c,suspendedPlayers:u=[],suspendedLoading:m=!1,onRefresh:h}=e;const[x,p]=(0,r.useState)("all"),[b,g]=(0,r.useState)(""),[f,y]=(0,r.useState)("All"),[v,w]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[S,k]=(0,r.useState)(1),[C,A]=(0,r.useState)(1),[_,P]=(0,r.useState)(1),T=10,[E,I]=(0,r.useState)({name:"",email:"",phoneNumber:"",referralCode:"",panCard:"",aadhaarFile:null,panCardFile:null,initialBalance:0}),[R,D]=(0,r.useState)(null),[O,L]=(0,r.useState)(!1),[F,M]=(0,r.useState)(null),[B,q]=(0,r.useState)(!1),[U,z]=(0,r.useState)(null),[K,W]=(0,r.useState)(!1),[H,V]=(0,r.useState)(null),[J,Q]=(0,r.useState)({type:"temporary",reason:"",duration:""}),G=ra(),{data:Y,isLoading:$}=hn({queryKey:["playerDetails",n,null===U||void 0===U?void 0:U.id],queryFn:async()=>{if(!U||!n)return null;const e=await jr.Dv.getPlayer(n,U.id);let t=[];try{const e=await fetch("".concat("http://localhost:3333/api","/player-documents/my"),{headers:{"x-player-id":U.id,"x-club-id":n}});if(e.ok){const s=await e.json();t=s.documents||[]}}catch(a){console.error("Error fetching documents:",a)}const s=e.kycDocuments||U.kycDocuments||[];if(Array.isArray(s)&&s.length>0){const e=new Set(t.map(e=>e.url));s.forEach(s=>{s.url&&!e.has(s.url)&&t.push(s)})}return(0,i.A)((0,i.A)({},e),{},{documents:t})},enabled:!!U&&!!n&&B}),Z=gn({mutationFn:async e=>{let{playerId:t,file:s,documentType:a}=e;const r=new FormData;r.append("file",s),r.append("type",a),r.append("name",s.name);const l=await fetch("".concat("http://localhost:3333/api","/player-documents/upload"),{method:"POST",headers:{"x-player-id":t,"x-club-id":n},body:r});if(!l.ok){const e=await l.json();throw new Error(e.message||"Failed to upload document")}return l.json()}}),X=gn({mutationFn:async e=>{const t=await jr.Dv.createPlayer(n,e),s=[];return E.aadhaarFile&&s.push(Z.mutateAsync({playerId:t.id,file:E.aadhaarFile,documentType:"government_id"})),E.panCardFile&&s.push(Z.mutateAsync({playerId:t.id,file:E.panCardFile,documentType:"pan_card"})),s.length>0&&await Promise.all(s),t},onSuccess:e=>{M({player:{name:e.name,email:e.email,tempPassword:e.tempPassword}}),L(!0),I({name:"",email:"",phoneNumber:"",referralCode:"",panCard:"",aadhaarFile:null,panCardFile:null,initialBalance:0}),G.invalidateQueries(["clubPlayers",n])},onError:e=>{wr.error(e.message||"Failed to create player")}}),ee=gn({mutationFn:e=>{let{playerId:t,notes:s}=e;return jr.Dv.approvePlayer(n,t,s)},onSuccess:()=>{wr.success("Player approved successfully!"),D(null),h()},onError:e=>{wr.error(e.message||"Failed to approve player")}}),te=gn({mutationFn:e=>{let{playerId:t,reason:s}=e;return jr.Dv.rejectPlayer(n,t,s)},onSuccess:()=>{wr.success("Player rejected"),D(null),h()},onError:e=>{wr.error(e.message||"Failed to reject player")}}),se=gn({mutationFn:async e=>{let{playerId:t,suspensionType:s,reason:a,duration:r}=e;const l={type:s,reason:a};return"temporary"===s&&r&&(l.duration="".concat(r," days")),await jr.Dv.suspendPlayer(n,t,l)},onSuccess:()=>{wr.success("Player suspended successfully"),W(!1),V(null),Q({type:"temporary",reason:"",duration:""}),h(),G.invalidateQueries(["clubPlayers",n]),G.invalidateQueries(["suspendedPlayers",n])},onError:e=>{wr.error(e.message||"Failed to suspend player")}}),ae=gn({mutationFn:async e=>await jr.Dv.unsuspendPlayer(n,e),onSuccess:()=>{wr.success("Player unsuspended successfully"),h(),G.invalidateQueries(["clubPlayers",n]),G.invalidateQueries(["suspendedPlayers",n])},onError:e=>{wr.error(e.message||"Failed to unsuspend player")}}),{data:re=[],isLoading:ne,isFetching:le,refetch:ie}=hn({queryKey:["fieldUpdateRequests",n],queryFn:()=>jr.Dv.getFieldUpdateRequests(n),enabled:!!n&&"field-updates"===x}),[oe,de]=(0,r.useState)(null),[ce,ue]=(0,r.useState)(""),[me,he]=(0,r.useState)({open:!1,request:null,oldDocUrl:null,newDocUrl:null}),xe=gn({mutationFn:e=>{let{requestId:t}=e;return jr.Dv.approveFieldUpdate(n,t)},onSuccess:()=>{wr.success("Field update approved"),G.invalidateQueries(["fieldUpdateRequests",n]),G.invalidateQueries(["clubPlayers",n])},onError:e=>{wr.error(e.message||"Failed to approve field update")}}),pe=gn({mutationFn:e=>{let{requestId:t,reason:s}=e;return jr.Dv.rejectFieldUpdate(n,t,s)},onSuccess:()=>{wr.success("Field update rejected"),de(null),ue(""),G.invalidateQueries(["fieldUpdateRequests",n])},onError:e=>{wr.error(e.message||"Failed to reject field update")}}),be=((null===l||void 0===l?void 0:l.players)||[]).filter(e=>{var t,s,a;const r=!b||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(b.toLowerCase()))||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(b.toLowerCase()))||(null===(a=e.playerId)||void 0===a?void 0:a.toLowerCase().includes(b.toLowerCase())),n="All"===f||e.status===f;return r&&n}),ge=Math.ceil(be.length/T),fe=(S-1)*T,ye=fe+T,ve=be.slice(fe,ye),we=Math.ceil(d.length/T),je=(C-1)*T,Ne=je+T,Se=d.slice(je,Ne),ke=Math.ceil(re.length/T),Ce=(_-1)*T,Ae=Ce+T,_e=re.slice(Ce,Ae);(0,r.useEffect)(()=>{k(1)},[b,f]);return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Player Management"}),(0,sa.jsx)("div",{className:"flex gap-2 border-b border-slate-700",children:[{id:"all",label:"All Players"},{id:"create",label:"Create Players"},{id:"approval",label:"Player Approval"},{id:"field-updates",label:"Player Fields Update Approval"}].map(e=>(0,sa.jsx)("button",{onClick:()=>{return t=e.id,p(t),k(1),A(1),void P(1);var t},className:"px-6 py-3 font-semibold transition-all ".concat(x===e.id?"bg-gradient-to-r from-red-400 to-purple-600 text-white border-b-2 border-purple-400":"text-gray-400 hover:text-white"),children:e.label},e.id))}),(0,sa.jsxs)("div",{className:"mt-6",children:["all"===x&&(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700 flex gap-4",children:[(0,sa.jsx)("input",{type:"text",placeholder:"Search by name, email, or ID...",value:b,onChange:e=>g(e.target.value),className:"flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500"}),(0,sa.jsxs)("select",{value:f,onChange:e=>y(e.target.value),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",children:[(0,sa.jsx)("option",{value:"All",children:"All Status"}),(0,sa.jsx)("option",{value:"Active",children:"Active"}),(0,sa.jsx)("option",{value:"Pending",children:"Pending"}),(0,sa.jsx)("option",{value:"Suspended",children:"Suspended"})]})]}),o?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading players..."})]}):(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,sa.jsx)("div",{className:"p-4 text-sm text-gray-400 flex justify-between items-center",children:(0,sa.jsxs)("span",{children:["Showing ",fe+1,"-",Math.min(ye,be.length)," of ",be.length," players"]})}),(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Name"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"ID"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Email"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Phone"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"KYC"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Registered"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Actions"})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:0===ve.length?(0,sa.jsx)("tr",{children:(0,sa.jsx)("td",{colSpan:"9",className:"px-6 py-8 text-center text-gray-400",children:"No players found"})}):ve.map(e=>(0,sa.jsxs)("tr",{className:"hover:bg-slate-750",children:[(0,sa.jsx)("td",{className:"px-6 py-4 font-medium cursor-pointer",onClick:()=>{z(e),q(!0)},children:e.name}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.playerId||"-"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.email}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.phoneNumber||"-"}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("Active"===e.status?"bg-emerald-600/20 text-emerald-400":"Pending"===e.status?"bg-yellow-600/20 text-yellow-400":"bg-red-600/20 text-red-400"),children:e.status})}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("approved"===e.kycStatus||"verified"===e.kycStatus?"bg-green-600/20 text-green-400":"bg-gray-600/20 text-gray-400"),children:e.kycStatus||"pending"})}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400 text-sm",children:new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),z(e),q(!0)},className:"bg-blue-600 hover:bg-blue-500 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",children:"\ud83d\udcc4 View"}),"Suspended"===e.status?(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),window.confirm("Are you sure you want to unsuspend ".concat(e.name,"?"))&&ae.mutate(e.id)},disabled:ae.isLoading,className:"bg-emerald-600 hover:bg-emerald-500 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors disabled:opacity-50",children:"Unsuspend"}):(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),V(e),W(!0)},className:"bg-red-600 hover:bg-red-500 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",children:"Suspend"})]})})]},e.id))})]}),ge>1&&(0,sa.jsxs)("div",{className:"p-4 border-t border-slate-700 flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",S," of ",ge]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>k(e=>Math.max(1,e-1)),disabled:1===S,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>k(e=>Math.min(ge,e+1)),disabled:S===ge,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Next"})]})]})]})]}),"create"===x&&(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Create New Player"}),!n&&(0,sa.jsx)("div",{className:"mb-6 p-4 bg-yellow-900/30 border border-yellow-500/50 rounded-lg",children:(0,sa.jsx)("p",{className:"text-yellow-400 font-semibold",children:"\u26a0\ufe0f Please select a club from the sidebar dropdown to create a player"})}),(0,sa.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!n)return void wr.error("Please select a club first");if(E.panCard&&E.panCard.trim()){if(!/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/.test(E.panCard.trim()))return void wr.error("PAN card must be in format: ABCDE1234F (5 letters, 4 digits, 1 letter)")}if(!E.aadhaarFile)return void wr.error("Please upload Aadhaar document");if(!E.panCardFile)return void wr.error("Please upload PAN card document");const t=5242880;if(E.aadhaarFile.size>t)return void wr.error("Aadhaar document must be less than 5MB");if(E.panCardFile.size>t)return void wr.error("PAN card document must be less than 5MB");const s=["image/jpeg","image/jpg","image/png","application/pdf"];if(!s.includes(E.aadhaarFile.type))return void wr.error("Aadhaar document must be JPG, PNG, or PDF");if(!s.includes(E.panCardFile.type))return void wr.error("PAN card document must be JPG, PNG, or PDF");const a={name:E.name,email:E.email,phoneNumber:E.phoneNumber,affiliateCode:E.referralCode||void 0,panCard:E.panCard||void 0,initialBalance:E.initialBalance||0};X.mutate(a)},className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Player Name *"}),(0,sa.jsx)("input",{type:"text",value:E.name,onChange:e=>I((0,i.A)((0,i.A)({},E),{},{name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email *"}),(0,sa.jsx)("input",{type:"email",value:E.email,onChange:e=>I((0,i.A)((0,i.A)({},E),{},{email:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Phone Number *"}),(0,sa.jsx)("input",{type:"tel",value:E.phoneNumber,onChange:e=>I((0,i.A)((0,i.A)({},E),{},{phoneNumber:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Referral Code (Optional)"}),(0,sa.jsx)("input",{type:"text",value:E.referralCode||"",onChange:e=>I((0,i.A)((0,i.A)({},E),{},{referralCode:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Referral code"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"PAN Card Number"}),(0,sa.jsx)("input",{type:"text",value:E.panCard,onChange:e=>{const t=e.target.value.toUpperCase();t.length<=10&&/^[A-Z0-9]*$/.test(t)&&I((0,i.A)((0,i.A)({},E),{},{panCard:t}))},className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white font-mono",placeholder:"ABCDE1234F",maxLength:10}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Format: 5 letters, 4 digits, 1 letter (e.g., ABCDE1234F)"})]}),(0,sa.jsxs)("div",{className:"col-span-2",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Aadhaar Document *"}),(0,sa.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,application/pdf",onChange:e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&I((0,i.A)((0,i.A)({},E),{},{aadhaarFile:s}))},className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-emerald-600 file:text-white hover:file:bg-emerald-500",required:!0}),E.aadhaarFile&&(0,sa.jsxs)("p",{className:"text-xs text-emerald-400 mt-1",children:["\u2713 ",E.aadhaarFile.name]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Upload Aadhaar card (JPG, PNG, or PDF, max 5MB)"})]}),(0,sa.jsxs)("div",{className:"col-span-2",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"PAN Card Document *"}),(0,sa.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,application/pdf",onChange:e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&I((0,i.A)((0,i.A)({},E),{},{panCardFile:s}))},className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-emerald-600 file:text-white hover:file:bg-emerald-500",required:!0}),E.panCardFile&&(0,sa.jsxs)("p",{className:"text-xs text-emerald-400 mt-1",children:["\u2713 ",E.panCardFile.name]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Upload PAN card document (JPG, PNG, or PDF, max 5MB)"})]}),(0,sa.jsxs)("div",{className:"col-span-2",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Initial Balance (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:E.initialBalance,onChange:e=>I((0,i.A)((0,i.A)({},E),{},{initialBalance:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),(0,sa.jsx)("div",{className:"flex gap-4 mt-6",children:(0,sa.jsx)("button",{type:"submit",disabled:X.isLoading||Z.isLoading||!n,className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-3 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2",children:X.isLoading||Z.isLoading?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,sa.jsx)("span",{children:"Creating Player & Uploading Documents..."})]}):n?"Create Player":"Select a Club First"})})]})]}),"approval"===x&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-end",children:(0,sa.jsxs)("button",{onClick:async()=>{N(!0);try{await h()}finally{N(!1)}},disabled:j||c,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-60 disabled:cursor-not-allowed text-white rounded-lg text-sm font-medium transition-colors",title:"Refresh approval requests",children:[(0,sa.jsx)("svg",{className:"w-4 h-4 ".concat(j||c?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),j||c?"Refreshing...":"Refresh"]})}),c?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading pending players..."})]}):0===d.length?(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 border border-slate-700 text-center",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\u2705"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No pending approvals"})]}):(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Player Name"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Email"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Phone"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Registration Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"KYC Document"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Actions"})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:0===Se.length?(0,sa.jsx)("tr",{children:(0,sa.jsx)("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-400",children:"No pending players found"})}):Se.map(e=>(0,sa.jsxs)("tr",{className:"hover:bg-slate-750",children:[(0,sa.jsx)("td",{className:"px-6 py-4 font-medium",children:e.name}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.email}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.phoneNumber||"-"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400 text-sm",children:new Date(e.registrationDate||e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsxs)("div",{className:"flex flex-col gap-1",children:[e.kycDocumentUrl&&(0,sa.jsx)("a",{href:e.kycDocumentUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 text-sm",children:"View Document"}),(0,sa.jsx)("button",{onClick:()=>{z(e),q(!0)},className:"inline-flex items-center justify-center bg-blue-600 hover:bg-blue-500 px-3 py-1 rounded-lg text-xs font-medium text-white transition-colors",children:"\ud83d\udcc4 View KYC"})]})}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 rounded text-xs font-semibold",children:"Pending"})}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>{D(e),ee.mutate({playerId:e.id,notes:"Approved by Super Admin"})},disabled:ee.isLoading,className:"bg-emerald-600 hover:bg-emerald-500 px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"Approve"}),(0,sa.jsx)("button",{onClick:()=>{const t=prompt("Enter rejection reason:");t&&te.mutate({playerId:e.id,reason:t})},disabled:te.isLoading,className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"Reject"})]})})]},e.id))})]}),we>1&&(0,sa.jsxs)("div",{className:"p-4 border-t border-slate-700 flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",C," of ",we]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>A(e=>Math.max(1,e-1)),disabled:1===C,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>A(e=>Math.min(we,e+1)),disabled:C===we,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Next"})]})]})]})]}),"field-updates"===x&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-end",children:(0,sa.jsxs)("button",{onClick:()=>ie(),disabled:le,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-60 disabled:cursor-not-allowed text-white rounded-lg text-sm font-medium transition-colors",title:"Refresh field update requests",children:[(0,sa.jsx)("svg",{className:"w-4 h-4 ".concat(le?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),le?"Refreshing...":"Refresh"]})}),ne?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading field update requests..."})]}):0===re.length?(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 border border-slate-700 text-center",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udcdd"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No pending field update requests"})]}):(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,sa.jsx)("div",{className:"p-4 text-sm text-gray-400 flex justify-between items-center",children:(0,sa.jsxs)("span",{children:["Showing ",Ce+1,"-",Math.min(Ae,re.length)," of ",re.length," field update requests"]})}),(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Player Name"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Field"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Change"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Requested Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Actions"})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:0===_e.length?(0,sa.jsx)("tr",{children:(0,sa.jsx)("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-400",children:"No field update requests found"})}):_e.map(e=>{var t,s;const a=null!==(t=e.player)&&void 0!==t&&t.name||null!==(s=e.player)&&void 0!==s&&s.first_name?"".concat(e.player.first_name||""," ").concat(e.player.last_name||"").trim():"Unknown",r={phoneNumber:"Phone",name:"Name",email:"Email",government_id:"Govt ID",pan_card:"PAN Card"}[e.fieldName]||e.fieldName,l=["government_id","pan_card"].includes(e.fieldName);return(0,sa.jsxs)("tr",{className:"hover:bg-slate-700/50",children:[(0,sa.jsx)("td",{className:"px-6 py-4 font-medium",children:a}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsxs)("span",{className:"px-2 py-1 rounded text-xs font-semibold uppercase ".concat(l?"bg-blue-600/20 text-blue-300":"bg-purple-600/20 text-purple-300"),children:[l?"\ud83d\udcc4 ":"",r]})}),(0,sa.jsx)("td",{className:"px-6 py-4 text-sm",children:l?(0,sa.jsx)("button",{onClick:async()=>{he({open:!0,request:e,oldDocUrl:null,newDocUrl:null,loading:!0});try{var t,s,a,r,l;const i=e.playerId||(null===(t=e.player)||void 0===t?void 0:t.id);if(!i)throw new Error("No player ID");const o=await jr.Dv.getPlayerDocuments(n,i),d=(null===o||void 0===o?void 0:o.documents)||[],c=e.fieldName,u=d.filter(e=>(e.type===c||e.documentType===c)&&(e.url||e.fileUrl)).sort((e,t)=>new Date(t.uploadedAt||t.createdAt||0)-new Date(e.uploadedAt||e.createdAt||0)),m=(null===(s=u[0])||void 0===s?void 0:s.url)||(null===(a=u[0])||void 0===a?void 0:a.fileUrl)||null,h=(null===(r=u[1])||void 0===r?void 0:r.url)||(null===(l=u[1])||void 0===l?void 0:l.fileUrl)||null,x=(e.requestedValue||"").startsWith("http")?e.requestedValue:null;he({open:!0,request:e,oldDocUrl:h,newDocUrl:m||x,loading:!1})}catch(o){console.error("Failed to load documents:",o);const t=(e.requestedValue||"").startsWith("http")?e.requestedValue:null;he(e=>(0,i.A)((0,i.A)({},e),{},{newDocUrl:t,loading:!1}))}},className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-600/20 hover:bg-blue-600/30 text-blue-300 rounded-lg text-xs font-medium border border-blue-500/30 transition-colors",children:"\ud83d\udd0d View Old & New Document"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("span",{className:"text-gray-500 line-through",children:e.currentValue||"N/A"})," \u2192 ",(0,sa.jsx)("span",{className:"text-emerald-400 font-medium",children:e.requestedValue})]})}),(0,sa.jsxs)("td",{className:"px-6 py-4 text-gray-400 text-sm",children:[new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",day:"2-digit",month:"short",year:"numeric"}),(0,sa.jsx)("br",{}),(0,sa.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour:"2-digit",minute:"2-digit"})})]}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 rounded text-xs font-semibold",children:"Pending"})}),(0,sa.jsx)("td",{className:"px-6 py-4",children:oe===e.id?(0,sa.jsxs)("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[(0,sa.jsx)("input",{type:"text",value:ce,onChange:e=>ue(e.target.value),placeholder:"Rejection reason...",className:"px-3 py-1.5 bg-slate-700 border border-slate-600 rounded text-white text-sm"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>{ce.trim()?pe.mutate({requestId:e.id,reason:ce.trim()}):wr.error("Please enter a rejection reason")},disabled:pe.isLoading,className:"bg-red-600 hover:bg-red-500 px-3 py-1.5 rounded text-xs font-medium transition-colors disabled:opacity-50",children:"Confirm"}),(0,sa.jsx)("button",{onClick:()=>{de(null),ue("")},className:"bg-slate-600 hover:bg-slate-500 px-3 py-1.5 rounded text-xs font-medium transition-colors",children:"Cancel"})]})]}):(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>xe.mutate({requestId:e.id}),disabled:xe.isLoading,className:"bg-emerald-600 hover:bg-emerald-500 px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"Approve"}),(0,sa.jsx)("button",{onClick:()=>de(e.id),disabled:pe.isLoading,className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"Reject"})]})})]},e.id)})})]}),ke>1&&(0,sa.jsxs)("div",{className:"p-4 border-t border-slate-700 flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",_," of ",ke]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>P(e=>Math.max(1,e-1)),disabled:1===_,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>P(e=>Math.min(ke,e+1)),disabled:_===ke,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Next"})]})]})]}),"suspend"===x&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Player Suspension Management"}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:(0,sa.jsxs)("div",{className:"text-center py-8",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-lg mb-2",children:"\ud83d\udca1 To suspend a player:"}),(0,sa.jsx)("p",{className:"text-gray-300",children:'Go to the "All Players" tab and click the "Suspend" button next to any player.'})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,sa.jsx)("div",{className:"p-4 text-sm text-gray-400",children:m?"Loading...":"Showing ".concat(u.length," suspended players")}),m?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading suspended players..."})]}):0===u.length?(0,sa.jsx)("div",{className:"p-12 text-center",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"No suspended players"})}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{className:"p-4 text-sm text-gray-400",children:["Showing ",Math.min((suspendPage-1)*T+1,u.length)," - ",Math.min(suspendPage*T,u.length)," of ",u.length," suspended players"]}),(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Name"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Email"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Suspended Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Reason"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Actions"})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:u.slice((suspendPage-1)*T,suspendPage*T).map(e=>(0,sa.jsxs)("tr",{className:"hover:bg-slate-750",children:[(0,sa.jsx)("td",{className:"px-6 py-4 font-medium",children:e.name}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.email}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400 text-sm",children:e.suspendedAt?new Date(e.suspendedAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"}):"-"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400 text-sm",children:e.suspensionReason||e.reason||"-"}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to unsuspend ".concat(e.name,"?"))&&jr.Dv.unsuspendPlayer(n,e.id).then(()=>{wr.success("Player unsuspended successfully"),h()}).catch(e=>{wr.error(e.message||"Failed to unsuspend player")})},className:"bg-emerald-600 hover:bg-emerald-500 px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Unsuspend"})})]},e.id))})]}),Math.ceil(u.length/T)>1&&(0,sa.jsxs)("div",{className:"p-4 border-t border-slate-700 flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",suspendPage," of ",Math.ceil(u.length/T)]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>setSuspendPage(e=>Math.max(1,e-1)),disabled:1===suspendPage,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>setSuspendPage(e=>Math.min(Math.ceil(u.length/T),e+1)),disabled:suspendPage>=Math.ceil(u.length/T),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Next"})]})]})]})]})]})]})]}),O&&F&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-8 max-w-2xl w-full border-2 border-emerald-500 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-500 rounded-full mb-4",children:(0,sa.jsx)("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white mb-2",children:"\ud83c\udf89 Player Created!"}),(0,sa.jsx)("p",{className:"text-emerald-400 text-sm",children:"Save these credentials securely!"})]}),(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-emerald-500/30",children:[(0,sa.jsxs)("h3",{className:"text-emerald-400 font-semibold mb-3 flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Player Login Credentials"]}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Name:"})," ",F.player.name]}),(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Email:"})," ",F.player.email]}),(0,sa.jsxs)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-3 mt-2",children:[(0,sa.jsx)("p",{className:"text-yellow-400 text-sm font-medium mb-1",children:"\u26a0\ufe0f Temporary Password"}),(0,sa.jsx)("p",{className:"text-yellow-100 font-mono text-lg font-bold",children:F.player.tempPassword}),(0,sa.jsx)("p",{className:"text-yellow-300 text-xs mt-1",children:"Player must reset password on first login"})]})]})]})}),(0,sa.jsx)("button",{onClick:()=>{L(!1),M(null),p("all")},className:"w-full mt-6 bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-lg font-bold text-white text-lg transition-colors",children:"Got it! Close"})]})}),B&&U&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-8 max-w-4xl w-full border-2 border-purple-500 shadow-2xl my-8 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white",children:"Player Details"}),(0,sa.jsx)("button",{onClick:()=>{q(!1),z(null)},className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),$?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Loading player details..."})]}):Y?(0,sa.jsxs)("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-purple-500/30",children:[(0,sa.jsxs)("h3",{className:"text-purple-400 font-semibold mb-4 text-lg flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Basic Information"]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Name"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:Y.name||U.name})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Email"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:Y.email||U.email})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Phone Number"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:Y.phoneNumber||U.phoneNumber||"-"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Player ID"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:Y.playerId||U.playerId||"-"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"PAN Card"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:Y.panCard||U.panCard||"-"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Status"}),(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded text-xs font-semibold ".concat("Active"===(Y.status||U.status)?"bg-emerald-600/20 text-emerald-400":"Pending"===(Y.status||U.status)?"bg-yellow-600/20 text-yellow-400":"bg-red-600/20 text-red-400"),children:Y.status||U.status})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"KYC Status"}),(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded text-xs font-semibold ".concat("approved"===(Y.kycStatus||U.kycStatus)||"verified"===(Y.kycStatus||U.kycStatus)?"bg-green-600/20 text-green-400":"bg-gray-600/20 text-gray-400"),children:Y.kycStatus||U.kycStatus||"pending"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Registration Date"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:new Date(Y.createdAt||U.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Balance"}),(0,sa.jsxs)("p",{className:"text-white font-medium",children:["\u20b9",Y.balance||U.balance||0]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-purple-500/30",children:[(0,sa.jsxs)("h3",{className:"text-purple-400 font-semibold mb-4 text-lg flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),"KYC Documents"]}),Y.documents&&Y.documents.length>0?(0,sa.jsx)("div",{className:"space-y-6",children:Y.documents.map((e,t)=>{const s=(e=>{if(!e)return"Unknown";const t=e.toLowerCase();return"government_id"===t||"aadhaar"===t||"aadhar"===t?"Aadhaar Card":"pan_card"===t||"pan"===t?"PAN Card":e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ")})(e.type||e.documentType),a=s.includes("Aadhaar");return(0,sa.jsxs)("div",{className:"bg-slate-700/70 rounded-xl p-6 border-2 ".concat(a?"border-blue-500/50 shadow-lg shadow-blue-500/10":"border-purple-500/50 shadow-lg shadow-purple-500/10"),children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("div",{className:"flex items-center gap-3 mb-3",children:(0,sa.jsx)("span",{className:"px-4 py-2 rounded-lg text-sm font-bold ".concat(a?"bg-blue-600/30 text-blue-300 border border-blue-500/50":"bg-purple-600/30 text-purple-300 border border-purple-500/50"),children:s})}),(0,sa.jsx)("p",{className:"text-white font-semibold text-lg mb-2",children:e.name||e.fileName||"Document ".concat(t+1)}),e.uploadedAt&&(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["\ud83d\udcc5 Uploaded: ",new Date(e.uploadedAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})]})]}),(0,sa.jsx)("div",{className:"flex gap-2",children:e.url&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 hover:bg-blue-500 px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 shadow-md",children:[(0,sa.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview"]}),(0,sa.jsxs)("a",{href:e.url,download:!0,className:"bg-emerald-600 hover:bg-emerald-500 px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 shadow-md",children:[(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})]})})]}),e.url&&(0,sa.jsx)("div",{className:"mt-3",children:e.url.match(/\.(jpg|jpeg|png|gif)$/i)?(0,sa.jsx)("img",{src:e.url,alt:e.name||"Document",className:"max-w-full h-auto rounded-lg border border-slate-600 max-h-64",onError:e=>{e.target.style.display="none"}}):e.url.match(/\.pdf$/i)?(0,sa.jsx)("iframe",{src:e.url,className:"w-full h-64 rounded-lg border border-slate-600",title:e.name||"PDF Document"}):(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4 text-center",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Preview not available for this file type"}),(0,sa.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Click Preview or Download to view"})]})})]},e.id||t)})}):(0,sa.jsx)("div",{className:"text-center py-8",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"No KYC documents uploaded yet"})})]})]}):(0,sa.jsx)("div",{className:"text-center py-12",children:(0,sa.jsx)("p",{className:"text-red-400",children:"Failed to load player details"})}),(0,sa.jsx)("div",{className:"mt-6 flex justify-end",children:(0,sa.jsx)("button",{onClick:()=>{q(!1),z(null)},className:"bg-purple-600 hover:bg-purple-500 px-6 py-3 rounded-lg font-bold text-white text-lg transition-colors",children:"Close"})})]})}),K&&H&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-8 max-w-2xl w-full border-2 border-red-500 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white",children:"Suspend Player"}),(0,sa.jsx)("button",{onClick:()=>{W(!1),V(null),Q({type:"temporary",reason:"",duration:""})},className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-red-500/30",children:[(0,sa.jsxs)("p",{className:"text-white font-medium mb-1",children:["Player: ",(0,sa.jsx)("span",{className:"text-red-400",children:H.name})]}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Email: ",H.email]})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),J.reason&&J.reason.trim()?se.mutate({playerId:H.id,suspensionType:J.type,reason:J.reason.trim(),duration:"temporary"===J.type&&J.duration?J.duration:void 0}):wr.error("Please provide a reason for suspension")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Suspension Type *"}),(0,sa.jsxs)("select",{value:J.type,onChange:e=>Q((0,i.A)((0,i.A)({},J),{},{type:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",required:!0,children:[(0,sa.jsx)("option",{value:"temporary",children:"Temporary"}),(0,sa.jsx)("option",{value:"permanent",children:"Permanent"})]})]}),"temporary"===J.type&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Duration (days) *"}),(0,sa.jsx)("input",{type:"number",min:"1",value:J.duration,onChange:e=>Q((0,i.A)((0,i.A)({},J),{},{duration:e.target.value})),placeholder:"Enter number of days",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",required:"temporary"===J.type})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reason for Suspension *"}),(0,sa.jsx)("textarea",{value:J.reason,onChange:e=>Q((0,i.A)((0,i.A)({},J),{},{reason:e.target.value})),placeholder:"Enter detailed reason for suspending this player...",rows:4,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{W(!1),V(null),Q({type:"temporary",reason:"",duration:""})},className:"flex-1 bg-slate-700 hover:bg-slate-600 px-6 py-3 rounded-lg font-bold text-white text-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:se.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 px-6 py-3 rounded-lg font-bold text-white text-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:se.isLoading?(0,sa.jsxs)("span",{className:"flex items-center justify-center",children:[(0,sa.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,sa.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,sa.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Suspending..."]}):"Suspend Player"})]})]})]})]})}),me.open&&me.request&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full border border-blue-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("h2",{className:"text-xl font-bold text-white",children:["Document Comparison \u2014 ","government_id"===me.request.fieldName?"Govt ID (Aadhaar)":"PAN Card"]}),(0,sa.jsx)("button",{onClick:()=>he({open:!1,request:null,oldDocUrl:null,newDocUrl:null,loading:!1}),className:"text-gray-400 hover:text-white text-2xl",children:"\xd7"})]}),(0,sa.jsx)("div",{className:"mb-4 p-3 bg-slate-700/50 rounded-lg",children:(0,sa.jsxs)("p",{className:"text-sm text-gray-300",children:[(0,sa.jsx)("span",{className:"text-white font-medium",children:(null===(t=me.request.player)||void 0===t?void 0:t.name)||"".concat((null===(s=me.request.player)||void 0===s?void 0:s.first_name)||""," ").concat((null===(a=me.request.player)||void 0===a?void 0:a.last_name)||"").trim()||"Unknown Player"})," ","requested a document change on"," ",(0,sa.jsx)("span",{className:"text-blue-300",children:new Date(me.request.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),me.loading?(0,sa.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-400"}),(0,sa.jsx)("span",{className:"ml-3 text-gray-400",children:"Loading documents..."})]}):(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold text-red-300 flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"w-3 h-3 rounded-full bg-red-500"}),"Old Document"]}),(0,sa.jsx)("div",{className:"bg-slate-700 rounded-lg border border-slate-600 p-4 min-h-[200px] flex items-center justify-center",children:me.oldDocUrl?(0,sa.jsxs)("div",{className:"space-y-3 w-full",children:[(0,sa.jsx)("img",{src:me.oldDocUrl,alt:"Old document",className:"max-w-full max-h-[400px] rounded-lg border border-slate-600 mx-auto object-contain",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"}}),(0,sa.jsx)("div",{style:{display:"none"},className:"text-center",children:(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Cannot preview this file type"})}),(0,sa.jsx)("a",{href:me.oldDocUrl,target:"_blank",rel:"noopener noreferrer",className:"block text-center text-blue-400 hover:text-blue-300 text-sm underline",children:"Open in new tab"})]}):(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("p",{className:"text-4xl mb-2",children:"\ud83d\udcc4"}),(0,sa.jsx)("p",{className:"text-gray-500 text-sm",children:"No previous document found (first upload)"})]})})]}),(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold text-emerald-300 flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"w-3 h-3 rounded-full bg-emerald-500"}),"New Document (Uploaded)"]}),(0,sa.jsx)("div",{className:"bg-slate-700 rounded-lg border border-emerald-600/30 p-4 min-h-[200px] flex items-center justify-center",children:me.newDocUrl?(0,sa.jsxs)("div",{className:"space-y-3 w-full",children:[(0,sa.jsx)("img",{src:me.newDocUrl,alt:"New document",className:"max-w-full max-h-[400px] rounded-lg border border-emerald-600/30 mx-auto object-contain",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"}}),(0,sa.jsx)("div",{style:{display:"none"},className:"text-center",children:(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Cannot preview this file type"})}),(0,sa.jsx)("a",{href:me.newDocUrl,target:"_blank",rel:"noopener noreferrer",className:"block text-center text-emerald-400 hover:text-emerald-300 text-sm underline",children:"Open in new tab"})]}):(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("p",{className:"text-4xl mb-2",children:"\ud83d\udcc4"}),(0,sa.jsx)("p",{className:"text-gray-500 text-sm",children:"New document not found"})]})})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6 justify-end",children:[(0,sa.jsx)("button",{onClick:()=>{he({open:!1,request:null,oldDocUrl:null,newDocUrl:null,loading:!1}),xe.mutate({requestId:me.request.id})},disabled:xe.isLoading||me.loading,className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-2.5 rounded-lg text-sm font-semibold transition-colors disabled:opacity-50",children:"\u2713 Approve Change"}),(0,sa.jsx)("button",{onClick:()=>{he({open:!1,request:null,oldDocUrl:null,newDocUrl:null,loading:!1}),de(me.request.id)},disabled:me.loading,className:"bg-red-600 hover:bg-red-500 px-6 py-2.5 rounded-lg text-sm font-semibold transition-colors disabled:opacity-50",children:"\u2717 Reject Change"}),(0,sa.jsx)("button",{onClick:()=>he({open:!1,request:null,oldDocUrl:null,newDocUrl:null,loading:!1}),className:"bg-slate-700 hover:bg-slate-600 px-6 py-2.5 rounded-lg text-sm font-semibold transition-colors",children:"Close"})]})]})})]})}function md(e){let{clubId:t}=e;const s=ra(),[a,n]=(0,r.useState)(null),[l,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)("");(0,r.useEffect)(()=>{if(!t)return;const e=id.channel("buyout-requests-".concat(t)).on("postgres_changes",{event:"INSERT",schema:"public",table:"buyout_requests",filter:"club_id=eq.".concat(t)},e=>{console.log("\ud83d\udd14 [REALTIME] New buy-out request:",e.new),s.invalidateQueries({queryKey:["buyOutRequests",t]}),wr("\ud83d\udcb8 New buy-out request received!",{icon:"\ud83d\udd14"})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"buyout_requests",filter:"club_id=eq.".concat(t)},e=>{console.log("\ud83d\udd04 [REALTIME] Buy-out request updated:",e.new),s.invalidateQueries({queryKey:["buyOutRequests",t]})}).subscribe(e=>{"SUBSCRIBED"===e&&console.log("\u2705 [REALTIME] Subscribed to buy-out requests for club:",t)});return()=>{id.removeChannel(e)}},[t,s]);const{data:x=[],isLoading:p,refetch:b}=hn({queryKey:["buyOutRequests",t],queryFn:()=>jr.Od.getBuyOutRequests(t),enabled:!!t}),g=gn({mutationFn:e=>{let{requestId:s,amount:a}=e;return jr.Od.approveBuyOutRequest(t,s,{amount:a})},onSuccess:()=>{wr.success("Buy-out request approved and balance updated!"),s.invalidateQueries(["buyOutRequests",t]),n(null)},onError:e=>{wr.error(e.message||"Failed to approve buy-out request")}}),f=gn({mutationFn:e=>{let{requestId:s,reason:a}=e;return jr.Od.rejectBuyOutRequest(t,s,{reason:a})},onSuccess:()=>{wr.success("Buy-out request rejected!"),s.invalidateQueries(["buyOutRequests",t]),n(null),i(!1),u("")},onError:e=>{wr.error(e.message||"Failed to reject buy-out request")}}),y=e=>{if(!e)return"";return new Date(e).toLocaleString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"})},v=x.filter(e=>"pending"===e.status);return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Table Buy-Out Requests"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[v.length," pending request",1!==v.length?"s":""]})]}),p?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"Loading buy-out requests..."}):0===v.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No pending buy-out requests"}):(0,sa.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,sa.jsx)("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold text-white",children:e.playerName}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Table ",e.tableNumber]}),e.seatNumber&&(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Seat ",e.seatNumber]})]}),(0,sa.jsx)("div",{className:"text-lg font-semibold text-yellow-400 mb-2",children:"\ud83d\udcb0 Enter amount when approving"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Call time started: ",y(e.callTimeStartedAt)]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Requested at: ",y(e.requestedAt)]})]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{n(e),h(""),d(!0)})(e),disabled:g.isPending,className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors disabled:opacity-50",children:g.isPending?"Processing...":"Approve"}),(0,sa.jsx)("button",{onClick:()=>(e=>{n(e),i(!0)})(e),disabled:f.isPending,className:"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors disabled:opacity-50",children:"Reject"})]})]})},e.id))})]}),o&&a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 max-w-lg w-full mx-4",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold mb-4 text-white",children:"Process Table Cashout"}),(0,sa.jsx)("div",{className:"bg-slate-700 rounded-lg p-4 mb-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Player:"}),(0,sa.jsx)("span",{className:"text-white font-semibold ml-2",children:a.playerName})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Table:"}),(0,sa.jsxs)("span",{className:"text-white font-semibold ml-2",children:["Table ",a.tableNumber]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Seat:"}),(0,sa.jsx)("span",{className:"text-white font-semibold ml-2",children:a.seatNumber||"N/A"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Call Time:"}),(0,sa.jsx)("span",{className:"text-white font-semibold ml-2",children:y(a.callTimeStartedAt)})]})]})}),(0,sa.jsx)("div",{className:"bg-blue-900/30 border border-blue-700/50 rounded-lg p-4 mb-4",children:(0,sa.jsxs)("div",{className:"text-sm text-blue-200 space-y-2",children:[(0,sa.jsx)("p",{className:"font-semibold",children:"\ud83d\udca1 How Cashout Works:"}),(0,sa.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[(0,sa.jsxs)("li",{children:["Enter the ",(0,sa.jsx)("strong",{children:"final amount"})," player has at the table"]}),(0,sa.jsxs)("li",{children:["If player used credit, it will be ",(0,sa.jsx)("strong",{children:"paid back first"})]}),(0,sa.jsx)("li",{children:"Remaining amount goes to the player's wallet"}),(0,sa.jsx)("li",{children:"If the final amount is less than the credit used, the player owes the difference"})]})]})}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Final Table Amount (\u20b9) ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"number",value:m,onChange:e=>h(e.target.value),placeholder:"Enter final amount at table (can be 0)",min:"0",step:"1",className:"w-full bg-slate-700 text-white rounded-lg px-4 py-3 border border-slate-600 text-lg focus:border-blue-500 focus:outline-none",autoFocus:!0}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Enter 0 if player lost everything. System will calculate credit payback automatically."})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{const e=parseFloat(m);isNaN(e)||e<0?wr.error("Please enter a valid amount (can be 0 for no winnings)"):(g.mutate({requestId:a.id,amount:e}),d(!1),h(""))},disabled:g.isPending||""===m,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g.isPending?"Processing...":"Complete Cashout"}),(0,sa.jsx)("button",{onClick:()=>{d(!1),n(null),h("")},className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})}),l&&a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 max-w-md w-full mx-4",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold mb-4 text-white",children:"Reject Buy-Out Request"}),(0,sa.jsxs)("p",{className:"text-gray-300 mb-4",children:["Reject buy-out request for ",(0,sa.jsx)("strong",{children:a.playerName}),"?"]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Reason for Rejection ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),placeholder:"Enter reason for rejection...",rows:"4",className:"w-full bg-slate-700 text-white rounded-lg px-4 py-2 border border-slate-600",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{c.trim()?f.mutate({requestId:a.id,reason:c}):wr.error("Please provide a reason for rejection")},disabled:f.isPending||!c.trim(),className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors disabled:opacity-50",children:f.isPending?"Rejecting...":"Reject Request"}),(0,sa.jsx)("button",{onClick:()=>{i(!1),n(null),u("")},className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white font-semibold py-2 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})})]})}function hd(e){var t,s;let{clubId:a,gameType:n}=e;const l=ra(),[o,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)({sessionDate:(new Date).toISOString().split("T")[0],chipDenomination:"",totalRakeAmount:"",notes:""}),[x,p]=(0,r.useState)({startDate:"",endDate:"",tableId:"",page:1,limit:10}),{data:b=[],isLoading:g}=hn({queryKey:["activeTablesForRake",a],queryFn:()=>jr.Od.getActiveTablesForRakeCollection(a),enabled:!!a}),f=n?b.filter(e=>"rummy"===n?"RUMMY"===e.tableType:"RUMMY"!==e.tableType):b,{data:y,isLoading:v}=hn({queryKey:["rakeCollections",a,x],queryFn:()=>jr.Od.getRakeCollections(a,x),enabled:!!a}),w=y?(0,i.A)((0,i.A)({},y),{},{collections:n?(y.collections||[]).filter(e=>{var t;const s=(null===(t=e.table)||void 0===t?void 0:t.tableType)||e.tableType||"";return"rummy"===n?"RUMMY"===s:"RUMMY"!==s}):y.collections||[]}):y,j=(null===w||void 0===w?void 0:w.collections)||[],N={totalEntries:j.length,totalCollected:Number(j.reduce((e,t)=>e+Number(t.totalRakeAmount||0),0).toFixed(2)),avgPerTable:(()=>{const e=new Set(j.map(e=>e.tableNumber)),t=j.reduce((e,t)=>e+Number(t.totalRakeAmount||0),0);return e.size>0?Number((t/e.size).toFixed(2)):0})()},S=v,k=gn({mutationFn:e=>jr.Od.createRakeCollection(a,e),onSuccess:()=>{wr.success("Rake collection saved successfully!"),u(!1),h({sessionDate:(new Date).toISOString().split("T")[0],chipDenomination:"",totalRakeAmount:"",notes:""}),d(null),l.invalidateQueries(["rakeCollections",a]),l.invalidateQueries(["rakeCollectionStats",a])},onError:e=>{wr.error(e.message||"Failed to save rake collection")}}),C=()=>{h({sessionDate:(new Date).toISOString().split("T")[0],chipDenomination:"",totalRakeAmount:"",notes:""})},A=e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"})},_=e=>{if(!e)return"";return new Date(e).toLocaleString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"})};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white",children:["Collect Rake from ","rummy"===n?"Rummy":"poker"===n?"Poker":""," Table"]}),"rummy"===n&&(0,sa.jsx)("span",{className:"text-xs bg-emerald-900/40 text-emerald-300 border border-emerald-500/30 px-3 py-1 rounded-full",children:"Multiple collections per session"})]}),g?(0,sa.jsx)("div",{className:"text-gray-400",children:"Loading tables..."}):0===f.length?(0,sa.jsx)("div",{className:"text-gray-400",children:"No active tables available"}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:f.map(e=>(0,sa.jsxs)("div",{onClick:()=>(e=>{d(e),h((0,i.A)((0,i.A)({},m),{},{chipDenomination:"\u20b925, \u20b950, \u20b9100, \u20b9500"})),u(!0)})(e),className:"bg-slate-700 hover:bg-slate-600 rounded-lg p-4 cursor-pointer transition-colors border border-slate-600",children:[(0,sa.jsxs)("div",{className:"text-lg font-semibold text-white",children:["Table ",e.tableNumber]}),(0,sa.jsx)("div",{className:"text-sm text-gray-300 mt-1",children:e.tableType}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400 mt-1",children:[e.currentSeats,"/",e.maxSeats," seats"]})]},e.id))}),c&&o&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("h3",{className:"text-xl font-bold mb-4 text-white",children:["Collect Rake - Table ",o.tableNumber]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o&&k.mutate({tableId:o.id,sessionDate:m.sessionDate,chipDenomination:m.chipDenomination,totalRakeAmount:parseFloat(m.totalRakeAmount),notes:m.notes})},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Table ID ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"text",value:"Table ".concat(o.tableNumber),disabled:!0,className:"w-full bg-slate-700 text-gray-300 rounded-lg px-4 py-2 border border-slate-600"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Session Date ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"date",value:m.sessionDate,onChange:e=>h((0,i.A)((0,i.A)({},m),{},{sessionDate:e.target.value})),required:!0,className:"w-full bg-slate-700 text-white rounded-lg px-4 py-2 border border-slate-600"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Chip Denomination"}),(0,sa.jsx)("input",{type:"text",value:m.chipDenomination,onChange:e=>h((0,i.A)((0,i.A)({},m),{},{chipDenomination:e.target.value})),placeholder:"\u20b925, \u20b950, \u20b9100, \u20b9500",className:"w-full bg-slate-700 text-white rounded-lg px-4 py-2 border border-slate-600"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Total Rake Amount (\u20b9) ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"number",step:"0.01",min:"0",value:m.totalRakeAmount,onChange:e=>h((0,i.A)((0,i.A)({},m),{},{totalRakeAmount:e.target.value})),required:!0,placeholder:"\u20b90.00",className:"w-full bg-slate-700 text-white rounded-lg px-4 py-2 border border-slate-600"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes"}),(0,sa.jsx)("textarea",{value:m.notes,onChange:e=>h((0,i.A)((0,i.A)({},m),{},{notes:e.target.value})),placeholder:"Additional notes about the rake collection...",rows:"4",className:"w-full bg-slate-700 text-white rounded-lg px-4 py-2 border border-slate-600"})]}),(0,sa.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:k.isPending,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors disabled:opacity-50",children:k.isPending?"Saving...":"Collect Rake"}),(0,sa.jsx)("button",{type:"button",onClick:C,className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white font-semibold py-2 px-4 rounded-lg transition-colors border border-slate-500",children:"Clear Form"}),(0,sa.jsx)("button",{type:"button",onClick:()=>{u(!1),d(null),C()},className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white font-semibold py-2 px-4 rounded-lg transition-colors border border-slate-500",children:"Cancel"})]})]})]})})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white",children:["rummy"===n?"Rummy":"poker"===n?"Poker":""," Rake Collection History"]}),(0,sa.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,sa.jsx)("input",{type:"date",value:x.startDate,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{startDate:e.target.value,page:1})),placeholder:"Start Date",className:"bg-slate-700 text-white rounded-lg px-3 py-2 border border-slate-600 text-sm"}),(0,sa.jsx)("input",{type:"date",value:x.endDate,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{endDate:e.target.value,page:1})),placeholder:"End Date",className:"bg-slate-700 text-white rounded-lg px-3 py-2 border border-slate-600 text-sm"}),(0,sa.jsxs)("select",{value:x.tableId,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{tableId:e.target.value,page:1})),className:"bg-slate-700 text-white rounded-lg px-3 py-2 border border-slate-600 text-sm",children:[(0,sa.jsx)("option",{value:"",children:"All Tables"}),f.map(e=>(0,sa.jsxs)("option",{value:e.id,children:["Table ",e.tableNumber]},e.id))]}),(0,sa.jsxs)("button",{onClick:()=>{var e;const t=null===w||void 0===w||null===(e=w.collections)||void 0===e?void 0:e.map(e=>({"Table ID":e.tableNumber,"Session Date":A(e.sessionDate),"Rake Amount":e.totalRakeAmount,"Chip Denomination":e.chipDenomination||"",Notes:e.notes||"","Collected By":e.collectedByName||"","Collected At":_(e.collectedAt)})),s=[Object.keys(t[0]||{}).join(","),...t.map(e=>Object.values(e).map(e=>'"'.concat(e,'"')).join(","))].join("\n"),a=new Blob([s],{type:"text/csv"}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download="rake-collections-".concat((new Date).toISOString().split("T")[0],".csv"),n.click()},className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]})]})]}),S?(0,sa.jsx)("div",{className:"text-gray-400 mb-6",children:"Loading stats..."}):N&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:"Total Entries"}),(0,sa.jsx)("div",{className:"text-2xl font-bold text-white mt-1",children:N.totalEntries})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:"Total Collected"}),(0,sa.jsxs)("div",{className:"text-2xl font-bold text-green-400 mt-1",children:["\u20b9",N.totalCollected.toLocaleString("en-IN")]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:"Avg Collection Per Table"}),(0,sa.jsxs)("div",{className:"text-2xl font-bold text-white mt-1",children:["\u20b9",N.avgPerTable.toLocaleString("en-IN")]})]})]}),v?(0,sa.jsx)("div",{className:"text-gray-400",children:"Loading history..."}):0===(null===w||void 0===w||null===(t=w.collections)||void 0===t?void 0:t.length)?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No rake collections found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400 mb-4",children:["Showing ",(x.page-1)*x.limit+1," to ",Math.min(x.page*x.limit,(null===w||void 0===w?void 0:w.total)||0)," of ",(null===w||void 0===w?void 0:w.total)||0," entries"]}),(0,sa.jsx)("div",{className:"space-y-4",children:null===w||void 0===w||null===(s=w.collections)||void 0===s?void 0:s.map(e=>(0,sa.jsx)("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,sa.jsxs)("div",{className:"text-lg font-semibold text-white",children:["Table ",e.tableNumber]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Session Date: ",A(e.sessionDate)]})]}),(0,sa.jsxs)("div",{className:"text-xl font-bold text-green-400 mb-2",children:["\u20b9",Number(e.totalRakeAmount).toLocaleString("en-IN")]}),e.notes&&(0,sa.jsxs)("div",{className:"text-sm text-gray-300 mb-2",children:["Notes: ",e.notes]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Chip Denomination: ",e.chipDenomination||"N/A"]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400 mt-1",children:["Collected by: ",e.collectedByName||"N/A"," \u2022 ",_(e.collectedAt)]})]}),(0,sa.jsxs)("div",{className:"bg-green-600 text-white px-3 py-1 rounded-lg text-sm font-semibold flex items-center gap-1",children:[(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Collected"]})]})},e.id))}),w&&w.totalPages>1&&(0,sa.jsxs)("div",{className:"flex justify-center gap-2 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>p((0,i.A)((0,i.A)({},x),{},{page:x.page-1})),disabled:1===x.page,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsxs)("div",{className:"bg-slate-700 text-white px-4 py-2 rounded-lg",children:["Page ",x.page," of ",w.totalPages]}),(0,sa.jsx)("button",{onClick:()=>p((0,i.A)((0,i.A)({},x),{},{page:x.page+1})),disabled:x.page>=w.totalPages,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})}function xd(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("live-tables"),{data:n,isLoading:l}=(ra(),hn({queryKey:["tables",t],queryFn:()=>jr.rj.getTables(t),enabled:!!t})),{data:i,isLoading:o}=hn({queryKey:["waitlist",t],queryFn:()=>jr.IX.getWaitlist(t),enabled:!!t}),d=n||[],c=i||[];return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Tables & Waitlist"}),!t&&(0,sa.jsxs)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100 flex items-center gap-3",children:[(0,sa.jsx)("svg",{className:"w-6 h-6 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.3 2.647-1.3 3.412 0l7 12a1.5 1.5 0 01-1.302 2.25H2.847a1.5 1.5 0 01-1.302-2.25l7-12zM9 13a1 1 0 112 0v2a1 1 0 11-2 0v-2zm0-6a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})}),(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club from the sidebar dropdown to manage tables."})]}),(0,sa.jsx)("div",{className:"flex gap-2 border-b border-slate-700",children:[{id:"live-tables",label:"Live Tables"},{id:"table-management",label:"Table Management"},{id:"table-buy-in",label:"Table Buy-In"},{id:"table-buy-out",label:"Table Buy-Out"},{id:"rake-collection",label:"Rake Collection"},{id:"history",label:"History"}].map(e=>(0,sa.jsx)("button",{onClick:()=>a(e.id),className:"px-6 py-3 font-semibold transition-all ".concat(s===e.id?"bg-gradient-to-r from-blue-600 to-indigo-700 text-white border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:e.label},e.id))}),(0,sa.jsxs)("div",{className:"mt-6",children:["live-tables"===s&&(0,sa.jsx)(pd,{selectedClubId:t,tables:d,tablesLoading:l}),"table-management"===s&&(0,sa.jsx)(fd,{selectedClubId:t,tables:d,tablesLoading:l}),"table-buy-in"===s&&(0,sa.jsx)(yd,{selectedClubId:t,tables:d,waitlist:c,waitlistLoading:o}),"table-buy-out"===s&&(0,sa.jsx)(vd,{selectedClubId:t,tables:d}),"rake-collection"===s&&(0,sa.jsx)(hd,{clubId:t,gameType:"poker"}),"history"===s&&(0,sa.jsx)(wd,{selectedClubId:t,tables:d})]})]})}function pd(e){let{selectedClubId:t,tables:s,tablesLoading:a}=e;const[n,l]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)({minPlayTime:30,callTime:5,cashOutWindow:10,sessionTimeout:120}),[h,x]=(0,r.useState)("Active"),p=s.filter(e=>("AVAILABLE"===e.status||"OCCUPIED"===e.status)&&"RUMMY"!==e.tableType),b=e=>{if(!e.notes)return null;const t=e.notes.match(/Dealer:.*?\(([^)]+)\)/i);return t?t[1]:null},g=e=>{var t,s,a,r,n,l,i,d;c(e),o(!0);const u=e.notes?e.notes.split("|").map(e=>e.trim()):[],h=(null===(t=u[3])||void 0===t||null===(s=t.match(/\d+/))||void 0===s?void 0:s[0])||"30",p=(null===(a=u[4])||void 0===a||null===(r=a.match(/\d+/))||void 0===r?void 0:r[0])||"5",b=(null===(n=u[5])||void 0===n||null===(l=n.match(/\d+/))||void 0===l?void 0:l[0])||"10",g=(null===(i=u[6])||void 0===i||null===(d=i.match(/\d+/))||void 0===d?void 0:d[0])||"120";m({minPlayTime:parseInt(h),callTime:parseInt(p),cashOutWindow:parseInt(b),sessionTimeout:parseInt(g)}),x("OCCUPIED"===e.status?"Active":"Paused")};return(0,sa.jsxs)("div",{className:"space-y-6",children:[i&&d&&(0,sa.jsx)(bd,{table:d,tables:p,sessionParams:u,setSessionParams:m,sessionStatus:h,setSessionStatus:x,clubId:t,onClose:()=>{o(!1),c(null)},onSelectTable:e=>{c(e),g(e)}}),!i&&(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Live Tables - Hologram View"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Manage live tables, seat players, and handle buy-ins using table hologram."})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 px-4 py-2 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Active Tables: ",p.length]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Total Players: ",p.reduce((e,t)=>e+(t.currentSeats||0),0)]})]})]}),a?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading tables..."})]}):0===p.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfb2"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No active tables"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Create and activate tables in Table Management"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600 hover:border-blue-500 transition-all cursor-pointer",onClick:()=>l(e),children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h3",{className:"text-lg font-bold text-white",children:["Table ",e.tableNumber]}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.tableType})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("OCCUPIED"===e.status?"bg-green-600/20 text-green-400":"bg-blue-600/20 text-blue-400"),children:e.status})]}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:["\u20b9",e.minBuyIn||0,"/\u20b9",e.maxBuyIn||0]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Occupied Seats:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:[e.currentSeats||0," / ",e.maxSeats]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Available Seats:"}),(0,sa.jsx)("span",{className:"text-green-400 font-medium",children:e.maxSeats-(e.currentSeats||0)})]}),b(e)&&(0,sa.jsxs)("div",{className:"flex justify-between text-sm pt-1 border-t border-slate-600",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"\ud83d\udc64 Dealer:"}),(0,sa.jsx)("span",{className:"text-purple-400 font-semibold",children:b(e)})]})]}),(0,sa.jsxs)("button",{onClick:t=>{t.stopPropagation(),l(e)},className:"w-full mt-4 bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-500 hover:to-indigo-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83c\udfaf"}),(0,sa.jsx)("span",{children:"View Table Hologram"})]}),(0,sa.jsxs)("button",{onClick:t=>{t.stopPropagation(),g(e)},className:"w-full mt-2 bg-gradient-to-r from-purple-600 to-pink-700 hover:from-purple-500 hover:to-pink-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\u2699\ufe0f"}),(0,sa.jsx)("span",{children:"Edit Session Control"})]})]},e.id))})]}),n&&(0,sa.jsx)(gd,{table:n,onClose:()=>l(null),clubId:t})]})}function bd(e){let{table:t,tables:s,sessionParams:a,setSessionParams:n,sessionStatus:l,setSessionStatus:o,clubId:d,onClose:c,onSelectTable:u}=e;const m=ra(),[h,x]=(0,r.useState)(d),[p,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)([]),[y,v]=(0,r.useState)({}),[w,j]=(0,r.useState)("");(0,r.useEffect)(()=>{d&&x(d)},[d]);const N=gn({mutationFn:async()=>{if(!h)throw new Error("Club ID not found");return await jr.rj.pauseSession(h,t.id)},onSuccess:()=>{o("Paused"),wr.success("Session paused successfully"),m.invalidateQueries(["tables",h])},onError:e=>{wr.error(e.message||"Failed to pause session")}}),S=gn({mutationFn:async()=>{if(!h)throw new Error("Club ID not found");return await jr.rj.resumeSession(h,t.id)},onSuccess:()=>{o("Active"),wr.success("Session resumed successfully"),m.invalidateQueries(["tables",h])},onError:e=>{wr.error(e.message||"Failed to resume session")}}),k=gn({mutationFn:async e=>{if(!h)throw new Error("Club ID not found");return await jr.rj.settleAndEndSession(h,t.id,e)},onSuccess:()=>{wr.success("All players settled and session ended successfully!"),m.invalidateQueries(["tables",h]),b(!1),c()},onError:e=>{wr.error(e.message||"Failed to settle and end session")}}),C=gn({mutationFn:async e=>{if(!h)throw new Error("Club ID not found");return await jr.rj.updateSessionParams(h,t.id,e)},onSuccess:e=>{wr.success("Session parameters updated successfully"),m.invalidateQueries(["tables",h]),e.sessionParams&&n(e.sessionParams)},onError:e=>{wr.error(e.message||"Failed to update session parameters")}}),A=(e,t)=>{const s={[e]:parseInt(t)};C.mutate(s)},_=e=>{const t=e.notes?e.notes.split("|").map(e=>e.trim()):[];return t[1]||e.tableType};return(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-blue-900/50 via-purple-900/50 to-indigo-900/50 rounded-2xl p-8 border-2 border-blue-500/30 shadow-2xl",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white",children:"Table Session Control"}),(0,sa.jsx)("button",{onClick:c,className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Table Sessions"}),(0,sa.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,sa.jsx)("div",{onClick:()=>u(e),className:"p-4 rounded-lg cursor-pointer transition-all ".concat(e.id===t.id?"bg-blue-600/30 border-2 border-blue-500":"bg-slate-700/50 border border-slate-600 hover:bg-slate-700"),children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"font-semibold text-white",children:["Table ",e.tableNumber," - ",_(e).split(" | ")[0]]}),(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:_(e)})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("OCCUPIED"===e.status?"bg-green-600/20 text-green-400":"bg-yellow-600/20 text-yellow-400"),children:"OCCUPIED"===e.status?"Active":"Paused"})]})},e.id))}),(0,sa.jsxs)("div",{className:"mt-6 p-4 bg-blue-600/20 border border-blue-500/30 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-sm text-blue-300 mb-2",children:["Selected: Table ",t.tableNumber," - ",_(t).split(" | ")[0]]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Game:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:_(t)})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:(e=>{var t;const s=e.notes?e.notes.split("|").map(e=>e.trim()):[];return(null===(t=s[2])||void 0===t?void 0:t.replace("Stakes:","").trim())||"\u20b9".concat(e.minBuyIn||0,"/\u20b9").concat(e.maxBuyIn||0)})(t)})]})]}),(0,sa.jsxs)("div",{className:"text-sm mt-2",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Players:"}),(0,sa.jsxs)("span",{className:"text-white ml-2",children:[t.currentSeats||0,"/",t.maxSeats]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Session Actions"}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm mb-2",children:"Current Status"}),(0,sa.jsx)("div",{className:"text-4xl font-bold ".concat("Active"===l?"text-green-400":"text-yellow-400"),children:l})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("button",{onClick:()=>{"Active"===l?N.mutate():S.mutate()},className:"w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white px-6 py-4 rounded-lg font-bold text-lg transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"Active"===l?"\u23f8":"\u25b6"}),(0,sa.jsx)("span",{children:"Active"===l?"Pause Session":"Resume Session"})]}),(0,sa.jsxs)("button",{onClick:async()=>{if(h)try{const e=await jr.rj.getSeatedPlayersForTable(h,t.id);if(e.seatedPlayers&&e.seatedPlayers.length>0){f(e.seatedPlayers);const t={};e.seatedPlayers.forEach(e=>{t[e.playerId]=0}),v(t),b(!0)}else window.confirm("No players are seated. End this session?")&&(await jr.rj.endSession(h,t.id),wr.success("Session ended successfully"),m.invalidateQueries(["tables",h]),c())}catch(e){console.error("Error fetching seated players:",e),wr.error("Failed to fetch seated players")}else wr.error("Club ID not found")},className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white px-6 py-4 rounded-lg font-bold text-lg transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\u2b1b"}),(0,sa.jsx)("span",{children:"End Session"})]})]}),(0,sa.jsx)("div",{className:"mt-6 p-4 bg-slate-700/50 rounded-lg",children:(0,sa.jsx)("p",{className:"text-sm text-gray-400 text-center",children:"Session parameters can be modified on the right panel."})})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Timing & Parameters"}),(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm font-medium mb-2",children:"MIN PLAY TIME"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("input",{type:"number",value:a.minPlayTime,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{minPlayTime:e.target.value})),className:"flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-lg font-semibold",min:"30"}),(0,sa.jsx)("button",{onClick:()=>A("minPlayTime",a.minPlayTime),className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-white font-semibold transition-colors",children:"Set"})]}),(0,sa.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Current: ",a.minPlayTime," mins"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm font-medium mb-2",children:"CALL TIME"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("input",{type:"number",value:a.callTime,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{callTime:e.target.value})),className:"flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-lg font-semibold",min:"1"}),(0,sa.jsx)("button",{onClick:()=>A("callTime",a.callTime),className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-white font-semibold transition-colors",children:"Set"})]}),(0,sa.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Current: ",a.callTime," mins"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm font-medium mb-2",children:"CASH-OUT WINDOW"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("input",{type:"number",value:a.cashOutWindow,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{cashOutWindow:e.target.value})),className:"flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-lg font-semibold",min:"1"}),(0,sa.jsx)("button",{onClick:()=>A("cashOutWindow",a.cashOutWindow),className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-white font-semibold transition-colors",children:"Set"})]}),(0,sa.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Current: ",a.cashOutWindow," mins"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm font-medium mb-2",children:"SESSION TIMEOUT"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("input",{type:"number",value:a.sessionTimeout,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{sessionTimeout:e.target.value})),className:"flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-lg font-semibold",min:"30"}),(0,sa.jsx)("button",{onClick:()=>A("sessionTimeout",a.sessionTimeout),className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-white font-semibold transition-colors",children:"Set"})]}),(0,sa.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Current: ",a.sessionTimeout," mins"]})]})]})]})]}),p&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto border-2 border-red-500/50 shadow-2xl",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white",children:"\ud83d\udcb0 Settle All Players"}),(0,sa.jsx)("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsx)("div",{className:"mb-6 p-4 bg-red-600/20 border border-red-500/30 rounded-lg",children:(0,sa.jsx)("p",{className:"text-sm text-red-300",children:"\u26a0\ufe0f Enter the cash-out amount for each seated player. This will create transactions, update balances, unseat all players, and end the session."})}),(0,sa.jsx)("div",{className:"space-y-4 mb-6",children:g.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-slate-600",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:e.playerName}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Seat #",e.seatNumber]})]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Seated ",new Date(e.seatedAt).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-3 text-sm",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/60 rounded px-3 py-2 text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:"Buy-In"}),(0,sa.jsxs)("div",{className:"text-cyan-400 font-semibold",children:["\u20b9",(e.buyInAmount||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/60 rounded px-3 py-2 text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:"Wallet Balance"}),(0,sa.jsxs)("div",{className:"font-semibold ".concat((e.walletBalance||0)>=0?"text-green-400":"text-red-400"),children:["\u20b9",(e.walletBalance||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/60 rounded px-3 py-2 text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:"Credits"}),(0,sa.jsx)("div",{className:"text-yellow-400 font-semibold",children:(e.totalCredits||0)>0?"\u20b9".concat((e.totalCredits||0).toLocaleString()):"-"})]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Cash-out Amount:"}),(0,sa.jsx)("input",{type:"number",value:y[e.playerId]||0,onChange:t=>{return s=e.playerId,a=t.target.value,void v(e=>(0,i.A)((0,i.A)({},e),{},{[s]:parseFloat(a)||0}));var s,a},className:"flex-1 px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-lg font-semibold",placeholder:"Enter amount",min:"0",step:"100"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:"\u20b9"})]})]},e.playerId))}),(0,sa.jsxs)("div",{className:"flex items-center justify-between p-4 bg-blue-600/20 border border-blue-500/30 rounded-lg mb-4",children:[(0,sa.jsx)("span",{className:"text-blue-300 font-semibold",children:"Total Settlement:"}),(0,sa.jsxs)("span",{className:"text-white text-2xl font-bold",children:["\u20b9",Object.values(y).reduce((e,t)=>e+(parseFloat(t)||0),0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"p-4 bg-amber-600/20 border border-amber-500/30 rounded-lg mb-6",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-amber-300 font-semibold whitespace-nowrap",children:"\ud83c\udfb0 Session Rake:"}),(0,sa.jsx)("input",{type:"number",value:w,onChange:e=>j(e.target.value),className:"flex-1 px-4 py-2 bg-slate-600 border border-amber-500/50 rounded-lg text-white text-lg font-semibold",placeholder:"Enter rake amount (optional)",min:"0",step:"100"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:"\u20b9"})]}),(0,sa.jsx)("p",{className:"text-amber-300/70 text-xs mt-2",children:"Rake will be recorded for this session automatically"})]}),(0,sa.jsxs)("div",{className:"flex gap-4",children:[(0,sa.jsx)("button",{onClick:()=>b(!1),className:"flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{onClick:()=>{const e=Object.entries(y).map(e=>{let[t,s]=e;return{playerId:t,amount:parseFloat(s)||0}}),t=parseFloat(w)||0,s=e.reduce((e,t)=>e+t.amount,0),a=t>0?"Settle ".concat(e.length," players for a total of \u20b9").concat(s," with \u20b9").concat(t," rake? This will end the session."):"Settle ".concat(e.length," players for a total of \u20b9").concat(s,"? This will end the session.");window.confirm(a)&&k.mutate({settlements:e,rakeAmount:t||void 0})},disabled:k.isLoading,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 disabled:from-gray-600 disabled:to-gray-600 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:k.isLoading?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("span",{className:"animate-spin",children:"\u23f3"}),(0,sa.jsx)("span",{children:"Processing..."})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("span",{children:"\u2705"}),(0,sa.jsx)("span",{children:"Settle & End Session"})]})})]})]})})]})}function gd(e){var t,s,a,n,l,i,o,d;let{table:c,onClose:u,clubId:m}=e;const h=ra(),[x,p]=(0,r.useState)(null),[b,g]=(0,r.useState)("00:00:00"),[f,y]=(0,r.useState)([]),[v,w]=(0,r.useState)("view"),[j,N]=(0,r.useState)([]),S=(()=>{if(!c.notes)return null;const e=c.notes.match(/Dealer:\s*([a-f0-9-]{36})\s*\(([^)]+)\)/i);return e?{id:e[1],name:e[2]}:null})();(0,r.useEffect)(()=>{const e=async()=>{try{const e=localStorage.getItem("token"),t=localStorage.getItem("userId"),s=localStorage.getItem("tenantId"),a=await fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_API_URL||"http://localhost:3333/api","/clubs/").concat(m,"/tables/").concat(c.id,"/seated-players"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"x-user-id":t||"","x-tenant-id":s||"","x-club-id":m}});if(a.ok){const e=await a.json();y(e.seatedPlayers||[])}}catch(e){console.error("Error fetching seated players:",e)}};if(m&&null!==c&&void 0!==c&&c.id){e();const t=setInterval(e,5e3);return()=>clearInterval(t)}},[m,null===c||void 0===c?void 0:c.id]),(0,r.useEffect)(()=>{m&&null!==c&&void 0!==c&&c.tableNumber&&"history"===v&&(async()=>{if("history"===v)try{const e=localStorage.getItem("token"),t=localStorage.getItem("userId"),s=localStorage.getItem("tenantId"),a=await fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_API_URL||"http://localhost:3333/api","/clubs/").concat(m,"/transactions?tableNumber=").concat(c.tableNumber),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"x-user-id":t||"","x-tenant-id":s||"","x-club-id":m}});if(a.ok){const e=(await a.json()).filter(e=>{var t,s,a;return("Table Buy In"===e.type||"Table Buy Out"===e.type||"Club Buy In"===e.type||"Buy In"===e.type||"Credit"===e.type||"Debit"===e.type||"Deposit"===e.type&&(null===(t=e.notes)||void 0===t?void 0:t.includes("Table ".concat(c.tableNumber))))&&((null===(s=e.notes)||void 0===s?void 0:s.includes("Table ".concat(c.tableNumber)))||(null===(a=e.description)||void 0===a?void 0:a.includes("Table ".concat(c.tableNumber))))}).sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt));N(e)}}catch(e){console.error("Error fetching table history:",e)}})()},[m,null===c||void 0===c?void 0:c.tableNumber,v]);const k=gn({mutationFn:async()=>{if(!c||!S)return;const e=(c.notes||"").replace(/\s*\|\s*Dealer:.*$/i,"").trim();return jr.rj.updateTable(m,c.id,{notes:e})},onSuccess:()=>{wr.success("Dealer unassigned successfully"),h.invalidateQueries(["tables",m]),h.invalidateQueries(["staff",m]),h.invalidateQueries(["all-tables",m]),h.invalidateQueries(["rummy-tables",m]),u()},onError:e=>{wr.error(e.message||"Failed to unassign dealer")}}),C=()=>{window.confirm('Are you sure you want to unassign dealer "'.concat(S.name,'" from this table?'))&&k.mutate()};(0,r.useEffect)(()=>{m&&(async()=>{try{const e=localStorage.getItem("token"),t=localStorage.getItem("userId"),s=localStorage.getItem("tenantId"),a=await fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_API_URL||"http://localhost:3333/api","/clubs/").concat(m),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"x-user-id":t||"","x-tenant-id":s||"","x-club-id":m}});if(a.ok){const e=await a.json();p(e)}else console.error("Failed to fetch club data:",a.status,await a.text())}catch(e){console.error("Error fetching club data:",e)}})()},[m]),(0,r.useEffect)(()=>{var e,t;if(!c)return void g("00:00:00");if("AVAILABLE"===c.status||"PAUSED"===c.status){var s;const e=null===(s=c.notes)||void 0===s?void 0:s.match(/Paused Elapsed: (\d+)/);if(e){const t=parseInt(e[1],10);if(!isNaN(t)&&t>=0){const e=Math.floor(t/3600),s=Math.floor(t%3600/60),a=t%60;g("".concat(String(e).padStart(2,"0"),":").concat(String(s).padStart(2,"0"),":").concat(String(a).padStart(2,"0")))}else g("00:00:00")}else g("00:00:00");return}if("OCCUPIED"!==c.status)return void g("00:00:00");const a=null===(e=c.notes)||void 0===e?void 0:e.match(/Session Started: ([^|]+)/),r=null===(t=c.notes)||void 0===t?void 0:t.match(/Paused Elapsed: (\d+)/);if(!a||!a[1])return console.warn("No session start time found in notes:",c.notes),void g("00:00:00");const n=a[1].trim(),l=new Date(n);if(isNaN(l.getTime()))return console.error("Invalid session start time:",n,"Full notes:",c.notes),void g("00:00:00");const i=r?parseInt(r[1],10):0;(isNaN(i)||i<0)&&console.warn("Invalid paused elapsed time, using 0:",null===r||void 0===r?void 0:r[1]);const o=()=>{const e=(new Date).getTime()-l.getTime();if(isNaN(e))return void g("00:00:00");const t=Math.floor(e/1e3)+i;if(isNaN(t)||t<0)return void g("00:00:00");const s=Math.floor(t/3600),a=Math.floor(t%3600/60),r=t%60;g("".concat(String(s).padStart(2,"0"),":").concat(String(a).padStart(2,"0"),":").concat(String(r).padStart(2,"0")))};o();const d=setInterval(o,1e3);return()=>clearInterval(d)},[c]);const A=Array.from({length:c.maxSeats},(e,t)=>t+1),_=f.map(e=>e.seatNumber).filter(Boolean),P=f.reduce((e,t)=>{const s=t.buyInAmount||t.sessionBuyInAmount||0;return console.log("[TABLE VALUE] Player: ".concat(t.playerName,", Buy-In: ").concat(s)),e+Number(s)},0);console.log("[TABLE VALUE] Total: \u20b9".concat(P,", Players:"),f);const T=c.notes?c.notes.split("|").map(e=>e.trim()):[],E=(null===x||void 0===x?void 0:x.logoUrl)||null,I=(null===(t=c.notes)||void 0===t||null===(s=t.match(/Game Type: ([^|]+)/))||void 0===s||null===(a=s[1])||void 0===a?void 0:a.trim())||T[1]||c.tableType,R=(null===(n=c.notes)||void 0===n||null===(l=n.match(/Stakes: ([^|]+)/))||void 0===l||null===(i=l[1])||void 0===i?void 0:i.trim())||(null===(o=T[2])||void 0===o?void 0:o.replace("Stakes:","").trim())||"\u20b9".concat(c.minBuyIn||0,"/\u20b9").concat(c.maxBuyIn||0);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-8 max-w-4xl w-full border-2 border-blue-500 shadow-2xl max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h2",{className:"text-3xl font-bold text-white",children:["Table ",c.tableNumber," - ",I]}),(0,sa.jsxs)("p",{className:"text-gray-400",children:["Stakes: ",R]})]})}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700 mb-6",children:[(0,sa.jsx)("button",{onClick:()=>w("view"),className:"px-4 py-2 font-semibold transition-all ".concat("view"===v?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:"Live View"}),(0,sa.jsx)("button",{onClick:()=>w("history"),className:"px-4 py-2 font-semibold transition-all ".concat("history"===v?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:"History"})]}),"view"===v?(0,sa.jsxs)(sa.Fragment,{children:[S&&(0,sa.jsxs)("div",{className:"mb-4 flex items-center justify-center gap-3 bg-purple-900/30 border border-purple-600/50 rounded-lg p-3",children:[(0,sa.jsxs)("span",{className:"text-purple-300 font-semibold",children:["Dealer: ",S.name]}),(0,sa.jsx)("button",{onClick:C,disabled:k.isLoading,className:"hover:bg-purple-700 rounded-full p-0.5 transition-colors disabled:opacity-50",title:"Unassign Dealer",children:(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsx)("div",{className:"mb-6 flex justify-center",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-yellow-600 to-orange-600 px-6 py-3 rounded-2xl shadow-xl border-2 border-yellow-400",children:[(0,sa.jsx)("div",{className:"text-xs text-yellow-100 text-center mb-1",children:"TABLE VALUE"}),(0,sa.jsxs)("div",{className:"text-3xl font-bold text-white text-center",children:["\u20b9",P.toLocaleString()]})]})}),(0,sa.jsxs)("div",{className:"relative w-full",style:{aspectRatio:"1.8 / 1"},children:[(0,sa.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-900 via-yellow-900 to-amber-950 shadow-2xl",style:{borderRadius:"50%"},children:(0,sa.jsx)("div",{className:"absolute inset-[10px] bg-gradient-to-br from-slate-600 via-slate-500 to-slate-600",style:{borderRadius:"50%"},children:(0,sa.jsx)("div",{className:"absolute inset-[8px] bg-gradient-to-br from-emerald-700 via-green-800 to-emerald-900 shadow-inner",style:{borderRadius:"50%"},children:(0,sa.jsx)("div",{className:"absolute inset-[30px] border border-emerald-600/30",style:{borderRadius:"50%"}})})})}),(0,sa.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:(0,sa.jsx)("div",{className:"w-24 h-24 bg-white/15 rounded-full border-2 border-white/25 flex items-center justify-center shadow-xl backdrop-blur-sm overflow-hidden",children:E?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("img",{src:E,alt:"Club Logo",className:"w-full h-full object-contain rounded-full p-2",onError:e=>{e.target.style.display="none";const t=e.target.parentElement.querySelector(".logo-fallback");t&&(t.style.display="flex")}}),(0,sa.jsx)("div",{className:"logo-fallback text-3xl font-bold text-white/40 hidden items-center justify-center w-full h-full",children:"\u2660"})]}):(0,sa.jsx)("div",{className:"text-3xl font-bold text-white/40",children:"\u2660"})})}),(0,sa.jsxs)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center z-20",children:[S&&(0,sa.jsxs)("div",{className:"mb-2 bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-bold shadow-lg flex items-center gap-2",children:[(0,sa.jsxs)("span",{children:["\ud83d\udc64 ",S.name]}),(0,sa.jsx)("button",{onClick:e=>{e.stopPropagation(),C()},disabled:k.isLoading,className:"hover:bg-purple-700 rounded-full p-0.5 transition-colors disabled:opacity-50",title:"Unassign Dealer",children:(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsx)("div",{className:"bg-yellow-600 text-white px-3 py-1 rounded-full text-sm font-bold",children:"D"})]}),A.map(e=>{var t;const s=(360/c.maxSeats*(e-1)-90)*(Math.PI/180),a=50+42*Math.cos(s),r=50+40*Math.sin(s),n=_.includes(e),l=f.find(t=>t.seatNumber===e);return(0,sa.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 z-20",style:{left:"".concat(a,"%"),top:"".concat(r,"%")},children:[(0,sa.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center font-bold text-lg transition-all cursor-pointer ".concat(n?"bg-blue-600 text-white border-2 border-blue-400 shadow-lg shadow-blue-500/30":"bg-slate-700 text-gray-400 border-2 border-slate-600 hover:border-blue-500"),title:l?l.playerName:"Seat ".concat(e),children:n&&l?null===(t=l.playerName)||void 0===t?void 0:t.split(" ").map(e=>e.charAt(0)).join("").substring(0,2).toUpperCase():e}),(0,sa.jsx)("div",{className:"text-center text-xs text-white mt-1 whitespace-nowrap max-w-[80px] overflow-hidden text-ellipsis",children:n&&l?l.playerName:"Seat ".concat(e)}),n&&l&&l.buyInAmount>0&&(0,sa.jsxs)("div",{className:"text-center text-[10px] text-yellow-300 bg-slate-800/80 px-1 rounded mt-0.5",children:["\u20b9",Number(l.buyInAmount).toLocaleString()]})]},e)})]}),(0,sa.jsxs)("div",{className:"mt-6 grid grid-cols-4 gap-4 bg-slate-800 p-4 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Players"}),(0,sa.jsxs)("div",{className:"text-white font-bold text-xl",children:[c.currentSeats||0,"/",c.maxSeats]})]}),(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Table Value"}),(0,sa.jsxs)("div",{className:"text-yellow-400 font-bold text-xl",children:["\u20b9",P.toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Buy-In Range"}),(0,sa.jsxs)("div",{className:"text-white font-bold text-lg",children:["\u20b9",(c.minBuyIn||0).toLocaleString()," - \u20b9",(c.maxBuyIn||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Status"}),(0,sa.jsx)("div",{className:"font-bold text-xl ".concat("OCCUPIED"===c.status?"text-green-400":"AVAILABLE"===c.status?"text-yellow-400":"text-gray-400"),children:"OCCUPIED"===c.status?"Active":"AVAILABLE"===c.status?"Waiting":c.status})]})]}),("OCCUPIED"===c.status||"AVAILABLE"===c.status&&(null===(d=c.notes)||void 0===d?void 0:d.includes("Paused Elapsed")))&&(0,sa.jsxs)("div",{className:"mt-4 bg-gradient-to-r from-blue-600 to-purple-600 p-4 rounded-lg text-center",children:[(0,sa.jsx)("div",{className:"text-blue-100 text-sm mb-1",children:"SESSION RUNNING TIME"}),(0,sa.jsx)("div",{className:"text-white font-bold text-3xl font-mono",children:b})]}),(0,sa.jsx)("div",{className:"mt-6 flex justify-end",children:(0,sa.jsx)("button",{onClick:u,className:"bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded-lg font-bold text-white transition-colors",children:"Close"})})]}):(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Buy-In & Buy-Out History"}),0===j.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No transaction history for this table yet."}):(0,sa.jsx)("div",{className:"space-y-3",children:j.map((e,t)=>{var s;const a=["Table Buy In","Buy In","Club Buy In","Credit"].includes(e.type);["Table Buy Out","Debit"].includes(e.type)||"Deposit"===e.type&&(null===(s=e.notes)||void 0===s||s.includes("buy-out"));return(0,sa.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat(a?"bg-green-900/20 border-green-600/50":"bg-orange-900/20 border-orange-600/50"),children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsx)("div",{className:"flex-1",children:(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-2xl ".concat(a?"\ud83d\udcb0":"\ud83d\udcb5"),children:a?"\ud83d\udcb0":"\ud83d\udcb5"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-bold text-white",children:e.playerName||e.player_name||"Unknown Player"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[a?"Buy-In":"Buy-Out",e.notes&&" \u2022 ".concat(e.notes)]}),(0,sa.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]})]})}),(0,sa.jsxs)("div",{className:"text-right ".concat(a?"text-green-400":"text-orange-400"),children:[(0,sa.jsxs)("div",{className:"font-bold text-2xl",children:[a?"+":"","\u20b9",Number(e.amount).toLocaleString()]}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:e.status})]})]})},e.id||t)})}),(0,sa.jsx)("div",{className:"mt-6 flex justify-end",children:(0,sa.jsx)("button",{onClick:u,className:"bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded-lg font-bold text-white transition-colors",children:"Close"})})]})]})})}function fd(e){let{selectedClubId:t,tables:s,tablesLoading:a}=e;const[n,l]=(0,r.useState)("all"),[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),m=s.filter(e=>"RUMMY"!==e.tableType),[h,x]=(0,r.useState)({tableName:"",tableNumber:"",gameType:"Texas Hold'em",customGameType:"",maxSeats:8,stakes:"",minPlayTime:"30",callTime:5,cashOutWindow:10,sessionTimeout:120,tableType:"CASH",minBuyIn:"",maxBuyIn:"",notes:""}),[p,b]=(0,r.useState)(null),g=ra(),[f,y]=(0,r.useState)("30"),{data:v,isLoading:w}=hn({queryKey:["staff",t],queryFn:()=>jr.staffAPI.getStaff(t),enabled:!!t}),j=(null===v||void 0===v?void 0:v.filter(e=>"Dealer"===e.role&&"Active"===e.status))||[],N=(new Date).toISOString().split("T")[0],{data:S}=hn({queryKey:["dealersOnLeave",t,N],queryFn:()=>jr.iw.getDealers(t,N),enabled:!!t}),{data:k}=hn({queryKey:["availableDealersForToday",t,N],queryFn:()=>jr.iw.getAvailableDealersForDate(t,N),enabled:!!t}),C=(null===S||void 0===S?void 0:S.dealers)||[],A=new Set(j.filter(e=>!C.find(t=>t.id===e.id)).map(e=>e.id)),_=new Set(s.filter(e=>("OCCUPIED"===e.status||"RESERVED"===e.status)&&e.notes).map(e=>{var t;const s=null===(t=e.notes)||void 0===t?void 0:t.match(/Dealer:\s*([a-f0-9-]{36})/i);return s?s[1]:null}).filter(Boolean)),P=((null===k||void 0===k?void 0:k.dealers)||[]).filter(e=>!_.has(e.id)&&"rummy"!==e.gameType),T=j.filter(e=>!_.has(e.id)&&!A.has(e.id)&&"rummy"!==e.gameType),E=gn({mutationFn:async e=>{let{tableId:s,dealerId:a}=e;const r=m.find(e=>e.id===s),n=j.find(e=>e.id===a);if(!r||!n)throw new Error("Table or dealer not found");const l=(r.notes||"").replace(/\s*\|\s*Dealer:.*$/i,""),i="".concat(l," | Dealer: ").concat(n.id," (").concat(n.name,")").trim();return jr.rj.updateTable(t,s,{notes:i})},onSuccess:()=>{wr.success("Dealer assigned successfully"),d(""),u(""),g.invalidateQueries(["tables",t]),g.invalidateQueries(["staff",t]),g.invalidateQueries(["all-tables",t]),g.invalidateQueries(["rummy-tables",t])},onError:e=>{wr.error(e.message||"Failed to assign dealer")}}),I=gn({mutationFn:e=>jr.rj.createTable(t,e),onSuccess:()=>{wr.success("Table created successfully"),x({tableName:"",tableNumber:"",gameType:"Texas Hold'em",customGameType:"",maxSeats:8,stakes:"",minPlayTime:"30",callTime:5,cashOutWindow:10,sessionTimeout:120,tableType:"CASH",minBuyIn:"",maxBuyIn:"",notes:""}),y("30"),l("all"),g.invalidateQueries(["tables",t])},onError:e=>{wr.error(e.message||"Failed to create table")}}),R=gn({mutationFn:e=>{let{tableId:s,data:a}=e;return jr.rj.updateTable(t,s,a)},onSuccess:()=>{wr.success("Table updated successfully"),b(null),x({tableName:"",tableNumber:"",gameType:"Texas Hold'em",customGameType:"",maxSeats:8,stakes:"",minPlayTime:"30",callTime:5,cashOutWindow:10,sessionTimeout:120,tableType:"CASH",minBuyIn:"",maxBuyIn:"",notes:""}),y("30"),l("all"),g.invalidateQueries(["tables",t])},onError:e=>{wr.error(e.message||"Failed to update table")}}),D=gn({mutationFn:e=>jr.rj.deleteTable(t,e),onSuccess:()=>{wr.success("Table deleted successfully"),g.invalidateQueries(["tables",t])},onError:e=>{wr.error(e.message||"Failed to delete table")}}),O=gn({mutationFn:e=>jr.rj.resumeSession(t,e),onSuccess:()=>{wr.success("Session started successfully"),g.invalidateQueries(["tables",t])},onError:e=>{wr.error(e.message||"Failed to start session")}});return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Table Management"}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700 pb-4 mb-6",children:[(0,sa.jsx)("button",{onClick:()=>l("all"),className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("all"===n?"bg-gradient-to-r from-emerald-600 to-teal-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"All Tables"}),(0,sa.jsx)("button",{onClick:()=>{l("add"),b(null),x({tableName:"",tableNumber:"",gameType:"Texas Hold'em",customGameType:"",maxSeats:8,stakes:"",minPlayTime:"30",callTime:5,cashOutWindow:10,sessionTimeout:120,tableType:"CASH",minBuyIn:"",maxBuyIn:"",notes:""}),y("30")},className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("add"===n?"bg-gradient-to-r from-emerald-600 to-teal-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"Add New Table"})]}),"all"===n&&(0,sa.jsx)("div",{className:"space-y-4",children:a?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading tables..."})]}):0===m.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfb2"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No regular tables created yet"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:'Click "Add New Table" to create your first table (Rummy tables are managed separately)'})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h3",{className:"text-lg font-bold text-white",children:["Table ",e.tableNumber]}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.tableType})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("AVAILABLE"===e.status?"bg-green-600/20 text-green-400":"OCCUPIED"===e.status?"bg-blue-600/20 text-blue-400":"RESERVED"===e.status?"bg-yellow-600/20 text-yellow-400":"bg-gray-600/20 text-gray-400"),children:e.status})]}),(0,sa.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Max Seats:"}),(0,sa.jsx)("span",{className:"text-white font-medium",children:e.maxSeats})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:["\u20b9",e.minBuyIn||0,"/\u20b9",e.maxBuyIn||0]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Current Seats:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:[e.currentSeats||0," / ",e.maxSeats]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:["AVAILABLE"===e.status||"CLOSED"===e.status?(0,sa.jsxs)("button",{onClick:()=>O.mutate(e.id),disabled:O.isLoading,className:"flex-1 bg-green-600 hover:bg-green-500 px-3 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 flex items-center justify-center gap-1",children:[(0,sa.jsx)("span",{children:"\u25b6"}),(0,sa.jsx)("span",{children:"Start Session"})]}):null,(0,sa.jsx)("button",{onClick:()=>(e=>{var t,s,a,r,n,i,o,d,c,u,m,h;b(e);const p=e.notes?e.notes.split("|").map(e=>e.trim()):[],g=p[0]||"Table ".concat(e.tableNumber),f=p[1]||"Texas Hold'em",v=(null===(t=p[2])||void 0===t?void 0:t.replace("Stakes:","").trim())||"",w=(null===(s=p[3])||void 0===s||null===(a=s.match(/\d+/))||void 0===a?void 0:a[0])||"30",j=(null===(r=p[4])||void 0===r||null===(n=r.match(/\d+/))||void 0===n?void 0:n[0])||"5",N=(null===(i=p[5])||void 0===i||null===(o=i.match(/\d+/))||void 0===o?void 0:o[0])||"10",S=(null===(d=p[6])||void 0===d||null===(c=d.match(/\d+/))||void 0===c?void 0:c[0])||"120";x({tableName:g,tableNumber:(null===(u=e.tableNumber)||void 0===u?void 0:u.toString())||"",gameType:f,customGameType:"",maxSeats:e.maxSeats||8,stakes:v,minPlayTime:w,callTime:parseInt(j),cashOutWindow:parseInt(N),sessionTimeout:parseInt(S),tableType:e.tableType||"CASH",minBuyIn:(null===(m=e.minBuyIn)||void 0===m?void 0:m.toString())||"",maxBuyIn:(null===(h=e.maxBuyIn)||void 0===h?void 0:h.toString())||"",notes:e.notes||""});const k=new Set(["30","45","60","90","120","150","180"]);y(k.has(w)?w:"custom"),l("add")})(e),className:"flex-1 bg-blue-600 hover:bg-blue-500 px-3 py-2 rounded-lg text-sm font-medium transition-colors",children:"Edit"}),(0,sa.jsx)("button",{onClick:()=>(e=>{window.confirm("Are you sure you want to delete Table ".concat(e.tableNumber,"?"))&&D.mutate(e.id)})(e),disabled:D.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 px-3 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"Delete"})]})]},e.id))})}),"add"===n&&(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold mb-6",children:p?"Edit Table":"Create New Table"}),(0,sa.jsxs)("form",{onSubmit:p?e=>{if(e.preventDefault(),!p)return;const t="custom"===f?Math.max(30,parseInt(h.minPlayTime)||30):Math.max(30,parseInt(f)||30);R.mutate({tableId:p.id,data:{tableType:h.tableType,maxSeats:parseInt(h.maxSeats),minBuyIn:h.minBuyIn?parseFloat(h.minBuyIn):null,maxBuyIn:h.maxBuyIn?parseFloat(h.maxBuyIn):null,notes:h.notes||"".concat(h.tableName||"Table "+h.tableNumber," | ").concat("Custom"===h.gameType?h.customGameType:h.gameType," | Stakes: ").concat(h.stakes," | Min Play: ").concat(t,"m | Call: ").concat(h.callTime,"m | Cash-out: ").concat(h.cashOutWindow,"m | Timeout: ").concat(h.sessionTimeout,"m")}})}:e=>{if(e.preventDefault(),!t)return void wr.error("Please select a club first");if(!h.tableNumber)return void wr.error("Table number is required");const s="custom"===f?Math.max(30,parseInt(h.minPlayTime)||30):Math.max(30,parseInt(f)||30);I.mutate({tableNumber:parseInt(h.tableNumber),tableType:h.tableType,maxSeats:parseInt(h.maxSeats),minBuyIn:h.minBuyIn?parseFloat(h.minBuyIn):null,maxBuyIn:h.maxBuyIn?parseFloat(h.maxBuyIn):null,notes:h.notes||"".concat(h.tableName||"Table "+h.tableNumber," | ").concat("Custom"===h.gameType?h.customGameType:h.gameType," | Stakes: ").concat(h.stakes," | Min Play: ").concat(s,"m | Call: ").concat(h.callTime,"m | Cash-out: ").concat(h.cashOutWindow,"m | Timeout: ").concat(h.sessionTimeout,"m")})},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Table Name"}),(0,sa.jsx)("input",{type:"text",value:h.tableName,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{tableName:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",placeholder:"Table 1",disabled:!t})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Game Type"}),(0,sa.jsxs)("select",{value:h.gameType,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{gameType:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!t,children:[(0,sa.jsx)("option",{value:"Texas Hold'em",children:"Texas Hold'em"}),(0,sa.jsx)("option",{value:"Omaha",children:"Omaha"}),(0,sa.jsx)("option",{value:"Seven Card Stud",children:"Seven Card Stud"}),(0,sa.jsx)("option",{value:"Razz",children:"Razz"}),(0,sa.jsx)("option",{value:"Custom",children:"Custom"})]})]}),"Custom"===h.gameType&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Custom Game Type"}),(0,sa.jsx)("input",{type:"text",value:h.customGameType,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{customGameType:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",placeholder:"Enter custom game type",disabled:!t})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Table Number *"}),(0,sa.jsx)("input",{type:"number",value:h.tableNumber,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{tableNumber:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",required:!0,disabled:!t,min:"1",placeholder:"1"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Players"}),(0,sa.jsx)("input",{type:"number",value:h.maxSeats,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{maxSeats:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!t,min:"2",max:"10",placeholder:"8"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Blind Levels / Stakes"}),(0,sa.jsx)("input",{type:"text",value:h.stakes,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{stakes:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",placeholder:"\u20b925/\u20b950",disabled:!t})]}),(0,sa.jsxs)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:[(0,sa.jsx)("h4",{className:"text-white text-sm font-semibold mb-3",children:"Session Parameters"}),(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-xs mb-1",children:"Min Play Time (minutes)"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("select",{value:f,onChange:e=>{const t=e.target.value;y(t),"custom"!==t?x((0,i.A)((0,i.A)({},h),{},{minPlayTime:t})):(!h.minPlayTime||parseInt(h.minPlayTime)<30)&&x((0,i.A)((0,i.A)({},h),{},{minPlayTime:"30"}))},className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!t,children:[(0,sa.jsx)("option",{value:"30",children:"30 minutes"}),(0,sa.jsx)("option",{value:"45",children:"45 minutes"}),(0,sa.jsx)("option",{value:"60",children:"60 minutes"}),(0,sa.jsx)("option",{value:"90",children:"90 minutes"}),(0,sa.jsx)("option",{value:"120",children:"120 minutes"}),(0,sa.jsx)("option",{value:"150",children:"150 minutes"}),(0,sa.jsx)("option",{value:"180",children:"180 minutes"}),(0,sa.jsx)("option",{value:"custom",children:"Custom..."})]}),"custom"===f&&(0,sa.jsx)("input",{type:"number",min:30,value:h.minPlayTime,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{minPlayTime:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-sm",placeholder:"Enter minutes (min 30)",disabled:!t})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-xs mb-1",children:"Call Time (minutes)"}),(0,sa.jsx)("input",{type:"number",value:h.callTime,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{callTime:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-sm",placeholder:"5",disabled:!t})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-xs mb-1",children:"Cash-out Window (minutes)"}),(0,sa.jsx)("input",{type:"number",value:h.cashOutWindow,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{cashOutWindow:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-sm",placeholder:"10",disabled:!t})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-xs mb-1",children:"Session Timeout (minutes)"}),(0,sa.jsx)("input",{type:"number",value:h.sessionTimeout,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{sessionTimeout:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-sm",placeholder:"120",disabled:!t})]})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 border-t border-slate-600 pt-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Min Buy-In (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:h.minBuyIn,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{minBuyIn:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!t,min:"0",step:"0.01",placeholder:"1000.00"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Buy-In (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:h.maxBuyIn,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{maxBuyIn:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!t,min:"0",step:"0.01",placeholder:"10000.00"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Table Type (Backend)"}),(0,sa.jsxs)("select",{value:h.tableType,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{tableType:e.target.value})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!t,children:[(0,sa.jsx)("option",{value:"CASH",children:"Cash Game"}),(0,sa.jsx)("option",{value:"TOURNAMENT",children:"Tournament"}),(0,sa.jsx)("option",{value:"HIGH_STAKES",children:"High Stakes"}),(0,sa.jsx)("option",{value:"PRIVATE",children:"Private"})]})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,sa.jsx)("button",{type:"submit",disabled:I.isLoading||R.isLoading||!t,className:"flex-1 bg-gradient-to-r from-emerald-600 to-teal-700 hover:from-emerald-500 hover:to-teal-600 text-white py-3 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:I.isLoading||R.isLoading?(0,sa.jsxs)("span",{className:"flex items-center justify-center",children:[(0,sa.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,sa.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,sa.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),p?"Updating...":"Creating..."]}):p?"Update Table":"Create Table"}),p&&(0,sa.jsx)("button",{type:"button",onClick:()=>{b(null),x({tableName:"",tableNumber:"",gameType:"Texas Hold'em",customGameType:"",maxSeats:8,stakes:"",minPlayTime:"30",callTime:5,cashOutWindow:10,sessionTimeout:120,tableType:"CASH",minBuyIn:"",maxBuyIn:"",notes:""}),y("30"),l("all")},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg font-semibold transition-all",children:"Cancel"})]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Dealer Assignment"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Table"}),(0,sa.jsxs)("select",{value:o,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",disabled:!t,children:[(0,sa.jsx)("option",{value:"",children:"-- Select Table --"}),m.map(e=>(0,sa.jsxs)("option",{value:e.id,children:["Table ",e.tableNumber," - ",e.tableType," (",e.status,")"]},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Assign Dealer"}),(0,sa.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",disabled:!t||w,children:[(0,sa.jsx)("option",{value:"",children:"-- Select Dealer --"}),w?(0,sa.jsx)("option",{disabled:!0,children:"Loading dealers..."}):0===P.length?(0,sa.jsx)("option",{disabled:!0,children:j.length>0?"No dealers available (all assigned, on leave, or no shift today)":"No active dealers found"}):P.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name," (",e.employeeId||"No ID",")"]},e.id))]})]})]}),(0,sa.jsx)("button",{onClick:()=>{o&&c?E.mutate({tableId:o,dealerId:c}):wr.error("Please select both table and dealer")},disabled:!o||!c||E.isLoading||!t,className:"mt-4 bg-purple-600 hover:bg-purple-500 px-6 py-2 rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:E.isLoading?"Assigning...":"Assign Dealer"}),0===j.length&&!w&&t&&(0,sa.jsx)("p",{className:"mt-2 text-sm text-yellow-400",children:"\u26a0\ufe0f No active dealers found. Please create dealer staff members first."}),0===T.length&&j.length>0&&!w&&(0,sa.jsx)("p",{className:"mt-2 text-sm text-amber-400",children:"\u2139\ufe0f All dealers are currently assigned to active tables. Free up a dealer by ending a table session."})]})]})}function yd(e){var t;let{selectedClubId:s,tables:a,waitlist:n,waitlistLoading:l}=e;const o=ra(),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),[h,x]=(0,r.useState)(""),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)(1),[y,v]=(0,r.useState)(!1),w=gn({mutationFn:e=>jr.IX.deleteWaitlistEntry(s,e),onSuccess:()=>{o.invalidateQueries(["waitlist",s]),wr.success("Player removed from waitlist")},onError:e=>{wr.error(e.message||"Failed to remove from waitlist")}}),j=gn({mutationFn:e=>{let{entryId:t,tableId:a,seatedBy:r}=e;return jr.IX.assignSeat(s,t,{tableId:a,seatedBy:r||"Super Admin"})},onSuccess:()=>{o.invalidateQueries(["waitlist",s]),o.invalidateQueries(["tables",s]),c(""),m(""),x(""),wr.success("Seat assigned successfully")},onError:e=>{wr.error(e.message||"Failed to assign seat")}}),N=gn({mutationFn:e=>{let{entryId:t,newPriority:a}=e;return jr.IX.updateWaitlistEntry(s,t,{priority:a})},onSuccess:()=>{o.invalidateQueries(["waitlist",s]),wr.success("Waitlist reordered")},onError:e=>{wr.error(e.message||"Failed to reorder waitlist")}}),S=n.filter(e=>"PENDING"===e.status).sort((e,t)=>{const s=e.priority||0,a=t.priority||0;return a!==s?a-s:new Date(e.createdAt)-new Date(t.createdAt)}).map((e,t)=>(0,i.A)((0,i.A)({},e),{},{position:t+1})),k=Math.ceil(S.length/10),C=10*(g-1),A=C+10,_=S.slice(C,A);(0,r.useEffect)(()=>{g>k&&k>0&&f(1)},[k,g]);return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Waitlist Management"}),(0,sa.jsxs)("button",{type:"button",onClick:async()=>{v(!0);try{await Promise.all([o.refetchQueries({queryKey:["waitlist",s]}),o.refetchQueries({queryKey:["tables",s]})]),wr.success("Table Buy-In data refreshed")}finally{v(!1)}},disabled:l||y,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm font-medium transition-colors",children:[y?(0,sa.jsx)("span",{className:"animate-spin inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),y?"Refreshing...":"Refresh"]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Current Waitlist"}),l?(0,sa.jsxs)("div",{className:"text-center py-8",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-2"}),(0,sa.jsx)("p",{className:"text-sm",children:"Loading..."})]}):0===S.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No players in waitlist"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:_.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-600 p-4 rounded-lg",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:e.playerName}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Position: #",e.position||"N/A"]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Table Type: ",e.tableType||"Cash Game"]}),(0,sa.jsxs)("div",{className:"text-sm text-blue-400",children:["Requested Seat: ",e.requestedSeat||"N/A"]})]}),(0,sa.jsx)("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 rounded text-xs font-semibold",children:e.status})]}),(0,sa.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{let t=a.find(t=>t.tableType===e.tableType);t||(t=a.find(e=>"AVAILABLE"===e.status&&e.currentSeats<e.maxSeats)),!t&&a.length>0&&(t=a[0]),t?b({table:t,waitlistEntry:e}):wr.error("No tables available. Please create a table first.")})(e),className:"flex-1 bg-blue-600 hover:bg-blue-500 px-3 py-1.5 rounded text-sm font-medium transition-colors",children:"\ud83c\udfaf View Table"}),(0,sa.jsx)("button",{onClick:()=>w.mutate(e.id),disabled:w.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 disabled:bg-gray-600 px-3 py-1.5 rounded text-sm font-medium transition-colors",children:"Remove"})]})]},e.id))}),k>1&&(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-slate-600",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Showing ",C+1,"-",Math.min(A,S.length)," of ",S.length]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:1===g,className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 disabled:bg-slate-700 disabled:cursor-not-allowed rounded text-sm transition-colors",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-1",children:Array.from({length:k},(e,t)=>t+1).map(e=>(0,sa.jsx)("button",{onClick:()=>f(e),className:"px-3 py-1 rounded text-sm transition-colors ".concat(g===e?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:e},e))}),(0,sa.jsx)("button",{onClick:()=>f(e=>Math.min(k,e+1)),disabled:g===k,className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 disabled:bg-slate-700 disabled:cursor-not-allowed rounded text-sm transition-colors",children:"Next"})]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Seat Allocation"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Player"}),(0,sa.jsxs)("select",{value:d,onChange:e=>{const t=e.target.value;if(c(t),t){const e=S.find(e=>e.id===t);if(e){var s;let t=a.find(t=>t.tableType===e.tableType);t||(t=a.find(e=>"AVAILABLE"===e.status&&e.currentSeats<e.maxSeats)),!t&&a.length>0&&(t=a[0]),m((null===(s=t)||void 0===s?void 0:s.id)||""),e.requestedSeat?x(String(e.requestedSeat)):x("")}}else m(""),x("")},className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"-- Select Player --"}),S.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.playerName," ",e.requestedSeat?"(wants seat #".concat(e.requestedSeat,")"):""]},e.id))]})]}),d&&(()=>{const e=S.find(e=>e.id===d);return e?(0,sa.jsxs)("div",{className:"bg-slate-600 rounded-lg p-3 text-sm",children:[(0,sa.jsxs)("div",{className:"text-gray-300 mb-1",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Requested Table Type:"})," ",e.tableType||"Any"]}),e.requestedSeat&&(0,sa.jsxs)("div",{className:"text-blue-400",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Requested Seat:"})," #",e.requestedSeat]})]}):null})(),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Assigned Table ",d&&(0,sa.jsx)("span",{className:"text-xs text-gray-400",children:"(Auto-selected)"})]}),(0,sa.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!0,children:[(0,sa.jsx)("option",{value:"",children:"-- No table selected --"}),a.map(e=>(0,sa.jsxs)("option",{value:e.id,children:["Table ",e.tableNumber," (",e.currentSeats,"/",e.maxSeats,") - ",e.status]},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Seat Number ",d&&(null===(t=S.find(e=>e.id===d))||void 0===t?void 0:t.requestedSeat)&&(0,sa.jsx)("span",{className:"text-xs text-blue-400",children:"(Pre-selected)"})]}),(0,sa.jsxs)("select",{value:h,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",disabled:!u,children:[(0,sa.jsx)("option",{value:"",children:"-- Select Seat --"}),u&&(()=>{const e=a.find(e=>e.id===u),t=(null===e||void 0===e?void 0:e.maxSeats)||10,s=S.find(e=>e.id===d);return Array.from({length:t},(e,t)=>t+1).map(e=>(0,sa.jsxs)("option",{value:e,children:["Seat ",e,(null===s||void 0===s?void 0:s.requestedSeat)===e?" \u2b50 (Requested)":""]},e))})()]})]}),(0,sa.jsx)("button",{onClick:()=>{d&&u&&h?j.mutate({entryId:d,tableId:u,seatedBy:"Super Admin"}):wr.error("Please select player, table, and seat")},disabled:!d||!u||!h||j.isLoading,className:"w-full bg-purple-600 hover:bg-purple-500 disabled:bg-gray-600 px-4 py-3 rounded-lg font-semibold transition-colors",children:j.isLoading?"Assigning...":"Assign Seat"})]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Player Call & Reorder"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Call Players"}),(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsx)("button",{className:"w-full bg-green-600 hover:bg-green-500 px-4 py-3 rounded-lg font-semibold transition-colors",children:"Call Next Player"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400 text-center py-2",children:[S.length," player(s) in waitlist"]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Reorder Waitlist"}),(0,sa.jsx)("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:0===S.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No players to reorder"}):S.map((e,t)=>(0,sa.jsxs)("div",{className:"bg-slate-600 p-3 rounded flex justify-between items-center",children:[(0,sa.jsxs)("span",{className:"text-white",children:[t+1,". ",e.playerName]}),(0,sa.jsxs)("div",{className:"flex gap-1",children:[(0,sa.jsx)("button",{onClick:()=>((e,t)=>{if(0===t)return;const s=e.priority||0;N.mutate({entryId:e.id,newPriority:s+1})})(e,t),disabled:0===t||N.isLoading,className:"bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-2 py-1 rounded text-xs transition-colors",children:"\u2191"}),(0,sa.jsx)("button",{onClick:()=>((e,t)=>{if(t===n.length-1)return;const s=e.priority||0;N.mutate({entryId:e.id,newPriority:s-1})})(e,t),disabled:t===S.length-1||N.isLoading,className:"bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-2 py-1 rounded text-xs transition-colors",children:"\u2193"})]})]},e.id))})]})]})]}),p&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold",children:["Assign Player to Table ",p.table.tableNumber]}),(0,sa.jsx)("button",{onClick:()=>b(null),className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded transition-colors",children:"Close"})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4 mb-6",children:[(0,sa.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Table Information"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-gray-300",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Type:"})," ",p.table.tableType]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Seats:"})," ",p.table.currentSeats,"/",p.table.maxSeats]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,sa.jsx)("span",{className:"ml-2 px-2 py-0.5 rounded text-xs ".concat("AVAILABLE"===p.table.status?"bg-green-600":"OCCUPIED"===p.table.status?"bg-yellow-600":"bg-gray-600"),children:p.table.status})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Available Seats:"})," ",p.table.maxSeats-p.table.currentSeats]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4 mb-6",children:[(0,sa.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Player Waiting"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-gray-300",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Name:"})," ",p.waitlistEntry.playerName]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Position:"})," #",p.waitlistEntry.position||"N/A"]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Requested Seat:"})," ",p.waitlistEntry.requestedSeat||"Any"]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Party Size:"})," ",p.waitlistEntry.partySize||1]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4",children:[(0,sa.jsx)("h3",{className:"font-semibold text-lg mb-4",children:"Assign Seat"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Seat Number"}),(0,sa.jsxs)("select",{value:h,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"-- Choose a seat --"}),Array.from({length:p.table.maxSeats},(e,t)=>t+1).map(e=>(0,sa.jsxs)("option",{value:e,children:["Seat ",e,p.waitlistEntry.requestedSeat===e?" (Requested)":""]},e))]})]}),(0,sa.jsx)("button",{onClick:()=>{h?(j.mutate({entryId:p.waitlistEntry.id,tableId:p.table.id,seatedBy:"Super Admin"}),b(null),x("")):wr.error("Please select a seat number")},disabled:!h||j.isLoading,className:"w-full bg-green-600 hover:bg-green-500 disabled:bg-gray-600 disabled:cursor-not-allowed px-6 py-3 rounded-lg font-semibold transition-colors",children:j.isLoading?"Assigning...":"Assign to Seat ".concat(h||"...")})]})]})]})})]})}function vd(e){let{selectedClubId:t,tables:s}=e;const[a,n]=(0,r.useState)("process-buyout"),[l,i]=(0,r.useState)(null),[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(""),[x,p]=(0,r.useState)(!1),b=ra();console.log("[PROCESS BUY-OUT] Tables available:",s),console.log("[PROCESS BUY-OUT] Tables with players:",s.filter(e=>e.currentSeats>0));const{data:g=[],isLoading:f}=hn({queryKey:["seatedPlayersForTable",t,o],queryFn:async()=>{if(!t||!o)return[];const e=await jr.rj.getSeatedPlayersForTable(t,o);return(null===e||void 0===e?void 0:e.seatedPlayers)||[]},enabled:!!t&&!!o&&"process-buyout"===a});return(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-orange-600/30 via-red-500/20 to-rose-700/30 rounded-xl p-6 border border-orange-800/40",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Table Buy-Out"}),(0,sa.jsxs)("button",{type:"button",onClick:async()=>{p(!0);try{await Promise.all([b.refetchQueries({queryKey:["seatedPlayersForTable"]}),b.refetchQueries({queryKey:["tables",t]}),b.refetchQueries({queryKey:["waitlist",t]})]),wr.success("Table Buy-Out data refreshed")}finally{p(!1)}},disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm font-medium transition-colors",children:[x?(0,sa.jsx)("span",{className:"animate-spin inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),x?"Refreshing...":"Refresh"]})]}),(0,sa.jsx)("p",{className:"text-gray-300 text-sm mb-6",children:"Manage player buy-out requests and process manual buy-outs."}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-orange-800/40 pb-4 mb-6",children:[(0,sa.jsx)("button",{onClick:()=>n("process-buyout"),className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("process-buyout"===a?"bg-gradient-to-r from-orange-600 to-red-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"Process Buy-Out"}),(0,sa.jsx)("button",{onClick:()=>n("player-requests"),className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("player-requests"===a?"bg-gradient-to-r from-orange-600 to-red-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"Player Requests"})]}),"process-buyout"===a&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Process Buy-Out"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"1. Select Table"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",value:o,onChange:e=>{d(e.target.value),i(null)},children:[(0,sa.jsx)("option",{value:"",children:"-- Select Table --"}),s.filter(e=>(e.currentSeats||0)>0).map(e=>(0,sa.jsxs)("option",{value:e.id,children:["Table ",e.tableNumber," (",e.currentSeats||0," players)"]},e.id))]})]}),o&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"2. Select Seated Player"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",value:(null===l||void 0===l?void 0:l.playerId)||"",onChange:e=>{const t=g.find(t=>t.playerId===e.target.value);i(t||null)},disabled:f||0===g.length,children:[(0,sa.jsx)("option",{value:"",children:f?"Loading...":0===g.length?"No seated players":"-- Select Player --"}),g.map(e=>(0,sa.jsxs)("option",{value:e.playerId,children:[e.playerName," - Seat #",e.seatNumber]},e.playerId))]})]}),l&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"p-4 bg-blue-500/20 rounded-lg border border-blue-400/30",children:(0,sa.jsxs)("div",{className:"text-sm text-white space-y-2",children:[(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Player:"}),(0,sa.jsx)("span",{className:"font-semibold",children:l.playerName})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Seat:"}),(0,sa.jsxs)("span",{className:"font-semibold",children:["#",l.seatNumber]})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Buy-In Amount:"}),(0,sa.jsxs)("span",{className:"font-semibold text-cyan-300",children:["\u20b9",(l.buyInAmount||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Wallet Balance:"}),(0,sa.jsxs)("span",{className:"font-semibold ".concat((l.walletBalance||0)>=0?"text-green-300":"text-red-300"),children:["\u20b9",(l.walletBalance||0).toLocaleString()]})]}),(l.totalCredits||0)>0&&(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Credits Outstanding:"}),(0,sa.jsxs)("span",{className:"font-semibold text-yellow-300",children:["\u20b9",(l.totalCredits||0).toLocaleString()]})]})]})}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"3. Final Balance / Buy-Out Amount"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Enter final balance amount...",value:m,onChange:e=>h(e.target.value)}),(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Buy-in: \u20b9",(null===l||void 0===l?void 0:l.buyInAmount)||0," | Wallet: \u20b9",((null===l||void 0===l?void 0:l.walletBalance)||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"4. Reason (Optional)"}),(0,sa.jsx)("textarea",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",rows:"3",placeholder:"Enter reason for buy-out (optional)...",value:c,onChange:e=>u(e.target.value)})]}),(0,sa.jsx)("button",{onClick:async()=>{if(!l||!m)return void wr.error("Please select a player and enter buy-out amount");const e=parseFloat(m);if(isNaN(e)||e<=0)wr.error("Please enter a valid amount");else if(window.confirm("Confirm: Add \u20b9".concat(e.toLocaleString("en-IN")," to ").concat(l.playerName,"'s balance and complete buy-out?")))try{var a;await jr.Dv.createTransaction(t,{playerId:l.playerId,playerName:l.playerName,type:"Deposit",amount:e,notes:"Buy-out from Table ".concat((null===(a=s.find(e=>e.id===o))||void 0===a?void 0:a.tableNumber)||"").concat(c?" - ".concat(c):"")});const r=(await jr.IX.getWaitlist(t)).find(e=>{var t;return e.playerId===l.playerId&&"SEATED"===e.status&&e.tableNumber===(null===(t=s.find(e=>e.id===o))||void 0===t?void 0:t.tableNumber)});r&&await jr.IX.unseatPlayerFromTable(t,r.id),wr.success("Buy-out approved! \u20b9".concat(e.toLocaleString("en-IN")," added to ").concat(l.playerName,"'s balance")),i(null),h(""),u(""),b.invalidateQueries(["seatedPlayersForTable"]),b.invalidateQueries(["tables"]),b.invalidateQueries(["waitlist"])}catch(d){var r,n;console.error("Error approving buy-out:",d),wr.error((null===d||void 0===d||null===(r=d.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||(null===d||void 0===d?void 0:d.message)||"Failed to approve buy-out")}},disabled:!l||!m,className:"w-full bg-orange-600 hover:bg-orange-500 disabled:bg-gray-600 disabled:cursor-not-allowed px-4 py-3 rounded-lg font-semibold transition-colors",children:"Approve Buy-Out"})]})]})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Buy-Out Information"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold mb-2",children:"How Buy-Out Works:"}),(0,sa.jsxs)("ul",{className:"text-sm text-gray-300 space-y-2 list-disc list-inside",children:[(0,sa.jsx)("li",{children:"Select a player who is currently seated at a table"}),(0,sa.jsx)("li",{children:"Their table chip balance will be moved to their available balance"}),(0,sa.jsx)("li",{children:"Player will be removed from the table (seat becomes available)"}),(0,sa.jsx)("li",{children:"Player can then convert chips to real money at the cashier counter"})]})]}),(0,sa.jsxs)("div",{className:"p-4 bg-yellow-500/20 rounded-lg border border-yellow-400/30",children:[(0,sa.jsx)("h4",{className:"text-yellow-300 font-semibold mb-2",children:"\u26a0\ufe0f Important Notes:"}),(0,sa.jsxs)("ul",{className:"text-sm text-yellow-200 space-y-1 list-disc list-inside",children:[(0,sa.jsx)("li",{children:"Buy-out approval is permanent and cannot be undone"}),(0,sa.jsx)("li",{children:"Table balance will be immediately transferred to player's available balance"}),(0,sa.jsx)("li",{children:"Player must go to cashier to convert chips to real money"})]})]}),(0,sa.jsx)("div",{className:"p-4 bg-green-500/20 rounded-lg border border-green-400/30",children:(0,sa.jsxs)("div",{className:"text-sm text-green-300",children:[(0,sa.jsx)("div",{className:"font-semibold mb-1",children:"Currently Seated Players:"}),(0,sa.jsx)("div",{className:"text-green-200",children:"0 player(s) at tables"})]})})]})]})]}),"player-requests"===a&&(0,sa.jsx)(md,{clubId:t})]})})}function wd(e){let{selectedClubId:t,tables:s}=e;const[a,n]=(0,r.useState)({type:"all",search:"",tableNumber:"all",page:1,perPage:10}),{data:l=[],isLoading:o}=hn({queryKey:["transactions",t],queryFn:async()=>{if(!t)return[];try{const e=await jr.Dv.getTransactions(t,{});console.log("[HISTORY] Raw transactions response:",e),console.log("[HISTORY] Response type:",typeof e,Array.isArray(e));let s=Array.isArray(e)?e:(null===e||void 0===e?void 0:e.data)||(null===e||void 0===e?void 0:e.transactions)||[];return s=s.filter(e=>"rummy"!==e.game_type),console.log("[HISTORY] Parsed poker transactions:",s.length,"records"),s}catch(e){return console.error("[HISTORY] Error fetching transactions:",e),[]}},enabled:!!t}),d=l.filter(e=>{var t,s,r,n;const l=["Table Buy In","Buy In","Club Buy In","Credit"].includes(e.type),i=["Table Buy Out","Club Buy Out","Debit"].includes(e.type)||("Deposit"===e.type||"Cashout"===e.type)&&((null===(t=e.notes)||void 0===t?void 0:t.toLowerCase().includes("buy-out"))||(null===(s=e.notes)||void 0===s?void 0:s.toLowerCase().includes("buyout"))||(null===(r=e.description)||void 0===r?void 0:r.toLowerCase().includes("buy-out"))||(null===(n=e.description)||void 0===n?void 0:n.toLowerCase().includes("buyout")));if("buy-in"===a.type&&!l)return!1;if("buy-out"===a.type&&!i)return!1;if("all"===a.type&&!l&&!i)return!1;if("all"!==a.tableNumber){var o,d,c,u;if(!((null===(o=e.notes)||void 0===o?void 0:o.includes("Table ".concat(a.tableNumber)))||(null===(d=e.description)||void 0===d?void 0:d.includes("Table ".concat(a.tableNumber)))||(null===(c=e.notes)||void 0===c?void 0:c.includes("table ".concat(a.tableNumber)))||(null===(u=e.description)||void 0===u?void 0:u.includes("table ".concat(a.tableNumber)))))return!1}if(a.search){const t=a.search.toLowerCase(),s=e.playerName||e.player_name||"",r=e.email||"";return s.toLowerCase().includes(t)||r.toLowerCase().includes(t)}return!0});console.log("[HISTORY] All transactions:",l.length),console.log("[HISTORY] Filtered:",d.length,"Filters:",a);const c=d.slice((a.page-1)*a.perPage,a.page*a.perPage),u=Math.ceil(d.length/a.perPage);return(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600/30 via-purple-500/20 to-pink-700/30 rounded-xl p-6 border border-indigo-800/40",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Buy-In & Buy-Out History"}),(0,sa.jsx)("p",{className:"text-gray-300 text-sm mb-6",children:"View all buy-in and buy-out transactions with advanced filters."}),(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Filters"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Transaction Type"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",value:a.type,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{type:e.target.value,page:1})),children:[(0,sa.jsx)("option",{value:"all",children:"All Transactions"}),(0,sa.jsx)("option",{value:"buy-in",children:"Buy-In Only"}),(0,sa.jsx)("option",{value:"buy-out",children:"Buy-Out Only"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Table"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",value:a.tableNumber,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{tableNumber:e.target.value,page:1})),children:[(0,sa.jsx)("option",{value:"all",children:"All Tables"}),s.map(e=>(0,sa.jsxs)("option",{value:e.tableNumber,children:["Table ",e.tableNumber]},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Search Player"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Player name or email...",value:a.search,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{search:e.target.value,page:1}))})]})]})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Transaction History (",d.length," records)"]}),o?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Loading..."}):0===c.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No transactions found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-3 mb-6",children:c.map((e,t)=>{var s,a,r,n;const l=["Table Buy In","Buy In","Club Buy In","Credit"].includes(e.type);["Table Buy Out","Club Buy Out","Debit"].includes(e.type)||("Deposit"===e.type||"Cashout"===e.type)&&((null===(s=e.notes)||void 0===s?void 0:s.toLowerCase().includes("buy-out"))||(null===(a=e.notes)||void 0===a?void 0:a.toLowerCase().includes("buyout"))||(null===(r=e.description)||void 0===r?void 0:r.toLowerCase().includes("buy-out"))||null===(n=e.description)||void 0===n||n.toLowerCase().includes("buyout"));return(0,sa.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat(l?"bg-green-900/20 border-green-600/50":"bg-orange-900/20 border-orange-600/50"),children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsx)("div",{className:"flex-1",children:(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-2xl",children:l?"\ud83d\udcb0":"\ud83d\udcb5"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-bold text-white",children:e.playerName||e.player_name||"Unknown Player"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[l?"Buy-In":"Buy-Out",e.notes&&" \u2022 ".concat(e.notes)]}),(0,sa.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]})]})}),(0,sa.jsxs)("div",{className:"text-right ".concat(l?"text-green-400":"text-orange-400"),children:[(0,sa.jsxs)("div",{className:"font-bold text-2xl",children:[l?"+":"","\u20b9",Number(e.amount).toLocaleString()]}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:e.status})]})]})},e.id||t)})}),u>1&&(0,sa.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,sa.jsx)("button",{onClick:()=>n((0,i.A)((0,i.A)({},a),{},{page:Math.max(1,a.page-1)})),disabled:1===a.page,className:"px-4 py-2 bg-slate-700 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-white",children:["Page ",a.page," of ",u]}),(0,sa.jsx)("button",{onClick:()=>n((0,i.A)((0,i.A)({},a),{},{page:Math.min(u,a.page+1)})),disabled:a.page===u,className:"px-4 py-2 bg-slate-700 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600",children:"Next"})]})]})]})]})})}const jd="all_players",Nd="new_signups",Sd="vip_players",kd="tables_players",Cd="waitlist_players",Ad="custom_group",_d="all_staff",Pd="staff_admin",Td="staff_manager",Ed="staff_cashier",Id="staff_dealer",Rd="staff_hr",Dd="staff_fnb",Od="staff_gre",Ld="staff_custom",Fd=e=>{if(!e)return e;const t=e.lastIndexOf("."),s=-1!==t?e.substring(0,t):e,a=-1!==t?e.substring(t):"";return s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"").toLowerCase()+a};function Md(e){let{selectedClubId:t}=e;const s=ra(),[a,n]=(0,r.useState)("player"),[l,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[m,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)({title:"",details:"",targetType:jd,imageFile:null,imageUrl:"",videoFile:null,videoUrl:"",customPlayerIds:[],customStaffIds:[],scheduledAt:"",isActive:!0}),{data:b=[],isLoading:g}=hn({queryKey:["pushNotifications",t,a],queryFn:()=>jr.Dv.getPushNotifications(t,a),enabled:!!t}),{data:f=[]}=hn({queryKey:["allPlayersForGroup",t],queryFn:async()=>{if(!t)return[];const e=[];let s=1;let a=!0;for(;a;)try{const r=(await jr.Dv.getPlayers(t,{limit:50,page:s})).players||[];if(!r||0===r.length){a=!1;break}const n=r.filter(e=>("approved"===e.kycStatus||"verified"===e.kycStatus)&&"Active"===e.status);e.push(...n),r.length<50?a=!1:(s++,s>20&&(a=!1))}catch(r){console.error("Error fetching players page ".concat(s,":"),r),a=!1}return e},enabled:!!t&&x.targetType===Ad}),{data:y=[]}=hn({queryKey:["allStaffForGroup",t],queryFn:async()=>{if(!t)return[];return(await jr.Dv.getStaff(t)||[]).filter(e=>"Active"===e.status&&"AFFILIATE"!==e.role)},enabled:!!t&&x.targetType===Ld}),v=gn({mutationFn:async e=>{let s=e.imageUrl,r=e.videoUrl;if(e.imageFile)try{const a=Fd(e.imageFile.name),{signedUrl:r,publicUrl:n}=await jr.Dv.createPushNotificationUploadUrl(t,a,!1);await jr.Dv.uploadToSignedUrl(r,e.imageFile),s=n}catch(n){return console.error("Failed to upload image:",n),void wr.error("Failed to upload image: "+(n.message||"Unknown error"))}if(e.videoFile)try{const s=Fd(e.videoFile.name),{signedUrl:a,publicUrl:n}=await jr.Dv.createPushNotificationUploadUrl(t,s,!0);await jr.Dv.uploadToSignedUrl(a,e.videoFile),r=n}catch(n){return console.error("Failed to upload video:",n),void wr.error("Failed to upload video: "+(n.message||"Unknown error"))}return await jr.Dv.createPushNotification(t,{title:e.title,details:e.details,imageUrl:s||void 0,videoUrl:r||void 0,targetType:e.targetType,customPlayerIds:e.targetType===Ad?e.customPlayerIds:void 0,customStaffIds:e.targetType===Ld?e.customStaffIds:void 0,notificationType:a,scheduledAt:e.scheduledAt||void 0,isActive:e.isActive})},onSuccess:()=>{wr.success("Push notification created successfully!"),s.invalidateQueries(["pushNotifications",t]),i(!1),N()},onError:e=>{wr.error(e.message||"Failed to create notification")}}),w=gn({mutationFn:async e=>await jr.Dv.sendPushNotification(t,e),onSuccess:e=>{wr.success("Notification sent to ".concat(e.recipientCount," recipient(s)!")),s.invalidateQueries(["pushNotifications",t])},onError:e=>{wr.error(e.message||"Failed to send notification")}}),j=gn({mutationFn:async e=>await jr.Dv.deletePushNotification(t,e),onSuccess:()=>{wr.success("Notification deleted successfully!"),s.invalidateQueries(["pushNotifications",t])},onError:e=>{wr.error(e.message||"Failed to delete notification")}}),N=()=>{p({title:"",details:"",targetType:"player"===a?jd:_d,imageFile:null,imageUrl:"",videoFile:null,videoUrl:"",customPlayerIds:[],customStaffIds:[],scheduledAt:"",isActive:!0})};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Push Notifications & Offers"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Create and manage push notifications for players and staff"})]}),(0,sa.jsx)("button",{onClick:()=>{N(),i(!0)},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold rounded-lg transition-all shadow-lg",children:"+ Create Notification"})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-gray-700",children:[(0,sa.jsx)("button",{onClick:()=>{n("player"),N()},className:"px-6 py-3 font-semibold transition-colors ".concat("player"===a?"text-white border-b-2 border-blue-500 bg-blue-500/10":"text-gray-400 hover:text-white"),children:"Player Notifications"}),(0,sa.jsx)("button",{onClick:()=>{n("staff"),N()},className:"px-6 py-3 font-semibold transition-colors ".concat("staff"===a?"text-white border-b-2 border-purple-500 bg-purple-500/10":"text-gray-400 hover:text-white"),children:"Staff Notifications"})]}),g?(0,sa.jsx)("div",{className:"text-center text-gray-400 py-12",children:"Loading notifications..."}):0===b.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsxs)("p",{className:"text-gray-400 text-lg mb-4",children:["No ",a," notifications yet"]}),(0,sa.jsx)("button",{onClick:()=>{N(),i(!0)},className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:"Create Your First Notification"})]}):(0,sa.jsx)("div",{className:"space-y-4",children:b.map(e=>(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 hover:border-blue-500 transition-all",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:e.title}),e.details&&(0,sa.jsx)("p",{className:"text-gray-300 mb-3",children:e.details}),(0,sa.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,sa.jsxs)("span",{className:"px-3 py-1 bg-blue-600 text-white text-sm font-semibold rounded",children:[e.targetType===jd&&"All Players",e.targetType===Nd&&"New Signups",e.targetType===Sd&&"VIP Players",e.targetType===kd&&"Tables Players",e.targetType===Cd&&"Waitlist Players",e.targetType===Ad&&"Custom Group",e.targetType===_d&&"All Staff",e.targetType===Pd&&"Admin Staff",e.targetType===Td&&"Manager Staff",e.targetType===Ed&&"Cashier Staff",e.targetType===Id&&"Dealer Staff",e.targetType===Rd&&"HR Staff",e.targetType===Dd&&"F&B Staff",e.targetType===Od&&"GRE Staff",e.targetType===Ld&&"Custom Staff Group"]}),(0,sa.jsx)("span",{className:"px-3 py-1 text-sm font-semibold rounded ".concat(e.isActive?"bg-green-600 text-white":"bg-gray-600 text-gray-300"),children:e.isActive?"Active":"Inactive"}),e.sentAt&&(0,sa.jsxs)("span",{className:"px-3 py-1 bg-purple-600 text-white text-sm font-semibold rounded",children:["Sent ",new Date(e.sentAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})]})]}),(e.imageUrl||e.videoUrl)&&(0,sa.jsxs)("div",{className:"mt-3",children:[e.imageUrl&&(0,sa.jsx)("img",{src:e.imageUrl,alt:e.title,className:"max-w-xs rounded-lg"}),e.videoUrl&&(0,sa.jsx)("video",{src:e.videoUrl,controls:!0,className:"max-w-xs rounded-lg mt-2"})]})]}),(0,sa.jsxs)("div",{className:"ml-4 flex flex-col gap-2",children:[!e.sentAt&&(0,sa.jsxs)("button",{onClick:()=>{return t=e.id,s=e.title,void(window.confirm('Are you sure you want to send "'.concat(s,'" to all recipients?'))&&w.mutate(t));var t,s},disabled:w.isPending,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-50 flex items-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udce4"})," Send"]}),(0,sa.jsx)("button",{onClick:()=>{return t=e.id,s=e.title,void(window.confirm('Are you sure you want to delete "'.concat(s,'"?'))&&j.mutate(t));var t,s},disabled:j.isPending,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-50",children:"Delete"})]})]})},e.id))}),l&&(0,sa.jsx)(Bd,{title:"Create Push Notification",form:x,setForm:p,onSubmit:e=>{e.preventDefault(),x.title.trim()?x.targetType!==Ad||0!==x.customPlayerIds.length?x.targetType!==Ld||0!==x.customStaffIds.length?v.mutate(x):wr.error("Please select at least one staff member for custom group"):wr.error("Please select at least one player for custom group"):wr.error("Title is required")},onClose:()=>{i(!1),N()},isLoading:v.isPending,activeTab:a,allPlayers:f,allStaff:y,showCustomGroupModal:m,setShowCustomGroupModal:h})]})}function Bd(e){let{title:t,form:s,setForm:a,onSubmit:r,onClose:n,isLoading:l,activeTab:o,allPlayers:d,allStaff:c,showCustomGroupModal:u,setShowCustomGroupModal:m}=e;return(0,sa.jsxs)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full my-8 border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:t}),(0,sa.jsxs)("form",{onSubmit:r,className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2 font-semibold",children:["Title ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"text",value:s.title,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{title:e.target.value})),placeholder:"e.g., Special Weekend Offer!",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Details"}),(0,sa.jsx)("textarea",{value:s.details,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{details:e.target.value})),placeholder:"Enter notification details...",rows:4,className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2 font-semibold",children:["Target Audience ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("select",{value:s.targetType,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{targetType:e.target.value,customPlayerIds:[],customStaffIds:[]})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:"player"===o?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("option",{value:jd,children:"All Players"}),(0,sa.jsx)("option",{value:Nd,children:"New Sign-up Players"}),(0,sa.jsx)("option",{value:Sd,children:"VIP Players"}),(0,sa.jsx)("option",{value:kd,children:"Tables Players"}),(0,sa.jsx)("option",{value:Cd,children:"Waitlist Players"}),(0,sa.jsx)("option",{value:Ad,children:"Custom Group"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("option",{value:_d,children:"All Staff"}),(0,sa.jsx)("option",{value:Pd,children:"Admin Staff"}),(0,sa.jsx)("option",{value:Td,children:"Manager Staff"}),(0,sa.jsx)("option",{value:Ed,children:"Cashier Staff"}),(0,sa.jsx)("option",{value:Id,children:"Dealer Staff"}),(0,sa.jsx)("option",{value:Rd,children:"HR Staff"}),(0,sa.jsx)("option",{value:Dd,children:"F&B Staff"}),(0,sa.jsx)("option",{value:Od,children:"GRE Staff"}),(0,sa.jsx)("option",{value:Ld,children:"Custom Staff Group"})]})}),s.targetType===Ad&&(0,sa.jsx)("button",{type:"button",onClick:()=>m(!0),className:"mt-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-colors",children:s.customPlayerIds.length>0?"Selected ".concat(s.customPlayerIds.length," players"):"Select Players"}),s.targetType===Ld&&(0,sa.jsx)("button",{type:"button",onClick:()=>m(!0),className:"mt-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-colors",children:s.customStaffIds.length>0?"Selected ".concat(s.customStaffIds.length," staff members"):"Select Staff Members"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Image (Optional)"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsxs)("label",{className:"flex-shrink-0 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold cursor-pointer transition-colors",children:[(0,sa.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(r.size>10485760)return void wr.error("Image must be less than 10MB");a((0,i.A)((0,i.A)({},s),{},{imageFile:r,imageUrl:""}))}}}),s.imageFile?"\u2713 File Selected":"Choose Image"]}),(0,sa.jsx)("input",{type:"url",value:s.imageUrl,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{imageUrl:e.target.value,imageFile:null})),placeholder:"Or paste image URL",disabled:!!s.imageFile,className:"flex-1 px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"})]}),s.imageFile&&(0,sa.jsxs)("p",{className:"text-green-400 text-xs mt-1",children:["\ud83d\udcc1 ",s.imageFile.name," (",(s.imageFile.size/1024).toFixed(1)," KB)"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Video (Optional)"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsxs)("label",{className:"flex-shrink-0 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold cursor-pointer transition-colors",children:[(0,sa.jsx)("input",{type:"file",accept:"video/*",className:"hidden",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(r.size>104857600)return void wr.error("Video must be less than 100MB");a((0,i.A)((0,i.A)({},s),{},{videoFile:r,videoUrl:""}))}}}),s.videoFile?"\u2713 File Selected":"Choose Video"]}),(0,sa.jsx)("input",{type:"url",value:s.videoUrl,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{videoUrl:e.target.value,videoFile:null})),placeholder:"Or paste video URL",disabled:!!s.videoFile,className:"flex-1 px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"})]}),s.videoFile&&(0,sa.jsxs)("p",{className:"text-green-400 text-xs mt-1",children:["\ud83d\udcc1 ",s.videoFile.name," (",(s.videoFile.size/1048576).toFixed(1)," MB)"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Schedule (Optional)"}),(0,sa.jsx)("input",{type:"datetime-local",value:s.scheduledAt,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{scheduledAt:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,sa.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Leave empty to send immediately"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("input",{type:"checkbox",id:"isActive",checked:s.isActive,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{isActive:e.target.checked})),className:"w-5 h-5 text-blue-600 bg-slate-700 border-gray-600 rounded focus:ring-blue-500"}),(0,sa.jsx)("label",{htmlFor:"isActive",className:"text-gray-300 font-semibold",children:"Notification is Active"})]}),(0,sa.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:l,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:l?"Creating...":"Create Notification"}),(0,sa.jsx)("button",{type:"button",onClick:n,className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Cancel"})]})]})]}),u&&s.targetType===Ad&&(0,sa.jsx)(qd,{allPlayers:d,selectedPlayerIds:s.customPlayerIds,onSelect:e=>{a((0,i.A)((0,i.A)({},s),{},{customPlayerIds:e})),m(!1)},onClose:()=>m(!1)}),u&&s.targetType===Ld&&(0,sa.jsx)(Ud,{allStaff:c,selectedStaffIds:s.customStaffIds,onSelect:e=>{a((0,i.A)((0,i.A)({},s),{},{customStaffIds:e})),m(!1)},onClose:()=>m(!1)})]})}function qd(e){let{allPlayers:t,selectedPlayerIds:s,onSelect:a,onClose:n}=e;const[l,i]=(0,r.useState)(""),[o,d]=(0,r.useState)(new Set(s)),c=t.filter(e=>{if(!l)return!0;const t=l.toLowerCase();return e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.phoneNumber&&e.phoneNumber.includes(l)||e.playerId&&e.playerId.toLowerCase().includes(t)}),u=e=>{const t=new Set(o);t.has(e)?t.delete(e):t.add(e),d(t)};return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-3xl w-full max-h-[80vh] overflow-y-auto border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white mb-4",children:"Select Players for Custom Group"}),(0,sa.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),placeholder:"Search by name, email, or ID...",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-purple-500"}),(0,sa.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto mb-4",children:c.map(e=>(0,sa.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-700 rounded-lg hover:bg-slate-600 transition-colors cursor-pointer",onClick:()=>u(e.id),children:[(0,sa.jsx)("input",{type:"checkbox",checked:o.has(e.id),onChange:()=>u(e.id),className:"w-5 h-5 text-purple-600"}),(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:e.name}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:e.email})]})]},e.id))}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsxs)("button",{onClick:()=>a(Array.from(o)),className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 rounded-lg transition-colors",children:["Select ",o.size," Players"]}),(0,sa.jsx)("button",{onClick:n,className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Cancel"})]})]})})}function Ud(e){let{allStaff:t,selectedStaffIds:s,onSelect:a,onClose:n}=e;const[l,i]=(0,r.useState)(""),[o,d]=(0,r.useState)(new Set(s)),c=t.filter(e=>{if(!l)return!0;const t=l.toLowerCase();return e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.employeeId&&e.employeeId.toLowerCase().includes(t)||e.role&&e.role.toLowerCase().includes(t)}),u=e=>{const t=new Set(o);t.has(e)?t.delete(e):t.add(e),d(t)};return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-3xl w-full max-h-[80vh] overflow-y-auto border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white mb-4",children:"Select Staff Members for Custom Group"}),(0,sa.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),placeholder:"Search by name, email, employee ID, or role...",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-purple-500"}),(0,sa.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto mb-4",children:c.map(e=>(0,sa.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-700 rounded-lg hover:bg-slate-600 transition-colors cursor-pointer",onClick:()=>u(e.id),children:[(0,sa.jsx)("input",{type:"checkbox",checked:o.has(e.id),onChange:()=>u(e.id),className:"w-5 h-5 text-purple-600"}),(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:e.name}),(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:[e.email," \u2022 ",e.role]})]})]},e.id))}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsxs)("button",{onClick:()=>a(Array.from(o)),className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 rounded-lg transition-colors",children:["Select ",o.size," Staff Members"]}),(0,sa.jsx)("button",{onClick:n,className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Cancel"})]})]})})}function zd(e){let{selectedClubId:t}=e;const s=ra(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)(""),[y,v]=(0,r.useState)(""),[w,j]=(0,r.useState)(null),[N,S]=(0,r.useState)(null),[k,C]=(0,r.useState)("details"),[A,_]=(0,r.useState)(null),[P,T]=(0,r.useState)(0),E=["No Limit Hold'em","Pot Limit Omaha","Pot Limit Omaha Hi-Lo","Limit Hold'em","Seven Card Stud","Seven Card Stud Hi-Lo","Custom"],I=["Standard","Turbo","Super Turbo","Deep Stack","Hyper Turbo","Custom"],R=["Every 4 levels","Every 6 levels","Every 8 levels","No breaks","Custom"],D=["Top 10%","Top 15%","Top 20%","Top 25%","Winner takes all","Custom"],O=["Random","Table Balance","Manual","Custom"],L=["Standard (pause on breaks)","No Pause","Pause on All-in","Custom"],[F,M]=(0,r.useState)({name:"",tournament_type:"No Limit Hold'em",buy_in:"",entry_fee:"",starting_chips:"",blind_structure:"Standard",number_of_levels:15,minutes_per_level:15,break_structure:"Every 4 levels",break_duration:10,late_registration:60,payout_structure:"Top 15%",seat_draw_method:"Random",clock_pause_rules:"Standard (pause on breaks)",allow_rebuys:!1,allow_addon:!1,allow_reentry:!1,bounty_amount:"",max_players:100,start_time:"",custom_tournament_type:"",custom_blind_structure:"",custom_break_structure:"",custom_payout_structure:"",custom_seat_draw_method:"",custom_clock_pause_rules:""}),[B,q]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{if(t)try{const e=await jr.Od.getClub(t);_((null===e||void 0===e?void 0:e.logoUrl)||null)}catch(e){console.error("Error fetching club logo:",e)}})()},[t]);const{data:U,isLoading:z}=hn({queryKey:["tournaments",t],queryFn:()=>jr.Re.getTournaments(t),enabled:!!t}),{data:K,isLoading:W}=hn({queryKey:["tournament-details",t,null===w||void 0===w?void 0:w.id],queryFn:()=>jr.Re.getTournamentById(t,w.id),enabled:!!t&&!!w&&d}),{data:H,isLoading:V}=hn({queryKey:["tournament-players",t,null===w||void 0===w?void 0:w.id],queryFn:()=>jr.Re.getTournamentPlayers(t,w.id),enabled:!!t&&!!w&&(d||u)}),{data:J}=hn({queryKey:["tournament-winners",t,null===w||void 0===w?void 0:w.id],queryFn:()=>jr.Re.getTournamentWinners(t,w.id),enabled:!!t&&!!w&&"completed"===w.status}),Q=gn({mutationFn:e=>jr.Re.createTournament(t,e),onSuccess:()=>{wr.success("Tournament created successfully!"),s.invalidateQueries(["tournaments",t]),n(!1),ue()},onError:e=>{wr.error(e.message||"Failed to create tournament")}}),G=gn({mutationFn:e=>jr.Re.startTournament(t,e),onSuccess:()=>{wr.success("Tournament started successfully!"),s.invalidateQueries(["tournaments",t])},onError:e=>{wr.error(e.message||"Failed to start tournament")}}),Y=gn({mutationFn:e=>{let{tournamentId:s,winners:a}=e;return jr.Re.endTournament(t,s,{winners:a})},onSuccess:()=>{wr.success("Tournament ended and winners updated successfully!"),s.invalidateQueries(["tournaments",t]),m(!1),c(!1),q([])},onError:e=>{wr.error(e.message||"Failed to end tournament")}}),$=gn({mutationFn:e=>{let{tournamentId:s,data:a}=e;return jr.Re.updateTournament(t,s,a)},onSuccess:()=>{wr.success("Tournament updated successfully!"),s.invalidateQueries(["tournaments",t]),o(!1),S(null),ue()},onError:e=>{wr.error(e.message||"Failed to update tournament")}}),Z=gn({mutationFn:e=>jr.Re.deleteTournament(t,e),onSuccess:()=>{wr.success("Tournament deleted successfully!"),s.invalidateQueries(["tournaments",t])},onError:e=>{wr.error(e.message||"Failed to delete tournament")}}),X=gn({mutationFn:e=>jr.Re.exitTournamentPlayer(t,w.id,e),onSuccess:e=>{wr.success(e.message||"Player exited successfully!"),s.invalidateQueries(["tournament-players",t,null===w||void 0===w?void 0:w.id]),s.invalidateQueries(["tournaments",t]),x(!1),b(null),f(""),v("")},onError:e=>{wr.error(e.message||"Failed to exit player")}}),ee=gn({mutationFn:e=>jr.Re.rebuyTournamentPlayer(t,w.id,e),onSuccess:e=>{wr.success(e.message||"Rebuy successful!"),s.invalidateQueries(["tournament-players",t,null===w||void 0===w?void 0:w.id]),s.invalidateQueries(["tournaments",t])},onError:e=>{wr.error(e.message||"Failed to process rebuy")}}),te=gn({mutationFn:()=>jr.Re.pauseTournament(t,w.id),onSuccess:e=>{wr.success("Tournament paused!"),s.invalidateQueries(["tournaments",t]),s.invalidateQueries(["tournament-details",t,null===w||void 0===w?void 0:w.id]),null!==e&&void 0!==e&&e.tournament&&j(t=>(0,i.A)((0,i.A)({},t),e.tournament))},onError:e=>{wr.error(e.message||"Failed to pause tournament")}}),se=gn({mutationFn:()=>jr.Re.resumeTournament(t,w.id),onSuccess:e=>{wr.success("Tournament resumed!"),s.invalidateQueries(["tournaments",t]),s.invalidateQueries(["tournament-details",t,null===w||void 0===w?void 0:w.id]),null!==e&&void 0!==e&&e.tournament&&j(t=>(0,i.A)((0,i.A)({},t),e.tournament))},onError:e=>{wr.error(e.message||"Failed to resume tournament")}}),ae=gn({mutationFn:()=>jr.Re.stopTournament(t,w.id),onSuccess:()=>{wr.success("Tournament stopped!"),s.invalidateQueries(["tournaments",t]),s.invalidateQueries(["tournament-details",t,null===w||void 0===w?void 0:w.id]),c(!1),j(null)},onError:e=>{wr.error(e.message||"Failed to stop tournament")}});(0,r.useEffect)(()=>{const e=K||w;if(null===e||void 0===e||!e.session_started_at||"active"!==(null===e||void 0===e?void 0:e.status))return void T(0);const t=new Date(e.session_started_at).getTime(),s=parseInt(e.total_paused_seconds)||0,a=!!e.paused_at,r=e.paused_at?new Date(e.paused_at).getTime():null,n=()=>{const e=Date.now(),n=Math.floor((e-t)/1e3);if(a&&r){const e=Math.floor((r-t)/1e3);T(e-s)}else T(n-s)};n();const l=a?null:setInterval(n,1e3);return()=>{l&&clearInterval(l)}},[K,w]);const re=(0,r.useCallback)(e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),a=e%60;return"".concat(t.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))},[]),ne=()=>{window.confirm("Pause the tournament session? The timer and levels will be frozen.")&&te.mutate()},le=()=>{se.mutate()},ie=()=>{window.confirm("Force STOP this tournament? This will end the tournament without declaring winners. This action cannot be undone.")&&ae.mutate()},oe=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rebuy";const s="rebuy"===t?"Rebuy":"reentry"===t?"Re-enter":"Add-on",a=fe||w,r=parseFloat((null===a||void 0===a?void 0:a.buy_in)||0);window.confirm("".concat(s," for ").concat(e.name,"? This will charge \u20b9").concat(r," buy-in."))&&ee.mutate({playerId:e.id,type:t})},de=(0,r.useCallback)(()=>{const e=K||w;if(null===e||void 0===e||!e.session_started_at||"active"!==(null===e||void 0===e?void 0:e.status))return null;let t=e.structure||{};if("string"===typeof t)try{t=JSON.parse(t)}catch(N){t={}}const s=t.minutes_per_level||e.minutes_per_level||15,a=t.number_of_levels||e.number_of_levels||15,r=t.break_structure||e.break_structure||"",n=t.break_duration||e.break_duration||10,l=t.late_registration||e.late_registration||0,i=t.allow_rebuys||e.allow_rebuys||!1,o=t.allow_reentry||e.allow_reentry||!1,d=t.allow_addon||e.allow_addon||!1;let c=0;const u=r.match(/(\d+)/);u&&(c=parseInt(u[1]));const m=P/60;let h=1,x=0,p=!1,b=0;for(let w=1;w<=a;w++){const e=x+s;if(m<e){h=w;break}if(x=e,h=w,c>0&&w%c===0&&w<a){const e=x+n;if(m<e){p=!0,b=Math.ceil(e-m);break}x=e}}let g=0;for(let w=1;w<h;w++)g+=s,c>0&&w%c===0&&(g+=n);const f=m-g,y=Math.max(0,s-f),v=Math.ceil(60*y),j=l>0&&m<=l;return{currentLevel:h,numberOfLevels:a,minutesPerLevel:s,onBreak:p,breakTimeRemaining:b,timeRemainingInLevel:Math.ceil(y),timeRemainingSeconds:v,lateRegOpen:j,lateRegistration:l,allowRebuys:i,allowReentry:o,allowAddon:d,breakEveryNLevels:c,breakDuration:n,elapsedMinutes:Math.floor(m)}},[K,w,P]),ce=de(),ue=()=>{M({name:"",tournament_type:"No Limit Hold'em",buy_in:"",entry_fee:"",starting_chips:"",blind_structure:"Standard",number_of_levels:15,minutes_per_level:15,break_structure:"Every 4 levels",break_duration:10,late_registration:60,payout_structure:"Top 15%",seat_draw_method:"Random",clock_pause_rules:"Standard (pause on breaks)",allow_rebuys:!1,allow_addon:!1,allow_reentry:!1,bounty_amount:"",max_players:100,start_time:"",custom_tournament_type:"",custom_blind_structure:"",custom_break_structure:"",custom_payout_structure:"",custom_seat_draw_method:"",custom_clock_pause_rules:""})},me=e=>{window.confirm("Are you sure you want to start this tournament?")&&G.mutate(e)},he=e=>{var t,s,a,r,n,l,i;S(e);let d={};if(e.structure&&"string"===typeof e.structure)try{d=JSON.parse(e.structure)}catch(ia){d={}}else e.structure&&(d=e.structure);M({name:e.name||"",tournament_type:d.tournament_type||e.tournament_type||"No Limit Hold'em",buy_in:(null===(t=e.buy_in)||void 0===t?void 0:t.toString())||"",entry_fee:(null===(s=e.entry_fee)||void 0===s?void 0:s.toString())||(null===(a=d.entry_fee)||void 0===a?void 0:a.toString())||"",starting_chips:(null===(r=e.starting_chips)||void 0===r?void 0:r.toString())||(null===(n=d.starting_chips)||void 0===n?void 0:n.toString())||"",blind_structure:d.blind_structure||e.blind_structure||"Standard",number_of_levels:d.number_of_levels||e.number_of_levels||15,minutes_per_level:d.minutes_per_level||e.minutes_per_level||15,break_structure:d.break_structure||e.break_structure||"Every 4 levels",break_duration:d.break_duration||e.break_duration||10,late_registration:d.late_registration||e.late_registration||60,payout_structure:d.payout_structure||e.payout_structure||"Top 15%",seat_draw_method:d.seat_draw_method||e.seat_draw_method||"Random",clock_pause_rules:d.clock_pause_rules||e.clock_pause_rules||"Standard (pause on breaks)",allow_rebuys:d.allow_rebuys||e.allow_rebuys||!1,allow_addon:d.allow_addon||e.allow_addon||!1,allow_reentry:d.allow_reentry||e.allow_reentry||!1,bounty_amount:(null===(l=e.bounty_amount)||void 0===l?void 0:l.toString())||(null===(i=d.bounty_amount)||void 0===i?void 0:i.toString())||"",max_players:e.max_players||100,start_time:e.start_time?new Date(e.start_time).toISOString().slice(0,16):"",custom_tournament_type:e.custom_tournament_type||"",custom_blind_structure:e.custom_blind_structure||"",custom_break_structure:e.custom_break_structure||"",custom_payout_structure:e.custom_payout_structure||"",custom_seat_draw_method:e.custom_seat_draw_method||"",custom_clock_pause_rules:e.custom_clock_pause_rules||""}),o(!0)},xe=(e,t,s)=>{const a=[...B];a[e][t]=s,q(a)},pe=U||[],be=(null===H||void 0===H?void 0:H.players)||H||[],ge=(null===J||void 0===J?void 0:J.winners)||[],fe=K||w,ye=e=>{switch(e){case"scheduled":return"bg-blue-500/20 text-blue-300 border-blue-500";case"active":return"bg-green-500/20 text-green-300 border-green-500";case"completed":return"bg-gray-500/20 text-gray-300 border-gray-500";default:return"bg-slate-500/20 text-slate-300 border-slate-500"}};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Tournament Management"}),(0,sa.jsx)("button",{onClick:()=>n(!0),className:"bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-400 hover:to-orange-500 text-white px-6 py-3 rounded-lg font-semibold shadow-lg transition-all",children:"\u2795 Create Tournament"})]}),z?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading tournaments..."})]}):0===pe.length?(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfc6"}),(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Tournaments Yet"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Create your first tournament to get started"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:pe.map(e=>{var t;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 hover:border-emerald-600 transition-all",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:e.name}),(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold border ".concat(ye(e.status)),children:null===(t=e.status)||void 0===t?void 0:t.toUpperCase()}),"active"===e.status&&e.session_started_at&&(0,sa.jsx)("div",{className:"flex items-center gap-1.5 mt-2",children:e.paused_at?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),(0,sa.jsx)("span",{className:"text-yellow-400 text-xs font-medium",children:"Session Paused"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,sa.jsx)("span",{className:"text-green-400 text-xs font-medium",children:"Session Running"})]})})]}),(0,sa.jsxs)("div",{className:"text-right",children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Tournament ID"}),(0,sa.jsx)("p",{className:"text-white font-mono",children:e.tournament_id})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Type"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:e.tournament_type})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Buy-in"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",e.buy_in]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Starting Chips"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:e.starting_chips})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Players"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:[e.registered_players||0," / ",e.max_players]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>{j(e),c(!0),C("details")},className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"View Details"}),"scheduled"===e.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>he(e),className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Edit"}),(0,sa.jsx)("button",{onClick:()=>me(e.id),className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Start"})]}),"active"===e.status&&(0,sa.jsxs)(sa.Fragment,{children:[e.paused_at?(0,sa.jsx)("button",{onClick:()=>{j(e),se.mutate()},className:"bg-green-600 hover:bg-green-500 text-white px-3 py-2 rounded-lg font-semibold transition-colors text-sm",children:"\u25b6 Resume"}):(0,sa.jsx)("button",{onClick:()=>{j(e),te.mutate()},className:"bg-yellow-600 hover:bg-yellow-500 text-white px-3 py-2 rounded-lg font-semibold transition-colors text-sm",children:"\u23f8 Pause"}),(0,sa.jsx)("button",{onClick:()=>{j(e),m(!0)},className:"flex-1 bg-orange-600 hover:bg-orange-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"End Tournament"})]}),"completed"===e.status&&(0,sa.jsx)("button",{onClick:()=>{j(e),c(!0),C("details")},className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"View Winners"}),"scheduled"===e.status&&(0,sa.jsx)("button",{onClick:()=>{return t=e.id,s=e.name,void(window.confirm('Are you sure you want to delete "'.concat(s,'"?'))&&Z.mutate(t));var t,s},className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Delete"})]})]},e.id)})}),a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full border border-emerald-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Create New Tournament"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white border-b border-white/20 pb-2",children:"Basic Information"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Tournament Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"Monday Night Hold'em",value:F.name,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{name:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Tournament Type *"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",value:F.tournament_type,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{tournament_type:e.target.value})),children:E.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.tournament_type&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Tournament Type"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"Enter custom type",value:F.custom_tournament_type,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_tournament_type:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Buy-in (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"1000",value:F.buy_in,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{buy_in:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Entry Fee (\u20b9)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"100",value:F.entry_fee,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{entry_fee:e.target.value}))})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Starting Chips *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"10000",value:F.starting_chips,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{starting_chips:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Time"}),(0,sa.jsx)("input",{type:"datetime-local",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",value:F.start_time,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{start_time:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Max Players"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"100",value:F.max_players,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{max_players:e.target.value}))})]})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white border-b border-white/20 pb-2",children:"Tournament Rules"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Blind Structure *"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",value:F.blind_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{blind_structure:e.target.value})),children:I.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.blind_structure&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Blind Structure"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"Enter custom structure",value:F.custom_blind_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_blind_structure:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Number of Levels"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"15",value:F.number_of_levels,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{number_of_levels:parseInt(e.target.value)||15}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Minutes per Level"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"15",value:F.minutes_per_level,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{minutes_per_level:parseInt(e.target.value)||15}))})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Break Structure"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",value:F.break_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{break_structure:e.target.value})),children:R.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.break_structure&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Break Structure"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"Enter custom structure",value:F.custom_break_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_break_structure:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Break Duration (minutes)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"10",value:F.break_duration,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{break_duration:parseInt(e.target.value)||10}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Late Registration (minutes)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"60",value:F.late_registration,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{late_registration:parseInt(e.target.value)||60}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Payout Structure"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",value:F.payout_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{payout_structure:e.target.value})),children:D.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.payout_structure&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Payout Structure"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"Enter custom structure",value:F.custom_payout_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_payout_structure:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Seat Draw Method"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",value:F.seat_draw_method,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{seat_draw_method:e.target.value})),children:O.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.seat_draw_method&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Seat Draw Method"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"Enter custom method",value:F.custom_seat_draw_method,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_seat_draw_method:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Clock Pause Rules"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",value:F.clock_pause_rules,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{clock_pause_rules:e.target.value})),children:L.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.clock_pause_rules&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Clock Pause Rules"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"Enter custom rules",value:F.custom_clock_pause_rules,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_clock_pause_rules:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"col-span-2 space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white border-b border-white/20 pb-2",children:"Rebuy, Add-on & Re-entry Options"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,sa.jsxs)("label",{className:"flex items-center space-x-3 text-white cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",className:"w-5 h-5 rounded bg-slate-700 border-slate-600 text-emerald-500 focus:ring-emerald-500",checked:F.allow_rebuys,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{allow_rebuys:e.target.checked}))}),(0,sa.jsx)("span",{children:"Allow Rebuys"})]}),(0,sa.jsxs)("label",{className:"flex items-center space-x-3 text-white cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",className:"w-5 h-5 rounded bg-slate-700 border-slate-600 text-emerald-500 focus:ring-emerald-500",checked:F.allow_addon,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{allow_addon:e.target.checked}))}),(0,sa.jsx)("span",{children:"Allow Add-on"})]}),(0,sa.jsxs)("label",{className:"flex items-center space-x-3 text-white cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",className:"w-5 h-5 rounded bg-slate-700 border-slate-600 text-emerald-500 focus:ring-emerald-500",checked:F.allow_reentry,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{allow_reentry:e.target.checked}))}),(0,sa.jsx)("span",{children:"Allow Re-entry"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Bounty Amount (\u20b9) - Leave blank for regular tournament"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500",placeholder:"0",value:F.bounty_amount,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{bounty_amount:e.target.value}))}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"If set, this becomes a knockout/bounty tournament"})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{if(!F.name||!F.buy_in||!F.starting_chips)return void wr.error("Please fill in all required fields");const e={name:F.name,tournament_type:F.tournament_type,buy_in:parseFloat(F.buy_in)||0,entry_fee:F.entry_fee?parseFloat(F.entry_fee):void 0,starting_chips:parseInt(F.starting_chips)||0,blind_structure:F.blind_structure,number_of_levels:parseInt(F.number_of_levels)||15,minutes_per_level:parseInt(F.minutes_per_level)||15,break_structure:F.break_structure,break_duration:parseInt(F.break_duration)||10,late_registration:parseInt(F.late_registration)||60,payout_structure:F.payout_structure,seat_draw_method:F.seat_draw_method,clock_pause_rules:F.clock_pause_rules,allow_rebuys:Boolean(F.allow_rebuys),allow_addon:Boolean(F.allow_addon),allow_reentry:Boolean(F.allow_reentry),bounty_amount:F.bounty_amount?parseFloat(F.bounty_amount):void 0,max_players:parseInt(F.max_players)||100,start_time:F.start_time||void 0,custom_tournament_type:F.custom_tournament_type||void 0,custom_blind_structure:F.custom_blind_structure||void 0,custom_break_structure:F.custom_break_structure||void 0,custom_payout_structure:F.custom_payout_structure||void 0,custom_seat_draw_method:F.custom_seat_draw_method||void 0,custom_clock_pause_rules:F.custom_clock_pause_rules||void 0};Q.mutate(e)},disabled:Q.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:Q.isLoading?"Creating...":"Create Tournament"}),(0,sa.jsx)("button",{onClick:()=>{n(!1),ue()},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),l&&N&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full border border-purple-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white mb-6",children:["Edit Tournament: ",N.name]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white border-b border-white/20 pb-2",children:"Basic Information"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Tournament Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Monday Night Hold'em",value:F.name,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{name:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Tournament Type *"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:F.tournament_type,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{tournament_type:e.target.value})),children:E.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.tournament_type&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Tournament Type"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Enter custom type",value:F.custom_tournament_type,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_tournament_type:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Buy-in (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"1000",value:F.buy_in,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{buy_in:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Entry Fee (\u20b9)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"100",value:F.entry_fee,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{entry_fee:e.target.value}))})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Starting Chips *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"10000",value:F.starting_chips,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{starting_chips:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Time"}),(0,sa.jsx)("input",{type:"datetime-local",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:F.start_time,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{start_time:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Max Players"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"100",value:F.max_players,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{max_players:e.target.value}))})]})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white border-b border-white/20 pb-2",children:"Tournament Rules"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Blind Structure *"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:F.blind_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{blind_structure:e.target.value})),children:I.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.blind_structure&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Blind Structure"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Enter custom structure",value:F.custom_blind_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_blind_structure:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Number of Levels"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"15",value:F.number_of_levels,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{number_of_levels:parseInt(e.target.value)||15}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Minutes per Level"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"15",value:F.minutes_per_level,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{minutes_per_level:parseInt(e.target.value)||15}))})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Break Structure"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:F.break_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{break_structure:e.target.value})),children:R.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.break_structure&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Break Structure"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Enter custom structure",value:F.custom_break_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_break_structure:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Break Duration (minutes)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"10",value:F.break_duration,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{break_duration:parseInt(e.target.value)||10}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Late Registration (minutes)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"60",value:F.late_registration,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{late_registration:parseInt(e.target.value)||60}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Payout Structure"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:F.payout_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{payout_structure:e.target.value})),children:D.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.payout_structure&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Payout Structure"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Enter custom structure",value:F.custom_payout_structure,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_payout_structure:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Seat Draw Method"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:F.seat_draw_method,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{seat_draw_method:e.target.value})),children:O.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.seat_draw_method&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Seat Draw Method"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Enter custom method",value:F.custom_seat_draw_method,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_seat_draw_method:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Clock Pause Rules"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:F.clock_pause_rules,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{clock_pause_rules:e.target.value})),children:L.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===F.clock_pause_rules&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Clock Pause Rules"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Enter custom rules",value:F.custom_clock_pause_rules,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{custom_clock_pause_rules:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"col-span-2 space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white border-b border-white/20 pb-2",children:"Rebuy, Add-on & Re-entry Options"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,sa.jsxs)("label",{className:"flex items-center space-x-3 text-white cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",className:"w-5 h-5 rounded bg-slate-700 border-slate-600 text-purple-500 focus:ring-purple-500",checked:F.allow_rebuys,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{allow_rebuys:e.target.checked}))}),(0,sa.jsx)("span",{children:"Allow Rebuys"})]}),(0,sa.jsxs)("label",{className:"flex items-center space-x-3 text-white cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",className:"w-5 h-5 rounded bg-slate-700 border-slate-600 text-purple-500 focus:ring-purple-500",checked:F.allow_addon,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{allow_addon:e.target.checked}))}),(0,sa.jsx)("span",{children:"Allow Add-on"})]}),(0,sa.jsxs)("label",{className:"flex items-center space-x-3 text-white cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",className:"w-5 h-5 rounded bg-slate-700 border-slate-600 text-purple-500 focus:ring-purple-500",checked:F.allow_reentry,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{allow_reentry:e.target.checked}))}),(0,sa.jsx)("span",{children:"Allow Re-entry"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Bounty Amount (\u20b9) - Leave blank for regular tournament"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"0",value:F.bounty_amount,onChange:e=>M((0,i.A)((0,i.A)({},F),{},{bounty_amount:e.target.value}))}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"If set, this becomes a knockout/bounty tournament"})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{if(!F.name||!F.buy_in||!F.starting_chips)return void wr.error("Please fill in all required fields");const e={name:F.name,tournament_type:F.tournament_type,buy_in:parseFloat(F.buy_in)||0,entry_fee:F.entry_fee?parseFloat(F.entry_fee):void 0,starting_chips:parseInt(F.starting_chips)||0,blind_structure:F.blind_structure,number_of_levels:parseInt(F.number_of_levels)||15,minutes_per_level:parseInt(F.minutes_per_level)||15,break_structure:F.break_structure,break_duration:parseInt(F.break_duration)||10,late_registration:parseInt(F.late_registration)||60,payout_structure:F.payout_structure,seat_draw_method:F.seat_draw_method,clock_pause_rules:F.clock_pause_rules,allow_rebuys:Boolean(F.allow_rebuys),allow_addon:Boolean(F.allow_addon),allow_reentry:Boolean(F.allow_reentry),bounty_amount:F.bounty_amount?parseFloat(F.bounty_amount):void 0,max_players:parseInt(F.max_players)||100,start_time:F.start_time||void 0,custom_tournament_type:F.custom_tournament_type||void 0,custom_blind_structure:F.custom_blind_structure||void 0,custom_break_structure:F.custom_break_structure||void 0,custom_payout_structure:F.custom_payout_structure||void 0,custom_seat_draw_method:F.custom_seat_draw_method||void 0,custom_clock_pause_rules:F.custom_clock_pause_rules||void 0};$.mutate({tournamentId:N.id,data:e})},disabled:$.isLoading,className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:$.isLoading?"Updating...":"Update Tournament"}),(0,sa.jsx)("button",{onClick:()=>{o(!1),S(null),ue()},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),d&&w&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-6xl w-full border border-emerald-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:w.name}),(0,sa.jsx)("button",{onClick:()=>{c(!1),j(null)},className:"text-gray-400 hover:text-white text-2xl",children:"\xd7"})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>C("details"),className:"px-4 py-2 font-semibold transition-colors ".concat("details"===k?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Details"}),(0,sa.jsxs)("button",{onClick:()=>C("players"),className:"px-4 py-2 font-semibold transition-colors ".concat("players"===k?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:["Players (",be.length,")"]}),"completed"===w.status&&(0,sa.jsxs)("button",{onClick:()=>C("winners"),className:"px-4 py-2 font-semibold transition-colors ".concat("winners"===k?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:["Winners (",ge.length,")"]})]}),"details"===k&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"relative w-full bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl p-8 border border-slate-700",children:[(0,sa.jsx)("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-10",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-emerald-600 via-green-500 to-emerald-500 border-2 border-emerald-400/80 px-6 py-3 rounded-lg text-center shadow-xl",children:[(0,sa.jsx)("div",{className:"text-emerald-200 text-xs font-semibold uppercase tracking-wider",children:"Prize Pool"}),(0,sa.jsxs)("div",{className:"text-white text-2xl font-bold",children:["\u20b9",(w.prize_pool||w.buy_in*(be.length||w.registered_players||0)).toLocaleString()]})]})}),(0,sa.jsx)("div",{className:"relative w-full max-w-lg mx-auto mt-16 mb-8",style:{aspectRatio:"1.8 / 1"},children:(0,sa.jsx)("div",{className:"absolute inset-0 rounded-[50%] bg-gradient-to-br from-amber-900 via-yellow-900 to-amber-950 shadow-2xl",style:{borderRadius:"50%"},children:(0,sa.jsx)("div",{className:"absolute inset-2 rounded-[50%] bg-gradient-to-br from-slate-700 via-slate-600 to-slate-700",style:{borderRadius:"50%"},children:(0,sa.jsxs)("div",{className:"absolute inset-2 rounded-[50%] bg-gradient-to-br from-emerald-700 via-green-800 to-emerald-900 shadow-inner flex items-center justify-center",style:{borderRadius:"50%"},children:[(0,sa.jsx)("div",{className:"absolute inset-6 rounded-[50%] border border-emerald-600/30",style:{borderRadius:"50%"}}),(0,sa.jsxs)("div",{className:"w-28 h-28 bg-white/10 rounded-full border-2 border-white/20 flex items-center justify-center shadow-xl backdrop-blur-sm overflow-hidden z-10",children:[A?(0,sa.jsx)("img",{src:A,alt:"Club Logo",className:"w-full h-full object-contain rounded-full p-2",onError:e=>{e.target.style.display="none";const t=e.target.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,sa.jsx)("div",{className:"text-4xl font-bold text-white/30 ".concat(A?"hidden":"flex"," items-center justify-center w-full h-full"),children:"\u2660"})]})]})})})}),"active"===(null===fe||void 0===fe?void 0:fe.status)&&(null===fe||void 0===fe?void 0:fe.session_started_at)&&(0,sa.jsxs)("div",{className:"mt-6 space-y-3",children:[(()=>{const e=!(null===fe||void 0===fe||!fe.paused_at);return(0,sa.jsxs)("div",{className:"".concat(e?"bg-gradient-to-r from-yellow-900/40 to-orange-900/40 border-yellow-500/30":"bg-gradient-to-r from-green-900/40 to-emerald-900/40 border-green-500/30"," border rounded-xl p-4"),children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e?"bg-yellow-500":"bg-green-500 animate-pulse")}),(0,sa.jsx)("span",{className:"".concat(e?"text-yellow-400":"text-green-400"," text-sm font-medium uppercase tracking-wider"),children:e?"PAUSED":"LIVE"})]}),(0,sa.jsx)("div",{className:"text-4xl font-mono font-bold ".concat(e?"text-yellow-300":"text-green-300"," tabular-nums"),children:re(P)}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[e?(0,sa.jsx)("button",{onClick:le,disabled:se.isLoading,className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors disabled:opacity-50 flex items-center gap-1",children:"\u25b6 Resume"}):(0,sa.jsx)("button",{onClick:ne,disabled:te.isLoading,className:"bg-yellow-600 hover:bg-yellow-500 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors disabled:opacity-50 flex items-center gap-1",children:"\u23f8 Pause"}),(0,sa.jsx)("button",{onClick:ie,disabled:ae.isLoading,className:"bg-red-700 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors disabled:opacity-50 flex items-center gap-1",children:"\u23f9 Stop"})]})]}),e&&(0,sa.jsxs)("div",{className:"mt-2 text-yellow-400/70 text-xs text-center",children:["Tournament paused since ",new Date(fe.paused_at).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0})]})]})})(),ce&&(0,sa.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,sa.jsxs)("div",{className:"rounded-lg p-3 text-center border ".concat(ce.onBreak?"bg-yellow-900/30 border-yellow-500/30":"bg-blue-900/30 border-blue-500/30"),children:[(0,sa.jsx)("div",{className:"text-xs mb-1 ".concat(ce.onBreak?"text-yellow-400":"text-blue-400"),children:ce.onBreak?"ON BREAK":"Current Level"}),(0,sa.jsx)("div",{className:"text-2xl font-bold ".concat(ce.onBreak?"text-yellow-300":"text-blue-300"),children:ce.onBreak?"".concat(ce.breakTimeRemaining,"m"):"".concat(ce.currentLevel," / ").concat(ce.numberOfLevels)})]}),(0,sa.jsxs)("div",{className:"bg-purple-900/30 rounded-lg p-3 text-center border border-purple-500/30",children:[(0,sa.jsx)("div",{className:"text-purple-400 text-xs mb-1",children:"Time Left in Level"}),(0,sa.jsx)("div",{className:"text-2xl font-bold text-purple-300 font-mono tabular-nums",children:ce.onBreak?"--:--":"".concat(Math.floor(ce.timeRemainingSeconds/60),":").concat((ce.timeRemainingSeconds%60).toString().padStart(2,"0"))})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Level Duration"}),(0,sa.jsxs)("div",{className:"text-lg font-bold text-white",children:[ce.minutesPerLevel," min"]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Features"}),(0,sa.jsxs)("div",{className:"flex flex-wrap gap-1 justify-center",children:[ce.allowRebuys&&(0,sa.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-green-600/20 text-green-400 border border-green-500/30",children:"Rebuy"}),ce.allowReentry&&(0,sa.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-blue-600/20 text-blue-400 border border-blue-500/30",children:"Re-entry"}),ce.allowAddon&&(0,sa.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-purple-600/20 text-purple-400 border border-purple-500/30",children:"Add-on"}),ce.lateRegOpen&&(0,sa.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-yellow-600/20 text-yellow-400 border border-yellow-500/30",children:"Late Reg Open"}),!ce.allowRebuys&&!ce.allowReentry&&!ce.allowAddon&&(0,sa.jsx)("span",{className:"text-xs text-gray-500",children:"Freezeout"})]})]})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Type"}),(0,sa.jsx)("div",{className:"text-white font-semibold text-sm",children:w.tournament_type||"Tournament"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Buy-In"}),(0,sa.jsxs)("div",{className:"text-white font-semibold text-sm",children:["\u20b9",w.buy_in]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Players"}),(0,sa.jsxs)("div",{className:"text-white font-semibold text-sm",children:[be.length||w.registered_players||0,"/",w.max_players]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Status"}),(0,sa.jsx)("div",{className:"text-white font-semibold text-sm",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("active"===w.status?"bg-green-500/20 text-green-300":"completed"===w.status?"bg-gray-500/20 text-gray-300":"bg-yellow-500/20 text-yellow-300"),children:w.status})})]})]})]}),(e=>{const t=fe||w;let s=t.structure||{};if("string"===typeof s)try{s=JSON.parse(s)}catch(i){s={}}const a=[{label:"Tournament ID",value:null===(e=t.id)||void 0===e?void 0:e.substring(0,8),mono:!0},{label:"Tournament Type",value:s.tournament_type||t.tournament_type},{label:"Buy-In",value:t.buy_in?"\u20b9".concat(Number(t.buy_in).toLocaleString()):null},{label:"Entry Fee",value:s.entry_fee||t.entry_fee?"\u20b9".concat(Number(s.entry_fee||t.entry_fee).toLocaleString()):null},{label:"Starting Chips",value:s.starting_chips||t.starting_chips?Number(s.starting_chips||t.starting_chips).toLocaleString():null},{label:"Prize Pool",value:t.prize_pool?"\u20b9".concat(Number(t.prize_pool).toLocaleString()):null},{label:"Blind Structure",value:s.blind_structure||t.blind_structure},{label:"Number of Levels",value:s.number_of_levels||t.number_of_levels},{label:"Minutes per Level",value:s.minutes_per_level||t.minutes_per_level?"".concat(s.minutes_per_level||t.minutes_per_level," min"):null},{label:"Break Structure",value:s.break_structure||t.break_structure},{label:"Break Duration",value:s.break_duration||t.break_duration?"".concat(s.break_duration||t.break_duration," min"):null},{label:"Late Registration",value:s.late_registration||t.late_registration?"".concat(s.late_registration||t.late_registration," min"):null},{label:"Payout Structure",value:s.payout_structure||t.payout_structure},{label:"Seat Draw Method",value:s.seat_draw_method||t.seat_draw_method},{label:"Clock Pause Rules",value:s.clock_pause_rules||t.clock_pause_rules},{label:"Allow Rebuys",value:s.allow_rebuys||t.allow_rebuys?"Yes":"No",badge:!0,positive:!(!s.allow_rebuys&&!t.allow_rebuys)},{label:"Allow Re-entry",value:s.allow_reentry||t.allow_reentry?"Yes":"No",badge:!0,positive:!(!s.allow_reentry&&!t.allow_reentry)},{label:"Allow Add-on",value:s.allow_addon||t.allow_addon?"Yes":"No",badge:!0,positive:!(!s.allow_addon&&!t.allow_addon)},{label:"Bounty Amount",value:s.bounty_amount||t.bounty_amount?"\u20b9".concat(Number(s.bounty_amount||t.bounty_amount).toLocaleString()):null},{label:"Max Players",value:t.max_players},{label:"Start Time",value:t.start_time?new Date(t.start_time).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",dateStyle:"medium",timeStyle:"short",hour12:!0}):null},{label:"Session Started",value:t.session_started_at?new Date(t.session_started_at).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",dateStyle:"medium",timeStyle:"short",hour12:!0}):null}].filter(e=>null!==e.value&&void 0!==e.value&&""!==e.value&&"N/A"!==e.value),r=Math.ceil(a.length/2),n=a.slice(0,r),l=a.slice(r);return(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n,l].map((e,t)=>(0,sa.jsx)("div",{className:"space-y-3",children:e.map((e,t)=>(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.label}),e.badge?(0,sa.jsx)("span",{className:"inline-block text-xs px-2 py-1 rounded ".concat(e.positive?"bg-green-600/20 text-green-400 border border-green-500/30":"bg-gray-600/20 text-gray-400 border border-gray-500/30"),children:e.value}):(0,sa.jsx)("p",{className:"text-white ".concat(e.mono?"font-mono":""),children:e.value})]},t))},t))})})(),(0,sa.jsxs)("div",{className:"mt-6 flex gap-4 pt-4 border-t border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>{c(!1),j(null)},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-6 py-2 rounded-lg",children:"Close"}),"scheduled"===w.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>{c(!1),he(w)},className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-6 py-2 rounded-lg",children:"Edit Tournament"}),(0,sa.jsx)("button",{onClick:()=>me(w.id),disabled:G.isLoading,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg disabled:opacity-50",children:"Start Tournament"})]}),"active"===w.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>m(!0),className:"flex-1 bg-orange-600 hover:bg-orange-500 text-white px-6 py-2 rounded-lg",children:"End with Winners"}),(0,sa.jsx)("button",{onClick:ie,disabled:ae.isLoading,className:"bg-red-700 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-semibold disabled:opacity-50",children:ae.isLoading?"Stopping...":"Force Stop"})]})]})]}),"players"===k&&(0,sa.jsxs)("div",{className:"space-y-4",children:["active"===(null===fe||void 0===fe?void 0:fe.status)&&(null===fe||void 0===fe?void 0:fe.session_started_at)&&(0,sa.jsxs)("div",{className:"".concat(null!==fe&&void 0!==fe&&fe.paused_at?"bg-gradient-to-r from-yellow-900/30 to-orange-900/30 border-yellow-500/20":"bg-gradient-to-r from-green-900/30 to-emerald-900/30 border-green-500/20"," border rounded-lg p-3 space-y-2"),children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(null!==fe&&void 0!==fe&&fe.paused_at?"bg-yellow-500":"bg-green-500 animate-pulse")}),(0,sa.jsx)("span",{className:"".concat(null!==fe&&void 0!==fe&&fe.paused_at?"text-yellow-400":"text-green-400"," text-sm font-medium"),children:null!==fe&&void 0!==fe&&fe.paused_at?"Tournament PAUSED":"Tournament Session Active"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"text-2xl font-mono font-bold ".concat(null!==fe&&void 0!==fe&&fe.paused_at?"text-yellow-300":"text-green-300"," tabular-nums"),children:re(P)}),null!==fe&&void 0!==fe&&fe.paused_at?(0,sa.jsx)("button",{onClick:le,disabled:se.isLoading,className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded text-xs font-semibold disabled:opacity-50",children:"\u25b6 Resume"}):(0,sa.jsx)("button",{onClick:ne,disabled:te.isLoading,className:"bg-yellow-600 hover:bg-yellow-500 text-white px-3 py-1.5 rounded text-xs font-semibold disabled:opacity-50",children:"\u23f8 Pause"})]})]}),ce&&(0,sa.jsxs)("div",{className:"flex items-center gap-4 text-sm flex-wrap",children:[(0,sa.jsx)("span",{className:"font-semibold ".concat(ce.onBreak?"text-yellow-400":"text-blue-400"),children:ce.onBreak?"BREAK (".concat(ce.breakTimeRemaining,"m left)"):"Level ".concat(ce.currentLevel,"/").concat(ce.numberOfLevels)}),!ce.onBreak&&(0,sa.jsxs)("span",{className:"text-purple-400 font-mono tabular-nums",children:[Math.floor(ce.timeRemainingSeconds/60),":",(ce.timeRemainingSeconds%60).toString().padStart(2,"0")," left"]}),ce.lateRegOpen&&(0,sa.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-yellow-600/20 text-yellow-400 border border-yellow-500/30",children:"Late Reg Open"}),(0,sa.jsxs)("div",{className:"flex gap-1 ml-auto",children:[ce.allowRebuys&&(0,sa.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-green-600/20 text-green-400",children:"Rebuy"}),ce.allowReentry&&(0,sa.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-blue-600/20 text-blue-400",children:"Re-entry"}),ce.allowAddon&&(0,sa.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-purple-600/20 text-purple-400",children:"Add-on"})]})]})]}),V?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading players..."})]}):0===be.length?(0,sa.jsx)("div",{className:"text-center py-12",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"No players registered yet"})}):(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Name"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Mobile"}),(0,sa.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-semibold",children:"Balance"}),(0,sa.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-semibold",children:"Credits"}),"active"===w.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("th",{className:"text-center py-3 px-4 text-gray-400 font-semibold",children:"Session"}),(0,sa.jsx)("th",{className:"text-center py-3 px-4 text-gray-400 font-semibold",children:"Status"})]}),"completed"===w.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Position"}),(0,sa.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-semibold",children:"Prize"})]}),"active"===w.status&&(0,sa.jsx)("th",{className:"text-center py-3 px-4 text-gray-400 font-semibold",children:"Action"})]})}),(0,sa.jsx)("tbody",{children:be.map(e=>{const t=Number(e.wallet_balance||0),s=Number(e.total_credits||0),a=e.is_exited;let r=null;const n=fe||w,l=null!==n&&void 0!==n&&n.paused_at?new Date(n.paused_at).getTime():null,i=parseInt(null===n||void 0===n?void 0:n.total_paused_seconds)||0,o=null!==n&&void 0!==n&&n.session_started_at?new Date(n.session_started_at).getTime():null,d=!(null===n||void 0===n||!n.paused_at);if(e.session_started_at&&!a){const t=new Date(e.session_started_at).getTime();let s;if(d&&l){const e=Math.max(t,l);s=Math.floor((e-t)/1e3);o&&Math.max(0,i-Math.max(0,Math.floor((t-o)/1e3)-Math.floor((Date.now()-o)/1e3)+i));const a=Math.floor((l-o)/1e3)-i,r=Math.max(0,Math.floor((t-o)/1e3));s=Math.max(0,a-r)}else{const e=Date.now(),a=(o?Math.floor((e-o)/1e3):0)-i,r=o?Math.max(0,Math.floor((t-o)/1e3)):0;s=Math.max(0,a-r)}const a=Math.floor(s/3600),n=Math.floor(s%3600/60),c=s%60;r="".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(c.toString().padStart(2,"0"))}else if(a&&e.session_started_at&&e.exited_at){const t=new Date(e.session_started_at).getTime(),s=new Date(e.exited_at).getTime(),a=Math.floor((s-t)/1e3),n=Math.floor(a/3600),l=Math.floor(a%3600/60),i=a%60;r="".concat(n.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}return(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30 ".concat(a?"opacity-60":""),children:[(0,sa.jsxs)("td",{className:"py-3 px-4 text-white",children:[e.name,a&&(0,sa.jsx)("span",{className:"ml-2 text-xs px-2 py-0.5 rounded bg-red-500/20 text-red-400 border border-red-500/30",children:"Exited"})]}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.mobile}),(0,sa.jsxs)("td",{className:"py-3 px-4 text-right font-semibold ".concat(t>=0?"text-green-400":"text-red-400"),children:["\u20b9",t.toLocaleString()]}),(0,sa.jsx)("td",{className:"py-3 px-4 text-right text-yellow-400 font-semibold",children:s>0?"\u20b9".concat(s.toLocaleString()):"-"}),"active"===w.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("td",{className:"py-3 px-4 text-center",children:[r?(0,sa.jsx)("span",{className:"font-mono text-xs tabular-nums ".concat(a?"text-gray-500":d?"text-yellow-300":"text-green-400"),children:r}):(0,sa.jsx)("span",{className:"text-gray-500 text-xs",children:"--"}),a&&e.exited_at&&(0,sa.jsxs)("div",{className:"text-[10px] text-gray-500 mt-0.5",children:["Ended ",new Date(e.exited_at).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0,hour:"numeric",minute:"2-digit"})]})]}),(0,sa.jsx)("td",{className:"py-3 px-4 text-center",children:(0,sa.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[a?(0,sa.jsxs)("span",{className:"text-xs px-2 py-1 rounded bg-gray-600/20 text-gray-400 border border-gray-500/30",children:["Out (\u20b9",Number(e.exit_balance||0).toFixed(0),")"]}):(0,sa.jsx)("span",{className:"text-xs px-2 py-1 rounded bg-green-600/20 text-green-400 border border-green-500/30",children:"Playing"}),Number(e.rebuy_count||0)>0&&(0,sa.jsxs)("span",{className:"text-xs text-orange-400",children:[e.rebuy_count,"x rebuy"]})]})})]}),"completed"===w.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.finishing_position||"-"}),(0,sa.jsx)("td",{className:"py-3 px-4 text-right text-emerald-400 font-semibold",children:e.prize_amount?"\u20b9".concat(e.prize_amount):"-"})]}),"active"===w.status&&(0,sa.jsx)("td",{className:"py-3 px-4 text-center",children:(0,sa.jsxs)("div",{className:"flex gap-1 justify-center flex-wrap",children:[!a&&(0,sa.jsx)("button",{onClick:()=>(e=>{b(e),f(""),v(""),x(!0)})(e),className:"bg-red-600 hover:bg-red-500 text-white px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors",children:"Exit"}),a&&(null===ce||void 0===ce?void 0:ce.allowRebuys)&&(0,sa.jsx)("button",{onClick:()=>oe(e,"rebuy"),disabled:ee.isLoading,className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors disabled:opacity-50",children:"Rebuy"}),a&&(null===ce||void 0===ce?void 0:ce.allowReentry)&&(null===ce||void 0===ce?void 0:ce.lateRegOpen)&&(0,sa.jsx)("button",{onClick:()=>oe(e,"reentry"),disabled:ee.isLoading,className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors disabled:opacity-50",children:"Re-entry"}),!a&&(null===ce||void 0===ce?void 0:ce.allowAddon)&&(0,sa.jsx)("button",{onClick:()=>oe(e,"addon"),disabled:ee.isLoading,className:"bg-purple-600 hover:bg-purple-500 text-white px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors disabled:opacity-50",children:"Add-on"})]})})]},e.id)})})]})})]}),"winners"===k&&"completed"===w.status&&(0,sa.jsx)("div",{className:"space-y-4",children:0===ge.length?(0,sa.jsx)("div",{className:"text-center py-12",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"No winners recorded"})}):(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Position"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Player ID"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Name"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Email"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Prize Amount"})]})}),(0,sa.jsx)("tbody",{children:ge.map(e=>(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30",children:[(0,sa.jsx)("td",{className:"py-3 px-4",children:(0,sa.jsx)("span",{className:"inline-block w-8 h-8 rounded-full bg-yellow-500 text-slate-900 font-bold flex items-center justify-center",children:e.finishing_position})}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white font-mono",children:e.player_id}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.name}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.email}),(0,sa.jsxs)("td",{className:"py-3 px-4 text-emerald-400 font-semibold",children:["\u20b9",e.prize_amount]})]},e.id))})]})})})]})}),u&&w&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-5xl w-full border border-orange-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white mb-4",children:["End Tournament: ",w.name]}),be.length>0&&(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("h3",{className:"text-sm font-semibold text-gray-400 mb-2 uppercase tracking-wider",children:"Player Balances (for reference)"}),(0,sa.jsx)("div",{className:"bg-slate-900/50 rounded-lg border border-slate-700 overflow-x-auto max-h-48 overflow-y-auto",children:(0,sa.jsxs)("table",{className:"w-full text-sm",children:[(0,sa.jsx)("thead",{className:"sticky top-0 bg-slate-800",children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-2 px-3 text-gray-400",children:"Player"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Initial Buy-In"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Total Invested"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Wallet Balance"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Credits"}),(0,sa.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"Status"})]})}),(0,sa.jsx)("tbody",{children:be.map(e=>{const t=Number(e.wallet_balance||0),s=Number(e.total_invested||w.buy_in||0),a=Number(e.total_credits||0);return(0,sa.jsxs)("tr",{className:"border-b border-slate-700/30 ".concat(e.is_exited?"opacity-50":""),children:[(0,sa.jsxs)("td",{className:"py-2 px-3 text-white",children:[e.name," ",(0,sa.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",e.player_id,")"]})]}),(0,sa.jsxs)("td",{className:"py-2 px-3 text-right text-cyan-400 font-mono",children:["\u20b9",Number(w.buy_in||0).toFixed(0)]}),(0,sa.jsxs)("td",{className:"py-2 px-3 text-right text-orange-400 font-mono",children:["\u20b9",s.toFixed(0)]}),(0,sa.jsxs)("td",{className:"py-2 px-3 text-right font-mono font-semibold ".concat(t>=0?"text-green-400":"text-red-400"),children:["\u20b9",t.toFixed(2)]}),(0,sa.jsx)("td",{className:"py-2 px-3 text-right text-yellow-400 font-mono",children:a>0?"\u20b9".concat(a.toFixed(0)):"-"}),(0,sa.jsx)("td",{className:"py-2 px-3 text-center",children:e.is_exited?(0,sa.jsxs)("span",{className:"text-xs px-2 py-0.5 rounded bg-red-500/20 text-red-400",children:["Exited (\u20b9",Number(e.exit_balance||0).toFixed(0),")"]}):(0,sa.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-green-500/20 text-green-400",children:"Playing"})})]},e.id)})})]})})]}),(0,sa.jsx)("p",{className:"text-gray-300 mb-4 text-sm",children:"Enter the winners and their prize amounts. Player balances will be automatically updated."}),(0,sa.jsx)("div",{className:"space-y-4 mb-6",children:B.map((e,t)=>{const s=be.find(t=>t.id===e.player_id);return(0,sa.jsxs)("div",{className:"space-y-1",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-12 gap-3 items-center",children:[(0,sa.jsx)("div",{className:"col-span-1",children:(0,sa.jsx)("div",{className:"w-10 h-10 rounded-full bg-yellow-500 text-slate-900 font-bold flex items-center justify-center",children:e.finishing_position})}),(0,sa.jsx)("div",{className:"col-span-5",children:(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",value:e.player_id,onChange:e=>xe(t,"player_id",e.target.value),children:[(0,sa.jsx)("option",{value:"",children:"Select Player"}),be.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name," (",e.player_id,") - Balance: \u20b9",Number(e.wallet_balance||0).toFixed(0)]},e.id))]})}),(0,sa.jsx)("div",{className:"col-span-2",children:(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"Position",value:e.finishing_position,onChange:e=>xe(t,"finishing_position",parseInt(e.target.value))})}),(0,sa.jsx)("div",{className:"col-span-3",children:(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"Prize Amount",value:e.prize_amount,onChange:e=>xe(t,"prize_amount",parseFloat(e.target.value))})}),(0,sa.jsx)("div",{className:"col-span-1",children:(0,sa.jsx)("button",{onClick:()=>(e=>{q(B.filter((t,s)=>s!==e))})(t),className:"w-full bg-red-600 hover:bg-red-500 text-white px-3 py-2 rounded-lg transition-colors",children:"\xd7"})})]}),s&&(0,sa.jsxs)("div",{className:"ml-14 text-xs text-gray-400 flex gap-4",children:[(0,sa.jsxs)("span",{children:["Initial: ",(0,sa.jsxs)("span",{className:"text-cyan-400 font-semibold",children:["\u20b9",Number(w.buy_in||0).toFixed(0)]})]}),(0,sa.jsxs)("span",{children:["Invested: ",(0,sa.jsxs)("span",{className:"text-orange-400 font-semibold",children:["\u20b9",Number(s.total_invested||w.buy_in||0).toFixed(0)]})]}),(0,sa.jsxs)("span",{children:["Wallet: ",(0,sa.jsxs)("span",{className:"font-semibold ".concat(Number(s.wallet_balance||0)>=0?"text-green-400":"text-red-400"),children:["\u20b9",Number(s.wallet_balance||0).toFixed(2)]})]}),Number(s.total_credits||0)>0&&(0,sa.jsxs)("span",{children:["Credits: ",(0,sa.jsxs)("span",{className:"text-yellow-400 font-semibold",children:["\u20b9",Number(s.total_credits||0).toFixed(0)]})]})]})]},t)})}),(0,sa.jsx)("button",{onClick:()=>{q([...B,{player_id:"",finishing_position:B.length+1,prize_amount:""}])},className:"w-full bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors mb-6",children:"+ Add Winner"}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{if(0===B.length)return void wr.error("Please add at least one winner");const e=B.every(e=>e.player_id&&e.finishing_position&&e.prize_amount);e?Y.mutate({tournamentId:w.id,winners:B}):wr.error("Please fill in all winner details")},disabled:Y.isLoading,className:"flex-1 bg-orange-600 hover:bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:Y.isLoading?"Ending Tournament...":"End Tournament & Update Balances"}),(0,sa.jsx)("button",{onClick:()=>{m(!1),q([])},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),h&&p&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[60] p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-red-600",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Exit Player from Tournament"}),(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-4 mb-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Player"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:p.name})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Player ID"}),(0,sa.jsx)("span",{className:"text-white font-mono text-sm",children:p.player_id})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Wallet Balance"}),(0,sa.jsxs)("span",{className:"font-semibold ".concat(Number(p.wallet_balance||0)>=0?"text-green-400":"text-red-400"),children:["\u20b9",Number(p.wallet_balance||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Credits Taken"}),(0,sa.jsxs)("span",{className:"text-yellow-400 font-semibold",children:["\u20b9",Number(p.total_credits||0).toFixed(2)]})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Exit Balance (Amount to credit back)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",placeholder:"\u20b90.00 (leave empty if bust)",value:g,onChange:e=>f(e.target.value)}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Leave at 0 or empty if the player went bust (zero or negative balance)."})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Notes (Optional)"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",placeholder:"Reason for exit...",value:y,onChange:e=>v(e.target.value)})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{p&&X.mutate({playerId:p.id,exitBalance:g?Number(g):0,notes:y||void 0})},disabled:X.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:X.isLoading?"Exiting...":"Exit Player".concat(g?" (\u20b9".concat(g,")"):" (Bust)")}),(0,sa.jsx)("button",{onClick:()=>{x(!1),b(null),f(""),v("")},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}var Kd={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Wd=r.createContext&&r.createContext(Kd),Hd=["attr","size","title"];function Vd(e,t){if(null==e)return{};var s,a,r=function(e,t){if(null==e)return{};var s={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;s[a]=e[a]}return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Jd(){return Jd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Jd.apply(this,arguments)}function Qd(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)}return s}function Gd(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Qd(Object(s),!0).forEach(function(t){Yd(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Qd(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Yd(e,t,s){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function $d(e){return e&&e.map((e,t)=>r.createElement(e.tag,Gd({key:t},e.attr),$d(e.child)))}function Zd(e){return t=>r.createElement(Xd,Jd({attr:Gd({},e.attr)},t),$d(e.child))}function Xd(e){var t=t=>{var s,{attr:a,size:n,title:l}=e,i=Vd(e,Hd),o=n||t.size||"1em";return t.className&&(s=t.className),e.className&&(s=(s?s+" ":"")+e.className),r.createElement("svg",Jd({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,i,{className:s,style:Gd(Gd({color:e.color||t.color},t.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),l&&r.createElement("title",null,l),e.children)};return void 0!==Wd?r.createElement(Wd.Consumer,null,e=>t(e)):t(Kd)}function ec(e){return Zd({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function tc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function sc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(e)}function ac(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 405.3V448c0 35.3 86 64 192 64s192-28.7 192-64v-42.7C342.7 434.4 267.2 448 192 448S41.3 434.4 0 405.3zM320 128c106 0 192-28.7 192-64S426 0 320 0 128 28.7 128 64s86 64 192 64zM0 300.4V352c0 35.3 86 64 192 64s192-28.7 192-64v-51.6c-41.3 34-116.9 51.6-192 51.6S41.3 334.4 0 300.4zm416 11c57.3-11.1 96-31.7 96-55.4v-42.7c-23.2 16.4-57.3 27.6-96 34.5v63.6zM192 160C86 160 0 195.8 0 240s86 80 192 80 192-35.8 192-80-86-80-192-80zm219.3 56.3c60-10.8 100.7-32 100.7-56.3v-42.7c-35.5 25.1-96.5 38.6-160.7 41.8 29.5 14.3 51.2 33.5 60 57.2z"},child:[]}]})(e)}function rc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"},child:[]}]})(e)}function nc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V256H0v176zm192-68c0-6.6 5.4-12 12-12h136c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-40zm-128 0c0-6.6 5.4-12 12-12h72c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM576 80v48H0V80c0-26.5 21.5-48 48-48h480c26.5 0 48 21.5 48 48z"},child:[]}]})(e)}function lc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 288 512"},child:[{tag:"path",attr:{d:"M209.2 233.4l-108-31.6C88.7 198.2 80 186.5 80 173.5c0-16.3 13.2-29.5 29.5-29.5h66.3c12.2 0 24.2 3.7 34.2 10.5 6.1 4.1 14.3 3.1 19.5-2l34.8-34c7.1-6.9 6.1-18.4-1.8-24.5C238 74.8 207.4 64.1 176 64V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48h-2.5C45.8 64-5.4 118.7.5 183.6c4.2 46.1 39.4 83.6 83.8 96.6l102.5 30c12.5 3.7 21.2 15.3 21.2 28.3 0 16.3-13.2 29.5-29.5 29.5h-66.3C100 368 88 364.3 78 357.5c-6.1-4.1-14.3-3.1-19.5 2l-34.8 34c-7.1 6.9-6.1 18.4 1.8 24.5 24.5 19.2 55.1 29.9 86.5 30v48c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-48.2c46.6-.9 90.3-28.6 105.7-72.7 21.5-61.6-14.6-124.8-72.5-141.7z"},child:[]}]})(e)}function ic(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function oc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function dc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function cc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function uc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(e)}function mc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(e)}function hc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M32 448c0 17.7 14.3 32 32 32h160V320H32v128zm256 32h160c17.7 0 32-14.3 32-32V320H288v160zm192-320h-42.1c6.2-12.1 10.1-25.5 10.1-40 0-48.5-39.5-88-88-88-41.6 0-68.5 21.3-103 68.3-34.5-47-61.4-68.3-103-68.3-48.5 0-88 39.5-88 88 0 14.5 3.8 27.9 10.1 40H32c-17.7 0-32 14.3-32 32v80c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16v-80c0-17.7-14.3-32-32-32zm-326.1 0c-22.1 0-40-17.9-40-40s17.9-40 40-40c19.9 0 34.6 3.3 86.1 80h-86.1zm206.1 0h-86.1c51.4-76.5 65.7-80 86.1-80 22.1 0 40 17.9 40 40s-17.9 40-40 40z"},child:[]}]})(e)}function xc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(e)}function pc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(e)}function bc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function gc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M358.4 3.2L320 48 265.6 3.2a15.9 15.9 0 0 0-19.2 0L192 48 137.6 3.2a15.9 15.9 0 0 0-19.2 0L64 48 25.6 3.2C15-4.7 0 2.8 0 16v480c0 13.2 15 20.7 25.6 12.8L64 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L192 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L320 464l38.4 44.8c10.5 7.9 25.6.4 25.6-12.8V16c0-13.2-15-20.7-25.6-12.8zM320 360c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function fc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function yc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z"},child:[]}]})(e)}function vc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},child:[]}]})(e)}function wc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function jc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"},child:[]}]})(e)}function Nc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function Sc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function kc(e){return Zd({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"},child:[]}]})(e)}const Cc=Object.create(null);Cc.open="0",Cc.close="1",Cc.ping="2",Cc.pong="3",Cc.message="4",Cc.upgrade="5",Cc.noop="6";const Ac=Object.create(null);Object.keys(Cc).forEach(e=>{Ac[Cc[e]]=e});const _c={type:"error",data:"parser error"},Pc="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Tc="function"===typeof ArrayBuffer,Ec=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Ic=(e,t,s)=>{let{type:a,data:r}=e;return Pc&&r instanceof Blob?t?s(r):Rc(r,s):Tc&&(r instanceof ArrayBuffer||Ec(r))?t?s(r):Rc(new Blob([r]),s):s(Cc[a]+(r||""))},Rc=(e,t)=>{const s=new FileReader;return s.onload=function(){const e=s.result.split(",")[1];t("b"+(e||""))},s.readAsDataURL(e)};function Dc(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Oc;const Lc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fc="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let Yx=0;Yx<64;Yx++)Fc[Lc.charCodeAt(Yx)]=Yx;const Mc="function"===typeof ArrayBuffer,Bc=(e,t)=>{if("string"!==typeof e)return{type:"message",data:Uc(e,t)};const s=e.charAt(0);if("b"===s)return{type:"message",data:qc(e.substring(1),t)};return Ac[s]?e.length>1?{type:Ac[s],data:e.substring(1)}:{type:Ac[s]}:_c},qc=(e,t)=>{if(Mc){const s=(e=>{let t,s,a,r,n,l=.75*e.length,i=e.length,o=0;"="===e[e.length-1]&&(l--,"="===e[e.length-2]&&l--);const d=new ArrayBuffer(l),c=new Uint8Array(d);for(t=0;t<i;t+=4)s=Fc[e.charCodeAt(t)],a=Fc[e.charCodeAt(t+1)],r=Fc[e.charCodeAt(t+2)],n=Fc[e.charCodeAt(t+3)],c[o++]=s<<2|a>>4,c[o++]=(15&a)<<4|r>>2,c[o++]=(3&r)<<6|63&n;return d})(e);return Uc(s,t)}return{base64:!0,data:e}},Uc=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,zc=String.fromCharCode(30);function Kc(){return new TransformStream({transform(e,t){!function(e,t){Pc&&e.data instanceof Blob?e.data.arrayBuffer().then(Dc).then(t):Tc&&(e.data instanceof ArrayBuffer||Ec(e.data))?t(Dc(e.data)):Ic(e,!1,e=>{Oc||(Oc=new TextEncoder),t(Oc.encode(e))})}(e,s=>{const a=s.length;let r;if(a<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,a);else if(a<65536){r=new Uint8Array(3);const e=new DataView(r.buffer);e.setUint8(0,126),e.setUint16(1,a)}else{r=new Uint8Array(9);const e=new DataView(r.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(a))}e.data&&"string"!==typeof e.data&&(r[0]|=128),t.enqueue(r),t.enqueue(s)})}})}let Wc;function Hc(e){return e.reduce((e,t)=>e+t.length,0)}function Vc(e,t){if(e[0].length===t)return e.shift();const s=new Uint8Array(t);let a=0;for(let r=0;r<t;r++)s[r]=e[0][a++],a===e[0].length&&(e.shift(),a=0);return e.length&&a<e[0].length&&(e[0]=e[0].slice(a)),s}function Jc(e){if(e)return function(e){for(var t in Jc.prototype)e[t]=Jc.prototype[t];return e}(e)}Jc.prototype.on=Jc.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Jc.prototype.once=function(e,t){function s(){this.off(e,s),t.apply(this,arguments)}return s.fn=t,this.on(e,s),this},Jc.prototype.off=Jc.prototype.removeListener=Jc.prototype.removeAllListeners=Jc.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s,a=this._callbacks["$"+e];if(!a)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<a.length;r++)if((s=a[r])===t||s.fn===t){a.splice(r,1);break}return 0===a.length&&delete this._callbacks["$"+e],this},Jc.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),s=this._callbacks["$"+e],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(s){a=0;for(var r=(s=s.slice(0)).length;a<r;++a)s[a].apply(this,t)}return this},Jc.prototype.emitReserved=Jc.prototype.emit,Jc.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Jc.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Qc="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Gc="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function Yc(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];return s.reduce((t,s)=>(e.hasOwnProperty(s)&&(t[s]=e[s]),t),{})}const $c=Gc.setTimeout,Zc=Gc.clearTimeout;function Xc(e,t){t.useNativeTimers?(e.setTimeoutFn=$c.bind(Gc),e.clearTimeoutFn=Zc.bind(Gc)):(e.setTimeoutFn=Gc.setTimeout.bind(Gc),e.clearTimeoutFn=Gc.clearTimeout.bind(Gc))}function eu(e){return"string"===typeof e?function(e){let t=0,s=0;for(let a=0,r=e.length;a<r;a++)t=e.charCodeAt(a),t<128?s+=1:t<2048?s+=2:t<55296||t>=57344?s+=3:(a++,s+=4);return s}(e):Math.ceil(1.33*(e.byteLength||e.size))}function tu(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class su extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class au extends Jc{constructor(e){super(),this.writable=!1,Xc(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new su(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Bc(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&443!==Number(this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let s in e)e.hasOwnProperty(s)&&(t.length&&(t+="&"),t+=encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return t}(e);return t.length?"?"+t:""}}class ru extends au{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const s=e.split(zc),a=[];for(let r=0;r<s.length;r++){const e=Bc(s[r],t);if(a.push(e),"error"===e.type)break}return a})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const s=e.length,a=new Array(s);let r=0;e.forEach((e,n)=>{Ic(e,!1,e=>{a[n]=e,++r===s&&t(a.join(zc))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=tu()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let nu=!1;try{nu="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Gx){}const lu=nu;function iu(){}class ou extends ru{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let s=location.port;s||(s=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class du extends Jc{constructor(e,t,s){super(),this.createRequest=e,Xc(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=void 0!==s.data?s.data:null,this._create()}_create(){var e;const t=Yc(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&s.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(ia){}if("POST"===this._method)try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(ia){}try{s.setRequestHeader("Accept","*/*")}catch(ia){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var e;3===s.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(s.getResponseHeader("set-cookie"))),4===s.readyState&&(200===s.status||1223===s.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"===typeof s.status?s.status:0)},0))},s.send(this._data)}catch(ia){return void this.setTimeoutFn(()=>{this._onError(ia)},0)}"undefined"!==typeof document&&(this._index=du.requestsCount++,du.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=iu,e)try{this._xhr.abort()}catch(ia){}"undefined"!==typeof document&&delete du.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(du.requestsCount=0,du.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",cu);else if("function"===typeof addEventListener){addEventListener("onpagehide"in Gc?"pagehide":"unload",cu,!1)}function cu(){for(let e in du.requests)du.requests.hasOwnProperty(e)&&du.requests[e].abort()}const uu=function(){const e=mu({xdomain:!1});return e&&null!==e.responseType}();function mu(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||lu))return new XMLHttpRequest}catch(ia){}if(!t)try{return new(Gc[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(ia){}}const hu="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class xu extends au{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=hu?{}:Yc(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(Gx){return this.emitReserved("error",Gx)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],a=t===e.length-1;Ic(s,this.supportsBinary,e=>{try{this.doWrite(s,e)}catch(ia){}a&&Qc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=tu()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const pu=Gc.WebSocket||Gc.MozWebSocket;const bu={websocket:class extends xu{createSocket(e,t,s){return hu?new pu(e,t,s):t?new pu(e,t):new pu(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends au{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(Gx){return this.emitReserved("error",Gx)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){Wc||(Wc=new TextDecoder);const s=[];let a=0,r=-1,n=!1;return new TransformStream({transform(l,i){for(s.push(l);;){if(0===a){if(Hc(s)<1)break;const e=Vc(s,1);n=128===(128&e[0]),r=127&e[0],a=r<126?3:126===r?1:2}else if(1===a){if(Hc(s)<2)break;const e=Vc(s,2);r=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),a=3}else if(2===a){if(Hc(s)<8)break;const e=Vc(s,8),t=new DataView(e.buffer,e.byteOffset,e.length),n=t.getUint32(0);if(n>Math.pow(2,21)-1){i.enqueue(_c);break}r=n*Math.pow(2,32)+t.getUint32(4),a=3}else{if(Hc(s)<r)break;const e=Vc(s,r);i.enqueue(Bc(n?e:Wc.decode(e),t)),a=0}if(0===r||r>e){i.enqueue(_c);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),a=Kc();a.readable.pipeTo(e.writable),this._writer=a.writable.getWriter();const r=()=>{s.read().then(e=>{let{done:t,value:s}=e;t||(this.onPacket(s),r())}).catch(e=>{})};r();const n={type:"open"};this.query.sid&&(n.data='{"sid":"'.concat(this.query.sid,'"}')),this._writer.write(n).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],a=t===e.length-1;this._writer.write(s).then(()=>{a&&Qc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends ou{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=uu&&!t}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd},this.opts),new du(mu,this.uri(),e)}}},gu=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fu=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function yu(e){if(e.length>8e3)throw"URI too long";const t=e,s=e.indexOf("["),a=e.indexOf("]");-1!=s&&-1!=a&&(e=e.substring(0,s)+e.substring(s,a).replace(/:/g,";")+e.substring(a,e.length));let r=gu.exec(e||""),n={},l=14;for(;l--;)n[fu[l]]=r[l]||"";return-1!=s&&-1!=a&&(n.source=t,n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":"),n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":"),n.ipv6uri=!0),n.pathNames=function(e,t){const s=/\/{2,9}/g,a=t.replace(s,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||a.splice(0,1);"/"==t.slice(-1)&&a.splice(a.length-1,1);return a}(0,n.path),n.queryKey=function(e,t){const s={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,a){t&&(s[t]=a)}),s}(0,n.query),n}const vu="function"===typeof addEventListener&&"function"===typeof removeEventListener,wu=[];vu&&addEventListener("offline",()=>{wu.forEach(e=>e())},!1);class ju extends Jc{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"===typeof e&&(t=e,e=null),e){const s=yu(e);t.hostname=s.host,t.secure="https"===s.protocol||"wss"===s.protocol,t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=yu(t.host).host);Xc(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},s=e.split("&");for(let a=0,r=s.length;a<r;a++){let e=s[a].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),vu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},wu.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&ju.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",ju.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const s=this.writeBuffer[t].data;if(s&&(e+=eu(s)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Qc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,a){if("function"===typeof t&&(a=t,t=void 0),"function"===typeof s&&(a=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const r={type:e,data:t,options:s};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),a&&this.once("flush",a),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(ju.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),vu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=wu.indexOf(this._offlineEventListener);-1!==e&&wu.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}ju.protocol=4;class Nu extends ju{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;ju.priorWebsocketSuccess=!1;const a=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!s)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;ju.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{s||"closed"!==this.readyState&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function r(){s||(s=!0,d(),t.close(),t=null)}const n=e=>{const s=new Error("probe error: "+e);s.transport=t.name,r(),this.emitReserved("upgradeError",s)};function l(){n("transport closed")}function i(){n("socket closed")}function o(e){t&&e.name!==t.name&&r()}const d=()=>{t.removeListener("open",a),t.removeListener("error",n),t.removeListener("close",l),this.off("close",i),this.off("upgrading",o)};t.once("open",a),t.once("error",n),t.once("close",l),this.once("close",i),this.once("upgrading",o),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}class Su extends Nu{constructor(e){const t="object"===typeof e?e:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t.transports||t.transports&&"string"===typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>bu[e]).filter(e=>!!e)),super(e,t)}}const ku="function"===typeof ArrayBuffer,Cu=Object.prototype.toString,Au="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Cu.call(Blob),_u="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===Cu.call(File);function Pu(e){return ku&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Au&&e instanceof Blob||_u&&e instanceof File}function Tu(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,s=e.length;t<s;t++)if(Tu(e[t]))return!0;return!1}if(Pu(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return Tu(e.toJSON(),!0);for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&Tu(e[s]))return!0;return!1}function Eu(e){const t=[],s=e.data,a=e;return a.data=Iu(s,t),a.attachments=t.length,{packet:a,buffers:t}}function Iu(e,t){if(!e)return e;if(Pu(e)){const s={_placeholder:!0,num:t.length};return t.push(e),s}if(Array.isArray(e)){const s=new Array(e.length);for(let a=0;a<e.length;a++)s[a]=Iu(e[a],t);return s}if("object"===typeof e&&!(e instanceof Date)){const s={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=Iu(e[a],t));return s}return e}function Ru(e,t){return e.data=Du(e.data,t),delete e.attachments,e}function Du(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let s=0;s<e.length;s++)e[s]=Du(e[s],t);else if("object"===typeof e)for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(e[s]=Du(e[s],t));return e}const Ou=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Lu=5;var Fu;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Fu||(Fu={}));class Mu{constructor(e){this.replacer=e}encode(e){return e.type!==Fu.EVENT&&e.type!==Fu.ACK||!Tu(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Fu.EVENT?Fu.BINARY_EVENT:Fu.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Fu.BINARY_EVENT&&e.type!==Fu.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Eu(e),s=this.encodeAsString(t.packet),a=t.buffers;return a.unshift(s),a}}class Bu extends Jc{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===Fu.BINARY_EVENT;s||t.type===Fu.BINARY_ACK?(t.type=s?Fu.EVENT:Fu.ACK,this.reconstructor=new qu(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Pu(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(void 0===Fu[s.type])throw new Error("unknown packet type "+s.type);if(s.type===Fu.BINARY_EVENT||s.type===Fu.BINARY_ACK){const a=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const r=e.substring(a,t);if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");s.attachments=Number(r)}if("/"===e.charAt(t+1)){const a=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}s.nsp=e.substring(a,t)}else s.nsp="/";const a=e.charAt(t+1);if(""!==a&&Number(a)==a){const a=t+1;for(;++t;){const s=e.charAt(t);if(null==s||Number(s)!=s){--t;break}if(t===e.length)break}s.id=Number(e.substring(a,t+1))}if(e.charAt(++t)){const a=this.tryParse(e.substr(t));if(!Bu.isPayloadValid(s.type,a))throw new Error("invalid payload");s.data=a}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(ia){return!1}}static isPayloadValid(e,t){switch(e){case Fu.CONNECT:return zu(t);case Fu.DISCONNECT:return void 0===t;case Fu.CONNECT_ERROR:return"string"===typeof t||zu(t);case Fu.EVENT:case Fu.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===Ou.indexOf(t[0]));case Fu.ACK:case Fu.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class qu{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Ru(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Uu=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e};function zu(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ku(e){return"string"===typeof e.nsp&&(void 0===(t=e.id)||Uu(t))&&function(e,t){switch(e){case Fu.CONNECT:return void 0===t||zu(t);case Fu.DISCONNECT:return void 0===t;case Fu.EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===Ou.indexOf(t[0]));case Fu.ACK:return Array.isArray(t);case Fu.CONNECT_ERROR:return"string"===typeof t||zu(t);default:return!1}}(e.type,e.data);var t}function Wu(e,t,s){return e.on(t,s),function(){e.off(t,s)}}const Hu=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Vu extends Jc{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Wu(e,"open",this.onopen.bind(this)),Wu(e,"packet",this.onpacket.bind(this)),Wu(e,"error",this.onerror.bind(this)),Wu(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,s,a;if(Hu.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var r=arguments.length,n=new Array(r>1?r-1:0),l=1;l<r;l++)n[l-1]=arguments[l];if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const i={type:Fu.EVENT,data:n,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"===typeof n[n.length-1]){const e=this.ids++,t=n.pop();this._registerAckCallback(e,t),i.id=e}const o=null===(s=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===s?void 0:s.writable,d=this.connected&&!(null===(a=this.io.engine)||void 0===a?void 0:a._hasPingExpired());return this.flags.volatile&&!o||(d?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var s,a=this;const r=null!==(s=this.flags.timeout)&&void 0!==s?s:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},r),l=function(){a.io.clearTimeoutFn(n);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];t.apply(a,s)};l.withError=!0,this.acks[e]=l}emitWithAck(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];return new Promise((t,a)=>{const r=(e,s)=>e?a(e):t(s);r.withError=!0,s.push(r),this.emit(e,...s)})}_addToQueue(e){var t=this;let s;"function"===typeof e[e.length-1]&&(s=e.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(function(e){t._queue[0];if(null!==e)a.tryCount>t._opts.retries&&(t._queue.shift(),s&&s(e));else if(t._queue.shift(),s){for(var r=arguments.length,n=new Array(r>1?r-1:0),l=1;l<r;l++)n[l-1]=arguments[l];s(null,...n)}return a.pending=!1,t._drainQueue()}),this._queue.push(a),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Fu.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Fu.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Fu.EVENT:case Fu.BINARY_EVENT:this.onevent(e);break;case Fu.ACK:case Fu.BINARY_ACK:this.onack(e);break;case Fu.DISCONNECT:this.ondisconnect();break;case Fu.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(){if(!s){s=!0;for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];t.packet({type:Fu.ACK,id:e,data:r})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Fu.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function Ju(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Ju.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),s=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-s:e+s}return 0|Math.min(e,this.max)},Ju.prototype.reset=function(){this.attempts=0},Ju.prototype.setMin=function(e){this.ms=e},Ju.prototype.setMax=function(e){this.max=e},Ju.prototype.setJitter=function(e){this.jitter=e};class Qu extends Jc{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Xc(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(s=t.randomizationFactor)&&void 0!==s?s:.5),this.backoff=new Ju({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||a;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Su(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const a=Wu(t,"open",function(){s.onopen(),e&&e()}),r=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},n=Wu(t,"error",r);if(!1!==this._timeout){const e=this._timeout,s=this.setTimeoutFn(()=>{a(),r(new Error("timeout")),t.close()},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}return this.subs.push(a),this.subs.push(n),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Wu(e,"ping",this.onping.bind(this)),Wu(e,"data",this.ondata.bind(this)),Wu(e,"error",this.onerror.bind(this)),Wu(e,"close",this.onclose.bind(this)),Wu(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(ia){this.onclose("parse error",ia)}}ondecoded(e){Qc(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new Vu(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t){if(this.nsps[s].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),null===(s=this.engine)||void 0===s||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Gu={};function Yu(e,t){"object"===typeof e&&(t=e,e=void 0);const s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0,a=e;s=s||"undefined"!==typeof location&&location,null==e&&(e=s.protocol+"//"+s.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?s.protocol+e:s.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof s?s.protocol+"//"+e:"https://"+e),a=yu(e)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const r=-1!==a.host.indexOf(":")?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+r+":"+a.port+t,a.href=a.protocol+"://"+r+(s&&s.port===a.port?"":":"+a.port),a}(e,(t=t||{}).path||"/socket.io"),a=s.source,r=s.id,n=s.path,l=Gu[r]&&n in Gu[r].nsps;let i;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?i=new Qu(a,t):(Gu[r]||(Gu[r]=new Qu(a,t)),i=Gu[r]),s.query&&!t.query&&(t.query=s.queryKey),i.socket(s.path,t)}function $u(e){let{clubId:t,hidePlayerChat:s=!1}=e;const[a,n]=(0,r.useState)("staff"),[l,i]=(0,r.useState)(null);return(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6",children:(0,sa.jsxs)("div",{className:"max-w-[1600px] mx-auto",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 p-6 rounded-lg mb-6",children:[(0,sa.jsxs)("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[(0,sa.jsx)(rc,{className:"text-4xl"}),s?"Staff Chat":"Player & Staff Support Chat"]}),(0,sa.jsx)("p",{className:"text-white/80 mt-2",children:s?"Communicate with staff members in real-time":"Communicate with staff members and respond to player queries in real-time"})]}),!s&&(0,sa.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,sa.jsxs)("button",{onClick:()=>n("staff"),className:"flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all ".concat("staff"===a?"bg-gradient-to-r from-blue-600 to-cyan-600 text-white shadow-lg scale-105":"bg-slate-700 text-white/70 hover:bg-slate-600"),children:[(0,sa.jsx)(Sc,{}),"Staff Chat"]}),(0,sa.jsxs)("button",{onClick:()=>n("player"),className:"flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all ".concat("player"===a?"bg-gradient-to-r from-orange-600 to-pink-600 text-white shadow-lg scale-105":"bg-slate-700 text-white/70 hover:bg-slate-600"),children:[(0,sa.jsx)(rc,{}),"Player Chat"]})]}),"staff"===a&&(0,sa.jsx)(Zu,{clubId:t,showNotification:(e,t)=>{i({message:e,senderName:t}),setTimeout(()=>i(null),5e3)}}),!s&&"player"===a&&(0,sa.jsx)(Xu,{clubId:t}),l&&(0,sa.jsx)("div",{className:"fixed top-20 right-6 bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-4 rounded-lg shadow-2xl z-50 animate-slide-in-right max-w-md",children:(0,sa.jsxs)("div",{className:"flex items-start gap-3",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center flex-shrink-0",children:(0,sa.jsx)(rc,{className:"text-xl"})}),(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("div",{className:"font-semibold mb-1",children:l.senderName}),(0,sa.jsx)("div",{className:"text-sm text-white/90 line-clamp-2",children:l.message})]}),(0,sa.jsx)("button",{onClick:()=>i(null),className:"text-white/60 hover:text-white",children:(0,sa.jsx)(wc,{})})]})})]})})}function Zu(e){let{clubId:t,showNotification:s}=e;const[a,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(1),[h,x]=(0,r.useState)(1),[p,b]=(0,r.useState)(""),[g,f]=(0,r.useState)(""),[y,v]=(0,r.useState)(!1),w=(0,r.useRef)(null);console.log("StaffChatTab rendered - clubId:",t,"showNewChatModal:",y),(0,r.useEffect)(()=>{j();const e=localStorage.getItem("userId");if(t&&e){const a="http://localhost:3333";console.log("\ud83d\udd0c Connecting to WebSocket:","".concat(a,"/realtime"),"userId:",e,"clubId:",t);const r=Yu("".concat(a,"/realtime"),{auth:{clubId:t,userId:e},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:1e4,reconnectionAttempts:1/0});return r.on("connect",()=>{console.log("\u2705 WebSocket connected for staff chat"),r.emit("subscribe:club",{clubId:t,userId:e}),r.emit("subscribe:staff",{staffId:e,clubId:t})}),r.on("connect_error",e=>{console.error("\u274c WebSocket connection error:",e)}),r.on("disconnect",e=>{console.warn("\u26a0\ufe0f WebSocket disconnected:",e)}),r.on("error",e=>{console.error("\u274c WebSocket error:",e)}),r.on("chat:new-message",e=>{n(t=>t.map(t=>t.id===e.sessionId?(0,i.A)((0,i.A)({},t),{},{lastMessageAt:e.message.createdAt,unreadCount:(t.unreadCount||0)+((null===l||void 0===l?void 0:l.id)!==t.id?1:0)}):t))}),r.on("chat:new-message-direct",e=>{var t;const a=localStorage.getItem("userId");console.log("\ud83d\udce8 Received chat:new-message-direct:",{recipientStaffUserId:e.recipientStaffUserId,currentUserId:a,sessionId:e.sessionId,senderName:null===(t=e.message)||void 0===t?void 0:t.senderName}),e.recipientStaffUserId===a?(console.log("\u2705 Notification matches current user, showing bubble"),l&&l.id===e.sessionId?console.log("\u2139\ufe0f User is viewing this chat, skipping notification"):s&&s(e.message.message,e.message.senderName),j()):console.log("\u274c Notification not for current user, ignoring")}),r.on("chat:session-updated",e=>{j()}),w.current=r,()=>{r&&(r.emit("unsubscribe:club",{clubId:t}),r.disconnect())}}},[t,u,p,g,l]);const j=async()=>{try{c(!0);const e=await jr.h2.getStaffChatSessions(t,{page:u,limit:10,search:p,role:g});n(e.sessions),x(e.totalPages)}catch(e){console.error("Error loading staff chat sessions:",e)}finally{c(!1)}};return(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-[calc(100vh-300px)]",children:[(0,sa.jsxs)("div",{className:"lg:col-span-1 bg-slate-800 rounded-lg p-4 overflow-hidden flex flex-col",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,sa.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Conversations"}),(0,sa.jsxs)("button",{onClick:()=>v(!0),className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg flex items-center gap-2 text-sm",children:[(0,sa.jsx)(bc,{})," New Chat"]})]}),(0,sa.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsx)(fc,{className:"absolute left-3 top-3 text-gray-400"}),(0,sa.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:p,onChange:e=>{b(e.target.value),m(1)},className:"w-full pl-10 pr-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("select",{value:g,onChange:e=>{f(e.target.value),m(1)},className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"",children:"All Roles"}),(0,sa.jsx)("option",{value:"SUPER_ADMIN",children:"Super Admin"}),(0,sa.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,sa.jsx)("option",{value:"MANAGER",children:"Manager"}),(0,sa.jsx)("option",{value:"HR",children:"HR"}),(0,sa.jsx)("option",{value:"GRE",children:"GRE"}),(0,sa.jsx)("option",{value:"CASHIER",children:"Cashier"}),(0,sa.jsx)("option",{value:"AFFILIATE",children:"Affiliate"}),(0,sa.jsx)("option",{value:"FNB",children:"FNB"})]})]}),(0,sa.jsx)("div",{className:"flex-1 overflow-y-auto space-y-2 min-h-0",style:{maxHeight:"calc(100vh - 450px)",scrollBehavior:"smooth",scrollbarWidth:"thin",scrollbarColor:"#475569 #1e293b"},children:d&&0===a.length?(0,sa.jsx)("div",{className:"text-white/60 text-center py-8",children:"Loading chats..."}):0===a.length?(0,sa.jsx)("div",{className:"text-white/60 text-center py-8",children:"No conversations yet"}):a.map(e=>{var t,s,a,r;return(0,sa.jsxs)("div",{onClick:()=>o(e),className:"p-3 rounded-lg cursor-pointer transition-all ".concat((null===l||void 0===l?void 0:l.id)===e.id?"bg-blue-600":"bg-slate-700 hover:bg-slate-600"),children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:(null===(t=e.otherStaff)||void 0===t||null===(s=t.name)||void 0===s?void 0:s[0])||"?"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:null===(a=e.otherStaff)||void 0===a?void 0:a.name}),(0,sa.jsx)("div",{className:"text-white/60 text-sm",children:null===(r=e.otherStaff)||void 0===r?void 0:r.role})]})]}),e.unreadCount>0&&(0,sa.jsx)("div",{className:"bg-red-600 text-white text-xs px-2 py-1 rounded-full",children:e.unreadCount})]}),e.subject&&(0,sa.jsx)("div",{className:"text-white/70 text-sm mt-1 truncate",children:e.subject})]},e.id)})}),h>1&&(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>m(e=>Math.max(1,e-1)),disabled:1===u,className:"text-white px-3 py-1 bg-slate-700 rounded disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-white text-sm",children:["Page ",u," of ",h]}),(0,sa.jsx)("button",{onClick:()=>m(e=>Math.min(h,e+1)),disabled:u===h,className:"text-white px-3 py-1 bg-slate-700 rounded disabled:opacity-50",children:"Next"})]})]}),(0,sa.jsx)("div",{className:"lg:col-span-2 flex flex-col min-h-0",children:l?(0,sa.jsx)(em,{clubId:t,session:l,onClose:()=>o(null),onDelete:()=>{o(null),j()},onSessionUpdate:e=>{n(t=>t.map(t=>t.id===e.id?e:t)),o(e)}}):(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-8 h-full flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-center text-white/60",children:[(0,sa.jsx)(rc,{className:"text-6xl mx-auto mb-4 opacity-50"}),(0,sa.jsx)("p",{className:"text-xl",children:"Select a staff chat to start messaging"})]})})}),y&&(0,sa.jsx)(tm,{clubId:t,existingSessions:a,onClose:()=>v(!1),onSuccess:async e=>{v(!1),await j(),setTimeout(()=>{n(t=>{const s=t.find(t=>t.id===(null===e||void 0===e?void 0:e.id));if(s)o(s);else{var a;const t=jr.R2.getCurrentUser(),s=null===t||void 0===t||null===(a=t.email)||void 0===a?void 0:a.toLowerCase();let n=null;if(e.staffInitiator&&e.staffRecipient){var r;n=s===(null===(r=e.staffInitiator.email)||void 0===r?void 0:r.toLowerCase())?e.staffRecipient:e.staffInitiator}o((0,i.A)((0,i.A)({},e),{},{otherStaff:n||e.staffRecipient||e.staffInitiator}))}return t})},200)}})]})}function Xu(e){let{clubId:t}=e;const[s,a]=(0,r.useState)([]),[n,l]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(1),[u,m]=(0,r.useState)(1),[h,x]=(0,r.useState)(""),[p,b]=(0,r.useState)("");(0,r.useEffect)(()=>{g();const e=setInterval(g,5e3);return()=>clearInterval(e)},[t,d,h,p]);const g=async()=>{try{o(!0);const e=await jr.h2.getPlayerChatSessions(t,{page:d,limit:10,search:h,status:p});a(e.sessions),m(e.totalPages)}catch(e){console.error("Error loading player chat sessions:",e)}finally{o(!1)}};return(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-[calc(100vh-300px)]",children:[(0,sa.jsxs)("div",{className:"lg:col-span-1 bg-slate-800 rounded-lg p-4 overflow-hidden flex flex-col",children:[(0,sa.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Player Support Tickets"}),(0,sa.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsx)(fc,{className:"absolute left-3 top-3 text-gray-400"}),(0,sa.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:h,onChange:e=>{x(e.target.value),c(1)},className:"w-full pl-10 pr-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("select",{value:p,onChange:e=>{b(e.target.value),c(1)},className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"",children:"All Status"}),(0,sa.jsx)("option",{value:"open",children:"Open"}),(0,sa.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,sa.jsx)("option",{value:"resolved",children:"Resolved"}),(0,sa.jsx)("option",{value:"closed",children:"Closed"})]})]}),(0,sa.jsx)("div",{className:"flex-1 overflow-y-auto space-y-2 min-h-0",style:{maxHeight:"calc(100vh - 450px)",scrollBehavior:"smooth",scrollbarWidth:"thin",scrollbarColor:"#475569 #1e293b"},children:i&&0===s.length?(0,sa.jsx)("div",{className:"text-white/60 text-center py-8",children:"Loading tickets..."}):0===s.length?(0,sa.jsx)("div",{className:"text-white/60 text-center py-8",children:"No support tickets yet"}):s.map(e=>{var t,s,a;return(0,sa.jsxs)("div",{onClick:()=>l(e),className:"p-3 rounded-lg cursor-pointer transition-all ".concat((null===n||void 0===n?void 0:n.id)===e.id?"bg-orange-600":"bg-slate-700 hover:bg-slate-600"),children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold",children:(null===(t=e.player)||void 0===t||null===(s=t.name)||void 0===s?void 0:s[0])||"?"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:null===(a=e.player)||void 0===a?void 0:a.name}),(0,sa.jsx)("div",{className:"text-white/60 text-sm flex items-center gap-2",children:(0,sa.jsx)(sm,{status:e.status})})]})]}),e.unreadCount>0&&(0,sa.jsx)("div",{className:"bg-red-600 text-white text-xs px-2 py-1 rounded-full",children:e.unreadCount})]}),(0,sa.jsx)("div",{className:"text-white/80 text-sm mt-1 font-medium",children:e.subject}),e.lastMessage&&(0,sa.jsx)("div",{className:"text-white/60 text-xs mt-1 truncate",children:e.lastMessage})]},e.id)})}),u>1&&(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>c(e=>Math.max(1,e-1)),disabled:1===d,className:"text-white px-3 py-1 bg-slate-700 rounded disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-white text-sm",children:["Page ",d," of ",u]}),(0,sa.jsx)("button",{onClick:()=>c(e=>Math.min(u,e+1)),disabled:d===u,className:"text-white px-3 py-1 bg-slate-700 rounded disabled:opacity-50",children:"Next"})]})]}),(0,sa.jsx)("div",{className:"lg:col-span-2 flex flex-col min-h-0",children:n?(0,sa.jsx)(em,{clubId:t,session:n,onClose:()=>l(null),isPlayerChat:!0,onStatusChange:e=>(async(e,s)=>{try{await jr.h2.updateChatSession(t,e,{status:s}),g()}catch(a){alert("Failed to update status")}})(n.id,e)}):(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-8 h-full flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-center text-white/60",children:[(0,sa.jsx)(rc,{className:"text-6xl mx-auto mb-4 opacity-50"}),(0,sa.jsx)("p",{className:"text-xl",children:"Select a player chat to start messaging"})]})})})]})}function em(e){let{clubId:t,session:s,onClose:a,isPlayerChat:n,onStatusChange:l,onDelete:i,onSessionUpdate:o}=e;const[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)(""),[h,x]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),y=(0,r.useRef)(null),v=(0,r.useRef)(null),w=async()=>{if(!n&&null!==s&&void 0!==s&&s.id)try{var e;const a=null===(e=(await jr.h2.getStaffChatSessions(t,{page:1,limit:100})).sessions)||void 0===e?void 0:e.find(e=>e.id===s.id);a&&a.otherStaff&&o&&o(a)}catch(a){console.error("Error refreshing session:",a)}};(0,r.useEffect)(()=>{j(),n||!s||s.otherStaff&&s.otherStaff.name||w();const e=setInterval(j,1e4),a=localStorage.getItem("userId");if(t&&a){const r=Yu("".concat("http://localhost:3333","/realtime"),{auth:{clubId:t,userId:a},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:1e4,reconnectionAttempts:1/0});return r.on("connect",()=>{r.emit("subscribe:club",{clubId:t,userId:a}),r.emit("subscribe:staff",{staffId:a,clubId:t})}),r.on("chat:new-message",e=>{e.sessionId===s.id&&c(t=>{const s=t.some(t=>t.id===e.message.id);return s?t:[...t,e.message]})}),r.on("chat:new-message-direct",e=>{e.sessionId===s.id&&c(t=>{const s=t.some(t=>t.id===e.message.id);return s?t:(console.log("New direct message received:",e.message),[...t,e.message])})}),r.on("chat:session-updated",e=>{var t;(null===(t=e.session)||void 0===t?void 0:t.id)===s.id&&w()}),v.current=r,()=>{clearInterval(e),r&&(r.emit("unsubscribe:club",{clubId:t}),r.disconnect())}}return()=>clearInterval(e)},[s.id,t]),(0,r.useEffect)(()=>{S()},[d]);const j=async()=>{try{x(!0);const e=await jr.h2.getSessionMessages(t,s.id);c(e.messages)}catch(e){console.error("Error loading messages:",e)}finally{x(!1)}},N=e=>{const t=new Date(e);return new Date(t.getTime()+198e5).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})},S=()=>{var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},k=()=>{var e;if(n)return(null===(e=s.player)||void 0===e?void 0:e.name)||"Player";{var t,a,r,l,i,o;if(null!==(t=s.otherStaff)&&void 0!==t&&t.name)return s.otherStaff.name;const e=jr.R2.getCurrentUser(),n=null===e||void 0===e?void 0:e.id,g=null===e||void 0===e||null===(a=e.email)||void 0===a?void 0:a.toLowerCase();if(s.staffInitiator&&s.staffRecipient){var d,c,u,m;const e=s.staffInitiator.id,t=s.staffRecipient.id;var h,x;if(n===e)return s.staffRecipient.name||(null===(h=s.staffRecipient.email)||void 0===h?void 0:h.split("@")[0])||"Staff Member";if(n===t)return s.staffInitiator.name||(null===(x=s.staffInitiator.email)||void 0===x?void 0:x.split("@")[0])||"Staff Member";const a=null===(d=s.staffInitiator.email)||void 0===d?void 0:d.toLowerCase(),r=null===(c=s.staffRecipient.email)||void 0===c?void 0:c.toLowerCase();var p,b;return g&&a===g?s.staffRecipient.name||(null===(p=s.staffRecipient.email)||void 0===p?void 0:p.split("@")[0])||"Staff Member":g&&r===g?s.staffInitiator.name||(null===(b=s.staffInitiator.email)||void 0===b?void 0:b.split("@")[0])||"Staff Member":s.staffRecipient.name||(null===(u=s.staffRecipient.email)||void 0===u?void 0:u.split("@")[0])||s.staffInitiator.name||(null===(m=s.staffInitiator.email)||void 0===m?void 0:m.split("@")[0])||"Staff Member"}return null!==(r=s.staffRecipient)&&void 0!==r&&r.name?s.staffRecipient.name:null!==(l=s.staffInitiator)&&void 0!==l&&l.name?s.staffInitiator.name:null!==(i=s.staffRecipient)&&void 0!==i&&i.email?s.staffRecipient.email.split("@")[0]:null!==(o=s.staffInitiator)&&void 0!==o&&o.email?s.staffInitiator.email.split("@")[0]:"Staff Member"}};return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg flex flex-col h-full min-h-0 max-h-full overflow-hidden",children:[(0,sa.jsxs)("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between flex-shrink-0",children:[(0,sa.jsx)("div",{children:(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r ".concat(n?"from-orange-500 to-pink-500":"from-blue-500 to-purple-500"," rounded-full flex items-center justify-center text-white font-bold"),children:k()[0]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:k()}),n&&s.subject&&(0,sa.jsx)("div",{className:"text-white/60 text-sm",children:s.subject})]})]})}),(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[n&&(0,sa.jsxs)("select",{value:s.status,onChange:e=>l(e.target.value),className:"px-3 py-1 bg-slate-700 text-white rounded-lg text-sm",children:[(0,sa.jsx)("option",{value:"open",children:"Open"}),(0,sa.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,sa.jsx)("option",{value:"resolved",children:"Resolved"}),(0,sa.jsx)("option",{value:"closed",children:"Closed"})]}),!n&&(0,sa.jsx)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to delete this chat? It will only be removed from your side."))try{f(!0),await jr.h2.archiveChatSession(t,s.id),i&&i(),a()}catch(e){alert("Failed to delete chat: "+(e.message||"Unknown error"))}finally{f(!1)}},disabled:g,className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm disabled:opacity-50",title:"Delete chat (only from your side)",children:g?"Deleting...":"Delete"}),(0,sa.jsx)("button",{onClick:a,className:"text-white/60 hover:text-white",children:(0,sa.jsx)(wc,{className:"text-xl"})})]})]}),(0,sa.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-0 flex-shrink",style:{scrollBehavior:"smooth",scrollbarWidth:"thin",scrollbarColor:"#475569 #1e293b"},children:[h&&0===d.length?(0,sa.jsx)("div",{className:"text-white/60 text-center py-8",children:"Loading messages..."}):0===d.length?(0,sa.jsx)("div",{className:"text-white/60 text-center py-8",children:"No messages yet. Start the conversation!"}):(e=>{const t=jr.R2.getCurrentUser(),s=null===t||void 0===t||null===(e=t.email)||void 0===e?void 0:e.toLowerCase(),a=localStorage.getItem("userId");return d.map(e=>{var t;let r=!1;if(n)r="staff"===e.senderType;else{var l,i,o;const t=null===(l=e.senderStaff)||void 0===l?void 0:l.userId,n=null===(i=e.senderStaff)||void 0===i||null===(o=i.email)||void 0===o?void 0:o.toLowerCase();r=a&&t===a||s&&n===s}return(0,sa.jsx)("div",{className:"flex ".concat(r?"justify-end":"justify-start"),children:(0,sa.jsxs)("div",{className:"max-w-[70%] ".concat(r?"bg-blue-600":"bg-green-600"," rounded-lg p-3"),children:[(0,sa.jsxs)("div",{className:"text-white/80 text-xs mb-1",children:[e.senderName,n&&"staff"===e.senderType&&(null===(t=e.senderStaff)||void 0===t?void 0:t.role)&&(0,sa.jsxs)("span",{className:"text-white/60 ml-1",children:["(",e.senderStaff.role,")"]})]}),(0,sa.jsx)("div",{className:"text-white",children:e.message}),(0,sa.jsx)("div",{className:"text-white/50 text-xs mt-1",children:N(e.createdAt)})]})},e.id)})})(),(0,sa.jsx)("div",{ref:y})]}),(0,sa.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),u.trim()&&!p)try{b(!0),await jr.h2.sendMessage(t,s.id,u.trim()),m(""),j()}catch(a){alert("Failed to send message")}finally{b(!1)}},className:"p-4 border-t border-slate-700 flex-shrink-0",children:(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"Type your message...",className:"flex-1 px-4 py-3 bg-slate-700 text-white rounded-lg",disabled:p}),(0,sa.jsxs)("button",{type:"submit",disabled:!u.trim()||p,className:"bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50 flex items-center gap-2",children:[(0,sa.jsx)(pc,{}),p?"Sending...":"Send"]})]})})]})}function tm(e){let{clubId:t,existingSessions:s=[],onClose:a,onSuccess:n}=e;const[l,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),[h,x]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&g()},[t]);const g=async()=>{try{x(!0);const e=await jr.h2.getChatableUsers(t,!0),s=(null===e||void 0===e?void 0:e.users)||e||[],a=Array.isArray(s)?s.filter(e=>"Active"===e.status||!e.status||"active"===e.status):[],r=[],n=new Set;a.forEach(e=>{var t;const s=null===(t=e.email)||void 0===t?void 0:t.toLowerCase();if(s&&!n.has(s)){n.add(s);let t=e.role||e.customRoleName||"Staff";"SUPER_ADMIN"===t?t="Super Admin":"ADMIN"===t?t="Admin":"MANAGER"===t?t="Manager":"HR"===t?t="HR":"GRE"===t?t="GRE":"CASHIER"===t?t="Cashier":"FNB"===t?t="FNB":"STAFF"===t?t="Staff":"DEALER"===t?t="Dealer":"AFFILIATE"===t&&(t="Affiliate"),r.push((0,i.A)((0,i.A)({},e),{},{chatId:e.chatId||e.id,name:e.name||e.displayName||e.email,role:t}))}}),o(r)}catch(e){console.error("Error loading staff members:",e),alert("Failed to load staff members: "+(e.message||"Unknown error")),o([])}finally{x(!1)}};return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Start New Chat"}),(0,sa.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),d)try{b(!0);const e=await jr.h2.createStaffChatSession(t,d,u||void 0);n(e.session)}catch(s){alert("Failed to create chat session")}finally{b(!1)}else alert("Please select a staff member")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Select Staff Member *"}),h?(0,sa.jsx)("div",{className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg text-center",children:"Loading staff members..."}):(0,sa.jsxs)("select",{value:d,onChange:e=>c(e.target.value),required:!0,className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",disabled:h||0===l.length,children:[(0,sa.jsx)("option",{value:"",children:0===l.length?"No staff members available":"Choose staff member..."}),l.map(e=>(0,sa.jsxs)("option",{value:e.chatId||e.id,children:[e.name||e.displayName," - ",e.role]},e.chatId||e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Subject (Optional)"}),(0,sa.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"What is this chat about?",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"submit",disabled:p||!d,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:p?"Creating...":"Start Chat"}),(0,sa.jsx)("button",{type:"button",onClick:a,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function sm(e){let{status:t}=e;return(0,sa.jsx)("span",{className:"".concat({open:"bg-yellow-600",in_progress:"bg-blue-600",resolved:"bg-green-600",closed:"bg-gray-600"}[t]||"bg-gray-600"," text-white text-xs px-2 py-1 rounded-full"),children:{open:"Open",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"}[t]||t})}function am(e){let{selectedClubId:t}=e;const s=ra(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(null),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)("details"),[y,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)(null),[N,S]=(0,r.useState)(""),[k,C]=(0,r.useState)(""),[A,_]=(0,r.useState)(0),P=["Points Rummy","Pool Rummy (101 Points)","Pool Rummy (201 Points)","Deals Rummy","Custom"],[T,E]=(0,r.useState)({name:"",rummy_variant:"Points Rummy",custom_variant:"",entry_fee:"",prize_pool:"",number_of_deals:1,points_per_deal:0,drop_points:20,max_points:80,min_players:2,max_players:6,start_time:"",deal_duration:5,break_duration:5,payout_structure:"Winner takes all",allow_reentry:!1,late_registration:60}),[I,R]=(0,r.useState)([]),[D,O]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(t)try{const e=await jr.Od.getClub(t);O((null===e||void 0===e?void 0:e.logoUrl)||null)}catch(e){console.error("Error fetching club logo:",e)}})()},[t]);const{data:L,isLoading:F}=hn({queryKey:["rummy-tournaments",t],queryFn:()=>jr.Re.getTournaments(t),enabled:!!t,select:e=>(Array.isArray(e)?e:(null===e||void 0===e?void 0:e.tournaments)||[]).filter(e=>e&&e.rummy_variant&&null!==e.rummy_variant&&""!==e.rummy_variant)}),{data:M,isLoading:B}=hn({queryKey:["rummy-tournament-details",t,null===h||void 0===h?void 0:h.id],queryFn:()=>jr.Re.getTournamentById(t,h.id),enabled:!!t&&!!h&&d}),{data:q,isLoading:U}=hn({queryKey:["rummy-tournament-players",t,null===h||void 0===h?void 0:h.id],queryFn:async()=>{const e=await jr.Re.getTournamentPlayers(t,h.id);return(null===e||void 0===e?void 0:e.players)||e||[]},enabled:!!t&&!!h&&(d||u)}),{data:z}=hn({queryKey:["rummy-tournament-winners",t,null===h||void 0===h?void 0:h.id],queryFn:async()=>{const e=await jr.Re.getTournamentWinners(t,h.id);return(null===e||void 0===e?void 0:e.winners)||e||[]},enabled:!!t&&!!h&&"completed"===h.status&&d});(0,r.useEffect)(()=>{z&&z.length>0&&"completed"===(null===h||void 0===h?void 0:h.status)&&R(z.map(e=>({player_id:e.player_id||e.id,finishing_position:e.finishing_position,prize_amount:e.prize_amount||0,name:e.name,email:e.email})))},[z,null===h||void 0===h?void 0:h.status]);const K=gn({mutationFn:e=>jr.Re.createTournament(t,{name:e.name,tournament_type:"Rummy - ".concat("Custom"===e.rummy_variant?e.custom_variant:e.rummy_variant),buy_in:parseFloat(e.entry_fee)||0,entry_fee:parseFloat(e.entry_fee)||0,starting_chips:0,blind_structure:"N/A",max_players:parseInt(e.max_players)||6,start_time:e.start_time||null,payout_structure:e.payout_structure||"Winner takes all",allow_reentry:e.allow_reentry||!1,late_registration:parseInt(e.late_registration)||60,break_duration:parseInt(e.break_duration)||5,rummy_variant:"Custom"===e.rummy_variant?e.custom_variant:e.rummy_variant,number_of_deals:parseInt(e.number_of_deals)||null,points_per_deal:parseInt(e.points_per_deal)||null,drop_points:parseInt(e.drop_points)||null,max_points:parseInt(e.max_points)||null,deal_duration:parseInt(e.deal_duration)||null,prize_pool:parseFloat(e.prize_pool)||null,min_players:parseInt(e.min_players)||2}),onSuccess:()=>{wr.success("Rummy tournament created successfully!"),s.invalidateQueries(["rummy-tournaments",t]),n(!1),ae()},onError:e=>{wr.error(e.message||"Failed to create rummy tournament")}}),W=gn({mutationFn:e=>{let{tournamentId:s,data:a}=e;return jr.Re.updateTournament(t,s,{name:a.name,tournament_type:"Rummy - ".concat("Custom"===a.rummy_variant?a.custom_variant:a.rummy_variant),buy_in:parseFloat(a.entry_fee)||0,entry_fee:parseFloat(a.entry_fee)||0,max_players:parseInt(a.max_players)||6,start_time:a.start_time||null,payout_structure:a.payout_structure||"Winner takes all",allow_reentry:a.allow_reentry||!1,late_registration:parseInt(a.late_registration)||60,break_duration:parseInt(a.break_duration)||5,rummy_variant:"Custom"===a.rummy_variant?a.custom_variant:a.rummy_variant,number_of_deals:parseInt(a.number_of_deals)||null,points_per_deal:parseInt(a.points_per_deal)||null,drop_points:parseInt(a.drop_points)||null,max_points:parseInt(a.max_points)||null,deal_duration:parseInt(a.deal_duration)||null,prize_pool:parseFloat(a.prize_pool)||null,min_players:parseInt(a.min_players)||2})},onSuccess:()=>{wr.success("Rummy tournament updated successfully!"),s.invalidateQueries(["rummy-tournaments",t]),c(!1),x(null)},onError:e=>{wr.error(e.message||"Failed to update rummy tournament")}}),H=gn({mutationFn:e=>jr.Re.startTournament(t,e),onSuccess:()=>{wr.success("Rummy tournament started!"),s.invalidateQueries(["rummy-tournaments",t])},onError:e=>{wr.error(e.message||"Failed to start tournament")}}),V=gn({mutationFn:e=>jr.Re.endTournament(t,h.id,e),onSuccess:()=>{wr.success("Rummy tournament ended successfully!"),s.invalidateQueries(["rummy-tournaments",t]),s.invalidateQueries(["rummy-tournament-winners",t,h.id]),m(!1),s.invalidateQueries(["rummy-tournament-details",t,h.id]),setTimeout(()=>{s.invalidateQueries(["rummy-tournaments",t])},500)},onError:e=>{wr.error(e.message||"Failed to end tournament")}}),J=gn({mutationFn:e=>jr.Re.deleteTournament(t,e),onSuccess:()=>{wr.success("Rummy tournament deleted successfully!"),s.invalidateQueries(["rummy-tournaments",t])},onError:e=>{wr.error(e.message||"Failed to delete tournament")}}),Q=gn({mutationFn:e=>jr.Re.exitTournamentPlayer(t,h.id,e),onSuccess:e=>{wr.success(e.message||"Player exited successfully!"),s.invalidateQueries(["rummy-tournament-players",t,null===h||void 0===h?void 0:h.id]),s.invalidateQueries(["rummy-tournaments",t]),v(!1),j(null),S(""),C("")},onError:e=>{wr.error(e.message||"Failed to exit player")}});(0,r.useEffect)(()=>{const e=M||h;if(null===e||void 0===e||!e.session_started_at||"active"!==(null===e||void 0===e?void 0:e.status))return void _(0);const t=new Date(e.session_started_at).getTime(),s=parseInt(e.total_paused_seconds)||0,a=!!e.paused_at,r=e.paused_at?new Date(e.paused_at).getTime():null,n=()=>{const e=Date.now();if(a&&r){const e=Math.floor((r-t)/1e3);_(e-s)}else{const a=Math.floor((e-t)/1e3);_(a-s)}};n();const l=a?null:setInterval(n,1e3);return()=>{l&&clearInterval(l)}},[M,h]);const G=(0,r.useCallback)(e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),a=e%60;return"".concat(t.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))},[]),Y=()=>{window.confirm("Pause the tournament session? The timer will be frozen.")&&ee.mutate()},$=()=>{te.mutate()},Z=()=>{window.confirm("Force STOP this tournament? This will end the tournament without declaring winners. This action cannot be undone.")&&se.mutate()},X=gn({mutationFn:e=>jr.Re.rebuyTournamentPlayer(t,h.id,e),onSuccess:e=>{wr.success(e.message||"Rebuy successful!"),s.invalidateQueries(["rummy-tournament-players",t,null===h||void 0===h?void 0:h.id]),s.invalidateQueries(["rummy-tournaments",t])},onError:e=>{wr.error(e.message||"Failed to process rebuy")}}),ee=gn({mutationFn:()=>jr.Re.pauseTournament(t,h.id),onSuccess:e=>{wr.success("Tournament paused!"),s.invalidateQueries(["rummy-tournaments",t]),s.invalidateQueries(["rummy-tournament-details",t,null===h||void 0===h?void 0:h.id]),null!==e&&void 0!==e&&e.tournament&&x(t=>(0,i.A)((0,i.A)({},t),e.tournament))},onError:e=>{wr.error(e.message||"Failed to pause tournament")}}),te=gn({mutationFn:()=>jr.Re.resumeTournament(t,h.id),onSuccess:e=>{wr.success("Tournament resumed!"),s.invalidateQueries(["rummy-tournaments",t]),s.invalidateQueries(["rummy-tournament-details",t,null===h||void 0===h?void 0:h.id]),null!==e&&void 0!==e&&e.tournament&&x(t=>(0,i.A)((0,i.A)({},t),e.tournament))},onError:e=>{wr.error(e.message||"Failed to resume tournament")}}),se=gn({mutationFn:()=>jr.Re.stopTournament(t,h.id),onSuccess:()=>{wr.success("Tournament stopped!"),s.invalidateQueries(["rummy-tournaments",t]),s.invalidateQueries(["rummy-tournament-details",t,null===h||void 0===h?void 0:h.id]),c(!1),x(null)},onError:e=>{wr.error(e.message||"Failed to stop tournament")}}),ae=()=>{E({name:"",rummy_variant:"Points Rummy",custom_variant:"",entry_fee:"",prize_pool:"",number_of_deals:1,points_per_deal:0,drop_points:20,max_points:80,min_players:2,max_players:6,start_time:"",deal_duration:5,break_duration:5,payout_structure:"Winner takes all",allow_reentry:!1,late_registration:60})},re=e=>{window.confirm("Are you sure you want to start this rummy tournament?")&&H.mutate(e)},ne=e=>{var t,s,a,r,n,l;b(e),E({name:e.name||"",rummy_variant:e.rummy_variant||"Points Rummy",custom_variant:e.custom_variant||"",entry_fee:(null===(t=e.entry_fee)||void 0===t?void 0:t.toString())||(null===(s=e.buy_in)||void 0===s?void 0:s.toString())||"",prize_pool:(null===(a=e.prize_pool)||void 0===a?void 0:a.toString())||"",number_of_deals:e.number_of_deals||1,points_per_deal:(null===(r=e.points_per_deal)||void 0===r?void 0:r.toString())||"0",drop_points:(null===(n=e.drop_points)||void 0===n?void 0:n.toString())||"20",max_points:(null===(l=e.max_points)||void 0===l?void 0:l.toString())||"80",min_players:e.min_players||2,max_players:e.max_players||6,start_time:e.start_time?new Date(e.start_time).toISOString().slice(0,16):"",deal_duration:e.deal_duration||5,break_duration:e.break_duration||5,payout_structure:e.payout_structure||"Winner takes all",allow_reentry:e.allow_reentry||!1,late_registration:e.late_registration||60}),o(!0)},le=(e,t,s)=>{const a=[...I];a[e][t]=s,R(a)},ie=Array.isArray(L)?L:(null===L||void 0===L?void 0:L.tournaments)||[],oe=M||h;return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Rummy Tournaments"}),(0,sa.jsx)("button",{onClick:()=>n(!0),className:"bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-lg font-medium",children:"+ Create Rummy Tournament"})]}),F?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading rummy tournaments..."})]}):0===ie.length?(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 border border-slate-700 text-center",children:[(0,sa.jsx)("p",{className:"text-gray-400 mb-4",children:"No rummy tournaments found"}),(0,sa.jsx)("button",{onClick:()=>n(!0),className:"bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-lg",children:"Create First Rummy Tournament"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ie.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 hover:border-emerald-500 transition-colors",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:e.name}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("active"===e.status?"bg-green-500/20 text-green-300":"completed"===e.status?"bg-gray-500/20 text-gray-300":"bg-yellow-500/20 text-yellow-300"),children:e.status}),"active"===e.status&&e.session_started_at&&(0,sa.jsx)("div",{className:"flex items-center gap-1.5 mt-2",children:e.paused_at?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),(0,sa.jsx)("span",{className:"text-yellow-400 text-xs font-medium",children:"Session Paused"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,sa.jsx)("span",{className:"text-green-400 text-xs font-medium",children:"Session Running"})]})})]}),(0,sa.jsxs)("div",{className:"space-y-2 text-sm text-gray-400",children:[(0,sa.jsxs)("p",{children:["Variant: ",e.tournament_type||e.rummy_variant||"N/A"]}),(0,sa.jsxs)("p",{children:["Entry Fee: \u20b9",e.entry_fee||e.buy_in||"0"]}),(0,sa.jsxs)("p",{children:["Max Players: ",e.max_players||"N/A"]}),e.start_time&&(0,sa.jsxs)("p",{children:["Start: ",new Date(e.start_time).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]})]}),(0,sa.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),x(e),c(!0),f("details")},className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded text-sm",children:"View Details"}),"scheduled"===e.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),ne(e)},className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded text-sm",children:"Edit"}),(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),re(e.id)},className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded text-sm",children:"Start"}),(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),window.confirm("Delete this tournament?")&&J.mutate(e.id)},className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded text-sm",children:"Delete"})]}),"active"===e.status&&(0,sa.jsxs)(sa.Fragment,{children:[e.paused_at?(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),x(e),te.mutate()},className:"bg-green-600 hover:bg-green-500 text-white px-3 py-2 rounded text-sm",children:"\u25b6 Resume"}):(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),x(e),ee.mutate()},className:"bg-yellow-600 hover:bg-yellow-500 text-white px-3 py-2 rounded text-sm",children:"\u23f8 Pause"}),(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),x(e),m(!0)},className:"flex-1 bg-orange-600 hover:bg-orange-500 text-white px-4 py-2 rounded text-sm",children:"End"})]})]})]},e.id))}),a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",onClick:()=>n(!1),children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto border border-slate-700",onClick:e=>e.stopPropagation(),children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Create Rummy Tournament"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tournament Name *"}),(0,sa.jsx)("input",{type:"text",value:T.name,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"e.g., Weekend Rummy Championship"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rummy Variant *"}),(0,sa.jsx)("select",{value:T.rummy_variant,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{rummy_variant:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",children:P.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===T.rummy_variant&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Custom Variant Name"}),(0,sa.jsx)("input",{type:"text",value:T.custom_variant,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{custom_variant:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Enter custom variant name"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Entry Fee (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",value:T.entry_fee,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{entry_fee:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"0",min:"0"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Prize Pool (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:T.prize_pool,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{prize_pool:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"0",min:"0"})]})]}),(T.rummy_variant.includes("Points")||"Custom"===T.rummy_variant)&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Drop Points"}),(0,sa.jsx)("input",{type:"number",value:T.drop_points,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{drop_points:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Points"}),(0,sa.jsx)("input",{type:"number",value:T.max_points,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{max_points:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Points Per Deal"}),(0,sa.jsx)("input",{type:"number",value:T.points_per_deal,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{points_per_deal:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),"Deals Rummy"===T.rummy_variant&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Number of Deals"}),(0,sa.jsx)("input",{type:"number",value:T.number_of_deals,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{number_of_deals:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"1"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Players"}),(0,sa.jsx)("input",{type:"number",value:T.min_players,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{min_players:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"2",max:"6"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Players"}),(0,sa.jsx)("input",{type:"number",value:T.max_players,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{max_players:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"2",max:"6"})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Deal Duration (minutes)"}),(0,sa.jsx)("input",{type:"number",value:T.deal_duration,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{deal_duration:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"1"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Break Duration (minutes)"}),(0,sa.jsx)("input",{type:"number",value:T.break_duration,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{break_duration:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Time"}),(0,sa.jsx)("input",{type:"datetime-local",value:T.start_time,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{start_time:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Payout Structure"}),(0,sa.jsxs)("select",{value:T.payout_structure,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{payout_structure:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"Winner takes all",children:"Winner takes all"}),(0,sa.jsx)("option",{value:"Top 2",children:"Top 2"}),(0,sa.jsx)("option",{value:"Top 3",children:"Top 3"}),(0,sa.jsx)("option",{value:"Top 50%",children:"Top 50%"})]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("input",{type:"checkbox",id:"allow_reentry",checked:T.allow_reentry,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{allow_reentry:e.target.checked})),className:"w-4 h-4"}),(0,sa.jsx)("label",{htmlFor:"allow_reentry",className:"text-sm text-gray-300",children:"Allow Re-entry"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Late Registration (minutes)"}),(0,sa.jsx)("input",{type:"number",value:T.late_registration,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{late_registration:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{n(!1),ae()},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-6 py-2 rounded-lg",children:"Cancel"}),(0,sa.jsx)("button",{onClick:()=>{T.name&&T.entry_fee?K.mutate(T):wr.error("Please fill in all required fields")},disabled:K.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-lg disabled:opacity-50",children:K.isLoading?"Creating...":"Create Tournament"})]})]})}),l&&p&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",onClick:()=>{o(!1),b(null),ae()},children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto border border-purple-700",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold mb-6",children:["Edit Rummy Tournament: ",p.name]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tournament Name *"}),(0,sa.jsx)("input",{type:"text",value:T.name,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rummy Variant *"}),(0,sa.jsx)("select",{value:T.rummy_variant,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{rummy_variant:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",children:P.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===T.rummy_variant&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Custom Variant"}),(0,sa.jsx)("input",{type:"text",value:T.custom_variant,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{custom_variant:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Entry Fee (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",value:T.entry_fee,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{entry_fee:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Prize Pool (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:T.prize_pool,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{prize_pool:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Players"}),(0,sa.jsx)("input",{type:"number",value:T.min_players,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{min_players:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"2"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Players"}),(0,sa.jsx)("input",{type:"number",value:T.max_players,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{max_players:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"2"})]})]}),"Points Rummy"===T.rummy_variant&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Points Per Deal"}),(0,sa.jsx)("input",{type:"number",value:T.points_per_deal,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{points_per_deal:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Drop Points"}),(0,sa.jsx)("input",{type:"number",value:T.drop_points,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{drop_points:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Points"}),(0,sa.jsx)("input",{type:"number",value:T.max_points,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{max_points:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]})]})]}),"Deals Rummy"===T.rummy_variant&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Number of Deals"}),(0,sa.jsx)("input",{type:"number",value:T.number_of_deals,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{number_of_deals:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"1"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Deal Duration (minutes)"}),(0,sa.jsx)("input",{type:"number",value:T.deal_duration,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{deal_duration:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"1"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Break Duration (minutes)"}),(0,sa.jsx)("input",{type:"number",value:T.break_duration,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{break_duration:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Time"}),(0,sa.jsx)("input",{type:"datetime-local",value:T.start_time,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{start_time:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Payout Structure"}),(0,sa.jsxs)("select",{value:T.payout_structure,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{payout_structure:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"Winner takes all",children:"Winner takes all"}),(0,sa.jsx)("option",{value:"Top 2",children:"Top 2"}),(0,sa.jsx)("option",{value:"Top 3",children:"Top 3"}),(0,sa.jsx)("option",{value:"Top 50%",children:"Top 50%"})]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("input",{type:"checkbox",id:"edit_allow_reentry",checked:T.allow_reentry,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{allow_reentry:e.target.checked})),className:"w-4 h-4"}),(0,sa.jsx)("label",{htmlFor:"edit_allow_reentry",className:"text-sm text-gray-300",children:"Allow Re-entry"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Late Registration (minutes)"}),(0,sa.jsx)("input",{type:"number",value:T.late_registration,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{late_registration:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{o(!1),b(null),ae()},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-6 py-2 rounded-lg",children:"Cancel"}),(0,sa.jsx)("button",{onClick:()=>{if(!T.name||!T.entry_fee)return void wr.error("Please fill in all required fields");const e={name:T.name,tournament_type:"Rummy - ".concat("Custom"===T.rummy_variant?T.custom_variant:T.rummy_variant),buy_in:parseFloat(T.entry_fee)||0,entry_fee:parseFloat(T.entry_fee)||0,max_players:parseInt(T.max_players)||6,min_players:parseInt(T.min_players)||2,start_time:T.start_time||void 0,prize_pool:T.prize_pool?parseFloat(T.prize_pool):void 0,payout_structure:T.payout_structure||"Winner takes all",allow_reentry:Boolean(T.allow_reentry),late_registration:parseInt(T.late_registration)||60,rummy_variant:T.rummy_variant,custom_variant:"Custom"===T.rummy_variant?T.custom_variant:void 0,number_of_deals:parseInt(T.number_of_deals)||1,points_per_deal:parseFloat(T.points_per_deal)||0,drop_points:parseFloat(T.drop_points)||20,max_points:parseFloat(T.max_points)||80,deal_duration:parseInt(T.deal_duration)||5,break_duration:parseInt(T.break_duration)||5};W.mutate({tournamentId:p.id,data:e})},disabled:W.isLoading,className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-6 py-2 rounded-lg disabled:opacity-50",children:W.isLoading?"Updating...":"Update Tournament"})]})]})}),d&&h&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-6xl w-full border border-emerald-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:h.name}),(0,sa.jsx)("button",{onClick:()=>{c(!1),x(null)},className:"text-gray-400 hover:text-white text-2xl",children:"\xd7"})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>f("details"),className:"px-4 py-2 font-semibold transition-colors ".concat("details"===g?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Details"}),"completed"!==h.status&&(0,sa.jsxs)("button",{onClick:()=>f("players"),className:"px-4 py-2 font-semibold transition-colors ".concat("players"===g?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:["Players (",(null===q||void 0===q?void 0:q.length)||0,")"]})]}),"details"===g&&"completed"===h.status?(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Tournament Winners"}),0===I.length?(0,sa.jsx)("div",{className:"text-center py-12",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"No winners recorded"})}):(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Position"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Player ID"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Name"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Email"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Prize Amount"})]})}),(0,sa.jsx)("tbody",{children:I.map((e,t)=>(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30",children:[(0,sa.jsx)("td",{className:"py-3 px-4",children:(0,sa.jsx)("span",{className:"inline-block w-8 h-8 rounded-full bg-yellow-500 text-slate-900 font-bold flex items-center justify-center",children:e.finishing_position})}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white font-mono",children:e.player_id}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.name||"N/A"}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.email||"N/A"}),(0,sa.jsxs)("td",{className:"py-3 px-4 text-emerald-400 font-semibold",children:["\u20b9",e.prize_amount?parseFloat(e.prize_amount).toLocaleString():"0"]})]},t))})]})})]}):"details"===g&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"relative w-full bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl p-8 border border-slate-700",children:[(0,sa.jsx)("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-10",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-yellow-600 via-amber-500 to-orange-500 border-2 border-yellow-400/80 px-6 py-3 rounded-lg text-center shadow-xl",children:[(0,sa.jsx)("div",{className:"text-yellow-200 text-xs font-semibold uppercase tracking-wider",children:"Prize Pool"}),(0,sa.jsxs)("div",{className:"text-white text-2xl font-bold",children:["\u20b9",h.prize_pool?parseFloat(h.prize_pool).toLocaleString():"0"]})]})}),(0,sa.jsx)("div",{className:"relative aspect-[1/1] max-w-md mx-auto mt-16 mb-8",children:(0,sa.jsx)("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-amber-900 via-yellow-900 to-amber-950 shadow-2xl",children:(0,sa.jsx)("div",{className:"absolute inset-2 rounded-full bg-gradient-to-br from-amber-700 via-amber-600 to-amber-700",children:(0,sa.jsxs)("div",{className:"absolute inset-2 rounded-full bg-gradient-to-br from-emerald-700 via-green-800 to-emerald-900 shadow-inner flex items-center justify-center",children:[(0,sa.jsx)("div",{className:"absolute inset-6 rounded-full border border-emerald-600/30"}),(0,sa.jsxs)("div",{className:"w-28 h-28 bg-white/10 rounded-full border-2 border-white/20 flex items-center justify-center shadow-xl backdrop-blur-sm overflow-hidden z-10",children:[D?(0,sa.jsx)("img",{src:D,alt:"Club Logo",className:"w-full h-full object-contain rounded-full p-2",onError:e=>{e.target.style.display="none";const t=e.target.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,sa.jsx)("div",{className:"text-4xl font-bold text-white/30 ".concat(D?"hidden":"flex"," items-center justify-center w-full h-full"),children:"\ud83c\udfb4"})]})]})})})}),"active"===(null===oe||void 0===oe?void 0:oe.status)&&(null===oe||void 0===oe?void 0:oe.session_started_at)&&(()=>{const e=!(null===oe||void 0===oe||!oe.paused_at);return(0,sa.jsxs)("div",{className:"mt-6 ".concat(e?"bg-gradient-to-r from-yellow-900/40 to-orange-900/40 border-yellow-500/30":"bg-gradient-to-r from-green-900/40 to-emerald-900/40 border-green-500/30"," border rounded-xl p-4"),children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e?"bg-yellow-500":"bg-green-500 animate-pulse")}),(0,sa.jsx)("span",{className:"".concat(e?"text-yellow-400":"text-green-400"," text-sm font-medium uppercase tracking-wider"),children:e?"PAUSED":"LIVE"})]}),(0,sa.jsx)("div",{className:"text-4xl font-mono font-bold ".concat(e?"text-yellow-300":"text-green-300"," tabular-nums"),children:G(A)}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[e?(0,sa.jsx)("button",{onClick:$,disabled:te.isLoading,className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold disabled:opacity-50",children:"\u25b6 Resume"}):(0,sa.jsx)("button",{onClick:Y,disabled:ee.isLoading,className:"bg-yellow-600 hover:bg-yellow-500 text-white px-4 py-2 rounded-lg text-sm font-semibold disabled:opacity-50",children:"\u23f8 Pause"}),(0,sa.jsx)("button",{onClick:Z,disabled:se.isLoading,className:"bg-red-700 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-semibold disabled:opacity-50",children:"\u23f9 Stop"})]})]}),e&&(0,sa.jsxs)("div",{className:"mt-2 text-yellow-400/70 text-xs text-center",children:["Tournament paused since ",new Date(oe.paused_at).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0})]})]})})(),(0,sa.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Variant"}),(0,sa.jsx)("div",{className:"text-white font-semibold text-sm",children:h.rummy_variant||"N/A"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Entry Fee"}),(0,sa.jsxs)("div",{className:"text-white font-semibold text-sm",children:["\u20b9",h.entry_fee||h.buy_in||"0"]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Players"}),(0,sa.jsxs)("div",{className:"text-white font-semibold text-sm",children:[(null===q||void 0===q?void 0:q.length)||0,"/",h.max_players||"N/A"]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-slate-400 text-xs mb-1",children:"Status"}),(0,sa.jsx)("div",{className:"text-white font-semibold text-sm",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("active"===h.status?"bg-green-500/20 text-green-300":"completed"===h.status?"bg-gray-500/20 text-gray-300":"bg-yellow-500/20 text-yellow-300"),children:h.status})})]})]})]}),(e=>{const t=oe||h,s=[{label:"Tournament ID",value:null===(e=t.id)||void 0===e?void 0:e.substring(0,8),mono:!0},{label:"Rummy Variant",value:t.rummy_variant},{label:"Tournament Type",value:t.tournament_type},{label:"Entry Fee / Buy-In",value:t.entry_fee||t.buy_in?"\u20b9".concat(Number(t.entry_fee||t.buy_in).toLocaleString()):null},{label:"Prize Pool",value:t.prize_pool?"\u20b9".concat(Number(t.prize_pool).toLocaleString()):null},{label:"Min Players",value:t.min_players},{label:"Max Players",value:t.max_players},{label:"Number of Deals",value:t.number_of_deals},{label:"Points Per Deal",value:t.points_per_deal},{label:"Drop Points",value:t.drop_points},{label:"Max Points",value:t.max_points},{label:"Deal Duration",value:t.deal_duration?"".concat(t.deal_duration," min"):null},{label:"Break Duration",value:t.break_duration?"".concat(t.break_duration," min"):null},{label:"Late Registration",value:t.late_registration?"".concat(t.late_registration," min"):null},{label:"Payout Structure",value:t.payout_structure},{label:"Allow Re-entry",value:t.allow_reentry?"Yes":"No",badge:!0,positive:!!t.allow_reentry},{label:"Start Time",value:t.start_time?new Date(t.start_time).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",dateStyle:"medium",timeStyle:"short",hour12:!0}):null},{label:"Session Started",value:t.session_started_at?new Date(t.session_started_at).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",dateStyle:"medium",timeStyle:"short",hour12:!0}):null}].filter(e=>null!==e.value&&void 0!==e.value&&""!==e.value&&0!==e.value),a=Math.ceil(s.length/2),r=s.slice(0,a),n=s.slice(a);return(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r,n].map((e,t)=>(0,sa.jsx)("div",{className:"space-y-3",children:e.map((e,t)=>(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.label}),e.badge?(0,sa.jsx)("span",{className:"inline-block text-xs px-2 py-1 rounded ".concat(e.positive?"bg-green-600/20 text-green-400 border border-green-500/30":"bg-gray-600/20 text-gray-400 border border-gray-500/30"),children:e.value}):(0,sa.jsx)("p",{className:"text-white ".concat(e.mono?"font-mono":""),children:e.value})]},t))},t))})})()]}),"players"===g&&(0,sa.jsxs)("div",{className:"space-y-4",children:["active"===(null===oe||void 0===oe?void 0:oe.status)&&(null===oe||void 0===oe?void 0:oe.session_started_at)&&(0,sa.jsxs)("div",{className:"".concat(null!==oe&&void 0!==oe&&oe.paused_at?"bg-gradient-to-r from-yellow-900/30 to-orange-900/30 border-yellow-500/20":"bg-gradient-to-r from-green-900/30 to-emerald-900/30 border-green-500/20"," border rounded-lg p-3 flex items-center justify-between"),children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(null!==oe&&void 0!==oe&&oe.paused_at?"bg-yellow-500":"bg-green-500 animate-pulse")}),(0,sa.jsx)("span",{className:"".concat(null!==oe&&void 0!==oe&&oe.paused_at?"text-yellow-400":"text-green-400"," text-sm font-medium"),children:null!==oe&&void 0!==oe&&oe.paused_at?"Tournament PAUSED":"Tournament Session Active"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("div",{className:"text-2xl font-mono font-bold ".concat(null!==oe&&void 0!==oe&&oe.paused_at?"text-yellow-300":"text-green-300"," tabular-nums"),children:G(A)}),null!==oe&&void 0!==oe&&oe.paused_at?(0,sa.jsx)("button",{onClick:$,disabled:te.isLoading,className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded text-xs font-semibold disabled:opacity-50",children:"\u25b6 Resume"}):(0,sa.jsx)("button",{onClick:Y,disabled:ee.isLoading,className:"bg-yellow-600 hover:bg-yellow-500 text-white px-3 py-1.5 rounded text-xs font-semibold disabled:opacity-50",children:"\u23f8 Pause"})]})]}),U?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading players..."})]}):q&&0!==q.length?(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Player ID"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Name"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Mobile"}),("active"===h.status||"completed"===h.status)&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-semibold",children:"Wallet Balance"}),(0,sa.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-semibold",children:"Credits"})]}),"active"===h.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("th",{className:"text-center py-3 px-4 text-gray-400 font-semibold",children:"Session"}),(0,sa.jsx)("th",{className:"text-center py-3 px-4 text-gray-400 font-semibold",children:"Status"})]}),"completed"===h.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Position"}),(0,sa.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-semibold",children:"Prize"})]}),"active"===h.status&&(0,sa.jsx)("th",{className:"text-center py-3 px-4 text-gray-400 font-semibold",children:"Action"})]})}),(0,sa.jsx)("tbody",{children:q.map(e=>{const t=Number(e.wallet_balance||0),s=Number(e.total_credits||0),a=e.is_exited;let r=null;if(e.session_started_at&&!a){const t=new Date(e.session_started_at).getTime(),s=Math.floor((Date.now()-t)/1e3),a=Math.floor(s/3600),n=Math.floor(s%3600/60),l=s%60;r="".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"))}else if(a&&e.session_started_at&&e.exited_at){const t=new Date(e.session_started_at).getTime(),s=new Date(e.exited_at).getTime(),a=Math.floor((s-t)/1e3),n=Math.floor(a/3600),l=Math.floor(a%3600/60),i=a%60;r="".concat(n.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}return(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30 ".concat(a?"opacity-60":""),children:[(0,sa.jsx)("td",{className:"py-3 px-4 text-white font-mono",children:e.player_id||e.id}),(0,sa.jsxs)("td",{className:"py-3 px-4 text-white",children:[e.name||"N/A",a&&(0,sa.jsx)("span",{className:"ml-2 text-xs px-2 py-0.5 rounded bg-red-500/20 text-red-400 border border-red-500/30",children:"Exited"})]}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.mobile||"N/A"}),("active"===h.status||"completed"===h.status)&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("td",{className:"py-3 px-4 text-right font-semibold ".concat(t>=0?"text-green-400":"text-red-400"),children:["\u20b9",t.toFixed(2)]}),(0,sa.jsx)("td",{className:"py-3 px-4 text-right text-yellow-400 font-semibold",children:s>0?"\u20b9".concat(s.toFixed(2)):"-"})]}),"active"===h.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("td",{className:"py-3 px-4 text-center",children:[r?(0,sa.jsx)("span",{className:"font-mono text-xs tabular-nums ".concat(a?"text-gray-500":"text-green-400"),children:r}):(0,sa.jsx)("span",{className:"text-gray-500 text-xs",children:"--"}),a&&e.exited_at&&(0,sa.jsxs)("div",{className:"text-[10px] text-gray-500 mt-0.5",children:["Ended ",new Date(e.exited_at).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0,hour:"numeric",minute:"2-digit"})]})]}),(0,sa.jsx)("td",{className:"py-3 px-4 text-center",children:a?(0,sa.jsxs)("span",{className:"text-xs px-2 py-1 rounded bg-gray-600/20 text-gray-400 border border-gray-500/30",children:["Out (\u20b9",Number(e.exit_balance||0).toFixed(0),")"]}):(0,sa.jsx)("span",{className:"text-xs px-2 py-1 rounded bg-green-600/20 text-green-400 border border-green-500/30",children:"Playing"})})]}),"completed"===h.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.finishing_position||"-"}),(0,sa.jsx)("td",{className:"py-3 px-4 text-right text-emerald-400 font-semibold",children:e.prize_amount?"\u20b9".concat(e.prize_amount):"-"})]}),"active"===h.status&&(0,sa.jsx)("td",{className:"py-3 px-4 text-center",children:(0,sa.jsxs)("div",{className:"flex gap-1 justify-center flex-wrap",children:[!a&&(0,sa.jsx)("button",{onClick:()=>(e=>{j(e),S(""),C(""),v(!0)})(e),className:"bg-red-600 hover:bg-red-500 text-white px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors",children:"Exit"}),a&&(0,sa.jsx)("button",{onClick:()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rebuy";const s="rebuy"===t?"Rebuy":"reentry"===t?"Re-enter":"Add-on",a=oe||h,r=parseFloat((null===a||void 0===a?void 0:a.buy_in)||0);window.confirm("".concat(s," for ").concat(e.name,"? This will charge \u20b9").concat(r," buy-in."))&&X.mutate({playerId:e.id,type:t})}(e,"rebuy"),disabled:X.isLoading,className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors disabled:opacity-50",children:"Rebuy"})]})})]},e.id||e.player_id)})})]})}):(0,sa.jsx)("div",{className:"text-center py-12",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"No players registered yet"})})]}),"winners"===g&&"completed"===h.status&&(0,sa.jsx)("div",{className:"space-y-4",children:0===I.length?(0,sa.jsx)("div",{className:"text-center py-12",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"No winners recorded"})}):(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Position"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Player ID"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Name"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Email"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Prize Amount"})]})}),(0,sa.jsx)("tbody",{children:I.map((e,t)=>(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30",children:[(0,sa.jsx)("td",{className:"py-3 px-4",children:(0,sa.jsx)("span",{className:"inline-block w-8 h-8 rounded-full bg-yellow-500 text-slate-900 font-bold flex items-center justify-center",children:e.finishing_position})}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white font-mono",children:e.player_id}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.name}),(0,sa.jsx)("td",{className:"py-3 px-4 text-white",children:e.email||"N/A"}),(0,sa.jsxs)("td",{className:"py-3 px-4 text-emerald-400 font-semibold",children:["\u20b9",e.prize_amount]})]},t))})]})})}),(0,sa.jsxs)("div",{className:"mt-6 flex gap-4 pt-4 border-t border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>{c(!1),x(null)},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-6 py-2 rounded-lg",children:"Close"}),"scheduled"===h.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:e=>{e.stopPropagation(),c(!1),ne(h)},className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-6 py-2 rounded-lg",children:"Edit Tournament"}),(0,sa.jsx)("button",{onClick:e=>{e.stopPropagation(),re(h.id)},className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg",children:"Start Tournament"})]}),"active"===h.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>{0===I.length&&R([{player_id:"",finishing_position:1,prize_amount:""}]),m(!0)},className:"flex-1 bg-orange-600 hover:bg-orange-500 text-white px-6 py-2 rounded-lg",children:"End with Winners"}),(0,sa.jsx)("button",{onClick:Z,disabled:se.isLoading,className:"bg-red-700 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-semibold disabled:opacity-50",children:se.isLoading?"Stopping...":"Force Stop"})]})]})]})}),u&&h&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-5xl w-full border border-orange-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white mb-4",children:["End Tournament: ",h.name]}),q&&q.length>0&&(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("h3",{className:"text-sm font-semibold text-gray-400 mb-2 uppercase tracking-wider",children:"Player Balances (for reference)"}),(0,sa.jsx)("div",{className:"bg-slate-900/50 rounded-lg border border-slate-700 overflow-x-auto max-h-48 overflow-y-auto",children:(0,sa.jsxs)("table",{className:"w-full text-sm",children:[(0,sa.jsx)("thead",{className:"sticky top-0 bg-slate-800",children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-2 px-3 text-gray-400",children:"Player"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Initial Buy-In"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Total Invested"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Wallet Balance"}),(0,sa.jsx)("th",{className:"text-right py-2 px-3 text-gray-400",children:"Credits"}),(0,sa.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"Status"})]})}),(0,sa.jsx)("tbody",{children:q.map(e=>{const t=Number(e.wallet_balance||0),s=Number(e.total_invested||h.buy_in||h.entry_fee||0),a=Number(e.total_credits||0);return(0,sa.jsxs)("tr",{className:"border-b border-slate-700/30 ".concat(e.is_exited?"opacity-50":""),children:[(0,sa.jsxs)("td",{className:"py-2 px-3 text-white",children:[e.name," ",(0,sa.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",e.player_id,")"]})]}),(0,sa.jsxs)("td",{className:"py-2 px-3 text-right text-cyan-400 font-mono",children:["\u20b9",Number(h.buy_in||h.entry_fee||0).toFixed(0)]}),(0,sa.jsxs)("td",{className:"py-2 px-3 text-right text-orange-400 font-mono",children:["\u20b9",s.toFixed(0)]}),(0,sa.jsxs)("td",{className:"py-2 px-3 text-right font-mono font-semibold ".concat(t>=0?"text-green-400":"text-red-400"),children:["\u20b9",t.toFixed(2)]}),(0,sa.jsx)("td",{className:"py-2 px-3 text-right text-yellow-400 font-mono",children:a>0?"\u20b9".concat(a.toFixed(0)):"-"}),(0,sa.jsx)("td",{className:"py-2 px-3 text-center",children:e.is_exited?(0,sa.jsxs)("span",{className:"text-xs px-2 py-0.5 rounded bg-red-500/20 text-red-400",children:["Exited (\u20b9",Number(e.exit_balance||0).toFixed(0),")"]}):(0,sa.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-green-500/20 text-green-400",children:"Playing"})})]},e.id)})})]})})]}),(0,sa.jsx)("p",{className:"text-gray-300 mb-4 text-sm",children:"Select players and assign prize amounts. Player balances will be automatically updated."}),(0,sa.jsx)("div",{className:"space-y-4 mb-6",children:I.map((e,t)=>{const s=null===q||void 0===q?void 0:q.find(t=>t.id===e.player_id);return(0,sa.jsxs)("div",{className:"space-y-1",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-12 gap-3 items-center bg-slate-700/50 p-4 rounded-lg",children:[(0,sa.jsx)("div",{className:"col-span-1",children:(0,sa.jsx)("div",{className:"w-10 h-10 rounded-full bg-yellow-500 text-slate-900 font-bold flex items-center justify-center",children:e.finishing_position})}),(0,sa.jsx)("div",{className:"col-span-5",children:(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",value:e.player_id,onChange:e=>le(t,"player_id",e.target.value),children:[(0,sa.jsx)("option",{value:"",children:"Select Player"}),null===q||void 0===q?void 0:q.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name," (",e.player_id,") - Balance: \u20b9",Number(e.wallet_balance||0).toFixed(0)]},e.id))]})}),(0,sa.jsx)("div",{className:"col-span-2",children:(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"Position",value:e.finishing_position,onChange:e=>le(t,"finishing_position",parseInt(e.target.value)||1),min:"1"})}),(0,sa.jsx)("div",{className:"col-span-3",children:(0,sa.jsx)("input",{type:"number",step:"0.01",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"Prize Amount (\u20b9)",value:e.prize_amount,onChange:e=>le(t,"prize_amount",parseFloat(e.target.value)||0),min:"0"})}),(0,sa.jsx)("div",{className:"col-span-1",children:(0,sa.jsx)("button",{onClick:()=>(e=>{R(I.filter((t,s)=>s!==e))})(t),className:"w-full bg-red-600 hover:bg-red-500 text-white px-3 py-2 rounded-lg transition-colors",children:"\xd7"})})]}),s&&(0,sa.jsxs)("div",{className:"ml-14 text-xs text-gray-400 flex gap-4",children:[(0,sa.jsxs)("span",{children:["Initial: ",(0,sa.jsxs)("span",{className:"text-cyan-400 font-semibold",children:["\u20b9",Number(h.buy_in||h.entry_fee||0).toFixed(0)]})]}),(0,sa.jsxs)("span",{children:["Invested: ",(0,sa.jsxs)("span",{className:"text-orange-400 font-semibold",children:["\u20b9",Number(s.total_invested||h.buy_in||0).toFixed(0)]})]}),(0,sa.jsxs)("span",{children:["Wallet: ",(0,sa.jsxs)("span",{className:"font-semibold ".concat(Number(s.wallet_balance||0)>=0?"text-green-400":"text-red-400"),children:["\u20b9",Number(s.wallet_balance||0).toFixed(2)]})]}),Number(s.total_credits||0)>0&&(0,sa.jsxs)("span",{children:["Credits: ",(0,sa.jsxs)("span",{className:"text-yellow-400 font-semibold",children:["\u20b9",Number(s.total_credits||0).toFixed(0)]})]})]})]},t)})}),(0,sa.jsx)("button",{onClick:()=>{R([...I,{player_id:"",finishing_position:I.length+1,prize_amount:""}])},className:"w-full bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors mb-6",children:"+ Add Winner"}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{if(0===I.length)return void wr.error("Please add at least one winner");const e=I.every(e=>e.player_id&&e.prize_amount&&e.prize_amount>0);e?V.mutate({winners:I}):wr.error("Please fill in all winner details (player and prize amount)")},disabled:V.isLoading,className:"flex-1 bg-orange-600 hover:bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:V.isLoading?"Ending Tournament...":"End Tournament & Update Balances"}),(0,sa.jsx)("button",{onClick:()=>{m(!1),R([])},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),y&&w&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[60] p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-red-600",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Exit Player from Tournament"}),(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-4 mb-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Player"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:w.name})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Player ID"}),(0,sa.jsx)("span",{className:"text-white font-mono text-sm",children:w.player_id})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Wallet Balance"}),(0,sa.jsxs)("span",{className:"font-semibold ".concat(Number(w.wallet_balance||0)>=0?"text-green-400":"text-red-400"),children:["\u20b9",Number(w.wallet_balance||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Credits Taken"}),(0,sa.jsxs)("span",{className:"text-yellow-400 font-semibold",children:["\u20b9",Number(w.total_credits||0).toFixed(2)]})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Exit Balance (Amount to credit back)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",placeholder:"\u20b90.00 (leave empty if bust)",value:N,onChange:e=>S(e.target.value)}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Leave at 0 or empty if the player went bust."})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Notes (Optional)"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",placeholder:"Reason for exit...",value:k,onChange:e=>C(e.target.value)})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{w&&Q.mutate({playerId:w.id,exitBalance:N?Number(N):0,notes:k||void 0})},disabled:Q.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:Q.isLoading?"Exiting...":"Exit Player".concat(N?" (\u20b9".concat(N,")"):" (Bust)")}),(0,sa.jsx)("button",{onClick:()=>{v(!1),j(null),S(""),C("")},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}function rm(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("live-tables"),{data:n,isLoading:l}=(ra(),hn({queryKey:["rummy-tables",t],queryFn:()=>jr.rj.getTables(t),enabled:!!t,select:e=>Array.isArray(e)?e.filter(e=>"RUMMY"===e.tableType):[]})),{data:i,isLoading:o}=hn({queryKey:["waitlist",t],queryFn:()=>jr.IX.getWaitlist(t),enabled:!!t}),d=n||[],c=i||[];return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Rummy Tables & Waitlist"}),!t&&(0,sa.jsxs)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100 flex items-center gap-3",children:[(0,sa.jsx)("svg",{className:"w-6 h-6 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.3 2.647-1.3 3.412 0l7 12a1.5 1.5 0 01-1.302 2.25H2.847a1.5 1.5 0 01-1.302-2.25l7-12zM9 13a1 1 0 112 0v2a1 1 0 11-2 0v-2zm0-6a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})}),(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club from the sidebar dropdown to manage rummy tables."})]}),(0,sa.jsx)("div",{className:"flex gap-2 border-b border-slate-700",children:[{id:"live-tables",label:"Live Rummy Tables"},{id:"table-management",label:"Table Management"},{id:"table-buy-in",label:"Table Buy-In"},{id:"table-buy-out",label:"Table Buy-Out"},{id:"rake-collection",label:"Rake Collection"},{id:"history",label:"History"}].map(e=>(0,sa.jsx)("button",{onClick:()=>a(e.id),className:"px-6 py-3 font-semibold transition-all ".concat(s===e.id?"bg-gradient-to-r from-emerald-600 to-teal-700 text-white border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:e.label},e.id))}),(0,sa.jsxs)("div",{className:"mt-6",children:["live-tables"===s&&(0,sa.jsx)(nm,{selectedClubId:t,tables:d,tablesLoading:l}),"table-management"===s&&(0,sa.jsx)(om,{selectedClubId:t,tables:d,tablesLoading:l}),"table-buy-in"===s&&(0,sa.jsx)(dm,{selectedClubId:t,tables:d,waitlist:c,waitlistLoading:o}),"table-buy-out"===s&&(0,sa.jsx)(cm,{selectedClubId:t,tables:d}),"rake-collection"===s&&(0,sa.jsx)(hd,{clubId:t,gameType:"rummy"}),"history"===s&&(0,sa.jsx)(um,{selectedClubId:t,tables:d})]})]})}function nm(e){let{selectedClubId:t,tables:s,tablesLoading:a}=e;const[n,l]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)({minPlayTime:30,callTime:5,cashOutWindow:10,sessionTimeout:120}),[h,x]=(0,r.useState)("Active"),p=s.filter(e=>"AVAILABLE"===e.status||"OCCUPIED"===e.status),b=e=>{if(!e.notes)return null;const t=e.notes.match(/Dealer:.*?\(([^)]+)\)/i);return t?t[1]:null},g=e=>{var t,s,a,r,n,l,i,d;c(e),o(!0);const u=e.notes?e.notes.split("|").map(e=>e.trim()):[],h=(null===(t=u[3])||void 0===t||null===(s=t.match(/\d+/))||void 0===s?void 0:s[0])||"30",p=(null===(a=u[4])||void 0===a||null===(r=a.match(/\d+/))||void 0===r?void 0:r[0])||"5",b=(null===(n=u[5])||void 0===n||null===(l=n.match(/\d+/))||void 0===l?void 0:l[0])||"10",g=(null===(i=u[6])||void 0===i||null===(d=i.match(/\d+/))||void 0===d?void 0:d[0])||"120";m({minPlayTime:parseInt(h),callTime:parseInt(p),cashOutWindow:parseInt(b),sessionTimeout:parseInt(g)}),x("OCCUPIED"===e.status?"Active":"Paused")};return(0,sa.jsxs)("div",{className:"space-y-6",children:[i&&d&&(0,sa.jsx)(lm,{table:d,tables:p,sessionParams:u,setSessionParams:m,sessionStatus:h,setSessionStatus:x,clubId:t,onClose:()=>{o(!1),c(null)},onSelectTable:e=>{c(e),g(e)}}),!i&&(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Live Rummy Tables - Hologram View"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Manage live rummy tables, seat players, and handle buy-ins using table hologram."})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 px-4 py-2 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Active Tables: ",p.length]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Total Players: ",p.reduce((e,t)=>e+(t.currentSeats||0),0)]})]})]}),a?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading rummy tables..."})]}):0===p.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udccf"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No active rummy tables"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Create and activate tables in Table Management"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600 hover:border-emerald-500 transition-all cursor-pointer",onClick:()=>l(e),children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h3",{className:"text-lg font-bold text-white",children:["Table ",e.tableNumber]}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.rummyVariant||"RUMMY"})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("OCCUPIED"===e.status?"bg-green-600/20 text-green-400":"bg-emerald-600/20 text-emerald-400"),children:e.status})]}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:["\u20b9",e.minBuyIn||0,"/\u20b9",e.maxBuyIn||0]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Occupied Seats:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:[e.currentSeats||0," / ",e.maxSeats]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Available Seats:"}),(0,sa.jsx)("span",{className:"text-emerald-400 font-medium",children:e.maxSeats-(e.currentSeats||0)})]}),b(e)&&(0,sa.jsxs)("div",{className:"flex justify-between text-sm pt-1 border-t border-slate-600",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"\ud83d\udc64 Dealer:"}),(0,sa.jsx)("span",{className:"text-purple-400 font-semibold",children:b(e)})]})]}),(0,sa.jsxs)("button",{onClick:t=>{t.stopPropagation(),l(e)},className:"w-full mt-4 bg-gradient-to-r from-emerald-600 to-teal-700 hover:from-emerald-500 hover:to-teal-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83c\udfaf"}),(0,sa.jsx)("span",{children:"View Table Hologram"})]}),(0,sa.jsxs)("button",{onClick:t=>{t.stopPropagation(),g(e)},className:"w-full mt-2 bg-gradient-to-r from-purple-600 to-pink-700 hover:from-purple-500 hover:to-pink-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\u2699\ufe0f"}),(0,sa.jsx)("span",{children:"Edit Session Control"})]})]},e.id))})]}),n&&(0,sa.jsx)(im,{table:n,onClose:()=>l(null),clubId:t})]})}function lm(e){let{table:t,tables:s,sessionParams:a,setSessionParams:n,sessionStatus:l,setSessionStatus:o,clubId:d,onClose:c,onSelectTable:u}=e;const m=ra(),[h,x]=(0,r.useState)(d),[p,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)([]),[y,v]=(0,r.useState)({}),[w,j]=(0,r.useState)("");(0,r.useEffect)(()=>{d&&x(d)},[d]);const N=gn({mutationFn:async()=>{if(!h)throw new Error("Club ID not found");return await jr.rj.pauseSession(h,t.id)},onSuccess:()=>{o("Paused"),wr.success("Session paused successfully"),m.invalidateQueries(["rummy-tables",h])},onError:e=>{wr.error(e.message||"Failed to pause session")}}),S=gn({mutationFn:async()=>{if(!h)throw new Error("Club ID not found");return await jr.rj.resumeSession(h,t.id)},onSuccess:()=>{o("Active"),wr.success("Session resumed successfully"),m.invalidateQueries(["rummy-tables",h])},onError:e=>{wr.error(e.message||"Failed to resume session")}}),k=gn({mutationFn:async e=>{if(!h)throw new Error("Club ID not found");return await jr.rj.settleAndEndSession(h,t.id,e)},onSuccess:()=>{wr.success("All players settled and session ended successfully!"),m.invalidateQueries(["rummy-tables",h]),b(!1),c()},onError:e=>{wr.error(e.message||"Failed to settle players")}}),C=gn({mutationFn:async()=>{if(!h)throw new Error("Club ID not found");return await jr.rj.endSession(h,t.id)},onSuccess:()=>{wr.success("Session ended successfully"),m.invalidateQueries(["rummy-tables",h]),c()},onError:e=>{wr.error(e.message||"Failed to end session")}}),A=gn({mutationFn:async e=>{if(!h)throw new Error("Club ID not found");return await jr.rj.updateSessionParams(h,t.id,e)},onSuccess:e=>{wr.success("Session parameters updated successfully"),m.invalidateQueries(["rummy-tables",h]),e.sessionParams&&n(e.sessionParams)},onError:e=>{wr.error(e.message||"Failed to update session parameters")}}),_=e=>{var t,s;return e.rummyVariant||(null===(t=e.notes)||void 0===t||null===(s=t.split("|")[1])||void 0===s?void 0:s.trim())||"RUMMY"};return(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-emerald-900/50 via-teal-900/50 to-green-900/50 rounded-2xl p-8 border-2 border-emerald-500/30 shadow-2xl",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white",children:"Rummy Table Session Control"}),(0,sa.jsx)("button",{onClick:c,className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Table Sessions"}),(0,sa.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,sa.jsx)("div",{onClick:()=>u(e),className:"p-4 rounded-lg cursor-pointer transition-all ".concat(e.id===t.id?"bg-emerald-600/30 border-2 border-emerald-500":"bg-slate-700/50 border border-slate-600 hover:bg-slate-700"),children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"font-semibold text-white",children:["Table ",e.tableNumber," - ",_(e)]}),(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:e.rummyVariant||"Rummy"})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("OCCUPIED"===e.status?"bg-green-600/20 text-green-400":"bg-yellow-600/20 text-yellow-400"),children:"OCCUPIED"===e.status?"Active":"Paused"})]})},e.id))}),(0,sa.jsxs)("div",{className:"mt-6 p-4 bg-emerald-600/20 border border-emerald-500/30 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-sm text-emerald-300 mb-2",children:["Selected: Table ",t.tableNumber," - ",_(t)]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Variant:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:t.rummyVariant||"Rummy"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:(e=>{var t;const s=e.notes?e.notes.split("|").map(e=>e.trim()):[];return(null===(t=s[2])||void 0===t?void 0:t.replace("Stakes:","").trim())||"\u20b9".concat(e.minBuyIn||0,"/\u20b9").concat(e.maxBuyIn||0)})(t)})]})]}),(0,sa.jsxs)("div",{className:"text-sm mt-2",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Players:"}),(0,sa.jsxs)("span",{className:"text-white ml-2",children:[t.currentSeats||0,"/",t.maxSeats]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Session Actions"}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm mb-2",children:"Current Status"}),(0,sa.jsx)("div",{className:"text-4xl font-bold ".concat("Active"===l?"text-green-400":"text-yellow-400"),children:l})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("button",{onClick:()=>{"Active"===l?N.mutate():S.mutate()},className:"w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white px-6 py-4 rounded-lg font-bold text-lg transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"Active"===l?"\u23f8":"\u25b6"}),(0,sa.jsx)("span",{children:"Active"===l?"Pause Session":"Resume Session"})]}),(0,sa.jsxs)("button",{onClick:async()=>{if(h)try{const e=await jr.rj.getSeatedPlayersForTable(h,t.id);if(e.seatedPlayers&&e.seatedPlayers.length>0){f(e.seatedPlayers);const t={};e.seatedPlayers.forEach(e=>{t[e.playerId]=0}),v(t),j(""),b(!0)}else window.confirm("No players are seated. End this session?")&&C.mutate()}catch(e){console.error("Error fetching seated players:",e),wr.error("Failed to fetch seated players")}else wr.error("Club ID not found")},className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white px-6 py-4 rounded-lg font-bold text-lg transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\u2b1b"}),(0,sa.jsx)("span",{children:"End Session"})]})]}),(0,sa.jsx)("div",{className:"mt-6 p-4 bg-slate-700/50 rounded-lg",children:(0,sa.jsx)("p",{className:"text-sm text-gray-400 text-center",children:"Rummy tables have no minimum play time or call time \u2014 players can exit anytime."})})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Session Settings"}),(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"p-3 bg-emerald-900/30 border border-emerald-500/30 rounded-lg",children:[(0,sa.jsx)("div",{className:"text-sm font-medium text-emerald-300 mb-1",children:"Rummy Rules"}),(0,sa.jsxs)("ul",{className:"text-xs text-emerald-400 space-y-1",children:[(0,sa.jsx)("li",{children:"\u2022 No minimum play time \u2014 players can exit anytime"}),(0,sa.jsx)("li",{children:"\u2022 No call time required"}),(0,sa.jsx)("li",{children:"\u2022 Rake can be collected multiple times per session"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm font-medium mb-2",children:"SESSION TIMEOUT"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("input",{type:"number",value:a.sessionTimeout,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{sessionTimeout:e.target.value})),className:"flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-lg font-semibold",min:"30"}),(0,sa.jsx)("button",{onClick:()=>((e,t)=>{const s={[e]:parseInt(t)};A.mutate(s)})("sessionTimeout",a.sessionTimeout),className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-white font-semibold transition-colors",children:"Set"})]}),(0,sa.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Current: ",a.sessionTimeout," mins"]})]})]})]})]}),p&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto border-2 border-emerald-500/50 shadow-2xl",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white",children:"\ud83c\udccf Settle All Rummy Players"}),(0,sa.jsx)("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsx)("div",{className:"mb-6 p-4 bg-red-600/20 border border-red-500/30 rounded-lg",children:(0,sa.jsx)("p",{className:"text-sm text-red-300",children:"Enter the cash-out amount for each seated player. This will create transactions, update balances, unseat all players, and end the session."})}),(0,sa.jsx)("div",{className:"space-y-4 mb-6",children:g.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-slate-600",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:e.playerName}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Seat #",e.seatNumber]})]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Seated ",new Date(e.seatedAt).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-3 text-sm",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/60 rounded px-3 py-2 text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:"Buy-In"}),(0,sa.jsxs)("div",{className:"text-cyan-400 font-semibold",children:["\u20b9",(e.buyInAmount||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/60 rounded px-3 py-2 text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:"Wallet Balance"}),(0,sa.jsxs)("div",{className:"font-semibold ".concat((e.walletBalance||0)>=0?"text-green-400":"text-red-400"),children:["\u20b9",(e.walletBalance||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/60 rounded px-3 py-2 text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:"Credits"}),(0,sa.jsx)("div",{className:"text-yellow-400 font-semibold",children:(e.totalCredits||0)>0?"\u20b9".concat((e.totalCredits||0).toLocaleString()):"-"})]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"Cash-out Amount:"}),(0,sa.jsx)("input",{type:"number",value:y[e.playerId]||0,onChange:t=>{return s=e.playerId,a=t.target.value,void v(e=>(0,i.A)((0,i.A)({},e),{},{[s]:parseFloat(a)||0}));var s,a},className:"flex-1 px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-lg font-semibold",placeholder:"Enter amount",min:"0",step:"100"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:"\u20b9"})]})]},e.playerId))}),(0,sa.jsxs)("div",{className:"flex items-center justify-between p-4 bg-emerald-600/20 border border-emerald-500/30 rounded-lg mb-4",children:[(0,sa.jsx)("span",{className:"text-emerald-300 font-semibold",children:"Total Settlement:"}),(0,sa.jsxs)("span",{className:"text-white text-2xl font-bold",children:["\u20b9",Object.values(y).reduce((e,t)=>e+(parseFloat(t)||0),0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"p-4 bg-amber-600/20 border border-amber-500/30 rounded-lg mb-6",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-amber-300 font-semibold whitespace-nowrap",children:"\ud83c\udfb0 Session Rake:"}),(0,sa.jsx)("input",{type:"number",value:w,onChange:e=>j(e.target.value),className:"flex-1 px-4 py-2 bg-slate-600 border border-amber-500/50 rounded-lg text-white text-lg font-semibold",placeholder:"Enter rake amount (optional)",min:"0",step:"100"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:"\u20b9"})]}),(0,sa.jsx)("p",{className:"text-amber-300/70 text-xs mt-2",children:"Rake will be recorded for this rummy session automatically"})]}),(0,sa.jsxs)("div",{className:"flex gap-4",children:[(0,sa.jsx)("button",{onClick:()=>b(!1),className:"flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{onClick:()=>{const e=Object.entries(y).map(e=>{let[t,s]=e;return{playerId:t,amount:parseFloat(s)||0}}),t=parseFloat(w)||0,s=e.reduce((e,t)=>e+t.amount,0),a=t>0?"Settle ".concat(e.length," players for a total of \u20b9").concat(s," with \u20b9").concat(t," rake? This will end the session."):"Settle ".concat(e.length," players for a total of \u20b9").concat(s,"? This will end the session.");window.confirm(a)&&k.mutate({settlements:e,rakeAmount:t||void 0})},disabled:k.isLoading,className:"flex-1 px-6 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 disabled:from-gray-600 disabled:to-gray-600 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:k.isLoading?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("span",{className:"animate-spin",children:"\u23f3"}),(0,sa.jsx)("span",{children:"Processing..."})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("span",{children:"\u2705"}),(0,sa.jsx)("span",{children:"Settle & End Session"})]})})]})]})})]})}function im(e){var t,s,a;let{table:n,onClose:l,clubId:i}=e;const o=ra(),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)("00:00:00"),[h,x]=(0,r.useState)([]),[p,b]=(0,r.useState)("view"),[g,f]=(0,r.useState)([]);(0,r.useEffect)(()=>{i&&null!==n&&void 0!==n&&n.tableNumber&&"history"===p&&(async()=>{if("history"===p)try{const e=localStorage.getItem("token"),t=localStorage.getItem("userId"),s=localStorage.getItem("tenantId"),a=await fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_API_URL||"http://localhost:3333/api","/clubs/").concat(i,"/transactions?tableNumber=").concat(n.tableNumber),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"x-user-id":t||"","x-tenant-id":s||"","x-club-id":i}});if(a.ok){const e=(await a.json()).filter(e=>{var t,s,a;return("Buy In"===e.type||"Deposit"===e.type&&(null===(t=e.notes)||void 0===t?void 0:t.includes("Table ".concat(n.tableNumber))))&&((null===(s=e.notes)||void 0===s?void 0:s.includes("Table ".concat(n.tableNumber)))||(null===(a=e.description)||void 0===a?void 0:a.includes("Table ".concat(n.tableNumber))))}).sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt));f(e)}}catch(e){console.error("Error fetching table history:",e)}})()},[i,null===n||void 0===n?void 0:n.tableNumber,p]),(0,r.useEffect)(()=>{const e=async()=>{try{const e=localStorage.getItem("token"),t=localStorage.getItem("userId"),s=localStorage.getItem("tenantId"),a=await fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_API_URL||"http://localhost:3333/api","/clubs/").concat(i,"/tables/").concat(n.id,"/seated-players"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"x-user-id":t||"","x-tenant-id":s||"","x-club-id":i}});if(a.ok){const e=await a.json();x(e.seatedPlayers||[])}}catch(e){console.error("Error fetching seated players:",e)}};if(i&&null!==n&&void 0!==n&&n.id){e();const t=setInterval(e,5e3);return()=>clearInterval(t)}},[i,null===n||void 0===n?void 0:n.id]);const y=(()=>{if(!n.notes)return null;const e=n.notes.match(/Dealer:\s*([a-f0-9-]{36})\s*\(([^)]+)\)/i);return e?{id:e[1],name:e[2]}:null})(),v=gn({mutationFn:async()=>{if(!n||!y)return;const e=(n.notes||"").replace(/\s*\|\s*Dealer:.*$/i,"").trim();return jr.rj.updateTable(i,n.id,{notes:e})},onSuccess:()=>{wr.success("Dealer unassigned successfully"),o.invalidateQueries(["rummy-tables",i]),o.invalidateQueries(["all-tables",i]),l()},onError:e=>{wr.error(e.message||"Failed to unassign dealer")}});(0,r.useEffect)(()=>{i&&(async()=>{try{const e=localStorage.getItem("token"),t=localStorage.getItem("userId"),s=localStorage.getItem("tenantId"),a=await fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:3333/api",REACT_APP_WEBSOCKET_URL:"http://localhost:3333"}.REACT_APP_API_URL||"http://localhost:3333/api","/clubs/").concat(i),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"x-user-id":t||"","x-tenant-id":s||"","x-club-id":i}});if(a.ok){const e=await a.json();c(e)}}catch(e){console.error("Error fetching club data:",e)}})()},[i]),(0,r.useEffect)(()=>{var e,t;if(!n)return void m("00:00:00");if("AVAILABLE"===n.status||"PAUSED"===n.status){var s;const e=null===(s=n.notes)||void 0===s?void 0:s.match(/Paused Elapsed: (\d+)/);if(e){const t=parseInt(e[1],10);if(!isNaN(t)&&t>=0){const e=Math.floor(t/3600),s=Math.floor(t%3600/60),a=t%60;m("".concat(String(e).padStart(2,"0"),":").concat(String(s).padStart(2,"0"),":").concat(String(a).padStart(2,"0")))}else m("00:00:00")}else m("00:00:00");return}if("OCCUPIED"!==n.status)return void m("00:00:00");const a=null===(e=n.notes)||void 0===e?void 0:e.match(/Session Started: ([^|]+)/),r=null===(t=n.notes)||void 0===t?void 0:t.match(/Paused Elapsed: (\d+)/);if(!a||!a[1])return void m("00:00:00");const l=a[1].trim(),i=new Date(l);if(isNaN(i.getTime()))return void m("00:00:00");const o=r?parseInt(r[1],10):0,d=()=>{const e=(new Date).getTime()-i.getTime();if(isNaN(e))return void m("00:00:00");const t=Math.floor(e/1e3)+o;if(isNaN(t)||t<0)return void m("00:00:00");const s=Math.floor(t/3600),a=Math.floor(t%3600/60),r=t%60;m("".concat(String(s).padStart(2,"0"),":").concat(String(a).padStart(2,"0"),":").concat(String(r).padStart(2,"0")))};d();const c=setInterval(d,1e3);return()=>clearInterval(c)},[n]);const w=Array.from({length:n.maxSeats},(e,t)=>t+1),j=h.map(e=>e.seatNumber).filter(Boolean),N=h.reduce((e,t)=>e+(Number(t.buyInAmount)||0),0),S=(null===d||void 0===d?void 0:d.logoUrl)||null,k=n.rummyVariant||(null===(t=n.notes)||void 0===t||null===(s=t.split("|")[1])||void 0===s?void 0:s.trim())||"RUMMY",C="\u20b9".concat(n.minBuyIn||0,"/\u20b9").concat(n.maxBuyIn||0);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-8 max-w-4xl w-full border-2 border-emerald-500 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h2",{className:"text-3xl font-bold text-white",children:["Table ",n.tableNumber," - ",k]}),(0,sa.jsxs)("p",{className:"text-gray-400",children:["Stakes: ",C]})]}),(0,sa.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700 mb-6",children:[(0,sa.jsx)("button",{onClick:()=>b("view"),className:"px-4 py-2 font-semibold transition-all ".concat("view"===p?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Live View"}),(0,sa.jsx)("button",{onClick:()=>b("history"),className:"px-4 py-2 font-semibold transition-all ".concat("history"===p?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"History"})]}),"view"===p?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"mb-6 flex justify-center",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 px-6 py-3 rounded-2xl shadow-xl border-2 border-emerald-400",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-100 text-center mb-1",children:"TABLE VALUE"}),(0,sa.jsxs)("div",{className:"text-3xl font-bold text-white text-center",children:["\u20b9",N.toLocaleString()]})]})}),(0,sa.jsxs)("div",{className:"relative w-full aspect-square max-w-[500px] mx-auto",children:[(0,sa.jsx)("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-amber-900 via-yellow-900 to-amber-950 shadow-2xl",children:(0,sa.jsx)("div",{className:"absolute inset-[10px] rounded-full bg-gradient-to-br from-amber-700 via-amber-600 to-amber-700",children:(0,sa.jsx)("div",{className:"absolute inset-[8px] rounded-full bg-gradient-to-br from-emerald-700 via-green-800 to-emerald-900 shadow-inner",children:(0,sa.jsx)("div",{className:"absolute inset-[30px] rounded-full border border-emerald-600/30"})})})}),(0,sa.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:(0,sa.jsx)("div",{className:"w-24 h-24 bg-white/15 rounded-full border-2 border-white/25 flex items-center justify-center shadow-xl backdrop-blur-sm overflow-hidden",children:S?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("img",{src:S,alt:"Club Logo",className:"w-full h-full object-contain rounded-full p-2",onError:e=>{e.target.style.display="none";const t=e.target.parentElement.querySelector(".logo-fallback");t&&(t.style.display="flex")}}),(0,sa.jsx)("div",{className:"logo-fallback text-3xl font-bold text-white/40 hidden items-center justify-center w-full h-full",children:"\ud83c\udfb4"})]}):(0,sa.jsx)("div",{className:"text-3xl font-bold text-white/40",children:"\ud83c\udfb4"})})}),(0,sa.jsxs)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center z-20",children:[y&&(0,sa.jsxs)("div",{className:"mb-2 bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-bold shadow-lg flex items-center gap-2",children:[(0,sa.jsxs)("span",{children:["\ud83d\udc64 ",y.name]}),(0,sa.jsx)("button",{onClick:e=>{e.stopPropagation(),window.confirm('Are you sure you want to unassign dealer "'.concat(y.name,'" from this table?'))&&v.mutate()},disabled:v.isLoading,className:"hover:bg-purple-700 rounded-full p-0.5 transition-colors disabled:opacity-50",title:"Unassign Dealer",children:(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsx)("div",{className:"bg-emerald-600 text-white px-3 py-1 rounded-full text-sm font-bold",children:"D"})]}),w.map(e=>{var t;const s=(360/n.maxSeats*(e-1)-90)*(Math.PI/180),a=50+42*Math.cos(s),r=50+42*Math.sin(s),l=j.includes(e),i=h.find(t=>t.seatNumber===e);return(0,sa.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 z-20",style:{left:"".concat(a,"%"),top:"".concat(r,"%")},children:[(0,sa.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center font-bold text-lg transition-all cursor-pointer ".concat(l?"bg-emerald-600 text-white border-2 border-emerald-400 shadow-lg shadow-emerald-500/30":"bg-slate-700 text-gray-400 border-2 border-slate-600 hover:border-emerald-500"),title:i?i.playerName:"Seat ".concat(e),children:l&&i?null===(t=i.playerName)||void 0===t?void 0:t.split(" ").map(e=>e.charAt(0)).join("").substring(0,2).toUpperCase():e}),(0,sa.jsx)("div",{className:"text-center text-xs text-white mt-1 whitespace-nowrap max-w-[80px] overflow-hidden text-ellipsis",children:l&&i?i.playerName:"Seat ".concat(e)}),l&&i&&i.buyInAmount>0&&(0,sa.jsxs)("div",{className:"text-center text-[10px] text-yellow-300 bg-slate-800/80 px-1 rounded mt-0.5",children:["\u20b9",Number(i.buyInAmount).toLocaleString()]})]},e)})]}),(0,sa.jsxs)("div",{className:"mt-6 grid grid-cols-4 gap-4 bg-slate-800 p-4 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Players"}),(0,sa.jsxs)("div",{className:"text-white font-bold text-xl",children:[n.currentSeats||0,"/",n.maxSeats]})]}),(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Table Value"}),(0,sa.jsxs)("div",{className:"text-emerald-400 font-bold text-xl",children:["\u20b9",N.toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Buy-In Range"}),(0,sa.jsxs)("div",{className:"text-white font-bold text-lg",children:["\u20b9",(n.minBuyIn||0).toLocaleString()," - \u20b9",(n.maxBuyIn||0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"Status"}),(0,sa.jsx)("div",{className:"font-bold text-xl ".concat("OCCUPIED"===n.status?"text-green-400":"AVAILABLE"===n.status?"text-yellow-400":"text-gray-400"),children:"OCCUPIED"===n.status?"Active":"AVAILABLE"===n.status?"Waiting":n.status})]})]}),("OCCUPIED"===n.status||"AVAILABLE"===n.status&&(null===(a=n.notes)||void 0===a?void 0:a.includes("Paused Elapsed")))&&(0,sa.jsxs)("div",{className:"mt-4 bg-gradient-to-r from-emerald-600 to-teal-600 p-4 rounded-lg text-center",children:[(0,sa.jsx)("div",{className:"text-emerald-100 text-sm mb-1",children:"SESSION RUNNING TIME"}),(0,sa.jsx)("div",{className:"text-white font-bold text-3xl font-mono",children:u})]}),(0,sa.jsx)("div",{className:"mt-6 flex justify-end",children:(0,sa.jsx)("button",{onClick:l,className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-lg font-bold text-white transition-colors",children:"Close"})})]}):(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Buy-In & Buy-Out History"}),0===g.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No transaction history for this table yet."}):(0,sa.jsx)("div",{className:"space-y-3",children:g.map((e,t)=>{const s="Buy In"===e.type;return(0,sa.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat(s?"bg-green-900/20 border-green-600/50":"bg-orange-900/20 border-orange-600/50"),children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsx)("div",{className:"flex-1",children:(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-2xl",children:s?"\ud83d\udcb0":"\ud83d\udcb5"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-bold text-white",children:e.playerName||e.player_name||"Unknown Player"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[s?"Buy-In":"Buy-Out",e.notes&&" \u2022 ".concat(e.notes)]}),(0,sa.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]})]})}),(0,sa.jsxs)("div",{className:"text-right ".concat(s?"text-green-400":"text-orange-400"),children:[(0,sa.jsxs)("div",{className:"font-bold text-2xl",children:[s?"+":"","\u20b9",Number(e.amount).toLocaleString()]}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:e.status})]})]})},e.id||t)})}),(0,sa.jsx)("div",{className:"mt-6 flex justify-end",children:(0,sa.jsx)("button",{onClick:l,className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-lg font-bold text-white transition-colors",children:"Close"})})]})]})})}function om(e){let{selectedClubId:t,tables:s,tablesLoading:a}=e;const[n,l]=(0,r.useState)("all"),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[m,h]=(0,r.useState)(""),[x,p]=(0,r.useState)(""),b=ra(),{data:g,isLoading:f}=hn({queryKey:["staff",t],queryFn:()=>jr.staffAPI.getStaff(t),enabled:!!t}),y=(null===g||void 0===g?void 0:g.filter(e=>"Dealer"===e.role&&"Active"===e.status))||[],v=(new Date).toISOString().split("T")[0],{data:w}=hn({queryKey:["dealersOnLeave",t,v],queryFn:()=>jr.iw.getDealers(t,v),enabled:!!t}),{data:j}=hn({queryKey:["availableDealersForToday",t,v],queryFn:()=>jr.iw.getAvailableDealersForDate(t,v),enabled:!!t}),N=(null===w||void 0===w?void 0:w.dealers)||[],S=new Set(y.filter(e=>!N.find(t=>t.id===e.id)).map(e=>e.id)),{data:k}=hn({queryKey:["all-tables",t],queryFn:()=>jr.rj.getTables(t),enabled:!!t}),C=new Set((k||[]).filter(e=>("OCCUPIED"===e.status||"RESERVED"===e.status)&&e.notes).map(e=>{var t;const s=null===(t=e.notes)||void 0===t?void 0:t.match(/Dealer:\s*([a-f0-9-]{36})/i);return s?s[1]:null}).filter(Boolean)),A=((null===j||void 0===j?void 0:j.dealers)||[]).filter(e=>!C.has(e.id)&&"poker"!==e.gameType),_=(y.filter(e=>!C.has(e.id)&&!S.has(e.id)&&"poker"!==e.gameType),gn({mutationFn:async e=>{let{tableId:a,dealerId:r}=e;const n=s.find(e=>e.id===a),l=y.find(e=>e.id===r);if(!n||!l)throw new Error("Table or dealer not found");const i=(n.notes||"").replace(/\s*\|\s*Dealer:.*$/i,""),o="".concat(i," | Dealer: ").concat(l.id," (").concat(l.name,")").trim();return jr.rj.updateTable(t,a,{notes:o})},onSuccess:()=>{wr.success("Dealer assigned successfully"),h(""),p(""),b.invalidateQueries(["rummy-tables",t]),b.invalidateQueries(["all-tables",t]),b.invalidateQueries(["staff",t])},onError:e=>{wr.error(e.message||"Failed to assign dealer")}})),[P,T]=(0,r.useState)({tableNumber:"",tableName:"",rummy_variant:"Points Rummy",custom_variant:"",points_value:1,number_of_deals:1,drop_points:20,max_points:80,min_players:2,max_players:6,entry_fee:"",min_buy_in:"",max_buy_in:"",deal_duration:5,notes:""}),E=gn({mutationFn:e=>jr.rj.createTable(t,(0,i.A)((0,i.A)({},e),{},{tableType:"RUMMY"})),onSuccess:()=>{wr.success("Rummy table created successfully"),b.invalidateQueries(["rummy-tables",t]),d(!1),l("all"),O()},onError:e=>{wr.error(e.message||"Failed to create rummy table")}}),I=gn({mutationFn:e=>{let{tableId:s,data:a}=e;return jr.rj.updateTable(t,s,(0,i.A)((0,i.A)({},a),{},{tableType:"RUMMY"}))},onSuccess:()=>{wr.success("Rummy table updated successfully"),b.invalidateQueries(["rummy-tables",t]),d(!1),u(null),l("all"),O()},onError:e=>{wr.error(e.message||"Failed to update rummy table")}}),R=gn({mutationFn:e=>jr.rj.deleteTable(t,e),onSuccess:()=>{wr.success("Rummy table deleted successfully"),b.invalidateQueries(["rummy-tables",t])},onError:e=>{wr.error(e.message||"Failed to delete rummy table")}}),D=gn({mutationFn:e=>jr.rj.resumeSession(t,e),onSuccess:()=>{wr.success("Session started successfully"),b.invalidateQueries(["rummy-tables",t])},onError:e=>{wr.error(e.message||"Failed to start session")}}),O=()=>{T({tableNumber:"",tableName:"",rummy_variant:"Points Rummy",custom_variant:"",points_value:1,number_of_deals:1,drop_points:20,max_points:80,min_players:2,max_players:6,entry_fee:"",min_buy_in:"",max_buy_in:"",deal_duration:5,notes:""}),u(null)};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Rummy Table Management"}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700 pb-4 mb-6",children:[(0,sa.jsx)("button",{onClick:()=>l("all"),className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("all"===n?"bg-gradient-to-r from-emerald-600 to-teal-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"All Tables"}),(0,sa.jsx)("button",{onClick:()=>{l("add"),u(null),O()},className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("add"===n?"bg-gradient-to-r from-emerald-600 to-teal-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"Add New Table"})]}),"all"===n&&(0,sa.jsx)("div",{className:"space-y-4",children:a?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading rummy tables..."})]}):0===s.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udccf"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No rummy tables created yet"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:'Click "Add New Table" to create your first rummy table'})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h3",{className:"text-lg font-bold text-white",children:["Table ",e.tableNumber]}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.rummyVariant||"RUMMY"})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("AVAILABLE"===e.status?"bg-green-600/20 text-green-400":"OCCUPIED"===e.status?"bg-emerald-600/20 text-emerald-400":"RESERVED"===e.status?"bg-yellow-600/20 text-yellow-400":"bg-gray-600/20 text-gray-400"),children:e.status})]}),(0,sa.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Max Seats:"}),(0,sa.jsx)("span",{className:"text-white font-medium",children:e.maxSeats})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:["\u20b9",e.minBuyIn||0,"/\u20b9",e.maxBuyIn||0]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Current Seats:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:[e.currentSeats||0," / ",e.maxSeats]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:["AVAILABLE"===e.status||"CLOSED"===e.status?(0,sa.jsxs)("button",{onClick:()=>D.mutate(e.id),disabled:D.isLoading,className:"flex-1 bg-green-600 hover:bg-green-500 px-3 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 flex items-center justify-center gap-1",children:[(0,sa.jsx)("span",{children:"\u25b6"}),(0,sa.jsx)("span",{children:"Start Session"})]}):null,(0,sa.jsx)("button",{onClick:()=>(e=>{var t,s,a,r,n,i;u(e),T({tableNumber:(null===(t=e.tableNumber)||void 0===t?void 0:t.toString())||"",tableName:(null===(s=e.notes)||void 0===s||null===(a=s.split("|")[0])||void 0===a?void 0:a.trim())||"",rummy_variant:e.rummyVariant||"Points Rummy",custom_variant:"",points_value:e.pointsValue||1,number_of_deals:e.numberOfDeals||1,drop_points:e.dropPoints||20,max_points:e.maxPoints||80,min_players:e.minPlayers||2,max_players:e.maxSeats||6,entry_fee:(null===(r=e.entryFee)||void 0===r?void 0:r.toString())||"",min_buy_in:(null===(n=e.minBuyIn)||void 0===n?void 0:n.toString())||"",max_buy_in:(null===(i=e.maxBuyIn)||void 0===i?void 0:i.toString())||"",deal_duration:e.dealDuration||5,notes:e.notes||""}),l("add")})(e),className:"flex-1 bg-blue-600 hover:bg-blue-500 px-3 py-2 rounded-lg text-sm font-medium transition-colors",children:"Edit"}),(0,sa.jsx)("button",{onClick:()=>(e=>{window.confirm("Are you sure you want to delete Table ".concat(e.tableNumber,"?"))&&R.mutate(e.id)})(e),disabled:R.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 px-3 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"Delete"})]})]},e.id))})}),"add"===n&&(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold mb-6",children:c?"Edit Rummy Table":"Create New Rummy Table"}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t?P.tableNumber?c?I.mutate({tableId:c.id,data:{tableType:"RUMMY",maxSeats:parseInt(P.max_players),minBuyIn:P.min_buy_in?parseFloat(P.min_buy_in):null,maxBuyIn:P.max_buy_in?parseFloat(P.max_buy_in):null,notes:P.notes||"".concat(P.tableName||"Rummy Table "+P.tableNumber," | ").concat("Custom"===P.rummy_variant?P.custom_variant:P.rummy_variant," | Points: ").concat(P.points_value," | Deals: ").concat(P.number_of_deals," | Drop: ").concat(P.drop_points," | Max: ").concat(P.max_points),rummyVariant:"Custom"===P.rummy_variant?P.custom_variant:P.rummy_variant,pointsValue:parseFloat(P.points_value)||1,numberOfDeals:parseInt(P.number_of_deals)||null,dropPoints:parseInt(P.drop_points)||null,maxPoints:parseInt(P.max_points)||null,dealDuration:parseInt(P.deal_duration)||null,entryFee:P.entry_fee?parseFloat(P.entry_fee):null,minPlayers:parseInt(P.min_players)||2}}):E.mutate({tableNumber:parseInt(P.tableNumber),tableType:"RUMMY",maxSeats:parseInt(P.max_players),minBuyIn:P.min_buy_in?parseFloat(P.min_buy_in):null,maxBuyIn:P.max_buy_in?parseFloat(P.max_buy_in):null,notes:P.notes||"".concat(P.tableName||"Rummy Table "+P.tableNumber," | ").concat("Custom"===P.rummy_variant?P.custom_variant:P.rummy_variant," | Points: ").concat(P.points_value," | Deals: ").concat(P.number_of_deals," | Drop: ").concat(P.drop_points," | Max: ").concat(P.max_points),rummyVariant:"Custom"===P.rummy_variant?P.custom_variant:P.rummy_variant,pointsValue:parseFloat(P.points_value)||1,numberOfDeals:parseInt(P.number_of_deals)||null,dropPoints:parseInt(P.drop_points)||null,maxPoints:parseInt(P.max_points)||null,dealDuration:parseInt(P.deal_duration)||null,entryFee:P.entry_fee?parseFloat(P.entry_fee):null,minPlayers:parseInt(P.min_players)||2}):wr.error("Table number is required"):wr.error("Please select a club first")},className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Table Number *"}),(0,sa.jsx)("input",{type:"number",value:P.tableNumber,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{tableNumber:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"1",required:!0,disabled:!!c})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Table Name"}),(0,sa.jsx)("input",{type:"text",value:P.tableName,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{tableName:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"e.g., Premium Rummy Table"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rummy Variant *"}),(0,sa.jsx)("select",{value:P.rummy_variant,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{rummy_variant:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0,children:["Points Rummy","Pool Rummy (101 Points)","Pool Rummy (201 Points)","Deals Rummy","Custom"].map(e=>(0,sa.jsx)("option",{value:e,children:e},e))})]}),"Custom"===P.rummy_variant&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Custom Variant Name"}),(0,sa.jsx)("input",{type:"text",value:P.custom_variant,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{custom_variant:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Enter custom variant name"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Points Value (per \u20b9)"}),(0,sa.jsx)("input",{type:"number",value:P.points_value,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{points_value:parseFloat(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0.1",step:"0.1"})]}),(P.rummy_variant.includes("Points")||"Custom"===P.rummy_variant)&&(0,sa.jsx)(sa.Fragment,{children:(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Drop Points"}),(0,sa.jsx)("input",{type:"number",value:P.drop_points,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{drop_points:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Points"}),(0,sa.jsx)("input",{type:"number",value:P.max_points,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{max_points:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]})}),"Deals Rummy"===P.rummy_variant&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Number of Deals"}),(0,sa.jsx)("input",{type:"number",value:P.number_of_deals,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{number_of_deals:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"1"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Players"}),(0,sa.jsx)("input",{type:"number",value:P.min_players,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{min_players:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"2",max:"6"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Players *"}),(0,sa.jsx)("input",{type:"number",value:P.max_players,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{max_players:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"2",max:"6",required:!0})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Entry Fee (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:P.entry_fee,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{entry_fee:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Buy-in (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:P.min_buy_in,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{min_buy_in:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Buy-in (\u20b9)"}),(0,sa.jsx)("input",{type:"number",value:P.max_buy_in,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{max_buy_in:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"0"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Deal Duration (minutes)"}),(0,sa.jsx)("input",{type:"number",value:P.deal_duration,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{deal_duration:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",min:"1"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes"}),(0,sa.jsx)("textarea",{value:P.notes,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{notes:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",rows:"3",placeholder:"Additional notes about this table..."})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,sa.jsx)("button",{type:"submit",disabled:E.isLoading||I.isLoading||!t,className:"flex-1 bg-gradient-to-r from-emerald-600 to-teal-700 hover:from-emerald-500 hover:to-teal-600 text-white py-3 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:E.isLoading||I.isLoading?(0,sa.jsxs)("span",{className:"flex items-center justify-center",children:[(0,sa.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,sa.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,sa.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c?"Updating...":"Creating..."]}):c?"Update Table":"Create Table"}),c&&(0,sa.jsx)("button",{type:"button",onClick:()=>{u(null),O(),l("all")},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg font-semibold transition-all",children:"Cancel"})]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Dealer Assignment"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Table"}),(0,sa.jsxs)("select",{value:m,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",disabled:!t,children:[(0,sa.jsx)("option",{value:"",children:"-- Select Table --"}),s.map(e=>(0,sa.jsxs)("option",{value:e.id,children:["Table ",e.tableNumber," - ",e.rummyVariant||"Rummy"," (",e.status,")"]},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Assign Dealer"}),(0,sa.jsxs)("select",{value:x,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",disabled:!t||f,children:[(0,sa.jsx)("option",{value:"",children:"-- Select Dealer --"}),f?(0,sa.jsx)("option",{disabled:!0,children:"Loading dealers..."}):0===A.length?(0,sa.jsx)("option",{disabled:!0,children:y.length>0?"No dealers available (all assigned, on leave, or no shift today)":"No active dealers found"}):A.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name," (",e.employeeId||"No ID",")"]},e.id))]})]})]}),(0,sa.jsx)("button",{onClick:()=>{m&&x?_.mutate({tableId:m,dealerId:x}):wr.error("Please select both table and dealer")},disabled:!m||!x||_.isLoading||!t,className:"mt-4 bg-purple-600 hover:bg-purple-500 px-6 py-2 rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:_.isLoading?"Assigning...":"Assign Dealer"}),0===y.length&&!f&&t&&(0,sa.jsx)("p",{className:"mt-2 text-sm text-yellow-400",children:"\u26a0\ufe0f No active dealers found. Please create dealer staff members first."}),0===A.length&&y.length>0&&!f&&(0,sa.jsx)("p",{className:"mt-2 text-sm text-amber-400",children:"\u2139\ufe0f No dealers available. They may be assigned, on leave, or don't have a shift today."})]})]})}function dm(e){let{selectedClubId:t,tables:s,waitlist:a,waitlistLoading:r}=e;return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Waitlist Management"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Current Waitlist"}),r?(0,sa.jsxs)("div",{className:"text-center py-8",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500 mx-auto mb-2"}),(0,sa.jsx)("p",{className:"text-sm",children:"Loading..."})]}):0===a.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No players in waitlist"}):(0,sa.jsx)("div",{className:"space-y-3",children:a.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-600 p-4 rounded-lg",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:e.playerName}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Position: ",e.priority||"N/A"]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Table Type: ",e.tableType||"Any"]})]}),(0,sa.jsx)("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 rounded text-xs font-semibold",children:e.status})]}),(0,sa.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,sa.jsx)("button",{className:"flex-1 bg-emerald-600 hover:bg-emerald-500 px-3 py-1.5 rounded text-sm font-medium transition-colors",children:"\ud83c\udfaf View Table"}),(0,sa.jsx)("button",{className:"flex-1 bg-red-600 hover:bg-red-500 px-3 py-1.5 rounded text-sm font-medium transition-colors",children:"Remove"})]})]},e.id))})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Seat Allocation"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Player"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"-- Select Player --"}),a.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.playerName},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Table"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"-- Select Table --"}),s.map(e=>(0,sa.jsxs)("option",{value:e.id,children:["Table ",e.tableNumber]},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Seat Number"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"-- Select Seat --"}),[1,2,3,4,5,6].map(e=>(0,sa.jsxs)("option",{value:e,children:["Seat ",e]},e))]})]}),(0,sa.jsx)("button",{className:"w-full bg-purple-600 hover:bg-purple-500 px-4 py-3 rounded-lg font-semibold transition-colors",children:"Assign Seat"})]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Player Call & Reorder"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Call Players"}),(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsx)("button",{className:"w-full bg-green-600 hover:bg-green-500 px-4 py-3 rounded-lg font-semibold transition-colors",children:"Call Next Player"}),(0,sa.jsx)("button",{className:"w-full bg-emerald-600 hover:bg-emerald-500 px-4 py-3 rounded-lg font-semibold transition-colors",children:"Call All Players"}),(0,sa.jsx)("button",{className:"w-full bg-yellow-600 hover:bg-yellow-500 px-4 py-3 rounded-lg font-semibold transition-colors",children:"Send SMS Notification"})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Reorder Waitlist"}),(0,sa.jsx)("div",{className:"space-y-2",children:0===a.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No players to reorder"}):a.map((e,t)=>(0,sa.jsxs)("div",{className:"bg-slate-600 p-3 rounded flex justify-between items-center",children:[(0,sa.jsxs)("span",{className:"text-white",children:[t+1,". ",e.playerName]}),(0,sa.jsxs)("div",{className:"flex gap-1",children:[(0,sa.jsx)("button",{disabled:0===t,className:"bg-emerald-600 hover:bg-emerald-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-2 py-1 rounded text-xs transition-colors",children:"\u2191"}),(0,sa.jsx)("button",{disabled:t===a.length-1,className:"bg-emerald-600 hover:bg-emerald-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-2 py-1 rounded text-xs transition-colors",children:"\u2193"})]})]},e.id))})]})]})]})]})}function cm(e){let{selectedClubId:t,tables:s}=e;const[a,n]=(0,r.useState)("process-buyout");return(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-orange-600/30 via-red-500/20 to-rose-700/30 rounded-xl p-6 border border-orange-800/40",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Rummy Table Buy-Out"}),(0,sa.jsx)("p",{className:"text-gray-300 text-sm mb-6",children:"Manage player buy-out requests and process manual buy-outs for rummy tables."}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-orange-800/40 pb-4 mb-6",children:[(0,sa.jsx)("button",{onClick:()=>n("process-buyout"),className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("process-buyout"===a?"bg-gradient-to-r from-orange-600 to-red-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"Process Buy-Out"}),(0,sa.jsx)("button",{onClick:()=>n("player-requests"),className:"px-5 py-2 rounded-t-lg font-semibold transition-all ".concat("player-requests"===a?"bg-gradient-to-r from-orange-600 to-red-700 text-white shadow-lg":"bg-slate-700 text-gray-400 hover:bg-slate-600"),children:"Player Requests"})]}),"process-buyout"===a&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Process Buy-Out"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Seated Player"}),(0,sa.jsx)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",children:(0,sa.jsx)("option",{value:"",children:"-- Select Player --"})})]}),(0,sa.jsx)("div",{className:"p-4 bg-emerald-500/20 rounded-lg border border-emerald-400/30",children:(0,sa.jsxs)("div",{className:"text-sm text-white space-y-2",children:[(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Player:"}),(0,sa.jsx)("span",{className:"font-semibold",children:"-"})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Table:"}),(0,sa.jsx)("span",{className:"font-semibold",children:"-"})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Current Table Balance:"}),(0,sa.jsx)("span",{className:"font-semibold text-emerald-300",children:"0 chips"})]})]})}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Reason (Optional)"}),(0,sa.jsx)("textarea",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",rows:"3",placeholder:"Enter reason for buy-out (optional)..."})]}),(0,sa.jsx)("button",{className:"w-full bg-orange-600 hover:bg-orange-500 px-4 py-3 rounded-lg font-semibold transition-colors",children:"Approve Buy-Out"})]})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Buy-Out Information"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold mb-2",children:"How Buy-Out Works:"}),(0,sa.jsxs)("ul",{className:"text-sm text-gray-300 space-y-2 list-disc list-inside",children:[(0,sa.jsx)("li",{children:"Select a player who is currently seated at a rummy table"}),(0,sa.jsx)("li",{children:"Their table chip balance will be moved to their available balance"}),(0,sa.jsx)("li",{children:"Player will be removed from the table (seat becomes available)"}),(0,sa.jsx)("li",{children:"Player can then convert chips to real money at the cashier counter"})]})]}),(0,sa.jsxs)("div",{className:"p-4 bg-yellow-500/20 rounded-lg border border-yellow-400/30",children:[(0,sa.jsx)("h4",{className:"text-yellow-300 font-semibold mb-2",children:"\u26a0\ufe0f Important Notes:"}),(0,sa.jsxs)("ul",{className:"text-sm text-yellow-200 space-y-1 list-disc list-inside",children:[(0,sa.jsx)("li",{children:"Buy-out approval is permanent and cannot be undone"}),(0,sa.jsx)("li",{children:"Table balance will be immediately transferred to player's available balance"}),(0,sa.jsx)("li",{children:"Player must go to cashier to convert chips to real money"})]})]}),(0,sa.jsx)("div",{className:"p-4 bg-green-500/20 rounded-lg border border-green-400/30",children:(0,sa.jsxs)("div",{className:"text-sm text-green-300",children:[(0,sa.jsx)("div",{className:"font-semibold mb-1",children:"Currently Seated Players:"}),(0,sa.jsx)("div",{className:"text-green-200",children:"0 player(s) at rummy tables"})]})})]})]})]}),"player-requests"===a&&(0,sa.jsx)(md,{clubId:t})]})})}function um(e){let{selectedClubId:t,tables:s}=e;const[a,n]=(0,r.useState)({type:"all",search:"",tableNumber:"all",page:1,perPage:10}),{data:l=[],isLoading:o}=hn({queryKey:["rummy-transactions",t],queryFn:async()=>{if(!t)return[];try{const e=await jr.Dv.getTransactions(t,{});return(Array.isArray(e)?e:(null===e||void 0===e?void 0:e.data)||(null===e||void 0===e?void 0:e.transactions)||[]).filter(e=>"rummy"===e.game_type)}catch(e){return console.error("[RUMMY HISTORY] Error fetching transactions:",e),[]}},enabled:!!t}),d=l.filter(e=>{var t,s,r,n;const l="Buy In"===e.type,i=("Deposit"===e.type||"Cashout"===e.type)&&((null===(t=e.notes)||void 0===t?void 0:t.toLowerCase().includes("buy-out"))||(null===(s=e.notes)||void 0===s?void 0:s.toLowerCase().includes("buyout"))||(null===(r=e.description)||void 0===r?void 0:r.toLowerCase().includes("buy-out"))||(null===(n=e.description)||void 0===n?void 0:n.toLowerCase().includes("buyout")));if("buy-in"===a.type&&!l)return!1;if("buy-out"===a.type&&!i)return!1;if("all"===a.type&&!l&&!i)return!1;if("all"!==a.tableNumber){var o,d,c,u;if(!((null===(o=e.notes)||void 0===o?void 0:o.includes("Table ".concat(a.tableNumber)))||(null===(d=e.description)||void 0===d?void 0:d.includes("Table ".concat(a.tableNumber)))||(null===(c=e.notes)||void 0===c?void 0:c.includes("table ".concat(a.tableNumber)))||(null===(u=e.description)||void 0===u?void 0:u.includes("table ".concat(a.tableNumber)))))return!1}if(a.search){const t=a.search.toLowerCase(),s=e.playerName||e.player_name||"",r=e.email||"";return s.toLowerCase().includes(t)||r.toLowerCase().includes(t)}return!0}),c=d.slice((a.page-1)*a.perPage,a.page*a.perPage),u=Math.ceil(d.length/a.perPage);return(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-emerald-600/30 via-teal-500/20 to-cyan-700/30 rounded-xl p-6 border border-emerald-800/40",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Rummy Buy-In & Buy-Out History"}),(0,sa.jsx)("p",{className:"text-gray-300 text-sm mb-6",children:"View all rummy buy-in and buy-out transactions with advanced filters."}),(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Filters"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Transaction Type"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",value:a.type,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{type:e.target.value,page:1})),children:[(0,sa.jsx)("option",{value:"all",children:"All Transactions"}),(0,sa.jsx)("option",{value:"buy-in",children:"Buy-In Only"}),(0,sa.jsx)("option",{value:"buy-out",children:"Buy-Out Only"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Table"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",value:a.tableNumber,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{tableNumber:e.target.value,page:1})),children:[(0,sa.jsx)("option",{value:"all",children:"All Tables"}),s.map(e=>(0,sa.jsxs)("option",{value:e.tableNumber,children:["Table ",e.tableNumber]},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Search Player"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Player name or email...",value:a.search,onChange:e=>n((0,i.A)((0,i.A)({},a),{},{search:e.target.value,page:1}))})]})]})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-5 rounded-lg mt-4",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Transaction History (",d.length," records)"]}),o?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Loading..."}):0===c.length?(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No rummy transactions found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-3 mb-6",children:c.map((e,t)=>{const s="Buy In"===e.type;return(0,sa.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat(s?"bg-green-900/20 border-green-600/50":"bg-orange-900/20 border-orange-600/50"),children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsx)("div",{className:"flex-1",children:(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-2xl",children:s?"\ud83d\udcb0":"\ud83d\udcb5"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-bold text-white",children:e.playerName||e.player_name||"Unknown Player"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[s?"Buy-In":"Buy-Out",e.notes&&" \u2022 ".concat(e.notes)]}),(0,sa.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]})]})}),(0,sa.jsxs)("div",{className:"text-right ".concat(s?"text-green-400":"text-orange-400"),children:[(0,sa.jsxs)("div",{className:"font-bold text-2xl",children:[s?"+":"","\u20b9",Number(e.amount).toLocaleString()]}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:e.status})]})]})},e.id||t)})}),u>1&&(0,sa.jsxs)("div",{className:"flex justify-center gap-2 mt-4",children:[(0,sa.jsx)("button",{onClick:()=>n((0,i.A)((0,i.A)({},a),{},{page:Math.max(1,a.page-1)})),disabled:1===a.page,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 rounded-lg text-white",children:"Previous"}),(0,sa.jsxs)("span",{className:"px-4 py-2 bg-slate-700 rounded-lg text-white",children:["Page ",a.page," of ",u]}),(0,sa.jsx)("button",{onClick:()=>n((0,i.A)((0,i.A)({},a),{},{page:Math.min(u,a.page+1)})),disabled:a.page>=u,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 rounded-lg text-white",children:"Next"})]})]})]})]})})}function mm(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("tournaments");return t?(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Rummy Management"})}),(0,sa.jsxs)("div",{className:"flex gap-4 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>a("tournaments"),className:"px-6 py-3 font-medium transition-colors ".concat("tournaments"===s?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Rummy Tournaments"}),(0,sa.jsx)("button",{onClick:()=>a("tables"),className:"px-6 py-3 font-medium transition-colors ".concat("tables"===s?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Rummy Tables"})]}),(0,sa.jsxs)("div",{className:"mt-6",children:["tournaments"===s&&(0,sa.jsx)(am,{selectedClubId:t}),"tables"===s&&(0,sa.jsx)(rm,{selectedClubId:t})]})]}):(0,sa.jsxs)("div",{className:"text-white",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Rummy Management"}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:(0,sa.jsx)("p",{className:"text-gray-400",children:"Please select a club to manage Rummy tournaments and tables."})})]})}Object.assign(Yu,{Manager:Qu,Socket:Vu,io:Yu,connect:Yu});const hm="Asia/Kolkata",xm=e=>e?new Date(e).toLocaleDateString("en-IN",{timeZone:hm,day:"2-digit",month:"short",year:"numeric"}):"",pm=xm;function bm(e){let{selectedClubId:t,recipientType:s="staff"}=e;const a=ra(),[n,l]=(0,r.useState)(null),[i,o]=(0,r.useState)(1),{data:d,isLoading:c}=hn({queryKey:["notificationInbox",t,s],queryFn:()=>jr.Dv.getNotificationInbox(t,s),enabled:!!t}),u=(null===d||void 0===d?void 0:d.notifications)||[],m=(null===d||void 0===d||d.total,[...u].sort((e,t)=>e.isRead!==t.isRead?e.isRead?1:-1:new Date(t.sentAt||t.createdAt)-new Date(e.sentAt||e.createdAt))),h=Math.ceil(m.length/10),x=10*(i-1),p=m.slice(x,x+10),b=gn({mutationFn:e=>jr.Dv.markNotificationAsRead(t,e,s),onSuccess:()=>{a.invalidateQueries(["notificationInbox",t,s]),a.invalidateQueries(["unreadNotificationCount",t,s])}}),g=gn({mutationFn:()=>jr.Dv.markAllNotificationsAsRead(t,s),onSuccess:()=>{wr.success("All notifications marked as read"),a.invalidateQueries(["notificationInbox",t,s]),a.invalidateQueries(["unreadNotificationCount",t,s])},onError:e=>{wr.error(e.message||"Failed to mark all as read")}}),f=gn({mutationFn:e=>jr.Dv.deletePushNotification(t,e),onSuccess:()=>{wr.success("Notification deleted"),l(null),a.invalidateQueries(["notificationInbox",t,s]),a.invalidateQueries(["unreadNotificationCount",t,s]),a.invalidateQueries(["pushNotifications",t])},onError:e=>{wr.error(e.message||"Failed to delete notification")}}),y=e=>{l(e),e.isRead||b.mutate(e.id)},v=u.filter(e=>!e.isRead).length,w=e=>{e.isRead&&window.confirm('Delete "'.concat(e.title,'"?'))?f.mutate(e.id):e.isRead||wr.error("Please read the notification before deleting")};return(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white",children:"\ud83d\udcec Notifications"}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm mt-1",children:[v>0?"".concat(v," unread \u2022 "):"",m.length," total"]})]}),v>0&&(0,sa.jsx)("button",{onClick:()=>g.mutate(),disabled:g.isPending,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-50",children:"Mark All as Read"})]}),c?(0,sa.jsx)("div",{className:"text-center text-gray-400 py-12",children:"Loading notifications..."}):0===m.length?(0,sa.jsxs)("div",{className:"text-center py-12 bg-slate-800 rounded-lg border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udced"}),(0,sa.jsx)("p",{className:"text-gray-400 text-lg",children:"No notifications yet"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-3",children:p.map(e=>(0,sa.jsx)("div",{onClick:()=>y(e),className:"p-4 rounded-lg border cursor-pointer transition-all ".concat(e.isRead?"bg-slate-800 border-slate-700 hover:border-slate-600":"bg-blue-900/20 border-blue-600 hover:border-blue-500"),children:(0,sa.jsxs)("div",{className:"flex items-start gap-3",children:[!e.isRead&&(0,sa.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white mb-1",children:e.title}),e.details&&(0,sa.jsx)("p",{className:"text-gray-300 text-sm mb-2 line-clamp-2",children:e.details}),(0,sa.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-400",children:[(0,sa.jsx)("span",{children:new Date(e.sentAt||e.createdAt).toLocaleDateString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"})}),e.isRead&&e.readAt&&(0,sa.jsxs)("span",{className:"text-green-400",children:["\u2713 Read on"," ",pm(e.readAt)]})]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),y(e)},className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors",children:"View"}),e.isRead&&(0,sa.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e)},disabled:f.isPending,className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm rounded transition-colors disabled:opacity-50",children:"Delete"})]})]})},e.id))}),h>1&&(0,sa.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>o(e=>Math.max(1,e-1)),disabled:1===i,className:"px-4 py-2 bg-slate-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Previous"}),(0,sa.jsx)("div",{className:"flex items-center gap-2",children:Array.from({length:h},(e,t)=>t+1).map(e=>(0,sa.jsx)("button",{onClick:()=>o(e),className:"w-10 h-10 rounded-lg font-semibold transition-colors ".concat(e===i?"bg-blue-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:e},e))}),(0,sa.jsx)("button",{onClick:()=>o(e=>Math.min(h,e+1)),disabled:i===h,className:"px-4 py-2 bg-slate-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Next"})]})]}),n&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",onClick:()=>l(null),children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full border border-slate-700",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:n.title}),(0,sa.jsx)("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-white text-2xl",children:"\xd7"})]}),n.details&&(0,sa.jsx)("p",{className:"text-gray-300 mb-4 whitespace-pre-wrap",children:n.details}),n.imageUrl&&(0,sa.jsx)("img",{src:n.imageUrl,alt:n.title,className:"w-full rounded-lg mb-4"}),n.videoUrl&&(0,sa.jsx)("video",{src:n.videoUrl,controls:!0,className:"w-full rounded-lg mb-4"}),(0,sa.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-400 pt-4 border-t border-slate-700",children:[(0,sa.jsxs)("span",{children:["Sent on"," ",new Date(n.sentAt||n.createdAt).toLocaleDateString("en-IN",{month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"})]}),n.isRead&&n.readAt&&(0,sa.jsxs)("span",{className:"text-green-400",children:["\u2713 Read on"," ",xm(n.readAt)]})]}),n.isRead&&(0,sa.jsx)("button",{onClick:()=>w(n),disabled:f.isPending,className:"w-full mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-50",children:f.isPending?"Deleting...":"Delete Notification"})]})})]})}const gm=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function fm(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(null),[n,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(t){d();const e=setInterval(d,3e5);return()=>clearInterval(e)}},[t]);const d=async()=>{try{const e=new Date,s=new Date(e);s.setDate(s.getDate()+7);const r=e.toISOString().split("T")[0],n=s.toISOString().split("T")[0],i=await(0,jr.AT)("/clubs/".concat(t,"/shifts?startDate=").concat(r,"&endDate=").concat(n));if(i.success){const t=i.shifts||[],s=e.toISOString().split("T")[0],r=t.find(e=>e.shiftDate.split("T")[0]===s);a(r||null);const n=t.filter(e=>{const t=new Date(e.shiftDate);t.setHours(0,0,0,0);const s=new Date;return s.setHours(0,0,0,0),t>s}).slice(0,3);l(n)}}catch(e){console.error("Error loading shifts:",e)}finally{o(!1)}},c=e=>{try{return new Date(e).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"})}catch(t){return e}},u=e=>{try{const t=new Date(e),s=new Date,a=new Date(s);a.setDate(a.getDate()+1);const r=t.toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",weekday:"short",month:"short",day:"numeric",year:"numeric"})===s.toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",weekday:"short",month:"short",day:"numeric",year:"numeric"}),n=t.toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",weekday:"short",month:"short",day:"numeric",year:"numeric"})===a.toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",weekday:"short",month:"short",day:"numeric",year:"numeric"});return r?"Today":n?"Tomorrow":"".concat(gm[t.getDay()],", ").concat(t.getDate())}catch(t){return e}};return i?(0,sa.jsx)("div",{className:"bg-gray-800 rounded-lg p-4",children:(0,sa.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,sa.jsx)("div",{className:"h-4 bg-gray-700 rounded w-1/2"}),(0,sa.jsx)("div",{className:"h-20 bg-gray-700 rounded"})]})}):(0,sa.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,sa.jsxs)("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,sa.jsx)("span",{children:"\u23f0"}),"My Shifts"]}),(0,sa.jsx)("button",{onClick:d,className:"text-gray-400 hover:text-white transition-colors",title:"Refresh",children:(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),s?(0,sa.jsxs)("div",{className:"rounded-lg p-3 mb-3 ".concat(s.isOffDay?"bg-gray-700 border border-gray-600":"bg-gradient-to-r from-orange-600 to-orange-500"),children:[(0,sa.jsx)("div",{className:"flex items-center justify-between mb-1",children:(0,sa.jsxs)("span",{className:"font-semibold text-white flex items-center gap-2",children:["Today",!s.isOffDay&&(0,sa.jsx)("span",{className:"px-1.5 py-0.5 bg-white/20 text-white text-xs rounded",children:"ACTIVE"})]})}),s.isOffDay?(0,sa.jsx)("div",{className:"text-gray-300 text-sm",children:"\ud83c\udf34 Off Day"}):(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"text-white font-bold text-lg",children:c(s.shiftStartTime)}),(0,sa.jsx)("span",{className:"text-white/60",children:"\u2192"}),(0,sa.jsx)("span",{className:"text-white font-bold text-lg",children:c(s.shiftEndTime)})]})]}):(0,sa.jsx)("div",{className:"bg-gray-700/50 rounded-lg p-3 mb-3 text-center",children:(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"No shift scheduled today"})}),n.length>0&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Upcoming"}),(0,sa.jsx)("div",{className:"space-y-2",children:n.map(e=>(0,sa.jsxs)("div",{className:"bg-gray-700/50 rounded p-2 text-sm",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,sa.jsx)("span",{className:"text-white font-medium",children:u(e.shiftDate)}),e.isOffDay&&(0,sa.jsx)("span",{className:"px-1.5 py-0.5 bg-gray-600 text-gray-300 text-xs rounded",children:"OFF"})]}),!e.isOffDay&&(0,sa.jsxs)("div",{className:"text-gray-300 text-xs",children:[c(e.shiftStartTime)," - ",c(e.shiftEndTime)]})]},e.id))})]}),!s&&0===n.length&&(0,sa.jsxs)("div",{className:"text-center py-4",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"No shifts scheduled"}),(0,sa.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Contact your manager"})]})]})}function ym(){var e,t,s,a,n,l,o,d,c;const u=me(),m=ra(),[h,x]=(0,r.useState)("Dashboard"),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{const e=localStorage.getItem("clubId");e?b(e):u("/login")},[u]);const{data:N,isLoading:S}=hn({queryKey:["club",p],queryFn:()=>jr.Od.getClub(p),enabled:!!p});(0,r.useEffect)(()=>{N&&f(N)},[N]),(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=jr.R2.getCurrentUser();if(!e.id)return void u("/login");const s="MANAGER"===e.role||"MANAGER"===(null===t||void 0===t?void 0:t.role),a="SUPER_ADMIN"===e.role||"SUPER_ADMIN"===(null===t||void 0===t?void 0:t.role),r="ADMIN"===e.role||"ADMIN"===(null===t||void 0===t?void 0:t.role),n=e.isMasterAdmin||(null===t||void 0===t?void 0:t.isMasterAdmin);if(!s&&!a&&!r&&!n){const s=(null===t||void 0===t?void 0:t.role)||e.role,a={MASTER_ADMIN:"/master-admin",SUPER_ADMIN:"/super-admin",ADMIN:"/admin",GRE:"/gre",CASHIER:"/cashier",HR:"/hr",FNB:"/fnb",STAFF:"/staff",DEALER:"/dealer",AFFILIATE:"/affiliate"},r=s&&a[s]?a[s]:"/login";return void u(r,{replace:!0})}e.mustResetPassword&&v(!0)},[u]);const{data:k,isLoading:C}=hn({queryKey:["clubRevenue",p],queryFn:()=>jr.Od.getClubRevenue(p),enabled:!!p}),{data:A,isLoading:_}=hn({queryKey:["clubPlayers",p],queryFn:()=>jr.bS.getPlayers(p,{limit:100}),enabled:!!p}),{data:P=[],isLoading:T}=hn({queryKey:["pendingPlayers",p],queryFn:()=>jr.bS.getPendingApprovalPlayers(p),enabled:!!p}),{data:E=[],isLoading:I}=hn({queryKey:["suspendedPlayers",p],queryFn:()=>jr.bS.getSuspendedPlayers(p),enabled:!!p}),R=e=>"\u20b9".concat((e||0).toLocaleString("en-IN")),D=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e)),v(!1),j({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),O=y&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}").email;t?w.currentPassword&&w.newPassword&&w.confirmPassword?w.newPassword===w.confirmPassword?w.newPassword.length<8?wr.error("Password must be at least 8 characters"):D.mutate({email:t,currentPassword:w.currentPassword,newPassword:w.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:w.currentPassword,onChange:e=>j((0,i.A)((0,i.A)({},w),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:w.newPassword,onChange:e=>j((0,i.A)((0,i.A)({},w),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:w.confirmPassword,onChange:e=>j((0,i.A)((0,i.A)({},w),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:D.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:D.isLoading?"Resetting...":"Reset Password"})]})]})});return S||!p?(0,sa.jsxs)(sa.Fragment,{children:[O,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900 flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-white text-center",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-xl",children:"Loading club data..."})]})})]}):(0,sa.jsxs)(sa.Fragment,{children:[O,(0,sa.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900",children:[(0,sa.jsx)(cd,{activeItem:h,setActiveItem:x,onSignOut:()=>{localStorage.clear(),sessionStorage.clear(),u("/login")},clubInfo:g||N}),(0,sa.jsxs)("main",{className:"flex-1 p-8 overflow-y-auto",children:["Dashboard"===h&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsxs)("h1",{className:"text-3xl font-bold text-white",children:["Dashboard - ",(null===g||void 0===g?void 0:g.name)||(null===N||void 0===N?void 0:N.name)||"Loading..."]})}),p&&(0,sa.jsx)(fm,{selectedClubId:p}),C?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading revenue data..."})]}):(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(e=k.previousDay)||void 0===e?void 0:e.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===k||void 0===k||null===(t=k.previousDay)||void 0===t?void 0:t.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-emerald-600",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-emerald-400",children:R((null===k||void 0===k||null===(s=k.currentDay)||void 0===s?void 0:s.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===k||void 0===k||null===(a=k.currentDay)||void 0===a?void 0:a.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(n=k.currentDay)||void 0===n?void 0:n.rake)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"10% of revenue"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(l=k.previousDay)||void 0===l?void 0:l.rake)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(o=k.previousDay)||void 0===o?void 0:o.tips)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(d=k.currentDay)||void 0===d?void 0:d.tips)||0)})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Players"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Total Players"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:_?"...":(null===A||void 0===A||null===(c=A.players)||void 0===c?void 0:c.length)||0})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Pending Approval"}),(0,sa.jsx)("span",{className:"text-yellow-400 font-semibold",children:T?"...":P.length})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Suspended"}),(0,sa.jsx)("span",{className:"text-red-400 font-semibold",children:I?"...":E.length})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Quick Actions"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsx)("button",{onClick:()=>x("Player Management"),className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white py-2 rounded-lg transition-colors",children:"Manage Players"}),(0,sa.jsxs)("button",{onClick:()=>x("Player Approval"),className:"w-full bg-blue-600 hover:bg-blue-500 text-white py-2 rounded-lg transition-colors",children:["Review Approvals (",T?"...":P.length,")"]}),(0,sa.jsxs)("button",{onClick:()=>x("Player Suspension"),className:"w-full bg-orange-600 hover:bg-orange-500 text-white py-2 rounded-lg transition-colors",children:["Suspended Players (",I?"...":E.length,")"]})]})]})]})]}),"Player Management"===h&&(0,sa.jsx)(ud,{selectedClubId:p,playersData:A,playersLoading:_,pendingPlayers:P,pendingLoading:T,suspendedPlayers:E,suspendedLoading:I,onRefresh:()=>{m.invalidateQueries(["pendingPlayers",p]),m.invalidateQueries(["clubPlayers",p]),m.invalidateQueries(["suspendedPlayers",p])}}),"Tables & Waitlist"===h&&(0,sa.jsx)(xd,{selectedClubId:p}),"Push Notifications"===h&&(0,sa.jsx)(Md,{selectedClubId:p}),"Tournaments"===h&&(0,sa.jsx)(zd,{selectedClubId:p}),"Chat"===h&&p&&(0,sa.jsx)($u,{clubId:p}),"Rummy"===h&&p&&(0,sa.jsx)(mm,{selectedClubId:p}),"Notifications"===h&&p&&(0,sa.jsx)(bm,{selectedClubId:p,recipientType:"staff"}),!["Dashboard","Player Management","Tables & Waitlist","Push Notifications","Tournaments","Chat","Rummy","Notifications"].includes(h)&&(0,sa.jsx)("div",{className:"text-white",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold mb-6",children:h})})]})]})]})}function vm(e){let{activeItem:t,setActiveItem:s,menuItems:a=[],onSignOut:n=null}=e;const[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(window.innerWidth<1024),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),p=(0,r.useRef)(null),b=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useRef)(null),y=localStorage.getItem("clubId");od(y);const{data:v}=hn({queryKey:["unreadNotificationCount",y,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(y,"staff"),enabled:!!y}),{data:w}=hn({queryKey:["myApprovedLeaves",y],queryFn:()=>jr.ie.getMyLeaveApplications(y,{status:"Approved"}),enabled:!!y}),j=(null===w||void 0===w?void 0:w.total)||0,{data:N}=hn({queryKey:["unreadChatCounts",y],queryFn:()=>jr.h2.getUnreadCounts(y),enabled:!!y}),S=((null===N||void 0===N?void 0:N.staffChats)||0)+((null===N||void 0===N?void 0:N.playerChats)||0);(0,r.useEffect)(()=>{const e=(null===v||void 0===v?void 0:v.unreadCount)||0;if(null!==p.current&&e>p.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}p.current=e},[null===v||void 0===v?void 0:v.unreadCount]),(0,r.useEffect)(()=>{if(null!==b.current&&j>b.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e)),wr.success("\ud83c\udf89 Your leave request has been approved!",{duration:5e3})}b.current=j},[j]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.staffChats)||0;if(null!==g.current&&e>g.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}g.current=e},[null===N||void 0===N?void 0:N.staffChats]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.playerChats)||0;if(null!==f.current&&e>f.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}f.current=e},[null===N||void 0===N?void 0:N.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;c(e),e||o(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(l&&d){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[l,d]);const{data:k}=hn({queryKey:["club",y],queryFn:()=>jr.Od.getClub(y),enabled:!!y}),C=JSON.parse(localStorage.getItem("user")||"{}"),A=C.email||"gre@pokerroom.com",_=C.displayName||"GRE",P=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e)),m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}});return(0,sa.jsxs)(sa.Fragment,{children:[d&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),d&&l&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>o(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] flex-shrink-0 bg-gradient-to-b from-blue-500/20 via-indigo-600/30 to-purple-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(d?l?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-indigo-300 to-purple-400 drop-shadow-lg mb-6",children:"GRE Portal"}),(0,sa.jsxs)("div",{onClick:()=>m(!0),className:"flex items-center text-white min-w-0 cursor-pointer hover:opacity-90 transition-opacity p-2 -m-2 rounded-lg",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:(0,sa.jsx)("span",{className:"text-gray-900 font-bold text-sm",children:"G"})}),(0,sa.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold truncate",children:_}),(0,sa.jsx)("div",{className:"text-sm opacity-80 truncate",children:A})]})]}),u&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]",onClick:()=>m(!1),children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full mx-4 border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Enter your current and new password"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),A?h.currentPassword&&h.newPassword&&h.confirmPassword?h.newPassword===h.confirmPassword?h.newPassword.length<8?wr.error("Password must be at least 8 characters"):P.mutate({email:A,currentPassword:h.currentPassword,newPassword:h.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:h.currentPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:h.newPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:h.confirmPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:P.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:P.isLoading?"Resetting...":"Reset Password"})]})]})]})}),document.body),k&&k.code&&(0,sa.jsx)("div",{className:"mb-6",children:(0,sa.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-300 font-semibold mb-1",children:"\ud83c\udfae Club Code"}),(0,sa.jsx)("div",{className:"text-emerald-100 font-mono text-lg font-bold tracking-wider text-center",children:k.code}),(0,sa.jsx)("div",{className:"text-xs text-emerald-400 mt-1 text-center",children:"Players use this to sign up"})]})})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:a.map((e,a)=>(0,sa.jsx)("button",{onClick:()=>{s(e),d&&o(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-blue-400 to-indigo-600 text-gray-900 font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-blue-400/20 hover:to-indigo-500/20 text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between",children:[(0,sa.jsx)("span",{className:"block truncate",children:e}),"Notifications"===e&&(null===v||void 0===v?void 0:v.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:v.unreadCount>9?"9+":v.unreadCount}),"Chat"===e&&S>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:S>9?"9+":S})]})},a))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})})]})}function wm(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).map(e=>"string"===typeof e?e:"object"===typeof e&&null!==e?Object.entries(e).filter(e=>{let[t,s]=e;return Boolean(s)}).map(e=>{let[t]=e;return t}).join(" "):"").join(" ").replace(/\s+/g," ").trim()}const jm=["className","variant","size","asChild","children"],Nm=r.forwardRef((e,t)=>{let{className:s,variant:a="default",size:n="default",asChild:o=!1,children:d}=e,c=l(e,jm);const u=((e,t,s)=>{const a={default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-gray-300 bg-transparent hover:bg-gray-100 text-gray-900",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300",ghost:"hover:bg-gray-100 text-gray-900",link:"text-blue-600 underline-offset-4 hover:underline"},r={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"};return wm("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a[e]||a.default,r[t]||r.default,s)})(a,n,s);return o&&r.isValidElement(d)?r.cloneElement(d,(0,i.A)({className:wm(u,d.props.className),ref:t},c)):(0,sa.jsx)("button",(0,i.A)((0,i.A)({className:u,ref:t},c),{},{children:d}))});Nm.displayName="Button";const Sm=["className"],km=["className"],Cm=["className"],Am=["className"],_m=["className"],Pm=["className"],Tm=r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,Sm);return(0,sa.jsx)("div",(0,i.A)({ref:t,className:wm("rounded-lg border bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm",s)},a))});Tm.displayName="Card";r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,km);return(0,sa.jsx)("div",(0,i.A)({ref:t,className:wm("flex flex-col space-y-1.5 p-6",s)},a))}).displayName="CardHeader";r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,Cm);return(0,sa.jsx)("div",(0,i.A)({ref:t,className:wm("text-2xl font-semibold leading-none tracking-tight",s)},a))}).displayName="CardTitle";r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,Am);return(0,sa.jsx)("div",(0,i.A)({ref:t,className:wm("text-sm text-gray-500 dark:text-gray-400",s)},a))}).displayName="CardDescription";const Em=r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,_m);return(0,sa.jsx)("div",(0,i.A)({ref:t,className:wm("p-6 pt-0",s)},a))});Em.displayName="CardContent";r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,Pm);return(0,sa.jsx)("div",(0,i.A)({ref:t,className:wm("flex items-center p-6 pt-0",s)},a))}).displayName="CardFooter";const Im=["asChild","children"],Rm=["className"],Dm=["className","children"],Om=["className"],Lm=["className"],Fm=["className"],Mm=e=>{let{className:t}=e;return(0,sa.jsxs)("svg",{className:t,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,sa.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,sa.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})},Bm=r.createContext({open:!1,onOpenChange:()=>{}}),qm=e=>{let{open:t,onOpenChange:s,children:a}=e;const[n,l]=r.useState(t||!1);r.useEffect(()=>{l(t||!1)},[t]);return(0,sa.jsx)(Bm.Provider,{value:{open:n,onOpenChange:e=>{l(e),s&&s(e)}},children:a})},Um=e=>{let{children:t}=e;return(0,sa.jsx)(sa.Fragment,{children:t})},zm=e=>{let{asChild:t,children:s}=e,a=l(e,Im);const{onOpenChange:n}=r.useContext(Bm);return t&&r.isValidElement(s)?r.cloneElement(s,(0,i.A)({onClick:e=>{n(!1),s.props.onClick&&s.props.onClick(e)}},a)):(0,sa.jsx)("button",(0,i.A)((0,i.A)({onClick:()=>n(!1)},a),{},{children:s}))},Km=r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,Rm);const{open:n,onOpenChange:o}=r.useContext(Bm);return n?(0,sa.jsx)("div",(0,i.A)({ref:t,className:wm("fixed inset-0 z-50 bg-black/80 animate-in fade-in-0",s),onClick:()=>o(!1)},a)):null});Km.displayName="DialogOverlay";const Wm=r.forwardRef((e,t)=>{let{className:s,children:a}=e,n=l(e,Dm);const{open:o,onOpenChange:d}=r.useContext(Bm);return r.useEffect(()=>{const e=e=>{"Escape"===e.key&&o&&d(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[o,d]),o?(0,sa.jsxs)(Um,{children:[(0,sa.jsx)(Km,{}),(0,sa.jsxs)("div",(0,i.A)((0,i.A)({ref:t,className:wm("fixed left-[50%] top-[50%] z-50 grid w-[95vw] max-w-lg max-h-[90vh] translate-x-[-50%] translate-y-[-50%] gap-4 border bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 p-6 sm:p-8 shadow-lg duration-200 rounded-lg overflow-y-auto animate-in fade-in-0 zoom-in-95",s),onClick:e=>e.stopPropagation()},n),{},{children:[a,(0,sa.jsxs)(zm,{className:"absolute right-4 top-4 sm:right-6 sm:top-6 rounded-full bg-white/10 hover:bg-white/20 p-2 transition-all duration-200 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 focus:ring-offset-transparent disabled:pointer-events-none z-10 backdrop-blur-sm border border-white/20",children:[(0,sa.jsx)(Mm,{className:"h-5 w-5 text-white drop-shadow-lg"}),(0,sa.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]}):null});Wm.displayName="DialogContent";const Hm=e=>{let{className:t}=e,s=l(e,Om);return(0,sa.jsx)("div",(0,i.A)({className:wm("flex flex-col space-y-2 text-center sm:text-left pr-16 sm:pr-20 pb-4",t)},s))};Hm.displayName="DialogHeader";const Vm=r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,Lm);return(0,sa.jsx)("h2",(0,i.A)({ref:t,className:wm("text-lg font-semibold leading-none tracking-tight",s)},a))});Vm.displayName="DialogTitle";const Jm=r.forwardRef((e,t)=>{let{className:s}=e,a=l(e,Fm);return(0,sa.jsx)("p",(0,i.A)({ref:t,className:wm("text-sm text-gray-500 dark:text-gray-400",s)},a))});Jm.displayName="DialogDescription";const Qm=e=>{let{className:t}=e;return(0,sa.jsx)("span",{className:t,children:"\u2190"})},Gm=e=>{let{className:t}=e;return(0,sa.jsx)("span",{className:t,children:"\ud83d\udc65"})},Ym=e=>{let{className:t}=e;return(0,sa.jsx)("span",{className:t,children:"\ud83d\udd50"})},$m=e=>{let{className:t}=e;return(0,sa.jsx)("span",{className:t,children:"\u20b9"})},Zm=e=>{let{className:t}=e;return(0,sa.jsx)("span",{className:t,children:"+"})},Xm=e=>{let{className:t}=e;return(0,sa.jsx)("span",{className:t,children:"+"})},eh=e=>{let{className:t}=e;return(0,sa.jsx)("span",{className:t,children:"\xd7"})},th=()=>null;function sh(e){var t;let{tableId:s,onNavigate:a,onClose:n,isManagerMode:l=!1,isViewOnly:i=!1,selectedPlayerForSeating:o=null,occupiedSeats:d={},onSeatAssign:c=null,tables:u=null}=e;const m=s?String(s):"1",h=a||(e=>{console.log("Navigate to:",e)}),[x,p]=(0,r.useState)(null),[b,g]=(0,r.useState)(!1),{toast:f}={toast:e=>{let{title:t,description:s,variant:a}=e;console.log("Toast [".concat(a||"info","]: ").concat(t," - ").concat(s)),alert("".concat(t,": ").concat(s))}},y=u||[{id:"1",name:"Main Table",gameType:"Texas Hold'em",stakes:"\u20b91000.00/10000.00",maxPlayers:6,status:"active"},{id:"2",name:"VIP Table",gameType:"Texas Hold'em",stakes:"\u20b95000.00/50000.00",maxPlayers:9,status:"active"},{id:"3",name:"High Stakes",gameType:"Texas Hold'em",stakes:"\u20b910000.00/100000.00",maxPlayers:6,status:"active"}],v=Array.isArray(y)?y:[],{user:w}={user:{id:null}},j={isInActiveGame:!1,activeGameInfo:null,seatedSessionFallback:null},N=v.find(e=>String(e.id)===String(m)),S=l&&d[m]||[],k=[],C=Array.isArray(k)?k:[],A=l?S.map((e,t)=>({seatNumber:e,player:{firstName:"Player",lastName:String(e)},session_buy_in_amount:0})):[],_=Array.isArray(A)?A:[],P={pot:_&&0!==_.length?_.reduce((e,t)=>{const s=(null===t||void 0===t?void 0:t.session_buy_in_amount)||(null===t||void 0===t?void 0:t.sessionBuyInAmount)||0;return e+Number(s)},0):0},T=C.some(e=>e.tableId===m),E=C.find(e=>e.tableId===m),I=!l&&j.isInActiveGame&&(null===(t=j.activeGameInfo)||void 0===t?void 0:t.tableId)===m,R=j.activeGameInfo||j.seatedSessionFallback,D=e=>{i||(l&&c&&o?(c({playerId:o.id||o.playerId,playerName:o.playerName||o.name,tableId:parseInt(m),seatNumber:e}),f({title:"Seat Assigned!",description:"".concat(o.playerName||o.name," assigned to Seat ").concat(e)}),p(null),g(!1),n&&n()):(f({title:"Joined Waitlist!",description:"You've been added to the waitlist successfully (dummy mode)"}),p(null),g(!1)))};return N?(0,sa.jsxs)("div",{className:"min-h-screen h-fit bg-gradient-to-b from-slate-900 to-slate-800 text-white",children:[(0,sa.jsxs)("div",{className:"p-4 flex justify-between",children:[(0,sa.jsxs)(Nm,{variant:"ghost",onClick:()=>n?n():h("/"),className:"text-white hover:bg-white/20",children:[(0,sa.jsx)(Qm,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,sa.jsxs)("div",{className:"flex gap-4 w-fit flex-col",children:[(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("h1",{className:"text-2xl font-bold text-white",children:N.name}),(0,sa.jsxs)("p",{className:"text-slate-300",children:[N.gameType," \u2022 ",N.stakes]})]}),(0,sa.jsx)("div",{className:"",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-yellow-600 via-amber-500 to-orange-500 border-2 border-yellow-400/80 px-4 py-2 rounded-lg text-center shadow-xl",children:[(0,sa.jsx)("div",{className:"text-yellow-200 text-xs font-semibold",children:"Table Value"}),(0,sa.jsxs)("div",{className:"text-white text-lg font-bold",children:["\u20b9",null!==P&&void 0!==P&&P.pot?parseFloat(P.pot).toLocaleString():"0"]})]})})]}),(0,sa.jsx)("div",{className:"w-16"})," "]}),T&&E&&!I&&(0,sa.jsx)("div",{className:"mx-4 mb-4 p-4 bg-gradient-to-r from-amber-600/20 to-amber-500/20 border border-amber-500/50 rounded-lg",children:(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-amber-200 font-semibold",children:"You're on the waitlist!"}),(0,sa.jsxs)("p",{className:"text-amber-100 text-sm",children:["Waiting for seat"," ",E.seatNumber||E.preferredSeat," \u2022 Position in queue: ",E.position||"TBD"]})]}),(0,sa.jsx)("div",{className:"text-amber-300",children:(0,sa.jsx)(Ym,{className:"w-5 h-5"})})]})}),!l&&I&&(null===w||void 0===w?void 0:w.id)&&(0,sa.jsx)("div",{className:"mx-4 mb-4",children:(0,sa.jsx)(th,{playerId:w.id.toString(),gameStatus:j})}),(0,sa.jsxs)("div",{className:"flex-1 flex flex-col items-center px-4 py-8",children:[(0,sa.jsx)("div",{className:"relative w-full max-w-4xl",children:(0,sa.jsx)("div",{className:"relative aspect-[5/3] max-w-2xl mx-auto mb-12 mt-8",children:(0,sa.jsx)("div",{className:"absolute inset-0 rounded-[50%] bg-gradient-to-br from-amber-600 via-yellow-500 to-amber-600 p-2 shadow-2xl",children:(0,sa.jsxs)("div",{className:"absolute inset-2 rounded-[50%] bg-gradient-to-br from-emerald-600 via-emerald-700 to-emerald-800 shadow-inner",children:[Array.from({length:N.maxPlayers||6},(e,t)=>{var s,a;const r=t+1,n=(N.maxPlayers||6)+1,d=(t+1)*(2*Math.PI/n)-Math.PI/2,c=50+42*Math.cos(d),u=50+32*Math.sin(d),h=x===r,b=_.find(e=>e.seatNumber===r),y=l?S.includes(r):!!b,v=(null===b||void 0===b?void 0:b.session_buy_in_amount)||(null===b||void 0===b?void 0:b.sessionBuyInAmount)||0,w=!(!l||!o)&&(o.preferredSeat===r&&String(o.preferredTable)===String(m));return(0,sa.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 z-50",style:{left:"".concat(c,"%"),top:"".concat(u,"%")},children:[(0,sa.jsxs)("div",{className:"w-10 h-10 rounded-full border-2 flex items-center justify-center shadow-lg transition-all duration-300 select-none ".concat(y?"bg-gradient-to-br from-blue-600 to-blue-700 border-blue-500 cursor-not-allowed":i?"bg-gradient-to-br from-slate-700 to-slate-800 border-slate-600 cursor-default":h||w?"border-emerald-400 shadow-emerald-500/50 scale-110 bg-gradient-to-br from-emerald-600 to-emerald-700 animate-pulse cursor-pointer":l?"bg-gradient-to-br from-slate-700 to-slate-800 border-slate-600 hover:border-yellow-400 hover:shadow-yellow-400/50 hover:scale-105 cursor-pointer active:scale-95":"bg-gradient-to-br from-slate-700 to-slate-800 border-slate-600 hover:border-emerald-400 hover:shadow-emerald-400/50 hover:scale-105 cursor-pointer active:scale-95"),onClick:e=>{e.preventDefault(),e.stopPropagation(),i||y||(l?(e=>{if(i||!l||!o)return;S.includes(e)?f({title:"Seat Occupied",description:"Seat ".concat(e," is already occupied"),variant:"destructive"}):(p(e),g(!0))})(r):(p(r),g(!0)))},style:{pointerEvents:i?"none":"auto",touchAction:"manipulation"},title:i?"Seat ".concat(r," (View Only)"):l&&w?"Preferred seat for ".concat(o.playerName||o.name):y&&null!==b&&void 0!==b&&b.player&&"".concat(b.player.firstName||""," ").concat(b.player.lastName||"").trim()||"Seat ".concat(r),children:[y&&null!==b&&void 0!==b&&b.player&&b.player.profileImage?(0,sa.jsx)("img",{src:b.player.profileImage,alt:"".concat(b.player.firstName," ").concat(b.player.lastName),className:"w-full h-full rounded-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,y&&null!==b&&void 0!==b&&b.player?(0,sa.jsxs)("span",{className:"text-white text-xs font-bold",style:{display:b.player.profileImage?"none":"flex"},children:[(null===(s=b.player.firstName)||void 0===s?void 0:s.charAt(0))||"",(null===(a=b.player.lastName)||void 0===a?void 0:a.charAt(0))||""]}):i?(0,sa.jsx)("span",{className:"text-slate-400 text-xs",children:"\u25cb"}):(0,sa.jsx)(Xm,{className:"w-3 h-3 text-emerald-400 font-bold transition-transform duration-300 ".concat(h?"rotate-45 scale-110":"hover:rotate-90 hover:scale-110")})]}),(0,sa.jsxs)("div",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-center transition-colors ".concat(y?"text-blue-400":h||w?"text-emerald-400":"text-slate-300"),children:[(0,sa.jsx)("div",{className:"text-xs font-medium whitespace-nowrap",children:y&&null!==b&&void 0!==b&&b.player&&("".concat(b.player.firstName||""," ").concat(b.player.lastName||"").trim()||b.playerName)||"Seat ".concat(r)}),w&&(0,sa.jsx)("div",{className:"text-[9px] text-yellow-400 bg-yellow-900/50 px-1 rounded mt-1 font-semibold",children:"\u2b50 Preferred"}),y&&v>0&&(0,sa.jsxs)("div",{className:"text-[10px] text-slate-400 bg-slate-800/80 px-1 rounded mt-1",children:["\u20b9",v.toLocaleString()]})]})]},r)}),(0,sa.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 z-40",style:{left:"50%",top:"8%"},children:[(0,sa.jsx)("div",{className:"w-7 h-7 bg-gradient-to-br from-yellow-600 to-yellow-700 rounded-full border-2 border-yellow-500 flex items-center justify-center shadow-xl",children:(0,sa.jsx)("span",{className:"text-xs font-bold text-white",children:"D"})}),(0,sa.jsx)("div",{className:"absolute -bottom-4 left-1/2 transform -translate-x-1/2 text-xs text-yellow-400 font-medium whitespace-nowrap",children:"Dealer"})]}),(0,sa.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,sa.jsx)("div",{className:"text-center",children:(0,sa.jsx)("div",{className:"w-24 h-24 bg-white/10 rounded-full border-2 border-white/20 flex items-center justify-center shadow-xl backdrop-blur-sm overflow-hidden",children:(0,sa.jsx)("img",{src:"https://img.freepik.com/free-vector/flat-design-culture-logo-template_23-2149845368.jpg?semt=ais_hybrid&w=740&q=80",alt:"Table Logo",className:"w-full h-full object-contain rounded-full"})})})})]})})})}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 w-full max-w-4xl",children:[(0,sa.jsx)(Tm,{className:"bg-slate-800 border-slate-700",children:(0,sa.jsxs)(Em,{className:"p-4 text-center",children:[(0,sa.jsx)(Gm,{className:"w-8 h-8 text-blue-400 mx-auto mb-2"}),(0,sa.jsx)("div",{className:"text-slate-400 text-sm",children:"Players"}),(0,sa.jsxs)("div",{className:"text-white text-xl font-bold",children:[_.length||0,"/",(null===N||void 0===N?void 0:N.maxPlayers)||6]})]})}),(0,sa.jsx)(Tm,{className:"bg-slate-800 border-slate-700",children:(0,sa.jsxs)(Em,{className:"p-4 text-center",children:[(0,sa.jsx)($m,{className:"w-8 h-8 text-emerald-400 mx-auto mb-2"}),(0,sa.jsx)("div",{className:"text-slate-400 text-sm",children:"Buy-in Range"}),(0,sa.jsx)("div",{className:"text-white text-lg font-bold",children:(null===N||void 0===N?void 0:N.stakes)||"N/A"})]})}),(0,sa.jsx)(Tm,{className:"bg-slate-800 border-slate-700",children:(0,sa.jsxs)(Em,{className:"p-4 text-center",children:[(0,sa.jsx)(Ym,{className:"w-8 h-8 text-purple-400 mx-auto mb-2"}),(0,sa.jsx)("div",{className:"text-slate-400 text-sm",children:"Blinds"}),(0,sa.jsx)("div",{className:"text-white text-lg font-bold",children:"\u20b910/\u20b920"})]})}),(0,sa.jsx)(Tm,{className:"bg-slate-800 border-slate-700",children:(0,sa.jsxs)(Em,{className:"p-4 text-center",children:[(0,sa.jsx)(Ym,{className:"w-8 h-8 text-yellow-400 mx-auto mb-2"}),(0,sa.jsx)("div",{className:"text-slate-400 text-sm",children:"Status"}),(0,sa.jsx)("div",{className:"text-white text-lg font-bold",children:"Waiting"})]})})]}),!l&&I&&R&&(0,sa.jsx)("div",{className:"mt-8 w-full max-w-4xl",children:(0,sa.jsx)(Tm,{className:"bg-gradient-to-r from-blue-800 to-blue-900 border-blue-600",children:(0,sa.jsxs)(Em,{className:"p-6",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,sa.jsx)("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),(0,sa.jsxs)("h3",{className:"text-xl font-bold text-blue-200",children:["You are seated at Seat ",R.seatNumber]})]}),(0,sa.jsx)("div",{className:"text-blue-300 text-sm",children:"Seated at Table"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{className:"bg-blue-900/50 rounded-lg p-4 border border-blue-700",children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,sa.jsx)($m,{className:"w-5 h-5 text-emerald-400"}),(0,sa.jsx)("span",{className:"text-blue-200 font-semibold",children:"Session Buy-in"})]}),(0,sa.jsxs)("div",{className:"text-2xl font-bold text-white",children:["\u20b9",(R.buyInAmount||5e3).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"bg-blue-900/50 rounded-lg p-4 border border-blue-700",children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,sa.jsx)(Ym,{className:"w-5 h-5 text-yellow-400"}),(0,sa.jsx)("span",{className:"text-blue-200 font-semibold",children:"Call Time"})]}),(0,sa.jsx)("div",{className:"text-lg font-bold text-white",children:(0,sa.jsx)("div",{className:"text-green-400",children:"Available"})})]}),(0,sa.jsxs)("div",{className:"bg-blue-900/50 rounded-lg p-4 border border-blue-700",children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,sa.jsx)(Qm,{className:"w-5 h-5 text-purple-400"}),(0,sa.jsx)("span",{className:"text-blue-200 font-semibold",children:"Cash Out"})]}),(0,sa.jsx)("div",{className:"text-lg font-bold text-white",children:(0,sa.jsx)("div",{className:"text-slate-400",children:"Pending"})})]})]})]})})}),!I&&(0,sa.jsx)("div",{className:"mt-8 text-center",children:x?(0,sa.jsx)("div",{className:"space-y-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 border rounded-lg p-4 max-w-md mx-auto ".concat(l?"border-yellow-500/50":"border-emerald-500/50"),children:[(0,sa.jsx)("h3",{className:"font-semibold mb-2 ".concat(l?"text-yellow-400":"text-emerald-400"),children:l?"Assign Seat ".concat(x):"Seat ".concat(x," Selected")}),l&&o?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("p",{className:"text-slate-300 text-sm mb-2",children:["Assign"," ",(0,sa.jsx)("span",{className:"font-semibold text-white",children:o.playerName||o.name})," ","to Seat ",x]}),(0,sa.jsxs)("p",{className:"text-slate-400 text-xs mb-4",children:["Table: ",null===N||void 0===N?void 0:N.name]})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("p",{className:"text-slate-300 text-sm mb-2",children:["Reserve this seat position for ",null===N||void 0===N?void 0:N.name]}),(0,sa.jsx)("p",{className:"text-slate-400 text-xs mb-4",children:"Note: Multiple players can reserve the same seat. Staff will assign final seating."})]}),(0,sa.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,sa.jsxs)(Nm,{onClick:()=>{D(x)},className:"shadow-lg transition-all duration-300 ".concat(l?"bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white hover:shadow-yellow-500/25":"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white hover:shadow-emerald-500/25"),children:[(0,sa.jsx)(Zm,{className:"w-4 h-4 mr-2"}),l?"Assign Seat ".concat(x):"Reserve Seat ".concat(x)]}),(0,sa.jsx)(Nm,{onClick:()=>p(null),variant:"outline",className:"border-slate-600 text-slate-300 hover:bg-slate-700",children:"Cancel"})]})]})}):(0,sa.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4 max-w-md mx-auto",children:[(0,sa.jsx)("p",{className:"text-slate-300 text-sm",children:l&&o?"Click on any available seat to assign ".concat(o.playerName||o.name):"Click on any seat to reserve your preferred position"}),(0,sa.jsx)("p",{className:"text-slate-400 text-xs mt-2",children:l?"Seats highlighted in yellow are preferred seats for this player":"Staff will manage final table assignments"})]})}),(0,sa.jsxs)("div",{className:"mt-8 text-center text-slate-400",children:[(0,sa.jsx)("p",{className:"text-sm",children:"This is a local offline poker game managed by casino staff."}),(0,sa.jsx)("p",{className:"text-xs mt-2",children:"Players are seated by super admin, admin, or manager only."})]})]}),(0,sa.jsx)(qm,{open:b,onOpenChange:g,children:(0,sa.jsxs)(Wm,{className:"bg-slate-800 border-slate-700 text-white",children:[(0,sa.jsxs)(Hm,{children:[(0,sa.jsx)(Vm,{className:"text-xl ".concat(l?"text-yellow-400":"text-emerald-400"),children:l?"Assign Seat":"Join Table Waitlist"}),(0,sa.jsx)(Jm,{className:"text-slate-300",children:l?"Confirm seat assignment for ".concat((null===o||void 0===o?void 0:o.playerName)||(null===o||void 0===o?void 0:o.name)||"player"):"Confirm your seat reservation for ".concat(null===N||void 0===N?void 0:N.name)})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 border border-slate-700",children:[(0,sa.jsx)("h4",{className:"font-semibold mb-2 ".concat(l?"text-yellow-400":"text-emerald-400"),children:l?"Assignment Information":"Table Information"}),(0,sa.jsxs)("div",{className:"text-sm space-y-1 text-slate-300",children:[l&&o&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{children:["\u2022 Player:"," ",(0,sa.jsx)("span",{className:"text-white font-semibold",children:o.playerName||o.name})]}),(0,sa.jsxs)("div",{children:["\u2022 Player ID:"," ",o.playerId||o.id]}),o.preferredSeat&&(0,sa.jsxs)("div",{children:["\u2022 Preferred Seat:"," ",o.preferredSeat===x?(0,sa.jsxs)("span",{className:"text-yellow-400 font-semibold",children:["\u2713 Seat ",x," (Matches preference)"]}):(0,sa.jsxs)("span",{className:"text-gray-400",children:["Seat ",o.preferredSeat]})]})]}),(0,sa.jsxs)("div",{children:["\u2022 Table: ",null===N||void 0===N?void 0:N.name]}),(0,sa.jsxs)("div",{children:["\u2022 Game: ",null===N||void 0===N?void 0:N.gameType]}),(0,sa.jsxs)("div",{children:["\u2022 Stakes: ",null===N||void 0===N?void 0:N.stakes]}),(0,sa.jsxs)("div",{children:["\u2022 Selected Seat:"," ",(0,sa.jsx)("span",{className:"text-white font-semibold",children:x})]})]})]}),!l&&(0,sa.jsx)("div",{className:"bg-amber-900/20 border border-amber-600/50 rounded-lg p-3",children:(0,sa.jsxs)("p",{className:"text-amber-200 text-sm",children:[(0,sa.jsx)("strong",{children:"Note:"})," You will be added to the waitlist for this table. Staff will assign seating when a spot becomes available."]})}),(0,sa.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,sa.jsxs)(Nm,{variant:"outline",onClick:()=>{g(!1),p(null)},className:"border-slate-600 bg-slate-800 text-slate-300 hover:bg-slate-700 hover:text-white hover:border-slate-500",children:[(0,sa.jsx)(eh,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,sa.jsxs)(Nm,{onClick:()=>{x&&D(x)},className:l?"bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white":"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white",children:[(0,sa.jsx)(Zm,{className:"w-4 h-4 mr-2"}),l?"Assign Seat ".concat(x):"Confirm Seat ".concat(x)]})]})]})]})})]}):(0,sa.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Table not found"}),(0,sa.jsx)(Nm,{onClick:()=>n?n():h("/"),children:"Back to Dashboard"})]})})}const ah=[{value:"Super Admin",label:"Super Admin"},{value:"Admin",label:"Admin"},{value:"Manager",label:"Manager"},{value:"HR",label:"HR"},{value:"GRE",label:"GRE"},{value:"Cashier",label:"Cashier"},{value:"Dealer",label:"Dealer"},{value:"FNB",label:"FNB"},{value:"Staff",label:"Staff"}],rh={Pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50",Approved:"bg-green-500/20 text-green-400 border-green-500/50",Rejected:"bg-red-500/20 text-red-400 border-red-500/50",Cancelled:"bg-gray-500/20 text-gray-400 border-gray-500/50"};function nh(e){let{clubId:t}=e;const s=ra(),a=JSON.parse(localStorage.getItem("user")||"{}").role||localStorage.getItem("userRole")||"",n="SUPER_ADMIN"===a||"Super Admin"===a,l="ADMIN"===a||"Admin"===a,o="HR"===a,d=n||l||o,c=n||l||o,u=!n,[m,h]=(0,r.useState)(c?"policies":u?"my-leaves":"policies");(0,r.useEffect)(()=>{n&&"my-leaves"===m&&h("policies")},[n,m]);const[x,p]=(0,r.useState)(!1),[b,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[S,k]=(0,r.useState)(""),[C,A]=(0,r.useState)({role:"",leavesPerYear:0}),[_,P]=(0,r.useState)({startDate:"",endDate:"",reason:""}),{data:T=[],isLoading:E,refetch:I}=hn({queryKey:["leavePolicies",t],queryFn:()=>jr.ie.getLeavePolicies(t),enabled:!!t&&c}),[R,D]=(0,r.useState)({status:"",startDate:"",endDate:"",page:1,limit:10}),{data:O,isLoading:L,refetch:F}=hn({queryKey:["myLeaveApplications",t,R],queryFn:()=>jr.ie.getMyLeaveApplications(t,R),enabled:!!t&&u}),M=(null===O||void 0===O?void 0:O.applications)||[],B=(null===O||void 0===O?void 0:O.totalPages)||0,q=(null===O||void 0===O?void 0:O.page)||1,U=(null===O||void 0===O?void 0:O.total)||0,{data:z,isLoading:K,refetch:W}=hn({queryKey:["leaveBalance",t],queryFn:()=>jr.ie.getLeaveBalance(t),enabled:!!t&&u}),[H,V]=(0,r.useState)({status:"",role:"",startDate:"",endDate:"",search:"",page:1,limit:10}),{data:J,isLoading:Q,refetch:G}=hn({queryKey:["leaveApplicationsForApproval",t,H],queryFn:()=>jr.ie.getLeaveApplicationsForApproval(t,H),enabled:!!t&&d}),Y=(null===J||void 0===J?void 0:J.applications)||[],$=(null===J||void 0===J?void 0:J.totalPages)||0,Z=(null===J||void 0===J?void 0:J.page)||1,X=(null===J||void 0===J?void 0:J.total)||0,{data:ee=[],isLoading:te}=hn({queryKey:["pendingLeaveApplications",t],queryFn:()=>jr.ie.getPendingLeaveApplications(t),enabled:!!t&&d}),se=gn({mutationFn:e=>jr.ie.createLeavePolicy(t,e),onSuccess:()=>{wr.success("Leave policy created successfully"),p(!1),A({role:"",leavesPerYear:0}),s.invalidateQueries(["leavePolicies",t])},onError:e=>{wr.error(e.message||"Failed to create leave policy")}}),ae=gn({mutationFn:e=>{let{role:s,data:a}=e;return jr.ie.updateLeavePolicy(t,s,a)},onSuccess:()=>{wr.success("Leave policy updated successfully"),p(!1),w(null),A({role:"",leavesPerYear:0}),s.invalidateQueries(["leavePolicies",t])},onError:e=>{wr.error(e.message||"Failed to update leave policy")}}),re=gn({mutationFn:e=>jr.ie.deleteLeavePolicy(t,e),onSuccess:()=>{wr.success("Leave policy deleted successfully"),s.invalidateQueries(["leavePolicies",t])},onError:e=>{wr.error(e.message||"Failed to delete leave policy")}}),ne=gn({mutationFn:e=>jr.ie.createLeaveApplication(t,e),onSuccess:async()=>{wr.success("Leave application submitted successfully"),g(!1),P({startDate:"",endDate:"",reason:""}),await Promise.all([s.refetchQueries({queryKey:["myLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveBalance",t]}),s.refetchQueries({queryKey:["pendingLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveApplicationsForApproval",t]})])},onError:e=>{wr.error(e.message||"Failed to submit leave application")}}),le=gn({mutationFn:e=>jr.ie.approveLeaveApplication(t,e),onSuccess:async()=>{wr.success("Leave application approved"),await Promise.all([s.refetchQueries({queryKey:["pendingLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveApplicationsForApproval",t]}),s.refetchQueries({queryKey:["myLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveBalance",t]})])},onError:e=>{wr.error(e.message||"Failed to approve leave")}}),ie=gn({mutationFn:e=>{let{applicationId:s,reason:a}=e;return jr.ie.rejectLeaveApplication(t,s,a)},onSuccess:async()=>{wr.success("Leave application rejected"),y(!1),k(""),N(null),await Promise.all([s.refetchQueries({queryKey:["pendingLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveApplicationsForApproval",t]}),s.refetchQueries({queryKey:["myLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveBalance",t]})])},onError:e=>{wr.error(e.message||"Failed to reject leave")}}),oe=gn({mutationFn:e=>jr.ie.cancelLeaveApplication(t,e),onSuccess:async()=>{wr.success("Leave application cancelled successfully"),await Promise.all([s.refetchQueries({queryKey:["myLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveBalance",t]}),s.refetchQueries({queryKey:["pendingLeaveApplications",t]}),s.refetchQueries({queryKey:["leaveApplicationsForApproval",t]})])},onError:e=>{wr.error(e.message||"Failed to cancel leave")}}),de=e=>e?xm(e):"";return(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:(0,sa.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,sa.jsx)("h1",{className:"text-4xl font-bold text-white mb-8",children:"Leave Management"}),(0,sa.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-slate-700",children:[c&&(0,sa.jsx)("button",{onClick:()=>h("policies"),className:"px-6 py-3 font-semibold transition-colors ".concat("policies"===m?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Leave Policies"}),d&&(0,sa.jsxs)("button",{onClick:()=>h("approve"),className:"px-6 py-3 font-semibold transition-colors relative ".concat("approve"===m?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:["Approve Leaves",ee.length>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full px-2 py-1",children:ee.length})]}),u&&(0,sa.jsx)("button",{onClick:()=>h("my-leaves"),className:"px-6 py-3 font-semibold transition-colors ".concat("my-leaves"===m?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"My Leaves"})]}),"policies"===m&&c&&(0,sa.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Leave Policies"}),(0,sa.jsxs)("button",{onClick:()=>{w(null),A({role:"",leavesPerYear:0}),p(!0)},className:"bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[(0,sa.jsx)(bc,{})," Create Policy"]})]}),E?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Loading policies..."})]}):0===T.length?(0,sa.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,sa.jsx)("p",{children:"No leave policies configured yet."}),(0,sa.jsx)("p",{className:"text-sm mt-2",children:'Click "Create Policy" to get started.'})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-slate-600",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.role}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{w(e),A({role:e.role,leavesPerYear:e.leavesPerYear}),p(!0)})(e),className:"text-blue-400 hover:text-blue-300",children:(0,sa.jsx)(oc,{})}),(0,sa.jsx)("button",{onClick:()=>{window.confirm("Delete leave policy for ".concat(e.role,"?"))&&re.mutate(e.role)},className:"text-red-400 hover:text-red-300",children:(0,sa.jsx)(Nc,{})})]})]}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-emerald-400",children:e.leavesPerYear}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"leaves per year"})]},e.id))})]}),"approve"===m&&d&&(0,sa.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Leave Applications"}),(0,sa.jsx)("div",{className:"bg-slate-700/50 rounded-lg p-4 mb-6 space-y-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),(0,sa.jsxs)("select",{value:H.status,onChange:e=>V((0,i.A)((0,i.A)({},H),{},{status:e.target.value,page:1})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"All Status"}),(0,sa.jsx)("option",{value:"Pending",children:"Pending"}),(0,sa.jsx)("option",{value:"Approved",children:"Approved"}),(0,sa.jsx)("option",{value:"Rejected",children:"Rejected"}),(0,sa.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Role"}),(0,sa.jsxs)("select",{value:H.role,onChange:e=>V((0,i.A)((0,i.A)({},H),{},{role:e.target.value,page:1})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"All Roles"}),ah.filter(e=>"Affiliate"!==e.value).map(e=>(0,sa.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search (Name/Email)"}),(0,sa.jsx)("input",{type:"text",value:H.search,onChange:e=>V((0,i.A)((0,i.A)({},H),{},{search:e.target.value,page:1})),placeholder:"Search by name or email...",className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:H.startDate,onChange:e=>V((0,i.A)((0,i.A)({},H),{},{startDate:e.target.value,page:1})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:H.endDate,onChange:e=>V((0,i.A)((0,i.A)({},H),{},{endDate:e.target.value,page:1})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white"})]}),(0,sa.jsx)("div",{className:"flex items-end",children:(0,sa.jsx)("button",{onClick:()=>V({status:"",role:"",startDate:"",endDate:"",search:"",page:1,limit:10}),className:"w-full bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg",children:"Clear Filters"})})]})}),(0,sa.jsxs)("div",{className:"mb-4 text-sm text-gray-400",children:["Showing ",Y.length," of ",X," leave application(s)"]}),Q?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Loading applications..."})]}):0===Y.length?(0,sa.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,sa.jsx)(sc,{className:"text-5xl mx-auto mb-4 opacity-50"}),(0,sa.jsx)("p",{children:"No leave applications found"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-4 mb-6",children:Y.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-6 border border-slate-600",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white",children:e.staff.name}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.staff.role})]}),(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold border ".concat(rh[e.status]),children:e.status})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Start Date"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:de(e.startDate)})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"End Date"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:de(e.endDate)})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Number of Days"}),(0,sa.jsxs)("p",{className:"text-white font-medium",children:[e.numberOfDays," days"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Applied On"}),(0,sa.jsx)("p",{className:"text-white font-medium",children:de(e.createdAt)})]})]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Reason"}),(0,sa.jsx)("p",{className:"text-white bg-slate-800/50 rounded p-3",children:e.reason})]}),"Pending"===e.status&&(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>le.mutate(e.id),disabled:le.isLoading||ie.isLoading,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:le.isLoading?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Approving..."]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)(sc,{})," Approve"]})}),(0,sa.jsxs)("button",{onClick:()=>(e=>{N(e),k(""),y(!0)})(e),disabled:le.isLoading||ie.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,sa.jsx)(vc,{})," Reject"]})]}),"Approved"===e.status&&e.approvedAt&&(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Approved on ",de(e.approvedAt)]}),"Rejected"===e.status&&e.rejectedAt&&(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Rejected on ",de(e.rejectedAt),e.rejectionReason&&(0,sa.jsxs)("div",{className:"mt-2 text-red-400 bg-red-900/20 rounded p-2",children:["Reason: ",e.rejectionReason]})]}),"Cancelled"===e.status&&(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:"Cancelled by employee"})]},e.id))}),$>1&&(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-slate-700",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",Z," of ",$]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>V((0,i.A)((0,i.A)({},H),{},{page:Z-1})),disabled:1===Z,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>V((0,i.A)((0,i.A)({},H),{},{page:Z+1})),disabled:Z>=$,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),"my-leaves"===m&&u&&(0,sa.jsxs)("div",{className:"space-y-6",children:[z&&(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-emerald-600/20 to-teal-600/20 rounded-xl p-6 border border-emerald-500/50",children:[(0,sa.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Leave Balance"}),(0,sa.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Total Leaves"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:z.totalLeaves})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Used Leaves"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-yellow-400",children:z.usedLeaves})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Remaining Leaves"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-emerald-400",children:z.remainingLeaves})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"My Leave Applications"}),(0,sa.jsxs)("button",{onClick:()=>{P({startDate:"",endDate:"",reason:""}),g(!0)},className:"bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[(0,sa.jsx)(bc,{})," Apply for Leave"]})]}),(0,sa.jsx)("div",{className:"bg-slate-700/50 rounded-lg p-4 mb-6 space-y-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),(0,sa.jsxs)("select",{value:R.status,onChange:e=>D((0,i.A)((0,i.A)({},R),{},{status:e.target.value,page:1})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"All Status"}),(0,sa.jsx)("option",{value:"Pending",children:"Pending"}),(0,sa.jsx)("option",{value:"Approved",children:"Approved"}),(0,sa.jsx)("option",{value:"Rejected",children:"Rejected"}),(0,sa.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:R.startDate,onChange:e=>D((0,i.A)((0,i.A)({},R),{},{startDate:e.target.value,page:1})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:R.endDate,onChange:e=>D((0,i.A)((0,i.A)({},R),{},{endDate:e.target.value,page:1})),className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white"})]}),(0,sa.jsx)("div",{className:"flex items-end",children:(0,sa.jsx)("button",{onClick:()=>D({status:"",startDate:"",endDate:"",page:1,limit:10}),className:"w-full bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg",children:"Clear Filters"})})]})}),(0,sa.jsxs)("div",{className:"mb-4 text-sm text-gray-400",children:["Showing ",M.length," of ",U," leave application(s)"]}),L?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Loading your leaves..."})]}):0===M.length?(0,sa.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,sa.jsx)(ec,{className:"text-5xl mx-auto mb-4 opacity-50"}),(0,sa.jsx)("p",{children:"No leave applications yet"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-4 mb-6",children:M.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-6 border border-slate-600",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold border ".concat(rh[e.status]),children:e.status}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:[e.numberOfDays," days"]})]}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:[de(e.startDate)," - ",de(e.endDate)]})]}),"Approved"===e.status&&e.approvedAt&&(0,sa.jsxs)("div",{className:"text-right",children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Approved on"}),(0,sa.jsx)("p",{className:"text-sm text-white",children:de(e.approvedAt)})]}),"Rejected"===e.status&&e.rejectedAt&&(0,sa.jsxs)("div",{className:"text-right",children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Rejected on"}),(0,sa.jsx)("p",{className:"text-sm text-white",children:de(e.rejectedAt)})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Reason"}),(0,sa.jsx)("p",{className:"text-white bg-slate-800/50 rounded p-3",children:e.reason})]}),e.rejectionReason&&(0,sa.jsxs)("div",{className:"mt-3",children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Rejection Reason"}),(0,sa.jsx)("p",{className:"text-red-400 bg-red-900/20 rounded p-3",children:e.rejectionReason})]}),"Cancelled"!==e.status&&(0,sa.jsx)("div",{className:"mt-4 flex justify-end",children:(0,sa.jsxs)("button",{onClick:()=>{window.confirm("Are you sure you want to cancel this leave application?")&&oe.mutate(e.id)},disabled:oe.isLoading,className:"bg-orange-600 hover:bg-orange-500 text-white px-4 py-2 rounded-lg flex items-center gap-2 disabled:opacity-50",children:[(0,sa.jsx)(vc,{})," Cancel Leave"]})})]},e.id))}),B>1&&(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-slate-700",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",q," of ",B]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>D((0,i.A)((0,i.A)({},R),{},{page:q-1})),disabled:1===q,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>D((0,i.A)((0,i.A)({},R),{},{page:q+1})),disabled:q>=B,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),x&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-md w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:v?"Edit Leave Policy":"Create Leave Policy"}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v?ae.mutate({role:v.role,data:{leavesPerYear:C.leavesPerYear}}):se.mutate(C)},children:[(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Role"}),(0,sa.jsxs)("select",{value:C.role,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{role:e.target.value})),disabled:!!v||se.isLoading||ae.isLoading,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50",required:!0,children:[(0,sa.jsx)("option",{value:"",children:"Select Role"}),ah.filter(e=>"Affiliate"!==e.value).map(e=>(0,sa.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Leaves Per Year"}),(0,sa.jsx)("input",{type:"number",min:"0",value:C.leavesPerYear,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{leavesPerYear:parseInt(e.target.value)||0})),disabled:se.isLoading||ae.isLoading,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[!(se.isLoading||ae.isLoading)&&(0,sa.jsx)("button",{type:"button",onClick:()=>{p(!1),w(null),A({role:"",leavesPerYear:0})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:se.isLoading||ae.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg disabled:opacity-50 flex items-center justify-center gap-2 ".concat(se.isLoading||ae.isLoading?"w-full":""),children:se.isLoading||ae.isLoading?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),v?"Updating...":"Creating..."]}):v?"Update":"Create"})]})]})]})}),b&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-md w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Apply for Leave"}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),ne.mutate(_)},children:[(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:_.startDate,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{startDate:e.target.value})),min:(new Date).toISOString().split("T")[0],className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:_.endDate,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{endDate:e.target.value})),min:_.startDate||(new Date).toISOString().split("T")[0],className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reason"}),(0,sa.jsx)("textarea",{value:_.reason,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{reason:e.target.value})),rows:"4",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Please provide a reason for your leave...",required:!0,minLength:10})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{g(!1),P({startDate:"",endDate:"",reason:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:ne.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Submit Application"})]})]})]})}),f&&j&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-md w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Reject Leave Application"}),(0,sa.jsxs)("p",{className:"text-gray-400 mb-4",children:["Rejecting leave application for ",(0,sa.jsx)("strong",{className:"text-white",children:j.staff.name})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),j&&ie.mutate({applicationId:j.id,reason:S})},children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rejection Reason (Optional)"}),(0,sa.jsx)("textarea",{value:S,onChange:e=>k(e.target.value),rows:"3",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white",placeholder:"Provide a reason for rejection..."})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{y(!1),N(null),k("")},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:ie.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:ie.isLoading?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Rejecting..."]}):"Reject Leave"})]})]})]})})]})})}function lh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(null),[n,l]=(0,r.useState)(!1),{data:i,isLoading:o}=hn({queryKey:["tables",t],queryFn:()=>jr.rj.getTables(t),enabled:!!t}),d=i||[],c=d.filter(e=>"AVAILABLE"===e.status||"OCCUPIED"===e.status);return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Tables & Waitlist"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"View-only mode: You can only view live tables"}),!t&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view tables."})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Live Tables - View Only"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"View live tables and their status."})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 px-4 py-2 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Active Tables: ",c.length]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Total Players: ",c.reduce((e,t)=>e+(t.currentSeats||0),0)]})]})]}),o?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading tables..."})]}):0===c.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfb2"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No active tables"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600 hover:border-blue-500 transition-all",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h3",{className:"text-lg font-bold text-white",children:["Table ",e.tableNumber||e.number]}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.tableType||"Cash Game"})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("OCCUPIED"===e.status?"bg-green-600/20 text-green-400":"bg-blue-600/20 text-blue-400"),children:e.status})]}),(0,sa.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:["\u20b9",e.minBuyIn||0,"/\u20b9",e.maxBuyIn||0]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Occupied Seats:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:[e.currentSeats||0," / ",e.maxSeats||8]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Available Seats:"}),(0,sa.jsx)("span",{className:"text-green-400 font-medium",children:e.maxSeats-(e.currentSeats||0)})]})]}),(0,sa.jsxs)("button",{onClick:()=>{a(e),l(!0)},className:"w-full bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-500 hover:to-indigo-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83c\udfaf"}),(0,sa.jsx)("span",{children:"View Table Hologram"})]})]},e.id))})]}),n&&s&&(0,sa.jsx)("div",{className:"fixed inset-0 z-50 bg-black/90 overflow-y-auto",children:(0,sa.jsx)(sh,{tableId:s.id,onClose:()=>{l(!1),a(null)},isManagerMode:!0,isViewOnly:!0,tables:d})})]})}function ih(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(null),{data:n,isLoading:l}=hn({queryKey:["tournaments",t],queryFn:()=>jr.Re.getTournaments(t),enabled:!!t}),i=Array.isArray(n)?n:(null===n||void 0===n?void 0:n.tournaments)||(null===n||void 0===n?void 0:n.data)||[],o=Array.isArray(i)?i:[];return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Tournaments"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"View-only mode: You can only view tournament information"}),!t&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view tournaments."})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Tournament List - View Only"}),l?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading tournaments..."})]}):0===o.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfc6"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No tournaments found"})]}):(0,sa.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,sa.jsx)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:e.name||"Tournament"}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Status: ",e.status||"Unknown"]}),e.buyIn&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Buy-In: \u20b9",e.buyIn]}),e.startTime&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Start: ",new Date(e.startTime).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]}),e.prizePool&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Prize Pool: \u20b9",e.prizePool]})]}),(0,sa.jsxs)("button",{onClick:()=>a(e),className:"bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-500 hover:to-indigo-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udc41\ufe0f"}),(0,sa.jsx)("span",{children:"View Details"})]})]})},e.id))})]}),s&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-2xl w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:s.name||"Tournament"}),(0,sa.jsx)("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Status"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:s.status||"Unknown"})]}),s.buyIn&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Buy-In"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.buyIn]})]}),s.prizePool&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Prize Pool"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.prizePool]})]}),s.startTime&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Start Time"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:new Date(s.startTime).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]}),s.description&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Description"}),(0,sa.jsx)("p",{className:"text-white",children:s.description})]})]})]})})]})}function oh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(null),{data:n,isLoading:l}=hn({queryKey:["rummy-tournaments",t],queryFn:()=>jr.Re.getTournaments(t),enabled:!!t,select:e=>Array.isArray(e)?e.filter(e=>"RUMMY"===e.tableType):[]}),i=n||[];return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Rummy Tournaments"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"View-only mode: You can only view rummy tournament details"})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"All Rummy Tournaments"}),l?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading rummy tournaments..."})]}):0===i.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udccf"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No rummy tournaments found"})]}):(0,sa.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,sa.jsx)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:e.name||"Rummy Tournament"}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Status: ",e.status||"Unknown"]}),(0,sa.jsxs)("p",{className:"text-sm text-emerald-400",children:["Variant: ",e.rummyVariant||"Points Rummy"]}),e.buyIn&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Buy-In: \u20b9",e.buyIn]}),e.startTime&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Start: ",new Date(e.startTime).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]}),e.prizePool&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Prize Pool: \u20b9",e.prizePool]})]}),(0,sa.jsxs)("button",{onClick:()=>a(e),className:"bg-gradient-to-r from-emerald-600 to-teal-700 hover:from-emerald-500 hover:to-teal-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udc41\ufe0f"}),(0,sa.jsx)("span",{children:"View Details"})]})]})},e.id))})]}),s&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-2xl w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:s.name||"Rummy Tournament"}),(0,sa.jsx)("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Status"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:s.status||"Unknown"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Rummy Variant"}),(0,sa.jsx)("p",{className:"text-emerald-400 font-semibold",children:s.rummyVariant||"Points Rummy"})]}),s.buyIn&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Buy-In"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.buyIn]})]}),s.prizePool&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Prize Pool"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.prizePool]})]}),s.startTime&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Start Time"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:new Date(s.startTime).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]}),s.description&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Description"}),(0,sa.jsx)("p",{className:"text-white",children:s.description})]})]})]})})]})}function dh(){const e=me(),t=ra(),[s,a]=(0,r.useState)("Player Management"),[n,l]=(0,r.useState)(null),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{const t=localStorage.getItem("clubId");t?l(t):e("/login")},[e]),(0,r.useEffect)(()=>{const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("greuser")||"{}");t.id||s.userId?(t.mustResetPassword||s.mustResetPassword)&&d(!0):e("/login")},[e]);const{data:m,isLoading:h}=hn({queryKey:["clubPlayers",n],queryFn:()=>jr.bS.getPlayers(n),enabled:!!n}),{data:x=[],isLoading:p}=hn({queryKey:["pendingPlayers",n],queryFn:()=>jr.bS.getPendingApprovalPlayers(n),enabled:!!n}),{data:b=[],isLoading:g}=hn({queryKey:["suspendedPlayers",n],queryFn:()=>jr.bS.getSuspendedPlayers(n),enabled:!!n}),{data:f}=hn({queryKey:["club",n],queryFn:()=>jr.Od.getClub(n),enabled:!!n}),y=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("greuser")||"{}");t.mustResetPassword=!1,localStorage.setItem("greuser",JSON.stringify(t)),d(!1),u({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),v=o&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("greuser")||"{}"),a=t.email||s.email;a?c.currentPassword&&c.newPassword&&c.confirmPassword?c.newPassword===c.confirmPassword?c.newPassword.length<8?wr.error("Password must be at least 8 characters"):y.mutate({email:a,currentPassword:c.currentPassword,newPassword:c.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:c.currentPassword,onChange:e=>u((0,i.A)((0,i.A)({},c),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:c.newPassword,onChange:e=>u((0,i.A)((0,i.A)({},c),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:c.confirmPassword,onChange:e=>u((0,i.A)((0,i.A)({},c),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:y.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:y.isLoading?"Resetting...":"Reset Password"})]})]})}),w=["Player Management","Notifications","Tables & Waitlist","Tournaments","Chat","Push Notifications","Leave Management"],j=null!==f&&void 0!==f&&f.rummyEnabled?[...w,"Rummy"]:w;return n?(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex flex-col lg:flex-row",children:[v,(0,sa.jsx)(vm,{activeItem:s,setActiveItem:a,menuItems:j,onSignOut:()=>{localStorage.clear(),e("/login")}}),(0,sa.jsx)("main",{className:"flex-1 min-w-0 min-h-screen",children:(0,sa.jsxs)("div",{className:"p-6 space-y-6",children:["Player Management"===s&&n&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-blue-500/20 to-indigo-600/20 rounded-xl p-6 border border-blue-500/30",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Player Management"}),(0,sa.jsx)("p",{className:"text-gray-300",children:"Manage player profiles, approvals, and suspensions"})]}),(0,sa.jsx)(ud,{selectedClubId:n,playersData:m,playersLoading:h,pendingPlayers:x,pendingLoading:p,suspendedPlayers:b,suspendedLoading:g,onRefresh:()=>{t.invalidateQueries(["pendingPlayers",n]),t.invalidateQueries(["clubPlayers",n]),t.invalidateQueries(["suspendedPlayers",n])}})]}),"Tables & Waitlist"===s&&n&&(0,sa.jsx)(lh,{selectedClubId:n}),"Tournaments"===s&&n&&(0,sa.jsx)(ih,{selectedClubId:n}),"Chat"===s&&n&&(0,sa.jsx)($u,{clubId:n}),"Notifications"===s&&n&&(0,sa.jsx)(bm,{selectedClubId:n,recipientType:"staff"}),"Push Notifications"===s&&n&&(0,sa.jsx)(Md,{selectedClubId:n}),"Leave Management"===s&&n&&(0,sa.jsx)(nh,{clubId:n,userRole:"GRE"}),"Rummy"===s&&n&&(0,sa.jsx)(oh,{selectedClubId:n}),!["Player Management","Tables & Waitlist","Tournaments","Chat","Notifications","Push Notifications","Leave Management","Rummy"].includes(s)&&(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Welcome to GRE Portal"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Select an option from the sidebar to get started."})]})]})})]}):(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-white text-xl",children:"Loading GRE Portal..."}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Initializing club data"})]})})}function ch(e){let{role:t,roleDisplayName:s,redirectPath:a,gradientFrom:n,gradientTo:l,description:o}=e;const[d,c]=(0,r.useState)({email:"",password:""}),[u,m]=(0,r.useState)(""),[h,x]=(0,r.useState)(!1),p=me();(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),s="".concat(t.toLowerCase(),"user"),r=JSON.parse(localStorage.getItem(s)||"{}");if(e.id||r.userId){((e.role||r.role)===t||"MASTER_ADMIN"===t&&e.isMasterAdmin)&&p(a,{replace:!0})}},[p,t,a]);const b=e=>{c((0,i.A)((0,i.A)({},d),{},{[e.target.name]:e.target.value}))};return(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"max-w-md w-full mx-4",children:[(0,sa.jsxs)("div",{className:"text-center mb-8",children:[(0,sa.jsxs)("div",{className:"text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r ".concat(n," ").concat(l," drop-shadow-lg mb-4"),children:[s," Portal"]}),(0,sa.jsx)("p",{className:"text-gray-300",children:o})]}),(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 via-gray-900 to-black rounded-2xl p-8 shadow-2xl border border-gray-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:"Sign In"}),u&&(0,sa.jsx)("div",{className:"bg-red-500/20 border border-red-500/30 text-red-300 px-4 py-3 rounded-lg mb-4",children:u}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(""),x(!0);try{const e=await jr.R2.login(d.email,d.password),i=e.clubRoles&&e.clubRoles.length>0;if(i&&("SUPER_ADMIN"===t||"MASTER_ADMIN"===t))throw new Error("Club staff (".concat(e.clubRoles.map(e=>e.role).join(", "),") should use /login portal, not ").concat(s," portal."));let o=!1;var r;if("SUPER_ADMIN"===t)o=(null===(r=e.tenantRoles)||void 0===r?void 0:r.some(e=>"SUPER_ADMIN"===e.role))&&!i;else if("MASTER_ADMIN"===t)o=e.user.isMasterAdmin&&!i;else{var n,l;o=(null===(n=e.clubRoles)||void 0===n?void 0:n.some(e=>e.role===t))||(null===(l=e.tenantRoles)||void 0===l?void 0:l.some(e=>e.role===t))}if(!o)throw new Error("You don't have ".concat(s," access. Please use the correct portal."));const c={id:e.user.id,email:d.email,displayName:e.user.displayName,role:t,mustResetPassword:e.user.mustResetPassword||!1};localStorage.setItem("".concat(t.toLowerCase(),"user"),JSON.stringify({email:d.email,role:t,userId:e.user.id,displayName:e.user.displayName,mustResetPassword:e.user.mustResetPassword||!1})),"SUPER_ADMIN"!==t&&"ADMIN"!==t||localStorage.setItem("user",JSON.stringify(c)),p(a)}catch(Gx){console.error("Login error:",Gx),m(Gx.message||"Invalid email or password. Please try again.")}finally{x(!1)}},className:"space-y-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-sm font-medium mb-2",children:"Email Address"}),(0,sa.jsx)("input",{type:"email",name:"email",value:d.email,onChange:b,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent",placeholder:"Enter your email",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-sm font-medium mb-2",children:"Password"}),(0,sa.jsx)("input",{type:"password",name:"password",value:d.password,onChange:b,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent",placeholder:"Enter your password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r ".concat(n," ").concat(l," hover:opacity-90 text-white font-bold py-3 px-4 rounded-lg shadow-lg transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed"),children:h?"Signing In...":"Sign In to ".concat(s," Portal")})]}),(0,sa.jsx)("div",{className:"mt-6 p-4 bg-blue-500/20 border border-blue-500/30 rounded-lg",children:(0,sa.jsxs)("p",{className:"text-blue-300 text-sm text-center",children:[(0,sa.jsx)("strong",{children:"Note:"})," Please use your registered credentials",(0,sa.jsx)("br",{}),"Contact admin if you need access"]})}),(0,sa.jsx)("div",{className:"mt-6 text-center",children:(0,sa.jsx)("button",{onClick:()=>p("/"),className:"text-emerald-400 hover:text-emerald-300 text-sm underline",children:"\u2190 Back to Home"})})]})]})})}const uh=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"documents";try{var a;const r=Date.now(),n=Math.random().toString(36).substring(2,15),l=e.name.split(".").pop(),i="".concat(s,"/").concat(t,"/").concat(r,"-").concat(n,".").concat(l),o=(null===(a=e.type)||void 0===a?void 0:a.startsWith("video/"))||!1,{signedUrl:d,publicUrl:c}=await jr.Dv.createPushNotificationUploadUrl(t,i,o);return await jr.Dv.uploadToSignedUrl(d,e),c}catch(r){throw console.error("Storage upload error:",r),new Error("Failed to upload document: ".concat(r.message||"Unknown error"))}},mh=[{value:0,label:"Sunday",short:"Sun"},{value:1,label:"Monday",short:"Mon"},{value:2,label:"Tuesday",short:"Tue"},{value:3,label:"Wednesday",short:"Wed"},{value:4,label:"Thursday",short:"Thu"},{value:5,label:"Friday",short:"Fri"},{value:6,label:"Saturday",short:"Sat"}];function hh(e){var t,s;let{selectedClubId:a}=e;const[n,l]=(0,r.useState)("templates"),[o,d]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[m,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),[b,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)({startDate:(new Date).toISOString().split("T")[0],periodType:"weekly",overwriteExisting:!1}),[v,w]=(0,r.useState)({startDate:(new Date).toISOString().split("T")[0],endDate:new Date(Date.now()+6048e5).toISOString().split("T")[0]}),[j,N]=(0,r.useState)(null),[S,k]=(0,r.useState)("");(0,r.useEffect)(()=>{a&&(C(),A())},[a]);const C=async()=>{try{const e=await(0,jr.AT)("/clubs/".concat(a,"/roster/templates"));e.success&&d(e.templates||[])}catch(e){console.error("Error loading templates:",e),alert("Failed to load roster templates")}},A=async()=>{try{const e=await jr.staffAPI.getAllStaffMembers(a);e.success&&u(e.staff||[])}catch(e){console.error("Error loading staff:",e)}},_=c.filter(e=>!o.some(t=>t.staffId===e.id)&&"Active"===e.status),P=(null===j||void 0===j||null===(t=j.staff)||void 0===t?void 0:t.filter(e=>""===S||e.staffName.toLowerCase().includes(S.toLowerCase())))||[];return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex gap-2 border-b border-gray-700",children:[{id:"templates",label:"Templates",icon:"\ud83d\udc65"},{id:"generate",label:"Generate Roster",icon:"\ud83d\udcc5"},{id:"overview",label:"Roster Overview",icon:"\ud83d\udcca"}].map(e=>(0,sa.jsxs)("button",{onClick:()=>l(e.id),className:"px-4 py-2 font-medium transition-colors ".concat(n===e.id?"text-orange-500 border-b-2 border-orange-500":"text-gray-400 hover:text-gray-300"),children:[(0,sa.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))}),"templates"===n&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,sa.jsxs)("h2",{className:"text-xl font-bold text-white mb-4",children:["Roster Templates (",o.length,")"]}),0===o.length?(0,sa.jsx)("p",{className:"text-gray-400 text-center py-8",children:"No roster templates created yet. Create templates for staff members below."}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(e=>(0,sa.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-white font-semibold",children:e.staffName}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.staffRole})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(e.isActive?"bg-green-500/20 text-green-400":"bg-gray-600 text-gray-400"),children:e.isActive?"Active":"Inactive"})]}),(0,sa.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Shift Time:"}),(0,sa.jsxs)("span",{className:"text-white ml-2",children:[e.defaultShiftStartTime.substring(0,5)," - ",e.defaultShiftEndTime.substring(0,5),e.shiftCrossesMidnight&&" (next day)"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Off Days:"}),(0,sa.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:0===e.offDays.length?(0,sa.jsx)("span",{className:"text-gray-500 text-xs",children:"No off days"}):e.offDays.map(e=>{var t;return(0,sa.jsx)("span",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 rounded text-xs",children:null===(t=mh.find(t=>t.value===e))||void 0===t?void 0:t.short},e)})})]})]}),(0,sa.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{p((0,i.A)((0,i.A)({},e),{},{defaultShiftStartTime:e.defaultShiftStartTime.substring(0,5),defaultShiftEndTime:e.defaultShiftEndTime.substring(0,5)})),g(!0)})(e),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors text-sm",children:"Edit"}),(0,sa.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this roster template?"))try{await(0,jr.AT)("/clubs/".concat(a,"/roster/templates/").concat(e),{method:"DELETE"}),alert("Template deleted successfully"),C()}catch(t){console.error("Error deleting template:",t),alert("Failed to delete template")}})(e.id),className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded transition-colors text-sm",children:"Delete"})]})]},e.id))})]}),_.length>0&&(0,sa.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,sa.jsxs)("h2",{className:"text-xl font-bold text-white mb-4",children:["Staff Without Templates (",_.length,")"]}),(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map(e=>(0,sa.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,sa.jsxs)("div",{className:"mb-3",children:[(0,sa.jsx)("h3",{className:"text-white font-semibold",children:e.name}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.role}),e.email&&(0,sa.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.email})]}),(0,sa.jsx)("button",{onClick:()=>(e=>{p({staffId:e.id,staffName:e.name,staffRole:e.role,offDays:[],defaultShiftStartTime:"18:00",defaultShiftEndTime:"02:00",shiftCrossesMidnight:!0,isActive:!0,notes:""}),g(!0)})(e),className:"w-full px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded transition-colors text-sm",children:"Create Template"})]},e.id))})]})]}),"generate"===n&&(0,sa.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Generate Roster"}),0===o.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("p",{className:"text-gray-400 mb-4",children:"You need to create roster templates first before generating a roster."}),(0,sa.jsx)("button",{onClick:()=>l("templates"),className:"px-6 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded transition-colors",children:"Go to Templates"})]}):(0,sa.jsxs)("div",{className:"max-w-2xl space-y-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:f.startDate,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Period Type"}),(0,sa.jsxs)("div",{className:"flex gap-4",children:[(0,sa.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,sa.jsx)("input",{type:"radio",value:"weekly",checked:"weekly"===f.periodType,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{periodType:e.target.value})),className:"text-orange-600"}),(0,sa.jsx)("span",{className:"text-white",children:"Weekly (7 days)"})]}),(0,sa.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,sa.jsx)("input",{type:"radio",value:"monthly",checked:"monthly"===f.periodType,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{periodType:e.target.value})),className:"text-orange-600"}),(0,sa.jsx)("span",{className:"text-white",children:"Monthly (rest of the month)"})]})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",checked:f.overwriteExisting,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{overwriteExisting:e.target.checked})),className:"rounded text-orange-600"}),(0,sa.jsx)("span",{className:"text-white",children:"Overwrite existing shifts in this period"})]}),f.overwriteExisting&&(0,sa.jsx)("p",{className:"text-sm text-yellow-500 mt-1",children:"\u26a0\ufe0f Warning: This will delete and recreate all shifts in the selected period"})]}),(0,sa.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,sa.jsx)("h3",{className:"text-white font-medium mb-2",children:"Summary"}),(0,sa.jsxs)("ul",{className:"text-sm text-gray-300 space-y-1",children:[(0,sa.jsxs)("li",{children:["\u2022 ",o.length," staff members with templates"]}),(0,sa.jsxs)("li",{children:["\u2022 Period: ",f.periodType]}),(0,sa.jsxs)("li",{children:["\u2022 Start: ",f.startDate]}),"monthly"===f.periodType&&(0,sa.jsx)("li",{children:"\u2022 Will create roster till end of month (28/29/30/31 days based on month)"}),"weekly"===f.periodType&&(0,sa.jsx)("li",{children:"\u2022 Will create 7 days roster"})]})]}),(0,sa.jsx)("button",{onClick:async()=>{let e="";if("monthly"===f.periodType){const t=new Date(f.startDate),s=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),a=new Date(t.getFullYear(),t.getMonth(),s).toISOString().split("T")[0];e="End: ".concat(a," (").concat(s," days in month)")}else{const t=new Date(f.startDate),s=new Date(t);s.setDate(t.getDate()+6),e="End: ".concat(s.toISOString().split("T")[0]," (7 days)")}if(window.confirm("Generate ".concat(f.periodType," roster from ").concat(f.startDate,"?\n").concat(e).concat(f.overwriteExisting?"\n\n\u26a0\ufe0f This will overwrite existing shifts!":"")))try{h(!0);const e=await(0,jr.AT)("/clubs/".concat(a,"/roster/generate"),{method:"POST",body:JSON.stringify(f)});e.success&&alert("Roster generated successfully!\n\n"+"Period: ".concat(f.periodType,"\n")+"Start: ".concat(e.startDate,"\n")+"End: ".concat(e.endDate,"\n")+"Shifts Created: ".concat(e.totalShiftsCreated,"\n")+"Staff Processed: ".concat(e.staffProcessed))}catch(t){console.error("Error generating roster:",t),alert(t.message||"Failed to generate roster")}finally{h(!1)}},disabled:m,className:"w-full px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded transition-colors disabled:opacity-50",children:m?"Generating...":"Generate Roster"})]})]}),"overview"===n&&(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white",children:"Roster Calendar View"}),(0,sa.jsxs)("div",{className:"flex gap-4 text-xs",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("div",{className:"w-4 h-4 bg-green-500/20 border border-green-500/50 rounded"}),(0,sa.jsx)("span",{className:"text-gray-400",children:"Working"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("div",{className:"w-4 h-4 bg-yellow-500/20 border border-yellow-500/50 rounded"}),(0,sa.jsx)("span",{className:"text-gray-400",children:"On Leave"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("div",{className:"w-4 h-4 bg-red-500/20 border border-red-500/50 rounded"}),(0,sa.jsx)("span",{className:"text-gray-400",children:"Off Day"})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:v.startDate,onChange:e=>w(t=>(0,i.A)((0,i.A)({},t),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:v.endDate,onChange:e=>w(t=>(0,i.A)((0,i.A)({},t),{},{endDate:e.target.value})),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,sa.jsx)("div",{className:"flex items-end",children:(0,sa.jsx)("button",{onClick:async()=>{try{h(!0);const e=await(0,jr.AT)("/clubs/".concat(a,"/roster/overview?startDate=").concat(v.startDate,"&endDate=").concat(v.endDate));e.success&&N(e)}catch(e){console.error("Error loading overview:",e),alert("Failed to load roster overview")}finally{h(!1)}},disabled:m,className:"px-6 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded transition-colors disabled:opacity-50",children:m?"Loading...":"Load"})})]}),j&&j.staff&&j.staff.length>0&&(0,sa.jsx)("div",{className:"mb-4",children:(0,sa.jsx)("input",{type:"text",placeholder:"Search staff by name...",value:S,onChange:e=>k(e.target.value),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500"})}),P.length>0&&(0,sa.jsx)("div",{className:"space-y-6",children:P.map(e=>(0,sa.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.staffName}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.staffRole})]}),(0,sa.jsx)("div",{className:"text-right",children:(0,sa.jsxs)("p",{className:"text-sm text-gray-300",children:[(0,sa.jsx)("span",{className:"text-green-400 font-semibold",children:e.workingDaysCount})," working",e.leaveDaysCount>0&&(0,sa.jsxs)(sa.Fragment,{children:[" \xb7 ",(0,sa.jsx)("span",{className:"text-yellow-400 font-semibold",children:e.leaveDaysCount})," on leave"]}),e.offDaysCount>0&&(0,sa.jsxs)(sa.Fragment,{children:[" \xb7 ",(0,sa.jsx)("span",{className:"text-red-400",children:e.offDaysCount})," off"]})]})})]}),(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("div",{className:"grid grid-cols-7 gap-2 min-w-[700px]",children:[mh.map(e=>(0,sa.jsx)("div",{className:"text-center py-2 text-xs font-semibold text-gray-400 border-b border-gray-600",children:e.short},e.value)),e.shifts.map(e=>{const t=e.isOffDay,s=e.onLeave;let a="bg-green-500/20 border-green-500/50",r="text-green-400";return s?(a="bg-yellow-500/20 border-yellow-500/50",r="text-yellow-400"):t&&(a="bg-red-500/20 border-red-500/50",r="text-red-400"),(0,sa.jsxs)("div",{className:"p-2 rounded text-center text-xs ".concat(a," border"),children:[(0,sa.jsx)("div",{className:"font-semibold mb-1 ".concat(r),children:new Date(e.date).getDate()}),s?(0,sa.jsx)("div",{className:"text-yellow-400 font-semibold text-[10px]",children:"ON LEAVE"}):t?(0,sa.jsx)("div",{className:"text-red-400 font-semibold",children:"OFF"}):(0,sa.jsxs)("div",{className:"text-gray-300",children:[(0,sa.jsx)("div",{children:e.startTime}),(0,sa.jsx)("div",{className:"text-gray-500 text-[8px]",children:"to"}),(0,sa.jsx)("div",{children:e.endTime})]})]},e.id)})]})}),e.defaultShiftTimes&&(0,sa.jsxs)("div",{className:"mt-3 text-xs text-gray-400",children:["Default: ",e.defaultShiftTimes.start," - ",e.defaultShiftTimes.end,e.defaultShiftTimes.crossesMidnight&&" (next day)"]})]},e.staffId))}),j&&(!j.staff||0===j.staff.length)&&(0,sa.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No roster data found for the selected period."}),0===P.length&&(null===j||void 0===j||null===(s=j.staff)||void 0===s?void 0:s.length)>0&&(0,sa.jsxs)("div",{className:"text-center py-12 text-gray-400",children:['No staff found matching "',S,'"']})]})}),b&&x&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,sa.jsx)("div",{className:"bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,sa.jsxs)("div",{className:"p-6",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white mb-6",children:[x.id?"Edit":"Create"," Roster Template"]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Staff Member"}),(0,sa.jsx)("input",{type:"text",value:"".concat(x.staffName," (").concat(x.staffRole,")"),disabled:!0,className:"w-full px-4 py-2 bg-gray-700 text-gray-400 rounded"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Shift Start Time"}),(0,sa.jsx)("input",{type:"time",value:x.defaultShiftStartTime,onChange:e=>p(t=>(0,i.A)((0,i.A)({},t),{},{defaultShiftStartTime:e.target.value})),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Shift End Time"}),(0,sa.jsx)("input",{type:"time",value:x.defaultShiftEndTime,onChange:e=>p(t=>(0,i.A)((0,i.A)({},t),{},{defaultShiftEndTime:e.target.value})),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),(0,sa.jsx)("div",{children:(0,sa.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",checked:x.shiftCrossesMidnight,onChange:e=>p(t=>(0,i.A)((0,i.A)({},t),{},{shiftCrossesMidnight:e.target.checked})),className:"rounded text-orange-600"}),(0,sa.jsx)("span",{className:"text-white",children:"Shift crosses midnight (ends next day)"})]})}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Weekly Off Days"}),(0,sa.jsx)("div",{className:"grid grid-cols-4 sm:grid-cols-7 gap-2",children:mh.map(e=>(0,sa.jsx)("button",{onClick:()=>{return t=e.value,void p(e=>{const s=e.offDays.includes(t)?e.offDays.filter(e=>e!==t):[...e.offDays,t].sort();return(0,i.A)((0,i.A)({},e),{},{offDays:s})});var t},className:"px-3 py-2 rounded transition-colors text-sm ".concat(x.offDays.includes(e.value)?"bg-orange-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"),children:e.short},e.value))}),(0,sa.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"These days will be marked as off days in the roster"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Notes (Optional)"}),(0,sa.jsx)("textarea",{value:x.notes||"",onChange:e=>p(t=>(0,i.A)((0,i.A)({},t),{},{notes:e.target.value})),rows:"3",className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Any additional notes about this roster template..."})]}),(0,sa.jsx)("div",{children:(0,sa.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,sa.jsx)("input",{type:"checkbox",checked:x.isActive,onChange:e=>p(t=>(0,i.A)((0,i.A)({},t),{},{isActive:e.target.checked})),className:"rounded text-orange-600"}),(0,sa.jsx)("span",{className:"text-white",children:"Active (will be used when generating roster)"})]})})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:async()=>{try{h(!0);const e={staffName:x.staffName,staffRole:x.staffRole,offDays:x.offDays,defaultShiftStartTime:x.defaultShiftStartTime+":00",defaultShiftEndTime:x.defaultShiftEndTime+":00",shiftCrossesMidnight:x.shiftCrossesMidnight,isActive:x.isActive,notes:x.notes||""};x.id?await(0,jr.AT)("/clubs/".concat(a,"/roster/templates/").concat(x.id),{method:"PATCH",body:JSON.stringify(e)}):(e.staffId=x.staffId,await(0,jr.AT)("/clubs/".concat(a,"/roster/templates"),{method:"POST",body:JSON.stringify(e)})),alert("Roster template saved successfully!"),g(!1),p(null),C()}catch(e){console.error("Error saving template:",e),alert(e.message||"Failed to save template")}finally{h(!1)}},disabled:m,className:"flex-1 px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded transition-colors disabled:opacity-50",children:m?"Saving...":"Save Template"}),(0,sa.jsx)("button",{onClick:()=>{g(!1),p(null)},className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"})]})]})})})]})}const xh=[{value:"Super Admin",label:"Super Admin"},{value:"Admin",label:"Admin"},{value:"Manager",label:"Manager"},{value:"HR",label:"HR"},{value:"GRE",label:"GRE (Guest Relations Executive)"},{value:"Cashier",label:"Cashier"},{value:"Affiliate",label:"Affiliate"},{value:"Dealer",label:"Dealer"},{value:"FNB",label:"FNB"},{value:"Staff",label:"Staff (Custom Role)"}];function ph(e){let{selectedClubId:t}=e;const s=ra(),[a,n]=(0,r.useState)("staff"),l=JSON.parse(localStorage.getItem("user")||"{}"),o="HR"===l.role,d="Admin"===l.role,c=o?xh.filter(e=>"Super Admin"!==e.value&&"Admin"!==e.value):d?xh.filter(e=>"Super Admin"!==e.value):xh,{data:u}=hn({queryKey:["club-data",t],queryFn:()=>jr.Od.getClub(t),enabled:!!t}),m=(null===u||void 0===u?void 0:u.pokerEnabled)&&(null===u||void 0===u?void 0:u.rummyEnabled),[h,x]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),[y,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)(!1),[N,S]=(0,r.useState)(null),[k,C]=(0,r.useState)(null),[A,_]=(0,r.useState)({role:"",status:"",search:"",sortBy:"createdAt",sortOrder:"DESC"}),[P,T]=(0,r.useState)({name:"",role:o?"Staff":d?"Admin":"Super Admin",email:"",phone:"",employeeId:"",customRoleName:"",gameType:"",aadharDocumentUrl:"",panDocumentUrl:"",baseSalary:"",salaryType:"Monthly"}),[E,I]=(0,r.useState)({reason:""}),[R,D]=(0,r.useState)(!1),[O,L]=(0,r.useState)(!1),{data:F,isLoading:M}=hn({queryKey:["staff-management",t,A],queryFn:()=>jr.staffAPI.getAllStaffMembers(t,A),enabled:!!t}),{data:B=[]}=hn({queryKey:["pendingLeaveApplications",t],queryFn:()=>jr.ie.getPendingLeaveApplications(t),enabled:!!t}),q=(null===B||void 0===B?void 0:B.length)||0,U=gn({mutationFn:e=>jr.staffAPI.createStaffMember(t,e),onSuccess:e=>{wr.success("Staff member created successfully!"),e.staff.tempPasswordPlainText&&(C({password:e.staff.tempPasswordPlainText,name:e.staff.name,email:e.staff.email,role:e.staff.role,affiliateCode:e.staff.affiliateCode,isReset:!1}),v(!0)),s.invalidateQueries(["staff-management",t]),x(!1),Q()},onError:e=>{wr.error(e.message||"Failed to create staff member")}}),z=gn({mutationFn:e=>{let{staffId:s,data:a}=e;return jr.staffAPI.updateStaffMember(t,s,a)},onSuccess:()=>{wr.success("Staff member updated successfully!"),s.invalidateQueries(["staff-management",t]),b(!1),S(null),Q()},onError:e=>{wr.error(e.message||"Failed to update staff member")}}),K=gn({mutationFn:e=>{let{staffId:s,reason:a}=e;return jr.staffAPI.suspendStaffMember(t,s,a)},onSuccess:()=>{wr.success("Staff member suspended successfully!"),s.invalidateQueries(["staff-management",t]),f(!1),S(null),I({reason:""})},onError:e=>{wr.error(e.message||"Failed to suspend staff member")}}),W=gn({mutationFn:e=>jr.staffAPI.reactivateStaffMember(t,e),onSuccess:()=>{wr.success("Staff member reactivated successfully!"),s.invalidateQueries(["staff-management",t])},onError:e=>{wr.error(e.message||"Failed to reactivate staff member")}}),H=gn({mutationFn:e=>jr.staffAPI.deleteStaffMember(t,e),onSuccess:()=>{wr.success("Staff member deleted successfully!"),s.invalidateQueries(["staff-management",t])},onError:e=>{wr.error(e.message||"Failed to delete staff member")}}),V=gn({mutationFn:async e=>{const s=await jr.staffAPI.resetStaffPassword(t,e),a=null===F||void 0===F?void 0:F.staff.find(t=>t.id===e);return(0,i.A)((0,i.A)({},s),{},{staff:a})},onSuccess:e=>{var t,s,a,r;wr.success("Password reset successfully!"),C({password:e.tempPassword,name:null===(t=e.staff)||void 0===t?void 0:t.name,email:null===(s=e.staff)||void 0===s?void 0:s.email,role:null===(a=e.staff)||void 0===a?void 0:a.role,affiliateCode:null===(r=e.staff)||void 0===r?void 0:r.affiliateCode,isReset:!0}),v(!0)},onError:e=>{wr.error(e.message||"Failed to reset password")}}),J=async(e,s)=>{"aadhar"===s?D(!0):L(!0);try{const a=await uh(e,t,"staff-kyc");T("aadhar"===s?(0,i.A)((0,i.A)({},P),{},{aadharDocumentUrl:a}):(0,i.A)((0,i.A)({},P),{},{panDocumentUrl:a})),wr.success("".concat("aadhar"===s?"Aadhar":"PAN"," card uploaded successfully"))}catch(a){wr.error("Failed to upload ".concat("aadhar"===s?"Aadhar":"PAN"," card"))}finally{"aadhar"===s?D(!1):L(!1)}},Q=()=>{T({name:"",role:o?"Staff":d?"Admin":"Super Admin",email:"",phone:"",employeeId:"",customRoleName:"",gameType:"",aadharDocumentUrl:"",panDocumentUrl:"",baseSalary:"",salaryType:"Monthly"})},G=(null===F||void 0===F?void 0:F.staff)||[],Y=e=>{switch(e){case"Active":return"bg-green-500/20 text-green-300 border-green-500";case"Suspended":return"bg-red-500/20 text-red-300 border-red-500";case"On Break":return"bg-yellow-500/20 text-yellow-300 border-yellow-500";default:return"bg-gray-500/20 text-gray-300 border-gray-500"}};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Staff Management"}),"staff"===a&&(0,sa.jsx)("button",{onClick:()=>x(!0),className:"bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-400 hover:to-pink-500 text-white px-6 py-3 rounded-lg font-semibold shadow-lg transition-all",children:"\u2795 Create Staff"})]}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>n("staff"),className:"px-6 py-3 font-semibold transition-colors ".concat("staff"===a?"text-white border-b-2 border-purple-500":"text-gray-400 hover:text-white"),children:"Staff Members"}),(0,sa.jsx)("button",{onClick:()=>n("roster"),className:"px-6 py-3 font-semibold transition-colors ".concat("roster"===a?"text-white border-b-2 border-purple-500":"text-gray-400 hover:text-white"),children:"Roster Management"}),(0,sa.jsx)("button",{onClick:()=>n("leave"),className:"px-6 py-3 font-semibold transition-colors relative ".concat("leave"===a?"text-white border-b-2 border-purple-500":"text-gray-400 hover:text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center gap-2",children:["Leave Management",q>0&&(0,sa.jsx)("span",{className:"bg-amber-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:q>9?"9+":q})]})})]}),"roster"===a&&(0,sa.jsx)(hh,{selectedClubId:t}),"leave"===a&&t&&(0,sa.jsx)(nh,{clubId:t}),"staff"===a&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Role"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:A.role,onChange:e=>_((0,i.A)((0,i.A)({},A),{},{role:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Roles"}),xh.map(e=>(0,sa.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Status"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:A.status,onChange:e=>_((0,i.A)((0,i.A)({},A),{},{status:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Status"}),(0,sa.jsx)("option",{value:"Active",children:"Active"}),(0,sa.jsx)("option",{value:"Suspended",children:"Suspended"}),(0,sa.jsx)("option",{value:"On Break",children:"On Break"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Sort By"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:A.sortBy,onChange:e=>_((0,i.A)((0,i.A)({},A),{},{sortBy:e.target.value})),children:[(0,sa.jsx)("option",{value:"createdAt",children:"Date Created"}),(0,sa.jsx)("option",{value:"name",children:"Name"}),(0,sa.jsx)("option",{value:"role",children:"Role"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Name, email, phone...",value:A.search,onChange:e=>_((0,i.A)((0,i.A)({},A),{},{search:e.target.value}))})]})]})}),M?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading staff..."})]}):0===G.length?(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 text-center border border-slate-700",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udc65"}),(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Staff Members Yet"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Create your first staff member to get started"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 gap-4",children:G.map(e=>(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 hover:border-purple-600 transition-all",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white",children:e.name}),(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold border ".concat(Y(e.status)),children:e.status}),(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold bg-purple-500/20 text-purple-300 border border-purple-500",children:"Staff"===e.role&&e.customRoleName?e.customRoleName:e.role}),"poker"===e.gameType?(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold bg-indigo-500/20 text-indigo-300 border border-indigo-500",children:"\u2660 Poker"}):"rummy"===e.gameType?(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold bg-amber-500/20 text-amber-300 border border-amber-500",children:"\ud83c\udccf Rummy"}):(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold bg-slate-500/20 text-slate-300 border border-slate-500",children:"\ud83c\udfaf General"}),e.affiliateCode&&(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-mono font-semibold bg-yellow-500/20 text-yellow-300 border border-yellow-500",children:e.affiliateCode})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Email"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:e.email})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Phone"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:e.phone})]}),e.employeeId&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Employee ID"}),(0,sa.jsx)("p",{className:"text-white font-mono font-semibold",children:e.employeeId})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Created"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]}),Number(e.baseSalary||0)>0&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"Salary"}),(0,sa.jsxs)("p",{className:"text-green-400 font-semibold",children:["\u20b9",Number(e.baseSalary).toFixed(0)," / ",e.salaryType||"Monthly"]})]})]}),"Suspended"===e.status&&e.suspendedReason&&(0,sa.jsx)("div",{className:"mt-3 bg-red-900/30 border border-red-500/50 rounded-lg p-3",children:(0,sa.jsxs)("p",{className:"text-sm text-red-300",children:[(0,sa.jsx)("strong",{children:"Suspension Reason:"})," ",e.suspendedReason]})})]}),(0,sa.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{S(e),j(!0)})(e),className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"View"}),!o&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>(e=>{S(e),T({name:e.name,role:e.role,email:e.email,phone:e.phone,employeeId:e.employeeId||"",customRoleName:e.customRoleName||"",gameType:e.gameType||"",aadharDocumentUrl:e.aadharDocumentUrl||"",panDocumentUrl:e.panDocumentUrl||"",baseSalary:e.baseSalary||"",salaryType:e.salaryType||"Monthly"}),b(!0)})(e),className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Edit"}),"Active"===e.status&&(0,sa.jsx)("button",{onClick:()=>(e=>{S(e),f(!0)})(e),className:"bg-orange-600 hover:bg-orange-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Suspend"}),"Suspended"===e.status&&(0,sa.jsx)("button",{onClick:()=>(e=>{window.confirm("Reactivate ".concat(e.name,"?"))&&W.mutate(e.id)})(e),className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Reactivate"}),(0,sa.jsx)("button",{onClick:()=>(e=>{window.confirm("Reset password for ".concat(e.name,"?"))&&V.mutate(e.id)})(e),className:"bg-yellow-600 hover:bg-yellow-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Reset Password"}),(0,sa.jsx)("button",{onClick:()=>(e=>{window.confirm("Are you sure you want to delete ".concat(e.name,"? This action cannot be undone."))&&H.mutate(e.id)})(e),className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Delete"})]})]})]})},e.id))}),h&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full border border-purple-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Create New Staff Member"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Full Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"John Doe",value:P.name,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{name:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Role *"}),(0,sa.jsx)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:P.role,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{role:e.target.value})),children:c.map(e=>(0,sa.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),"Staff"===P.role&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Role Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"e.g., Security, Maintenance, etc.",value:P.customRoleName,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{customRoleName:e.target.value}))})]}),("Dealer"===P.role||"Manager"===P.role)&&(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"text-white text-sm mb-1 block",children:["Game Type ",m?"*":"(Optional)"]}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:P.gameType,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{gameType:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"General (No specific game)"}),(0,sa.jsx)("option",{value:"poker",children:"\u2660 Poker"}),(0,sa.jsx)("option",{value:"rummy",children:"\ud83c\udccf Rummy"})]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Dealer"===P.role?"Dealer will only be assigned to tables of this game type":"Manager will manage tables of this game type"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Email *"}),(0,sa.jsx)("input",{type:"email",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"john@example.com",value:P.email,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{email:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Phone *"}),(0,sa.jsx)("input",{type:"tel",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"+91 1234567890",value:P.phone,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{phone:e.target.value}))})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Employee ID (Optional)"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"EMP001",value:P.employeeId,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{employeeId:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Base Salary (Optional)"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"0.00",value:P.baseSalary,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{baseSalary:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Salary Type"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:P.salaryType,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{salaryType:e.target.value})),children:[(0,sa.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,sa.jsx)("option",{value:"Weekly",children:"Weekly"})]})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Aadhar Card"}),(0,sa.jsx)("input",{type:"file",accept:"image/*,application/pdf",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",onChange:e=>e.target.files[0]&&J(e.target.files[0],"aadhar"),disabled:R}),R&&(0,sa.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Uploading..."}),P.aadharDocumentUrl&&(0,sa.jsx)("p",{className:"text-sm text-green-400 mt-1",children:"\u2713 Uploaded"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"PAN Card"}),(0,sa.jsx)("input",{type:"file",accept:"image/*,application/pdf",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",onChange:e=>e.target.files[0]&&J(e.target.files[0],"pan"),disabled:O}),O&&(0,sa.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Uploading..."}),P.panDocumentUrl&&(0,sa.jsx)("p",{className:"text-sm text-green-400 mt-1",children:"\u2713 Uploaded"})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{if(!P.name||!P.email||!P.phone)return void wr.error("Please fill in all required fields");if("Staff"===P.role&&!P.customRoleName)return void wr.error("Please enter a custom role name");if(m&&("Dealer"===P.role||"Manager"===P.role)&&!P.gameType)return void wr.error("Please select a game type for this "+P.role.toLowerCase());if(!P.aadharDocumentUrl)return void wr.error("Aadhar document is required to create a staff member");if(!P.panDocumentUrl)return void wr.error("PAN document is required to create a staff member");const e=(0,i.A)({},P);e.baseSalary?e.baseSalary=Number(e.baseSalary):delete e.baseSalary,U.mutate(e)},disabled:U.isLoading,className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:U.isLoading?"Creating...":"Create Staff Member"}),(0,sa.jsx)("button",{onClick:()=>{x(!1),Q()},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),p&&N&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full border border-blue-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Edit Staff Member"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Full Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",value:P.name,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{name:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Email *"}),(0,sa.jsx)("input",{type:"email",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",value:P.email,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{email:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Phone *"}),(0,sa.jsx)("input",{type:"tel",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",value:P.phone,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{phone:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Employee ID"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",value:P.employeeId,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{employeeId:e.target.value}))})]})]}),"Staff"===P.role&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Role Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",value:P.customRoleName,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{customRoleName:e.target.value}))})]}),("Dealer"===P.role||"Manager"===P.role)&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Game Type"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",value:P.gameType,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{gameType:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"General (No specific game)"}),(0,sa.jsx)("option",{value:"poker",children:"\u2660 Poker"}),(0,sa.jsx)("option",{value:"rummy",children:"\ud83c\udccf Rummy"})]}),(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Assign a specific game to this ",P.role.toLowerCase()]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Base Salary"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",placeholder:"0.00",value:P.baseSalary,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{baseSalary:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Salary Type"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",value:P.salaryType,onChange:e=>T((0,i.A)((0,i.A)({},P),{},{salaryType:e.target.value})),children:[(0,sa.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,sa.jsx)("option",{value:"Weekly",children:"Weekly"})]})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{P.name&&P.email&&P.phone?P.aadharDocumentUrl?P.panDocumentUrl?z.mutate({staffId:N.id,data:P}):wr.error("PAN document is required. Cannot remove PAN document."):wr.error("Aadhar document is required. Cannot remove Aadhar document."):wr.error("Please fill in all required fields")},disabled:z.isLoading,className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:z.isLoading?"Updating...":"Update Staff Member"}),(0,sa.jsx)("button",{onClick:()=>{b(!1),S(null),Q()},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),g&&N&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-orange-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Suspend Staff Member"}),(0,sa.jsxs)("p",{className:"text-gray-300 mb-4",children:["You are about to suspend ",(0,sa.jsx)("strong",{children:N.name}),". Please provide a reason:"]}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500 h-32",placeholder:"Enter suspension reason (minimum 5 characters)",value:E.reason,onChange:e=>I({reason:e.target.value})}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{!E.reason||E.reason.length<5?wr.error("Please provide a reason (minimum 5 characters)"):K.mutate({staffId:N.id,reason:E.reason})},disabled:K.isLoading,className:"flex-1 bg-orange-600 hover:bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:K.isLoading?"Suspending...":"Suspend"}),(0,sa.jsx)("button",{onClick:()=>{f(!1),S(null),I({reason:""})},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),y&&k&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-green-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:k.isReset?"Password Reset Successfully!":"Staff Member Created Successfully!"}),(0,sa.jsxs)("div",{className:"bg-green-900/30 border border-green-500/50 rounded-lg p-4 mb-4",children:[(0,sa.jsxs)("p",{className:"text-white mb-2",children:[(0,sa.jsx)("strong",{children:"Name:"})," ",k.name]}),(0,sa.jsxs)("p",{className:"text-white mb-2",children:[(0,sa.jsx)("strong",{children:"Role:"})," ",k.role]}),(0,sa.jsxs)("p",{className:"text-white mb-2",children:[(0,sa.jsx)("strong",{children:"Email:"})," ",k.email]}),k.affiliateCode&&(0,sa.jsxs)("p",{className:"text-yellow-300 mb-2 font-mono",children:[(0,sa.jsx)("strong",{children:"Affiliate Code:"})," ",k.affiliateCode]}),(0,sa.jsx)("p",{className:"text-white mb-2",children:(0,sa.jsx)("strong",{children:"Temporary Password:"})}),(0,sa.jsx)("div",{className:"bg-slate-700 rounded p-3 font-mono text-lg text-center text-green-300 select-all",children:k.password})]}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400 mb-4",children:["\u26a0\ufe0f Please save this password and share it with the staff member."," ",k.isReset?"They will be required to reset it on next login.":"They will be required to reset it on first login. This password will not be shown again."]}),(0,sa.jsx)("button",{onClick:()=>{v(!1),C(null)},className:"w-full bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:"I've Saved the Password"})]})}),w&&N&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full border border-purple-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Staff Member Details"}),(0,sa.jsx)("button",{onClick:()=>{j(!1),S(null)},className:"text-gray-400 hover:text-white text-2xl",children:"\xd7"})]}),(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 border-b border-slate-600 pb-2",children:"Basic Information"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Full Name"}),(0,sa.jsx)("p",{className:"text-white font-semibold text-lg",children:N.name})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Role"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:"Staff"===N.role&&N.customRoleName?N.customRoleName:N.role})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Email"}),(0,sa.jsx)("p",{className:"text-white",children:N.email})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Phone"}),(0,sa.jsx)("p",{className:"text-white",children:N.phone})]}),N.employeeId&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Employee ID"}),(0,sa.jsx)("p",{className:"text-white font-mono",children:N.employeeId})]}),N.affiliateCode&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Affiliate Code"}),(0,sa.jsx)("p",{className:"text-yellow-300 font-mono font-bold text-lg",children:N.affiliateCode})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Status"}),(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold border ".concat(Y(N.status)),children:N.status})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Game Type"}),(0,sa.jsx)("p",{children:"poker"===N.gameType?(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold bg-indigo-500/20 text-indigo-300 border border-indigo-500",children:"\u2660 Poker"}):"rummy"===N.gameType?(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold bg-amber-500/20 text-amber-300 border border-amber-500",children:"\ud83c\udccf Rummy"}):(0,sa.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold bg-slate-500/20 text-slate-300 border border-slate-500",children:"\ud83c\udfaf General"})})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Created At"}),(0,sa.jsx)("p",{className:"text-white",children:new Date(N.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Base Salary"}),(0,sa.jsx)("p",{className:"text-green-400 font-semibold",children:Number(N.baseSalary||0)>0?"\u20b9".concat(Number(N.baseSalary).toFixed(2)," / ").concat(N.salaryType||"Monthly"):"Not Set"})]})]}),"Suspended"===N.status&&N.suspendedReason&&(0,sa.jsxs)("div",{className:"mt-4 bg-red-900/30 border border-red-500/50 rounded-lg p-4",children:[(0,sa.jsxs)("p",{className:"text-sm text-red-300",children:[(0,sa.jsx)("strong",{children:"Suspension Reason:"})," ",N.suspendedReason]}),N.suspendedAt&&(0,sa.jsxs)("p",{className:"text-sm text-red-300 mt-2",children:[(0,sa.jsx)("strong",{children:"Suspended At:"})," ",new Date(N.suspendedAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 border-b border-slate-600 pb-2",children:"KYC Documents"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"Aadhar Card"}),N.aadharDocumentUrl?(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsx)("div",{className:"bg-slate-600 rounded-lg p-4 border border-slate-500",children:(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"text-2xl",children:"\ud83c\udd94"}),(0,sa.jsx)("span",{className:"text-white",children:"Aadhar Card"})]}),(0,sa.jsx)("span",{className:"text-green-400 text-sm",children:"\u2713 Uploaded"})]})}),(0,sa.jsx)("a",{href:N.aadharDocumentUrl,target:"_blank",rel:"noopener noreferrer",className:"block w-full bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors text-center",children:"View Document"}),(0,sa.jsx)("a",{href:N.aadharDocumentUrl,download:!0,className:"block w-full bg-slate-600 hover:bg-slate-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors text-center",children:"Download Document"})]}):(0,sa.jsx)("div",{className:"bg-slate-600 rounded-lg p-4 border border-slate-500 border-dashed",children:(0,sa.jsx)("p",{className:"text-gray-400 text-center",children:"No Aadhar card uploaded"})})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"PAN Card"}),N.panDocumentUrl?(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsx)("div",{className:"bg-slate-600 rounded-lg p-4 border border-slate-500",children:(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc4"}),(0,sa.jsx)("span",{className:"text-white",children:"PAN Card"})]}),(0,sa.jsx)("span",{className:"text-green-400 text-sm",children:"\u2713 Uploaded"})]})}),(0,sa.jsx)("a",{href:N.panDocumentUrl,target:"_blank",rel:"noopener noreferrer",className:"block w-full bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors text-center",children:"View Document"}),(0,sa.jsx)("a",{href:N.panDocumentUrl,download:!0,className:"block w-full bg-slate-600 hover:bg-slate-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors text-center",children:"Download Document"})]}):(0,sa.jsx)("div",{className:"bg-slate-600 rounded-lg p-4 border border-slate-500 border-dashed",children:(0,sa.jsx)("p",{className:"text-gray-400 text-center",children:"No PAN card uploaded"})})]})]})]}),(N.aadharDocumentUrl||N.panDocumentUrl)&&(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 border-b border-slate-600 pb-2",children:"Document Preview"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N.aadharDocumentUrl&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"Aadhar Card Preview"}),(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 border border-slate-600",children:[N.aadharDocumentUrl.match(/\.(jpg|jpeg|png|gif|webp)$/i)?(0,sa.jsx)("img",{src:N.aadharDocumentUrl,alt:"Aadhar Card",className:"w-full h-auto rounded-lg max-h-64 object-contain",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"}}):null,(0,sa.jsxs)("div",{style:{display:"none"},className:"text-center text-gray-400 py-8",children:[(0,sa.jsx)("p",{className:"text-lg mb-2",children:"\ud83d\udcc4"}),(0,sa.jsx)("p",{children:'PDF Document - Click "View Document" to open'})]})]})]}),N.panDocumentUrl&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"PAN Card Preview"}),(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 border border-slate-600",children:[N.panDocumentUrl.match(/\.(jpg|jpeg|png|gif|webp)$/i)?(0,sa.jsx)("img",{src:N.panDocumentUrl,alt:"PAN Card",className:"w-full h-auto rounded-lg max-h-64 object-contain",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"}}):null,(0,sa.jsxs)("div",{style:{display:"none"},className:"text-center text-gray-400 py-8",children:[(0,sa.jsx)("p",{className:"text-lg mb-2",children:"\ud83d\udcc4"}),(0,sa.jsx)("p",{children:'PDF Document - Click "View Document" to open'})]})]})]})]})]})]}),(0,sa.jsx)("div",{className:"mt-6 flex justify-end",children:(0,sa.jsx)("button",{onClick:()=>{j(!1),S(null)},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Close"})})]})})]})]})}function bh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(1),[n,l]=(0,r.useState)({search:"",startDate:"",endDate:"",staffId:""}),{data:o,isLoading:d}=hn({queryKey:["salary-payments",t,s,n],queryFn:async()=>await jr.Od.getSalaryPayments(t,(0,i.A)({page:s,limit:10},n)),enabled:!!t}),c=(null===o||void 0===o?void 0:o.payments)||[],u=(null===o||void 0===o?void 0:o.totalPages)||1,m=(null===o||void 0===o?void 0:o.total)||0,h=e=>"\u20b9".concat((e||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}));return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Salary History"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"View-only: Salary payment history for all employees"}),!t&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view salary history."})}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700 space-y-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsx)("input",{type:"text",placeholder:"Search by staff name...",value:n.search,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{search:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500"}),(0,sa.jsx)("input",{type:"date",placeholder:"Start Date",value:n.startDate,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{startDate:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500"}),(0,sa.jsx)("input",{type:"date",placeholder:"End Date",value:n.endDate,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{endDate:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500"}),(0,sa.jsx)("button",{onClick:()=>l({search:"",startDate:"",endDate:"",staffId:""}),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded-lg text-white transition-colors",children:"Clear Filters"})]})}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:d?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading salary history..."})]}):0===c.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udcb0"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No salary payments found"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"p-4 text-sm text-gray-400 flex justify-between items-center",children:(0,sa.jsxs)("span",{children:["Showing ",10*(s-1)+1,"-",Math.min(10*s,m)," of ",m," payments"]})}),(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Staff Name"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Pay Period"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Base Salary"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Overtime"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Deductions"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Gross Amount"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Net Amount"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Payment Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:c.map(e=>{var t,s;return(0,sa.jsxs)("tr",{className:"hover:bg-slate-750",children:[(0,sa.jsx)("td",{className:"px-6 py-4 font-medium",children:(null===(t=e.staff)||void 0===t?void 0:t.name)||"N/A"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.payPeriod||"-"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-white",children:h(e.baseSalary)}),(0,sa.jsx)("td",{className:"px-6 py-4 text-white",children:h(e.overtimeAmount)}),(0,sa.jsx)("td",{className:"px-6 py-4 text-red-400",children:h(e.deductions)}),(0,sa.jsx)("td",{className:"px-6 py-4 text-white font-medium",children:h(e.grossAmount)}),(0,sa.jsx)("td",{className:"px-6 py-4 text-green-400 font-bold",children:h(e.netAmount)}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:(s=e.paymentDate,s?new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-")}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("Processed"===e.status?"bg-green-600/20 text-green-400":"bg-yellow-600/20 text-yellow-400"),children:e.status||"Processed"})})]},e.id)})})]}),u>1&&(0,sa.jsxs)("div",{className:"p-4 border-t border-slate-700 flex items-center justify-between",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Page ",s," of ",u]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>a(e=>Math.max(1,e-1)),disabled:1===s,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>a(e=>Math.min(u,e+1)),disabled:s>=u,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-600 transition-colors",children:"Next"})]})]})]})})]})}function gh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("daily"),[n,l]=(0,r.useState)(!1),o=(()=>{const e=new Intl.DateTimeFormat("en-CA",{timeZone:hm}).formatToParts(new Date),t=t=>{var s;return(null===(s=e.find(e=>e.type===t))||void 0===s?void 0:s.value)||""};return"".concat(t("year"),"-").concat(t("month"),"-").concat(t("day"))})(),[d,c]=(0,r.useState)({staffId:"",loginDate:o,loginTime:"",logoutDate:o,logoutTime:"",notes:""}),u=ra(),[m,h]=(0,r.useState)({startDate:(new Date).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0],searchTerm:""}),[x,p]=(0,r.useState)((new Date).toISOString().split("T")[0]),[b,g]=(0,r.useState)({}),[f,y]=(0,r.useState)({}),{data:v}=hn({queryKey:["staff-list",t],queryFn:()=>jr.staffAPI.getAllStaffMembers(t,{status:"Active"}),enabled:!!t}),w=(null===v||void 0===v?void 0:v.staff)||[],{data:j=[],isLoading:N}=hn({queryKey:["attendance",t,m.startDate,m.endDate],queryFn:()=>jr.Od.getAttendanceRecords(t,m.startDate,m.endDate),enabled:!!t&&"records"===s}),S=(0,r.useMemo)(()=>{if(!m.searchTerm.trim())return j;const e=m.searchTerm.toLowerCase().trim();return j.filter(t=>{const s=(t.staffName||"").toLowerCase(),a=(t.staffEmail||t.email||"").toLowerCase();return s.includes(e)||a.includes(e)})},[j,m.searchTerm]),{data:k}=hn({queryKey:["attendanceStats",t,m.startDate,m.endDate],queryFn:()=>jr.Od.getAttendanceStats(t,m.startDate,m.endDate),enabled:!!t&&"records"===s}),{data:C=[],isLoading:A,refetch:_}=hn({queryKey:["daily-roster",t,x],queryFn:()=>jr.Od.getDailyRoster(t,x),enabled:!!t&&"daily"===s,onSuccess:e=>{const t={};e.forEach(e=>{e.alreadyLogged||e.isOnLeave||(t[e.staffId]=!1)}),g(t),y({})}}),P=gn({mutationFn:async e=>{const s=e.loginDate&&e.loginTime?"".concat(e.loginDate,"T").concat(e.loginTime,":00"):null,a=e.logoutDate&&e.logoutTime?"".concat(e.logoutDate,"T").concat(e.logoutTime,":00"):null,r={staffId:e.staffId,date:e.loginDate,loginTime:s,logoutTime:a};return e.notes&&e.notes.trim()&&(r.notes=e.notes.trim()),await jr.Od.createAttendanceRecord(t,r)},onSuccess:()=>{wr.success("Attendance record created successfully!"),u.invalidateQueries(["attendance",t]),u.invalidateQueries(["attendanceStats",t]),u.invalidateQueries(["daily-roster",t]),l(!1);const e=(new Date).toISOString().split("T")[0];c({staffId:"",loginDate:e,loginTime:"",logoutDate:e,logoutTime:"",notes:""})},onError:e=>{wr.error(e.message||"Failed to create attendance record")}}),T=gn({mutationFn:async e=>await jr.Od.bulkCreateAttendance(t,e),onSuccess:e=>{wr.success("Attendance marked: ".concat(e.created," created, ").concat(e.skipped," skipped")),u.invalidateQueries(["daily-roster",t]),u.invalidateQueries(["attendance",t]),u.invalidateQueries(["attendanceStats",t]),g({}),y({})},onError:e=>{wr.error(e.message||"Failed to submit bulk attendance")}}),E=e=>e?new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"}):"-",I=(e,t)=>{if(!e||!t)return"-";const s=new Date(e);return((new Date(t)-s)/36e5).toFixed(2)},R=C.filter(e=>!e.alreadyLogged&&!e.isOnLeave),D=Object.values(b).filter(Boolean).length,O=()=>{const e={};R.forEach(t=>{e[t.staffId]=!0}),g(e)},L=()=>{const e={};R.forEach(t=>{e[t.staffId]=!1}),g(e)},F=(e,t,s)=>{y(a=>(0,i.A)((0,i.A)({},a),{},{[e]:(0,i.A)((0,i.A)({},a[e]||{}),{},{[t]:s})}))};return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Attendance Management"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Track login and logout times for all employees"})]}),(0,sa.jsx)("button",{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white px-6 py-3 rounded-lg font-semibold transition-all shadow-lg hover:shadow-xl",children:"+ Manual Entry"})]}),!t&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view attendance records."})}),(0,sa.jsx)("div",{className:"flex gap-2 border-b border-slate-700 pb-2",children:[{id:"daily",label:"Daily Attendance"},{id:"records",label:"Records & Stats"}].map(e=>(0,sa.jsx)("button",{onClick:()=>a(e.id),className:"px-6 py-3 rounded-t-lg font-semibold transition-colors ".concat(s===e.id?"bg-blue-600 text-white":"bg-slate-800 text-gray-400 hover:text-white hover:bg-slate-700"),children:e.label},e.id))}),"daily"===s&&t&&(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700 flex flex-wrap items-center gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-sm text-gray-400 block mb-1",children:"Date"}),(0,sa.jsx)("input",{type:"date",value:x,onChange:e=>p(e.target.value),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500"})]}),(0,sa.jsxs)("div",{className:"flex gap-2 items-end mt-auto",children:[(0,sa.jsxs)("button",{onClick:O,className:"px-4 py-2 bg-green-700 hover:bg-green-600 text-white rounded-lg font-medium transition-colors",children:["Mark All Present (",R.length,")"]}),(0,sa.jsx)("button",{onClick:L,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"Unmark All"})]}),(0,sa.jsxs)("div",{className:"ml-auto flex items-center gap-4",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,sa.jsx)("span",{className:"text-white font-bold",children:D})," / ",R.length," selected"]}),(0,sa.jsx)("button",{onClick:()=>{const e=Object.entries(b).filter(e=>{let[t,s]=e;return s}).map(e=>{let[t]=e;return t});if(0===e.length)return void wr.error("Please select at least one staff member");const t=e.map(e=>{const t=f[e];return(null===t||void 0===t?void 0:t.loginTime)&&(null===t||void 0===t?void 0:t.logoutTime)?{staffId:e,date:x,loginTime:"".concat(x,"T").concat(t.loginTime,":00"),logoutTime:"".concat(x,"T").concat(t.logoutTime,":00"),useShiftTimes:!1}:{staffId:e,date:x,useShiftTimes:!0}});T.mutate(t)},disabled:0===D||T.isLoading,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:T.isLoading?"Submitting...":"Submit Attendance (".concat(D,")")})]})]}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:A?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading staff roster..."})]}):0===C.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udc65"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No active staff found"})]}):(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase w-12",children:(0,sa.jsx)("input",{type:"checkbox",checked:R.length>0&&D===R.length,onChange:()=>{D===R.length?L():O()},className:"w-4 h-4 rounded bg-slate-600 border-slate-500 text-blue-600 focus:ring-blue-500"})}),(0,sa.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Staff Name"}),(0,sa.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Role"}),(0,sa.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Shift Times"}),(0,sa.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"}),(0,sa.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Custom Login"}),(0,sa.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Custom Logout"})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:C.map(e=>{const t=e.alreadyLogged||e.isOnLeave||e.isOffDay,s=b[e.staffId]||!1,a=f[e.staffId]||{};let r;return r=e.alreadyLogged?(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-green-600/20 text-green-400 border border-green-500/30",children:"Already Logged"}):e.isOnLeave?(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-yellow-600/20 text-yellow-400 border border-yellow-500/30",children:"On Leave"}):e.isOffDay?(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-gray-600/20 text-gray-400 border border-gray-500/30",children:"Off Day"}):s?(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-blue-600/20 text-blue-400 border border-blue-500/30",children:"Present"}):(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-slate-600/20 text-gray-500 border border-slate-500/30",children:"Pending"}),(0,sa.jsxs)("tr",{className:"hover:bg-slate-750 ".concat(t?"opacity-60":""," ").concat(s?"bg-blue-900/10":""),children:[(0,sa.jsx)("td",{className:"px-4 py-3",children:(0,sa.jsx)("input",{type:"checkbox",checked:s,onChange:()=>{return t=e.staffId,void g(e=>(0,i.A)((0,i.A)({},e),{},{[t]:!e[t]}));var t},disabled:t,className:"w-4 h-4 rounded bg-slate-600 border-slate-500 text-blue-600 focus:ring-blue-500 disabled:opacity-40"})}),(0,sa.jsxs)("td",{className:"px-4 py-3",children:[(0,sa.jsx)("div",{className:"font-medium",children:e.staffName}),e.employeeId&&(0,sa.jsx)("div",{className:"text-xs text-gray-500",children:e.employeeId})]}),(0,sa.jsx)("td",{className:"px-4 py-3 text-gray-400",children:e.staffRole}),(0,sa.jsx)("td",{className:"px-4 py-3 text-gray-400 text-sm",children:e.hasShift&&!e.isOffDay?(0,sa.jsxs)("span",{children:[E(e.shiftStartTime)," - ",E(e.shiftEndTime)]}):e.isOffDay?(0,sa.jsx)("span",{className:"text-gray-500 italic",children:"Off Day"}):(0,sa.jsx)("span",{className:"text-gray-500 italic",children:"No shift"})}),(0,sa.jsx)("td",{className:"px-4 py-3",children:r}),(0,sa.jsxs)("td",{className:"px-4 py-3",children:[!t&&(0,sa.jsx)("input",{type:"time",value:a.loginTime||"",onChange:t=>F(e.staffId,"loginTime",t.target.value),className:"px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm focus:ring-2 focus:ring-blue-500 w-28",placeholder:"Custom"}),e.alreadyLogged&&(0,sa.jsx)("span",{className:"text-green-400 text-sm",children:E(e.loginTime)})]}),(0,sa.jsxs)("td",{className:"px-4 py-3",children:[!t&&(0,sa.jsx)("input",{type:"time",value:a.logoutTime||"",onChange:t=>F(e.staffId,"logoutTime",t.target.value),className:"px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm focus:ring-2 focus:ring-blue-500 w-28",placeholder:"Custom"}),e.alreadyLogged&&(0,sa.jsx)("span",{className:"text-red-400 text-sm",children:E(e.logoutTime)})]})]},e.staffId)})})]})})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[(0,sa.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"How it works:"}),(0,sa.jsxs)("ul",{className:"text-sm text-gray-400 space-y-1 list-disc list-inside",children:[(0,sa.jsxs)("li",{children:["Check the box next to staff members who are ",(0,sa.jsx)("strong",{className:"text-white",children:"present"})," today."]}),(0,sa.jsxs)("li",{children:["If ",(0,sa.jsx)("strong",{className:"text-white",children:"no custom times"})," are entered, their ",(0,sa.jsx)("strong",{className:"text-white",children:"shift times"})," will be used as login/logout."]}),(0,sa.jsxs)("li",{children:["Enter ",(0,sa.jsx)("strong",{className:"text-white",children:"custom login/logout times"})," to override shift timings for specific staff."]}),(0,sa.jsx)("li",{children:"Staff already logged, on leave, or on off day are automatically skipped."}),(0,sa.jsxs)("li",{children:["Click ",(0,sa.jsx)("strong",{className:"text-white",children:'"Mark All Present"'})," to select all eligible staff at once."]})]})]})]}),"records"===s&&t&&(0,sa.jsxs)("div",{className:"space-y-6",children:[k&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Total Records"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:k.totalRecords||0})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Active Sessions"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-blue-400",children:k.activeSessions||0})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Completed Sessions"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-green-400",children:k.completedSessions||0})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Avg Hours/Day"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-purple-400",children:k.avgHours||"0.00"})]})]}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsx)("input",{type:"date",placeholder:"Start Date",value:m.startDate,onChange:e=>h((0,i.A)((0,i.A)({},m),{},{startDate:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500"}),(0,sa.jsx)("input",{type:"date",placeholder:"End Date",value:m.endDate,onChange:e=>h((0,i.A)((0,i.A)({},m),{},{endDate:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500"}),(0,sa.jsx)("input",{type:"text",placeholder:"Search by staff name or email...",value:m.searchTerm,onChange:e=>h((0,i.A)((0,i.A)({},m),{},{searchTerm:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500"}),(0,sa.jsx)("button",{onClick:()=>{const e=(new Date).toISOString().split("T")[0];h({startDate:e,endDate:e,searchTerm:""})},className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded-lg text-white transition-colors",children:"Reset to Today"})]})}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:N?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading attendance records..."})]}):0===S.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\u23f0"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No attendance records found"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{className:"p-4 text-sm text-gray-400",children:["Showing ",S.length," attendance record(s)"]}),(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Staff Name"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Role"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Login Time"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Logout Time"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Total Hours"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:S.map(e=>(0,sa.jsxs)("tr",{className:"hover:bg-slate-750",children:[(0,sa.jsx)("td",{className:"px-6 py-4 font-medium",children:e.staffName}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:e.staffRole||"-"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-gray-400",children:M(e.date)}),(0,sa.jsx)("td",{className:"px-6 py-4 text-green-400 font-medium",children:E(e.loginTime)}),(0,sa.jsx)("td",{className:"px-6 py-4 text-red-400 font-medium",children:e.logoutTime?E(e.logoutTime):"-"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-white font-medium",children:e.totalHours?"".concat(e.totalHours," hrs"):"-"!==I(e.loginTime,e.logoutTime)?"".concat(I(e.loginTime,e.logoutTime)," hrs"):"-"}),(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("active"===e.status?"bg-blue-600/20 text-blue-400":"completed"===e.status?"bg-green-600/20 text-green-400":"bg-yellow-600/20 text-yellow-400"),children:"active"===e.status?"Active":"completed"===e.status?"Completed":"Incomplete"})})]},e.id))})]})})]})})]}),n&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-2xl w-full border border-blue-600 shadow-2xl max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Create Attendance Record"}),(0,sa.jsx)("button",{onClick:()=>{l(!1);const e=(new Date).toISOString().split("T")[0];c({staffId:"",loginDate:e,loginTime:"",logoutDate:e,logoutTime:"",notes:""})},className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!d.staffId||!d.loginDate||!d.loginTime||!d.logoutDate||!d.logoutTime)return void wr.error("Please fill in all required fields");const t=new Date("".concat(d.loginDate,"T").concat(d.loginTime));new Date("".concat(d.logoutDate,"T").concat(d.logoutTime))<=t?wr.error("Logout date & time must be after login date & time"):P.mutate(d)},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Staff Member *"}),(0,sa.jsxs)("select",{value:d.staffId,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{staffId:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,sa.jsx)("option",{value:"",children:"Select Staff Member"}),w.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name," - ",e.role||"Staff"," ",e.employeeId?"(".concat(e.employeeId,")"):""]},e.id))]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Login Date & Time *"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Login Date"}),(0,sa.jsx)("input",{type:"date",value:d.loginDate,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{loginDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Login Time"}),(0,sa.jsx)("input",{type:"time",value:d.loginTime,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{loginTime:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",required:!0})]})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Logout Date & Time *"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Logout Date"}),(0,sa.jsx)("input",{type:"date",value:d.logoutDate,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{logoutDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",min:d.loginDate,required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Logout Time"}),(0,sa.jsx)("input",{type:"time",value:d.logoutTime,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{logoutTime:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",required:!0})]})]})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Notes (Optional)"}),(0,sa.jsx)("textarea",{value:d.notes,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{notes:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Additional notes..."})]}),(0,sa.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{l(!1);const e=(new Date).toISOString().split("T")[0];c({staffId:"",loginDate:e,loginTime:"",logoutDate:e,logoutTime:"",notes:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:P.isLoading,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white font-medium py-3 rounded-lg transition-all disabled:opacity-50",children:P.isLoading?"Creating...":"Create Attendance"})]})]})]})})]});function M(e){return e?new Date(e).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-"}}function fh(e){let{activeItem:t,setActiveItem:s,menuItems:a=[],onSignOut:n=null}=e;const[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(window.innerWidth<1024),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),p=(0,r.useRef)(null),b=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useRef)(null),y=localStorage.getItem("clubId");od(y);const{data:v}=hn({queryKey:["unreadNotificationCount",y,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(y,"staff"),enabled:!!y}),{data:w}=hn({queryKey:["unreadChatCounts",y],queryFn:()=>jr.h2.getUnreadCounts(y),enabled:!!y}),j=((null===w||void 0===w?void 0:w.staffChats)||0)+((null===w||void 0===w?void 0:w.playerChats)||0),{data:N=[]}=hn({queryKey:["pendingLeaveApplications",y],queryFn:()=>jr.ie.getPendingLeaveApplications(y),enabled:!!y}),S=(null===N||void 0===N?void 0:N.length)||0;(0,r.useEffect)(()=>{const e=(null===v||void 0===v?void 0:v.unreadCount)||0;if(null!==p.current&&e>p.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}p.current=e},[null===v||void 0===v?void 0:v.unreadCount]),(0,r.useEffect)(()=>{const e=S;if(null!==b.current&&e>b.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}b.current=e},[S]),(0,r.useEffect)(()=>{const e=(null===w||void 0===w?void 0:w.staffChats)||0;if(null!==g.current&&e>g.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}g.current=e},[null===w||void 0===w?void 0:w.staffChats]),(0,r.useEffect)(()=>{const e=(null===w||void 0===w?void 0:w.playerChats)||0;if(null!==f.current&&e>f.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}f.current=e},[null===w||void 0===w?void 0:w.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;c(e),e||o(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(l&&d){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[l,d]);const{data:k}=hn({queryKey:["club",y],queryFn:()=>jr.Od.getClub(y),enabled:!!y}),C=JSON.parse(localStorage.getItem("user")||"{}"),A=C.email||"hr@pokerroom.com",_=C.displayName||"HR Manager",P=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e)),m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}});return(0,sa.jsxs)(sa.Fragment,{children:[d&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-purple-500 to-pink-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),d&&l&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>o(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] bg-gradient-to-b from-purple-500/20 via-pink-600/30 to-rose-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(d?l?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-300 to-rose-400 drop-shadow-lg mb-6",children:"HR Portal"}),(0,sa.jsxs)("div",{onClick:()=>m(!0),className:"flex items-center text-white min-w-0 cursor-pointer hover:opacity-90 transition-opacity p-2 -m-2 rounded-lg",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:(0,sa.jsx)("span",{className:"text-gray-900 font-bold text-sm",children:"HR"})}),(0,sa.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold truncate",children:_}),(0,sa.jsx)("div",{className:"text-sm opacity-80 truncate",children:A})]})]}),u&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]",onClick:()=>m(!1),children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full mx-4 border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Enter your current and new password"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),A?h.currentPassword&&h.newPassword&&h.confirmPassword?h.newPassword===h.confirmPassword?h.newPassword.length<8?wr.error("Password must be at least 8 characters"):P.mutate({email:A,currentPassword:h.currentPassword,newPassword:h.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:h.currentPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:h.newPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:h.confirmPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:P.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:P.isLoading?"Resetting...":"Reset Password"})]})]})]})}),document.body),k&&k.code&&(0,sa.jsx)("div",{className:"mb-6",children:(0,sa.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-300 font-semibold mb-1",children:"\ud83c\udfae Club Code"}),(0,sa.jsx)("div",{className:"text-emerald-100 font-mono text-lg font-bold tracking-wider text-center",children:k.code}),(0,sa.jsx)("div",{className:"text-xs text-emerald-400 mt-1 text-center",children:"Players use this to sign up"})]})})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:a.map((e,a)=>(0,sa.jsx)("button",{onClick:()=>{s(e),d&&o(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-purple-400 to-pink-600 text-gray-900 font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-purple-400/20 hover:to-pink-500/20 text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between",children:[(0,sa.jsx)("span",{className:"block truncate",children:e}),"Notifications"===e&&(null===v||void 0===v?void 0:v.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:v.unreadCount>9?"9+":v.unreadCount}),"Chat"===e&&j>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:j>9?"9+":j}),"Staff Management"===e&&S>0&&(0,sa.jsx)("span",{className:"ml-2 bg-amber-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:S>9?"9+":S})]})},a))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})})]})}function yh(){const[e,t]=(0,r.useState)("Staff Management"),s=me(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("hruser")||"{}");(e.mustResetPassword||t.mustResetPassword)&&n(!0)},[]);const d=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("hruser")||"{}");t.mustResetPassword=!1,localStorage.setItem("hruser",JSON.stringify(t)),n(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),c=a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("hruser")||"{}"),a=t.email||s.email;a?l.currentPassword&&l.newPassword&&l.confirmPassword?l.newPassword===l.confirmPassword?l.newPassword.length<8?wr.error("Password must be at least 8 characters"):d.mutate({email:a,currentPassword:l.currentPassword,newPassword:l.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:l.currentPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:l.newPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:l.confirmPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:d.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:d.isLoading?"Resetting...":"Reset Password"})]})]})}),[u,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=localStorage.getItem("clubId");e&&m(e)},[]);const h=[{id:"S001",name:"Sarah Johnson",position:"Dealer",department:"Operations",email:"sarah.j@email.com",phone:"+91 98765 43210",startDate:"2024-01-15",status:"Active",documents:[{type:"PAN Card",status:"Verified",uploadedDate:"2024-01-10"},{type:"Aadhaar Card",status:"Verified",uploadedDate:"2024-01-10"},{type:"ID Card",status:"Verified",uploadedDate:"2024-01-15"},{type:"Medical Certificate",status:"Verified",uploadedDate:"2024-01-12"}]},{id:"S002",name:"Mike Chen",position:"Floor Manager",department:"Operations",email:"mike.c@email.com",phone:"+91 98765 43211",startDate:"2023-11-20",status:"Active",documents:[{type:"PAN Card",status:"Verified",uploadedDate:"2023-11-15"},{type:"Passport",status:"Verified",uploadedDate:"2023-11-15"},{type:"Experience Certificate",status:"Pending Review",uploadedDate:"2024-01-20"},{type:"ID Card",status:"Verified",uploadedDate:"2023-11-20"}]},{id:"S003",name:"Emma Davis",position:"Cashier",department:"Operations",email:"emma.d@email.com",phone:"+91 98765 43212",startDate:"2024-02-01",status:"On Leave",documents:[{type:"PAN Card",status:"Verified",uploadedDate:"2024-01-28"},{type:"Aadhaar Card",status:"Verified",uploadedDate:"2024-01-28"},{type:"Medical Certificate",status:"Verified",uploadedDate:"2024-02-01"},{type:"ID Card",status:"Verified",uploadedDate:"2024-02-01"}]},{id:"S004",name:"John Smith",position:"Security",department:"Security",email:"john.s@email.com",phone:"+91 98765 43213",startDate:"2023-12-10",status:"Active",documents:[{type:"PAN Card",status:"Verified",uploadedDate:"2023-12-05"},{type:"Driving License",status:"Verified",uploadedDate:"2023-12-05"},{type:"ID Card",status:"Verified",uploadedDate:"2023-12-10"}]},{id:"S005",name:"David Wilson",position:"Dealer",department:"Operations",email:"david.w@email.com",phone:"+91 98765 43214",startDate:"2024-01-20",status:"Active",documents:[{type:"PAN Card",status:"Verified",uploadedDate:"2024-01-18"},{type:"ID Card",status:"Verified",uploadedDate:"2024-01-20"}]},{id:"S006",name:"Lisa Brown",position:"Kitchen Staff",department:"Kitchen",email:"lisa.b@email.com",phone:"+91 98765 43215",startDate:"2024-02-05",status:"Active",documents:[{type:"PAN Card",status:"Verified",uploadedDate:"2024-02-03"},{type:"Aadhaar Card",status:"Verified",uploadedDate:"2024-02-03"},{type:"ID Card",status:"Verified",uploadedDate:"2024-02-05"}]}],[x]=(0,r.useState)((new Date).toISOString().split("T")[0]),[p,b]=(0,r.useState)(()=>h.map(e=>({staffId:e.id,staffName:e.name,position:e.position,department:e.department,date:x,loginTime:"",logoutTime:"",status:"pending"}))),[g,f]=(0,r.useState)([{id:"SR001",staffId:"S001",staffName:"Sarah Johnson",requestType:"leave",subject:"Leave Application",message:"I need to take leave on 2024-01-25 for personal reasons.",leaveStartDate:"2024-01-25",leaveEndDate:"2024-01-26",leaveType:"Personal Leave",status:"pending",submittedDate:new Date(Date.now()-1728e5).toISOString(),hrResponse:null},{id:"SR002",staffId:"S002",staffName:"Mike Chen",requestType:"chat",subject:"Need to discuss schedule",message:"Can we discuss my upcoming schedule change?",status:"in_progress",submittedDate:new Date(Date.now()-864e5).toISOString(),hrResponse:"Sure, let's schedule a meeting."},{id:"SR003",staffId:"S003",staffName:"Emma Davis",requestType:"leave",subject:"Medical Leave Request",message:"I need medical leave for upcoming surgery.",leaveStartDate:"2024-02-05",leaveEndDate:"2024-02-10",leaveType:"Medical Leave",status:"approved",submittedDate:new Date(Date.now()-432e6).toISOString(),hrResponse:"Approved. Please submit medical certificate."}]),[y,v]=(0,r.useState)("all"),[w,j]=(0,r.useState)(null),[N,S]=(0,r.useState)(""),[k,C]=(0,r.useState)("pending"),[A,_]=(0,r.useState)(null),[P,T]=(0,r.useState)(!1),[E,I]=(0,r.useState)(""),[R,D]=(0,r.useState)(null),[O,L]=(0,r.useState)(""),[F,M]=(0,r.useState)([{id:1,name:"Rahul Sharma",documentType:"PAN Card",docUrl:"#",status:"Pending",submittedDate:"2024-02-20",playerId:"P001",documentNumber:"ABCDE1234F",email:"rahul@example.com",phone:"+91 9876543210"},{id:2,name:"Priya Patel",documentType:"Aadhaar",docUrl:"#",status:"Pending",submittedDate:"2024-02-21",playerId:"P002",documentNumber:"1234 5678 9012",email:"priya@example.com",phone:"+91 9876543211"}]),[B,q]=(0,r.useState)([{id:1,name:"Amit Kumar",playerId:"P003",fields:[{field:"Phone Number",oldValue:"+91 9876543210",newValue:"+91 9123456780"},{field:"Address",oldValue:"Old Address",newValue:"New Address"}],status:"Pending",requestedDate:"2024-02-22"},{id:2,name:"Sneha Gupta",playerId:"P004",fields:[{field:"Email",oldValue:"sneha.old@test.com",newValue:"sneha.new@test.com"}],status:"Pending",requestedDate:"2024-02-23"}]),[U,z]=(0,r.useState)([{id:"P001",name:"John Doe",email:"john.doe@example.com",phone:"+91 9876543210",status:"Active",kycStatus:"Verified",registrationDate:"2024-01-15",referredBy:"Agent X",balance:5e3},{id:"P002",name:"Jane Smith",email:"jane.smith@example.com",phone:"+91 9876543211",status:"Active",kycStatus:"Pending",registrationDate:"2024-01-10",referredBy:"Agent Y",balance:2500},{id:"P003",name:"Rajesh Kumar",email:"rajesh@example.com",phone:"+91 9876543212",status:"Suspended",kycStatus:"Verified",registrationDate:"2024-01-08",referredBy:"Agent Z",balance:0},{id:"P004",name:"Priya Sharma",email:"priya@example.com",phone:"+91 9876543213",status:"Pending Approval",kycStatus:"Pending",registrationDate:"2024-01-20",referredBy:"Agent A",balance:0}]),[K,W]=(0,r.useState)([{id:1,name:"Rajesh Kumar",email:"rajesh@example.com",phone:"+91 9876543212",registrationDate:"2024-02-18",status:"Pending",referredBy:"Agent X"},{id:2,name:"Meera Singh",email:"meera@example.com",phone:"+91 9876543213",registrationDate:"2024-02-19",status:"Pending",referredBy:"Agent Y"}]),[H,V]=(0,r.useState)([{id:1,name:"Vikram Patel",email:"vikram@example.com",reason:"Suspicious Activity",suspensionDate:"2024-02-15",status:"Suspended",duration:"temporary",suspensionDays:7}]),[J,Q]=(0,r.useState)([{id:"PC001",playerId:"P001",playerName:"Alex Johnson",status:"open",lastMessage:"Need assistance with account",lastMessageTime:new Date(Date.now()-18e4).toISOString(),messages:[{id:"M1",sender:"player",senderName:"Alex Johnson",text:"Need assistance with account",timestamp:new Date(Date.now()-18e4).toISOString()}],createdAt:new Date(Date.now()-6e5).toISOString()}]),[G,Y]=(0,r.useState)([{id:"SC001",staffId:"ST001",staffName:"Sarah Johnson",staffRole:"Dealer",status:"open",lastMessage:"Need assistance with schedule",lastMessageTime:new Date(Date.now()-3e5).toISOString(),messages:[{id:"M3",sender:"staff",senderName:"Sarah Johnson",text:"Need assistance with schedule",timestamp:new Date(Date.now()-3e5).toISOString()}],createdAt:new Date(Date.now()-3e5).toISOString()}]);(0,r.useEffect)(()=>{const e=(new Date).toISOString().split("T")[0];x!==e&&b(h.map(t=>({staffId:t.id,staffName:t.name,position:t.position,department:t.department,date:e,loginTime:"",logoutTime:"",status:"pending"})))},[x]);const $="all"===y?g:g.filter(e=>e.status===y),Z=(e,t)=>{_(s=>{const a=[...s.documents];return a[e]=(0,i.A)((0,i.A)({},a[e]),{},{status:t}),(0,i.A)((0,i.A)({},s),{},{documents:a})});h.map(s=>{if(s.id===A.id){const a=[...s.documents];return a[e]=(0,i.A)((0,i.A)({},a[e]),{},{status:t}),(0,i.A)((0,i.A)({},s),{},{documents:a})}return s});alert('Document status updated to "'.concat(t,'"'))};(0,r.useEffect)(()=>{A||(T(!1),I(""),D(null),L(""))},[A]);const X=()=>{localStorage.clear(),sessionStorage.clear(),s("/hr/signin")};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white font-sans",children:[(0,sa.jsxs)("div",{className:"flex",children:[(0,sa.jsx)(fh,{activeItem:e,setActiveItem:t,menuItems:["Staff Management","Notifications","Salary History","Attendance Management","Chat"],onSignOut:X}),(0,sa.jsx)("main",{className:"flex-1 lg:ml-0 min-w-0",children:(0,sa.jsxs)("div",{className:"mx-auto max-w-[1400px] px-4 sm:px-6 py-6 sm:py-10 space-y-8",children:[(0,sa.jsxs)("header",{className:"bg-gradient-to-r from-purple-600 via-pink-500 to-rose-400 p-6 rounded-xl shadow-md flex justify-between items-center mt-16 lg:mt-0",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h1",{className:"text-2xl font-bold text-white",children:["HR Portal - ",e]}),(0,sa.jsx)("p",{className:"text-gray-200 mt-1",children:"Staff management, attendance, and performance"})]}),(0,sa.jsx)("button",{onClick:X,className:"bg-red-600 hover:bg-red-500 text-white font-semibold px-4 py-2 rounded-lg shadow",children:"Sign Out"})]}),"Staff Management"===e&&(0,sa.jsxs)(sa.Fragment,{children:[u&&(0,sa.jsx)(fm,{selectedClubId:u}),(0,sa.jsx)(ph,{selectedClubId:u})]}),"Salary History"===e&&(0,sa.jsx)(bh,{selectedClubId:u}),"Attendance Management"===e&&(0,sa.jsx)(gh,{selectedClubId:u}),"Chat"===e&&(0,sa.jsx)($u,{clubId:u,hidePlayerChat:!0}),"Notifications"===e&&u&&(0,sa.jsx)(bm,{selectedClubId:u,recipientType:"staff"}),!1,"Staff Directory"===e&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-cyan-600/30 via-blue-500/20 to-indigo-700/30 rounded-xl shadow-md border border-cyan-800/40",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Staff Directory"}),(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(e=>(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg border border-blue-400/30",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.name}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-sm ".concat("Active"===e.status?"bg-green-500/30 text-green-300":"bg-yellow-500/30 text-yellow-300"),children:e.status})]}),(0,sa.jsxs)("div",{className:"space-y-1",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Position: ",e.position]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Department: ",e.department]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Email: ",e.email]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Phone: ",e.phone]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Start Date: ",e.startDate]})]}),(0,sa.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,sa.jsx)("button",{className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded text-sm",children:"Edit"}),(0,sa.jsx)("button",{onClick:()=>_(e),className:"bg-purple-600 hover:bg-purple-500 text-white px-3 py-1 rounded text-sm",children:"View Details"})]})]},e.id))})]}),A&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 via-gray-900 to-black rounded-xl shadow-2xl border border-purple-500/30 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("div",{className:"p-6 border-b border-white/10",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Staff Details"}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Complete information for ",A.name]})]}),(0,sa.jsx)("button",{onClick:()=>_(null),className:"text-white/70 hover:text-white text-2xl font-bold",children:"\xd7"})]})}),(0,sa.jsxs)("div",{className:"p-6 space-y-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 border-b border-white/10 pb-2",children:"Basic Information"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Staff ID"}),(0,sa.jsx)("div",{className:"text-white font-medium",children:A.id})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Full Name"}),(0,sa.jsx)("div",{className:"text-white font-medium",children:A.name})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Position"}),(0,sa.jsx)("div",{className:"text-white font-medium",children:A.position})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Department"}),(0,sa.jsx)("div",{className:"text-white font-medium",children:A.department})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Email"}),(0,sa.jsx)("div",{className:"text-white font-medium",children:A.email})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Phone"}),(0,sa.jsx)("div",{className:"text-white font-medium",children:A.phone})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Start Date"}),(0,sa.jsx)("div",{className:"text-white font-medium",children:A.startDate})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-sm",children:"Status"}),(0,sa.jsx)("div",{children:(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs border font-medium ".concat("Active"===A.status?"bg-green-500/30 text-green-300 border-green-400/50":"bg-yellow-500/30 text-yellow-300 border-yellow-400/50"),children:A.status})})]})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-4 border-b border-white/10 pb-2",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Document Management"}),(0,sa.jsx)("button",{onClick:()=>T(!P),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:P?"Cancel Upload":"\u2795 Upload Document"})]}),P&&(0,sa.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg border border-indigo-400/30 mb-4",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold mb-4",children:"Upload New Document"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Document Type"}),(0,sa.jsxs)(CustomSelect,{className:"w-full",value:E,onChange:e=>I(e.target.value),children:[(0,sa.jsx)("option",{value:"",children:"Select Document Type"}),(0,sa.jsx)("option",{value:"ID Card",children:"ID Card"}),(0,sa.jsx)("option",{value:"PAN Card",children:"PAN Card"}),(0,sa.jsx)("option",{value:"Aadhaar Card",children:"Aadhaar Card"}),(0,sa.jsx)("option",{value:"Passport",children:"Passport"}),(0,sa.jsx)("option",{value:"Driving License",children:"Driving License"}),(0,sa.jsx)("option",{value:"Educational Certificate",children:"Educational Certificate"}),(0,sa.jsx)("option",{value:"Experience Certificate",children:"Experience Certificate"}),(0,sa.jsx)("option",{value:"Medical Certificate",children:"Medical Certificate"}),(0,sa.jsx)("option",{value:"Contract Document",children:"Contract Document"}),(0,sa.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Upload Document"}),(0,sa.jsxs)("div",{className:"mt-1 border-2 border-dashed border-white/30 rounded-lg p-6 text-center hover:border-indigo-400/50 transition-colors",children:[(0,sa.jsx)("input",{type:"file",id:"document-upload",className:"hidden",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{const t=e.target.files[0];t&&(D(t),L(t.name),t.size>10485760&&(alert("File size should be less than 10MB"),D(null),L(""),e.target.value=""))}}),(0,sa.jsxs)("label",{htmlFor:"document-upload",className:"cursor-pointer",children:[(0,sa.jsx)("div",{className:"text-white mb-2",children:O?"\ud83d\udcc4 ".concat(O):"Click to upload or drag and drop"}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:"PNG, JPG, PDF up to 10MB"})]})]})]}),(0,sa.jsx)("button",{onClick:()=>{if(!E||!R)return void alert("Please select document type and upload a file");const e={type:E,status:"Pending Review",uploadedDate:(new Date).toISOString().split("T")[0]};_(t=>(0,i.A)((0,i.A)({},t),{},{documents:[...t.documents||[],e]}));h.map(t=>t.id===A.id?(0,i.A)((0,i.A)({},t),{},{documents:[...t.documents||[],e]}):t);alert('Document "'.concat(E,'" uploaded successfully for ').concat(A.name)),I(""),D(null),L(""),T(!1)},className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-semibold",children:"Upload Document"})]})]}),A.documents&&A.documents.length>0?(0,sa.jsx)("div",{className:"space-y-3",children:A.documents.map((e,t)=>(0,sa.jsx)("div",{className:"bg-white/5 p-4 rounded-lg border border-white/10",children:(0,sa.jsxs)("div",{className:"flex items-start justify-between",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,sa.jsx)("div",{className:"text-white font-medium",children:e.type}),(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs border font-medium ".concat("Verified"===e.status?"bg-green-500/30 text-green-300 border-green-400/50":"Pending Review"===e.status?"bg-yellow-500/30 text-yellow-300 border-yellow-400/50":"bg-red-500/30 text-red-300 border-red-400/50"),children:e.status})]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Uploaded: ",e.uploadedDate]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,sa.jsx)("button",{onClick:()=>alert("Viewing document: ".concat(e.type)),className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded text-sm",children:"\ud83d\udc41\ufe0f View"}),(0,sa.jsx)("button",{onClick:()=>alert("Downloading document: ".concat(e.type)),className:"bg-purple-600 hover:bg-purple-500 text-white px-3 py-1 rounded text-sm",children:"\u2b07\ufe0f Download"}),"Verified"!==e.status&&(0,sa.jsx)("button",{onClick:()=>Z(t,"Verified"),className:"bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded text-sm",children:"\u2713 Verify"}),"Pending Review"===e.status&&(0,sa.jsx)("button",{onClick:()=>Z(t,"Rejected"),className:"bg-red-600 hover:bg-red-500 text-white px-3 py-1 rounded text-sm",children:"\u2717 Reject"}),"Verified"===e.status&&(0,sa.jsx)("button",{onClick:()=>Z(t,"Pending Review"),className:"bg-yellow-600 hover:bg-yellow-500 text-white px-3 py-1 rounded text-sm",children:"\u21bb Reset"})]})]})},t))}):(0,sa.jsxs)("div",{className:"text-center py-8 text-gray-400 border border-white/10 rounded-lg bg-white/5",children:[(0,sa.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udcc4"}),(0,sa.jsx)("div",{children:"No documents uploaded yet"}),(0,sa.jsx)("div",{className:"text-sm mt-2",children:'Click "Upload Document" to add a new document'})]})]}),(0,sa.jsx)("div",{className:"flex gap-3 pt-4 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:()=>_(null),className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white px-4 py-3 rounded-lg font-semibold",children:"Close"})})]})]})})]}),"Staff Requests"===e&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-blue-600/30 via-indigo-500/20 to-purple-700/30 rounded-xl shadow-md border border-blue-800/40",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Staff Requests & Applications"}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Filter by Status"}),(0,sa.jsxs)(CustomSelect,{className:"w-full md:w-64",value:y,onChange:e=>v(e.target.value),children:[(0,sa.jsx)("option",{value:"all",children:"All Requests"}),(0,sa.jsx)("option",{value:"pending",children:"Pending"}),(0,sa.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,sa.jsx)("option",{value:"approved",children:"Approved"}),(0,sa.jsx)("option",{value:"rejected",children:"Rejected"})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4",children:["Staff Requests (",$.length,")"]}),(0,sa.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:$.length>0?$.map(e=>(0,sa.jsxs)("div",{onClick:()=>{j(e),S(e.hrResponse||""),C(e.status)},className:"p-4 rounded-lg border cursor-pointer transition-all ".concat((null===w||void 0===w?void 0:w.id)===e.id?"bg-gradient-to-r from-blue-500/30 to-purple-500/30 border-blue-400/50":"bg-white/5 border-white/10 hover:bg-white/10"),children:[(0,sa.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:e.staffName}),(0,sa.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["ID: ",e.staffId]})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("approved"===e.status?"bg-green-500/30 text-green-300":"rejected"===e.status?"bg-red-500/30 text-red-300":"in_progress"===e.status?"bg-blue-500/30 text-blue-300":"bg-yellow-500/30 text-yellow-300"),children:"approved"===e.status?"Approved":"rejected"===e.status?"Rejected":"in_progress"===e.status?"In Progress":"Pending"})]}),(0,sa.jsx)("div",{className:"text-sm text-white font-medium mb-1",children:"leave"===e.requestType?"\ud83d\udcc5 Leave Application":"\ud83d\udcac Chat Request"}),(0,sa.jsxs)("div",{className:"text-xs text-gray-300 mb-1",children:["Subject: ",e.subject]}),"leave"===e.requestType&&(0,sa.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Leave: ",e.leaveStartDate," to ",e.leaveEndDate," (",e.leaveType,")"]}),(0,sa.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["Submitted: ",new Date(e.submittedDate).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})]})]},e.id)):(0,sa.jsxs)("div",{className:"text-center py-12 text-gray-400",children:["No ","all"!==y?y:""," requests found"]})})]}),(0,sa.jsx)("div",{className:"bg-white/10 p-4 rounded-lg",children:w?(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Request Details"}),(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Staff Member"}),(0,sa.jsxs)("div",{className:"text-white font-medium",children:[w.staffName," (ID: ",w.staffId,")"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Request Type"}),(0,sa.jsx)("div",{className:"text-white",children:"leave"===w.requestType?"\ud83d\udcc5 Leave Application":"\ud83d\udcac Chat Request"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Subject"}),(0,sa.jsx)("div",{className:"text-white",children:w.subject})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Message"}),(0,sa.jsx)("div",{className:"text-white bg-white/5 p-3 rounded border border-white/10",children:w.message})]}),"leave"===w.requestType&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Leave Type"}),(0,sa.jsx)("div",{className:"text-white",children:w.leaveType})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Start Date"}),(0,sa.jsx)("div",{className:"text-white",children:w.leaveStartDate})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"End Date"}),(0,sa.jsx)("div",{className:"text-white",children:w.leaveEndDate})]})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Submitted"}),(0,sa.jsx)("div",{className:"text-white",children:new Date(w.submittedDate).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]})]})]}),w.hrResponse&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-gray-400 text-xs",children:"Previous HR Response"}),(0,sa.jsx)("div",{className:"text-white bg-blue-500/20 p-3 rounded border border-blue-400/30",children:w.hrResponse})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"HR Response"}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded text-white placeholder-gray-400",rows:"4",placeholder:"Enter your response...",value:N,onChange:e=>S(e.target.value)})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Status"}),(0,sa.jsxs)(CustomSelect,{className:"w-full",value:k,onChange:e=>C(e.target.value),children:[(0,sa.jsx)("option",{value:"pending",children:"Pending"}),(0,sa.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,sa.jsx)("option",{value:"approved",children:"Approved"}),(0,sa.jsx)("option",{value:"rejected",children:"Rejected"})]})]}),(0,sa.jsx)("button",{onClick:()=>{w&&N.trim()?(f(e=>e.map(e=>e.id===w.id?(0,i.A)((0,i.A)({},e),{},{hrResponse:N.trim(),status:k}):e)),alert("Request ".concat("approved"===k?"approved":"rejected"===k?"rejected":"updated"," successfully")),j(null),S(""),C("pending")):alert("Please enter a response")},className:"w-full bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold",children:"Submit Response"})]}):(0,sa.jsx)("div",{className:"flex items-center justify-center h-full min-h-[400px] text-gray-400",children:(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udccb"}),(0,sa.jsx)("div",{className:"text-lg",children:"Select a request to view details and respond"})]})})})]})]}),(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-purple-600/30 via-pink-500/20 to-rose-700/30 rounded-xl shadow-md border border-purple-800/40",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Request Summary"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg text-center",children:[(0,sa.jsx)("div",{className:"text-2xl font-bold text-yellow-300",children:g.filter(e=>"pending"===e.status).length}),(0,sa.jsx)("div",{className:"text-sm text-gray-300 mt-1",children:"Pending"})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg text-center",children:[(0,sa.jsx)("div",{className:"text-2xl font-bold text-blue-300",children:g.filter(e=>"in_progress"===e.status).length}),(0,sa.jsx)("div",{className:"text-sm text-gray-300 mt-1",children:"In Progress"})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg text-center",children:[(0,sa.jsx)("div",{className:"text-2xl font-bold text-green-300",children:g.filter(e=>"approved"===e.status).length}),(0,sa.jsx)("div",{className:"text-sm text-gray-300 mt-1",children:"Approved"})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg text-center",children:[(0,sa.jsx)("div",{className:"text-2xl font-bold text-red-300",children:g.filter(e=>"rejected"===e.status).length}),(0,sa.jsx)("div",{className:"text-sm text-gray-300 mt-1",children:"Rejected"})]})]})]})]}),"Performance Reviews"===e&&(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-orange-600/30 via-red-500/20 to-pink-700/30 rounded-xl shadow-md border border-orange-800/40",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Performance Reviews"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Schedule Review"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm",children:"Staff Member"}),(0,sa.jsxs)("select",{className:"w-full mt-1 px-3 py-2 bg-white/10 border border-white/20 rounded text-white",children:[(0,sa.jsx)("option",{children:"Sarah Johnson - Dealer"}),(0,sa.jsx)("option",{children:"Mike Chen - Floor Manager"}),(0,sa.jsx)("option",{children:"Emma Davis - Cashier"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm",children:"Review Type"}),(0,sa.jsxs)("select",{className:"w-full mt-1 px-3 py-2 bg-white/10 border border-white/20 rounded text-white",children:[(0,sa.jsx)("option",{children:"Monthly Review"}),(0,sa.jsx)("option",{children:"Quarterly Review"}),(0,sa.jsx)("option",{children:"Annual Review"}),(0,sa.jsx)("option",{children:"Probation Review"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm",children:"Review Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full mt-1 px-3 py-2 bg-white/10 border border-white/20 rounded text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm",children:"Reviewer"}),(0,sa.jsxs)("select",{className:"w-full mt-1 px-3 py-2 bg-white/10 border border-white/20 rounded text-white",children:[(0,sa.jsx)("option",{children:"HR Manager"}),(0,sa.jsx)("option",{children:"Operations Manager"}),(0,sa.jsx)("option",{children:"General Manager"})]})]}),(0,sa.jsx)("button",{className:"w-full bg-orange-600 hover:bg-orange-500 text-white px-4 py-2 rounded-lg font-semibold",children:"Schedule Review"})]})]}),(0,sa.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Upcoming Reviews"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("div",{className:"bg-orange-500/20 p-3 rounded-lg border border-orange-400/30",children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:"Sarah Johnson"}),(0,sa.jsx)("div",{className:"text-sm text-gray-300",children:"Monthly Review - Due: 2024-01-25"}),(0,sa.jsx)("div",{className:"text-xs text-orange-300",children:"Status: Scheduled"})]}),(0,sa.jsxs)("div",{className:"bg-orange-500/20 p-3 rounded-lg border border-orange-400/30",children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:"Mike Chen"}),(0,sa.jsx)("div",{className:"text-sm text-gray-300",children:"Quarterly Review - Due: 2024-02-01"}),(0,sa.jsx)("div",{className:"text-xs text-orange-300",children:"Status: Pending"})]}),(0,sa.jsxs)("div",{className:"bg-orange-500/20 p-3 rounded-lg border border-orange-400/30",children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:"Emma Davis"}),(0,sa.jsx)("div",{className:"text-sm text-gray-300",children:"Probation Review - Due: 2024-02-15"}),(0,sa.jsx)("div",{className:"text-xs text-orange-300",children:"Status: Scheduled"})]})]})]})]})]})})]})})]}),c]})}const vh=["Dashboard","Notifications","Payroll Management","Bonus Management","Tables & Waitlist","Club Buy-In","Push Notifications","Tournaments","Chat","Transactions"];function wh(e){let{activeItem:t,setActiveItem:s,menuItems:a=vh,onSignOut:n=null}=e;const[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(window.innerWidth<1024),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),p=(0,r.useRef)(null),b=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useRef)(null),y=localStorage.getItem("clubId");od(y);const{data:v}=hn({queryKey:["unreadNotificationCount",y,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(y,"staff"),enabled:!!y}),{data:w}=hn({queryKey:["myApprovedLeaves",y],queryFn:()=>jr.ie.getMyLeaveApplications(y,{status:"Approved"}),enabled:!!y}),j=(null===w||void 0===w?void 0:w.total)||0,{data:N}=hn({queryKey:["unreadChatCounts",y],queryFn:()=>jr.h2.getUnreadCounts(y),enabled:!!y}),S=((null===N||void 0===N?void 0:N.staffChats)||0)+((null===N||void 0===N?void 0:N.playerChats)||0);(0,r.useEffect)(()=>{const e=(null===v||void 0===v?void 0:v.unreadCount)||0;if(null!==p.current&&e>p.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}p.current=e},[null===v||void 0===v?void 0:v.unreadCount]),(0,r.useEffect)(()=>{if(null!==b.current&&j>b.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e)),wr.success("\ud83c\udf89 Your leave request has been approved!",{duration:5e3})}b.current=j},[j]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.staffChats)||0;if(null!==g.current&&e>g.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}g.current=e},[null===N||void 0===N?void 0:N.staffChats]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.playerChats)||0;if(null!==f.current&&e>f.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}f.current=e},[null===N||void 0===N?void 0:N.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;c(e),e||o(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(l&&d){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[l,d]);const{data:k}=hn({queryKey:["club",y],queryFn:()=>jr.Od.getClub(y),enabled:!!y}),C=JSON.parse(localStorage.getItem("user")||"{}"),A=C.email||"cashier@pokerroom.com",_=C.displayName||C.name||A.split("@")[0],P=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e)),m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}});return(0,sa.jsxs)(sa.Fragment,{children:[d&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-green-500 to-emerald-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),d&&l&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>o(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] bg-gradient-to-b from-green-500/20 via-emerald-600/30 to-teal-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(d?l?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-green-400 via-emerald-300 to-teal-400 drop-shadow-lg mb-6",children:"Cashier Portal"}),(0,sa.jsxs)("div",{onClick:()=>m(!0),className:"flex items-center text-white min-w-0 cursor-pointer hover:opacity-90 transition-opacity p-2 -m-2 rounded-lg",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:(0,sa.jsx)("span",{className:"text-gray-900 font-bold text-sm",children:"C"})}),(0,sa.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold truncate",children:_}),(0,sa.jsx)("div",{className:"text-sm opacity-80 truncate",children:A})]})]}),u&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]",onClick:()=>m(!1),children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full mx-4 border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Enter your current and new password"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),A?h.currentPassword&&h.newPassword&&h.confirmPassword?h.newPassword===h.confirmPassword?h.newPassword.length<8?wr.error("Password must be at least 8 characters"):P.mutate({email:A,currentPassword:h.currentPassword,newPassword:h.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:h.currentPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:h.newPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:h.confirmPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:P.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:P.isLoading?"Resetting...":"Reset Password"})]})]})]})}),document.body),k&&k.code&&(0,sa.jsx)("div",{className:"mb-6",children:(0,sa.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-300 font-semibold mb-1",children:"\ud83c\udfae Club Code"}),(0,sa.jsx)("div",{className:"text-emerald-100 font-mono text-lg font-bold tracking-wider text-center",children:k.code}),(0,sa.jsx)("div",{className:"text-xs text-emerald-400 mt-1 text-center",children:"Players use this to sign up"})]})})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:a.map((e,a)=>(0,sa.jsx)("button",{onClick:()=>{s(e),d&&o(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-green-400 to-emerald-600 text-gray-900 font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-green-400/20 hover:to-emerald-500/20 text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between",children:[(0,sa.jsx)("span",{className:"block truncate",children:e}),"Notifications"===e&&(null===v||void 0===v?void 0:v.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:v.unreadCount>9?"9+":v.unreadCount}),"Chat"===e&&S>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:S>9?"9+":S})]})},a))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})})]})}function jh(e){let{selectedClubId:t}=e;const s=ra(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(1),[u,m]=(0,r.useState)({search:"",startDate:"",endDate:"",staffId:""}),[h,x]=(0,r.useState)({staffId:"",payPeriod:"Weekly",baseSalary:"",overtimeHours:"",overtimeAmount:"",deductions:"",periodStartDate:"",periodEndDate:"",notes:""}),{data:p}=hn({queryKey:["payroll-staff",t],queryFn:()=>jr.oA.getAllStaffForPayroll(t),enabled:!!t}),{data:b,isLoading:g}=hn({queryKey:["salary-payments",t,d,u],queryFn:()=>jr.oA.getSalaryPayments(t,(0,i.A)({page:d,limit:10},u)),enabled:!!t}),f=gn({mutationFn:e=>jr.oA.processSalary(t,e),onSuccess:()=>{wr.success("Salary processed successfully!"),s.invalidateQueries(["salary-payments",t]),n(!1),y()},onError:e=>{wr.error(e.message||"Failed to process salary")}}),y=()=>{x({staffId:"",payPeriod:"Weekly",baseSalary:"",overtimeHours:"",overtimeAmount:"",deductions:"",periodStartDate:"",periodEndDate:"",notes:""}),o(null)},v=(null===p||void 0===p?void 0:p.staff)||[],w=(null===b||void 0===b?void 0:b.payments)||[],j=(null===b||void 0===b?void 0:b.totalPages)||1,N=(null===b||void 0===b?void 0:b.total)||0;return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Employee Salary Processing"}),(0,sa.jsxs)("div",{className:"text-white",children:["Total Records: ",N]})]}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Name or email...",value:u.search,onChange:e=>m((0,i.A)((0,i.A)({},u),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:u.startDate,onChange:e=>m((0,i.A)((0,i.A)({},u),{},{startDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"End Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:u.endDate,onChange:e=>m((0,i.A)((0,i.A)({},u),{},{endDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Employee"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:u.staffId,onChange:e=>m((0,i.A)((0,i.A)({},u),{},{staffId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Employees"}),v.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Select Employee to Process Salary"}),(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-h-60 overflow-y-auto",children:v.map(e=>(0,sa.jsxs)("button",{onClick:()=>(e=>{o(e),x((0,i.A)((0,i.A)({},h),{},{staffId:e.id,baseSalary:Number(e.baseSalary||0)>0?String(e.baseSalary):"",payPeriod:e.salaryType||"Monthly"})),n(!0)})(e),className:"bg-slate-700 hover:bg-slate-600 p-4 rounded-lg text-left transition-colors",children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:e.name}),(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:e.role}),(0,sa.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.email}),Number(e.baseSalary||0)>0&&(0,sa.jsxs)("div",{className:"text-xs text-green-400 mt-1",children:["\u20b9",Number(e.baseSalary).toFixed(0)," / ",e.salaryType||"Monthly"]})]},e.id))})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Salary Payment History"}),g?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===w.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No salary payments found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Employee"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Period"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Pay Period"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Base Salary"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Overtime"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Deductions"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Net Amount"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Date"})]})}),(0,sa.jsx)("tbody",{children:w.map(e=>{var t;return(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:null===(t=e.staff)||void 0===t?void 0:t.name}),(0,sa.jsxs)("td",{className:"text-white p-3 text-sm",children:[new Date(e.periodStartDate).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})," -"," ",new Date(e.periodEndDate).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})]}),(0,sa.jsx)("td",{className:"text-white p-3",children:e.payPeriod}),(0,sa.jsxs)("td",{className:"text-right text-white p-3",children:["\u20b9",Number(e.baseSalary).toFixed(2)]}),(0,sa.jsxs)("td",{className:"text-right text-green-400 p-3",children:["+\u20b9",Number(e.overtimeAmount).toFixed(2)]}),(0,sa.jsxs)("td",{className:"text-right text-red-400 p-3",children:["-\u20b9",Number(e.deductions).toFixed(2)]}),(0,sa.jsxs)("td",{className:"text-right text-white font-semibold p-3",children:["\u20b9",Number(e.netAmount).toFixed(2)]}),(0,sa.jsx)("td",{className:"text-white p-3",children:new Date(e.paymentDate).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]},e.id)})})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(d-1)+1," to ",Math.min(10*d,N)," of ",N," entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>c(e=>Math.max(1,e-1)),disabled:1===d,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(j)].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>c(t+1),className:"px-4 py-2 rounded-lg ".concat(d===t+1?"bg-purple-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>c(e=>Math.min(j,e+1)),disabled:d===j,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-purple-900/90 to-pink-900/90 rounded-xl p-6 max-w-2xl w-full border border-purple-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Process Staff Salary"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Select Staff Member *"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:h.staffId,onChange:e=>{const t=null===p||void 0===p?void 0:p.staff.find(t=>t.id===e.target.value);x((0,i.A)((0,i.A)({},h),{},{staffId:e.target.value,baseSalary:t&&Number(t.baseSalary||0)>0?String(t.baseSalary):h.baseSalary,payPeriod:(null===t||void 0===t?void 0:t.salaryType)||h.payPeriod})),o(t)},children:[(0,sa.jsx)("option",{value:"",children:"Select an option"}),v.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name," - ",e.role]},e.id))]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Pay Period *"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:h.payPeriod,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{payPeriod:e.target.value})),children:[(0,sa.jsx)("option",{value:"Weekly",children:"Weekly"}),(0,sa.jsx)("option",{value:"Bi-weekly",children:"Bi-weekly"}),(0,sa.jsx)("option",{value:"Monthly",children:"Monthly"})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Period Start Date *"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:h.periodStartDate,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{periodStartDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Period End Date *"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:h.periodEndDate,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{periodEndDate:e.target.value}))})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Base Salary *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"\u20b90.00",value:h.baseSalary,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{baseSalary:e.target.value}))}),l&&Number(l.baseSalary||0)>0&&(0,sa.jsxs)("p",{className:"text-xs text-green-400 mt-1",children:["Staff configured salary: \u20b9",Number(l.baseSalary).toFixed(2)," / ",l.salaryType||"Monthly"]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Overtime Hours"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"0",value:h.overtimeHours,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{overtimeHours:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Overtime Amount"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"\u20b90.00",value:h.overtimeAmount,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{overtimeAmount:e.target.value}))})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Deductions"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"\u20b90.00",value:h.deductions,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{deductions:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Notes"}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-purple-800/50 border border-purple-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 h-20",placeholder:"Additional notes...",value:h.notes,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{notes:e.target.value}))})]}),h.baseSalary&&(0,sa.jsxs)("div",{className:"bg-purple-800/30 border border-purple-500 rounded-lg p-4",children:[(0,sa.jsx)("h3",{className:"text-white font-semibold mb-2",children:"Calculation Summary"}),(0,sa.jsxs)("div",{className:"space-y-1 text-white",children:[(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{children:"Base Salary:"}),(0,sa.jsxs)("span",{children:["\u20b9",Number(h.baseSalary||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-green-400",children:[(0,sa.jsx)("span",{children:"Overtime:"}),(0,sa.jsxs)("span",{children:["+\u20b9",Number(h.overtimeAmount||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-red-400",children:[(0,sa.jsx)("span",{children:"Deductions:"}),(0,sa.jsxs)("span",{children:["-\u20b9",Number(h.deductions||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{className:"flex justify-between font-bold text-lg border-t border-purple-500 pt-2 mt-2",children:[(0,sa.jsx)("span",{children:"Net Amount:"}),(0,sa.jsxs)("span",{children:["\u20b9",(Number(h.baseSalary||0)+Number(h.overtimeAmount||0)-Number(h.deductions||0)).toFixed(2)]})]})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{h.staffId&&h.baseSalary&&h.periodStartDate&&h.periodEndDate?f.mutate((0,i.A)((0,i.A)({},h),{},{baseSalary:Number(h.baseSalary),overtimeHours:h.overtimeHours?Number(h.overtimeHours):0,overtimeAmount:h.overtimeAmount?Number(h.overtimeAmount):0,deductions:h.deductions?Number(h.deductions):0})):wr.error("Please fill in all required fields")},disabled:f.isLoading,className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:f.isLoading?"Processing...":"Process Salary"}),(0,sa.jsx)("button",{onClick:()=>{n(!1),y()},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}function Nh(e){var t;let{selectedClubId:s}=e;const a=ra(),[n,l]=(0,r.useState)("tips"),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),[b,g]=(0,r.useState)(null),[f,y]=(0,r.useState)(1),[v,w]=(0,r.useState)(1),[j,N]=(0,r.useState)(1),[S,k]=(0,r.useState)({search:"",startDate:"",endDate:"",dealerId:""}),[C,A]=(0,r.useState)({search:"",startDate:"",endDate:"",dealerId:""}),[_,P]=(0,r.useState)({search:"",startDate:"",endDate:"",managerId:""}),[T,E]=(0,r.useState)({clubHoldPercentage:15,dealerSharePercentage:80,floorManagerPercentage:5}),[I,R]=(0,r.useState)({dealerId:"",managerId:"",tipDate:(new Date).toISOString().split("T")[0],totalTips:"",notes:""}),[D,O]=(0,r.useState)({dealerId:"",cashoutDate:(new Date).toISOString().split("T")[0],amount:"",notes:""}),[L,F]=(0,r.useState)({managerId:"",cashoutDate:(new Date).toISOString().split("T")[0],amount:"",notes:""}),{data:M}=hn({queryKey:["payroll-dealers",s],queryFn:()=>jr.oA.getDealersForPayroll(s),enabled:!!s}),{data:B}=hn({queryKey:["payroll-managers",s],queryFn:()=>jr.oA.getManagersForPayroll(s),enabled:!!s}),{data:q}=hn({queryKey:["tip-settings",s,null===x||void 0===x?void 0:x.id],queryFn:()=>jr.oA.getTipSettings(s,null===x||void 0===x?void 0:x.id),enabled:!!s&&!!x&&o});(0,r.useEffect)(()=>{null!==q&&void 0!==q&&q.settings&&E({clubHoldPercentage:Number(q.settings.clubHoldPercentage),dealerSharePercentage:Number(q.settings.dealerSharePercentage),floorManagerPercentage:Number(q.settings.floorManagerPercentage)})},[q]);const{data:U,isLoading:z}=hn({queryKey:["dealer-tips",s,f,S],queryFn:()=>jr.oA.getDealerTips(s,(0,i.A)({page:f,limit:10},S)),enabled:!!s}),{data:K,isLoading:W}=hn({queryKey:["dealer-cashouts",s,v,C],queryFn:()=>jr.oA.getDealerCashouts(s,(0,i.A)({page:v,limit:10},C)),enabled:!!s}),{data:H,isLoading:V}=hn({queryKey:["manager-cashouts",s,j,_],queryFn:()=>jr.oA.getManagerCashouts(s,(0,i.A)({page:j,limit:10},_)),enabled:!!s&&"manager-cashout"===n}),{data:J}=hn({queryKey:["manager-tip-balance",s,null===b||void 0===b?void 0:b.id],queryFn:()=>jr.oA.getManagerTipBalance(s,null===b||void 0===b?void 0:b.id),enabled:!!s&&!!b&&m}),{data:Q}=hn({queryKey:["club-tip-summary",s],queryFn:()=>jr.oA.getClubTipSummary(s),enabled:!!s&&"club-share"===n}),G=gn({mutationFn:e=>{const t={clubHoldPercentage:parseFloat(e.clubHoldPercentage)||0,dealerSharePercentage:parseFloat(e.dealerSharePercentage)||0,floorManagerPercentage:parseFloat(e.floorManagerPercentage)||0};return jr.oA.updateTipSettings(s,t,null===x||void 0===x?void 0:x.id)},onSuccess:()=>{wr.success("Tip settings updated successfully!"),a.invalidateQueries(["tip-settings",s,null===x||void 0===x?void 0:x.id])},onError:e=>{wr.error(e.message||"Failed to update tip settings")}}),Y=gn({mutationFn:e=>jr.oA.processDealerTips(s,e),onSuccess:()=>{wr.success("Dealer tips processed successfully!"),a.invalidateQueries(["dealer-tips",s]),a.invalidateQueries(["club-tip-summary",s]),a.invalidateQueries(["manager-tip-balance"]),d(!1),p(null),R({dealerId:"",managerId:"",tipDate:(new Date).toISOString().split("T")[0],totalTips:"",notes:""}),E({clubHoldPercentage:15,dealerSharePercentage:80,floorManagerPercentage:5})},onError:e=>{wr.error(e.message||"Failed to process tips")}}),$=gn({mutationFn:e=>jr.oA.processDealerCashout(s,e),onSuccess:()=>{wr.success("Dealer cashout processed successfully!"),a.invalidateQueries(["dealer-cashouts",s]),a.invalidateQueries(["club-tip-summary",s]),u(!1),p(null),O({dealerId:"",cashoutDate:(new Date).toISOString().split("T")[0],amount:"",notes:""})},onError:e=>{wr.error(e.message||"Failed to process cashout")}}),Z=gn({mutationFn:e=>jr.oA.processManagerCashout(s,e),onSuccess:()=>{wr.success("Manager cashout processed successfully!"),a.invalidateQueries(["manager-cashouts",s]),a.invalidateQueries(["club-tip-summary",s]),a.invalidateQueries(["manager-tip-balance"]),h(!1),g(null),F({managerId:"",cashoutDate:(new Date).toISOString().split("T")[0],amount:"",notes:""})},onError:e=>{wr.error(e.message||"Failed to process manager cashout")}}),X=(null===M||void 0===M?void 0:M.dealers)||[],ee=(null===B||void 0===B?void 0:B.managers)||[],te=(null===U||void 0===U?void 0:U.tips)||[],se=(null===K||void 0===K?void 0:K.cashouts)||[],ae=(null===H||void 0===H?void 0:H.cashouts)||[],re=(null===U||void 0===U?void 0:U.totalPages)||1,ne=(null===U||void 0===U?void 0:U.total)||0,le=(null===K||void 0===K?void 0:K.totalPages)||1,ie=(null===K||void 0===K?void 0:K.total)||0,oe=(null===H||void 0===H?void 0:H.totalPages)||1,de=(null===H||void 0===H?void 0:H.total)||0,ce=Number(T.clubHoldPercentage)+Number(T.dealerSharePercentage)+Number(T.floorManagerPercentage),ue=J||{},me=Q||{};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Tips Management"})}),(0,sa.jsx)("div",{className:"flex gap-2 border-b border-slate-700 overflow-x-auto",children:[{id:"tips",label:"Dealer Tips %"},{id:"cashout",label:"Dealer Cash Out"},{id:"manager-cashout",label:"Manager Cash Out"},{id:"club-share",label:"Club Share"}].map(e=>(0,sa.jsx)("button",{onClick:()=>l(e.id),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat(n===e.id?"text-white border-b-2 border-cyan-500":"text-gray-400 hover:text-white"),children:e.label},e.id))}),"tips"===n&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Click a Dealer to Process Their Tips"}),(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-h-60 overflow-y-auto",children:X.map(e=>(0,sa.jsxs)("button",{onClick:()=>(e=>{p(e),R((0,i.A)((0,i.A)({},I),{},{dealerId:e.id,managerId:""})),d(!0)})(e),className:"bg-gradient-to-r from-cyan-900/30 to-blue-900/30 border border-cyan-700 rounded-lg p-4 hover:from-cyan-800/40 hover:to-blue-800/40 transition-all text-left",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold text-lg",children:e.name}),(0,sa.jsx)("p",{className:"text-sm text-cyan-400 mt-1",children:e.email}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.gameType?"rummy"===e.gameType?"Rummy":"Poker":"General"})]},e.id))})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Dealer Tips History"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Dealer name...",value:S.search,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:S.startDate,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{startDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"End Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:S.endDate,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{endDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Dealer"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:S.dealerId,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{dealerId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Dealers"}),X.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),z?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===te.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No tips processed yet"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Dealer"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Manager"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Total Tips"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Dealer Share"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Club Hold"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Floor Manager"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Date"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Status"})]})}),(0,sa.jsx)("tbody",{children:te.map(e=>{var t,s;return(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:null===(t=e.dealer)||void 0===t?void 0:t.name}),(0,sa.jsx)("td",{className:"text-white p-3 text-sm",children:(null===(s=e.manager)||void 0===s?void 0:s.name)||(0,sa.jsx)("span",{className:"text-gray-500",children:"Unassigned"})}),(0,sa.jsxs)("td",{className:"text-right text-white p-3",children:["\u20b9",Number(e.totalTips).toFixed(2)]}),(0,sa.jsxs)("td",{className:"text-right text-green-400 p-3",children:["\u20b9",Number(e.dealerShareAmount).toFixed(2)]}),(0,sa.jsxs)("td",{className:"text-right text-cyan-400 p-3",children:["\u20b9",Number(e.clubHoldAmount).toFixed(2)]}),(0,sa.jsxs)("td",{className:"text-right text-purple-400 p-3",children:["\u20b9",Number(e.floorManagerAmount).toFixed(2)]}),(0,sa.jsx)("td",{className:"text-white p-3",children:new Date(e.tipDate).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("td",{className:"text-white p-3",children:(0,sa.jsx)("span",{className:"px-2 py-1 bg-green-600 rounded text-xs",children:e.status})})]},e.id)})})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(f-1)+1," to ",Math.min(10*f,ne)," of"," ",ne," entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>y(e=>Math.max(1,e-1)),disabled:1===f,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(Math.min(re,5))].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>y(t+1),className:"px-4 py-2 rounded-lg ".concat(f===t+1?"bg-cyan-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>y(e=>Math.min(re,e+1)),disabled:f===re,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),"cashout"===n&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Click a Dealer to Process Cash Out"}),(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-h-60 overflow-y-auto",children:X.map(e=>(0,sa.jsxs)("button",{onClick:()=>(e=>{p(e),O((0,i.A)((0,i.A)({},D),{},{dealerId:e.id})),u(!0)})(e),className:"bg-gradient-to-r from-green-900/30 to-emerald-900/30 border border-green-700 rounded-lg p-4 hover:from-green-800/40 hover:to-emerald-800/40 transition-all text-left",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold text-lg",children:e.name}),(0,sa.jsx)("p",{className:"text-sm text-green-400 mt-1",children:e.email}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.gameType?"rummy"===e.gameType?"Rummy":"Poker":"General"})]},e.id))})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Dealer Cashout History"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",placeholder:"Dealer name...",value:C.search,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:C.startDate,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{startDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"End Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:C.endDate,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{endDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Dealer"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:C.dealerId,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{dealerId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Dealers"}),X.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),W?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===se.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No cashouts processed yet"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Dealer"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Amount"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Date"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Notes"})]})}),(0,sa.jsx)("tbody",{children:se.map(e=>{var t;return(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:null===(t=e.dealer)||void 0===t?void 0:t.name}),(0,sa.jsxs)("td",{className:"text-right text-green-400 font-semibold p-3",children:["\u20b9",Number(e.amount).toFixed(2)]}),(0,sa.jsx)("td",{className:"text-white p-3",children:new Date(e.cashoutDate).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:e.notes||"-"})]},e.id)})})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(v-1)+1," to"," ",Math.min(10*v,ie)," of ",ie," entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>w(e=>Math.max(1,e-1)),disabled:1===v,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(Math.min(le,5))].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>w(t+1),className:"px-4 py-2 rounded-lg ".concat(v===t+1?"bg-green-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>w(e=>Math.min(le,e+1)),disabled:v===le,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),"manager-cashout"===n&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Click a Manager to Process Cash Out"}),0===ee.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-4",children:"No managers found in this club"}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-h-60 overflow-y-auto",children:ee.map(e=>(0,sa.jsxs)("button",{onClick:()=>(e=>{g(e),F((0,i.A)((0,i.A)({},L),{},{managerId:e.id})),h(!0)})(e),className:"bg-gradient-to-r from-purple-900/30 to-indigo-900/30 border border-purple-700 rounded-lg p-4 hover:from-purple-800/40 hover:to-indigo-800/40 transition-all text-left",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold text-lg",children:e.name}),(0,sa.jsx)("p",{className:"text-sm text-purple-400 mt-1",children:e.email}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.gameType?"rummy"===e.gameType?"Rummy":"Poker":"General"})]},e.id))})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Manager Cashout History"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"Manager name...",value:_.search,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:_.startDate,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{startDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"End Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:_.endDate,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{endDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Manager"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:_.managerId,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{managerId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Managers"}),ee.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),V?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===ae.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No manager cashouts processed yet"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Manager"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Amount"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Game"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Date"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Notes"})]})}),(0,sa.jsx)("tbody",{children:ae.map(e=>{var t;return(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:null===(t=e.manager)||void 0===t?void 0:t.name}),(0,sa.jsxs)("td",{className:"text-right text-purple-400 font-semibold p-3",children:["\u20b9",Number(e.amount).toFixed(2)]}),(0,sa.jsx)("td",{className:"p-3",children:"rummy"===e.gameType?(0,sa.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded bg-amber-900/40 border border-amber-600/40 text-amber-300 text-xs font-medium",children:"\ud83c\udccf Rummy"}):"poker"===e.gameType?(0,sa.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded bg-indigo-900/40 border border-indigo-600/40 text-indigo-300 text-xs font-medium",children:"\u2660 Poker"}):(0,sa.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded bg-slate-700/40 border border-slate-500/40 text-slate-300 text-xs font-medium",children:"\ud83c\udfaf General"})}),(0,sa.jsx)("td",{className:"text-white p-3",children:new Date(e.cashoutDate).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:e.notes||"-"})]},e.id)})})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(j-1)+1," to"," ",Math.min(10*j,de)," of ",de," ","entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>N(e=>Math.max(1,e-1)),disabled:1===j,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(Math.min(oe,5))].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>N(t+1),className:"px-4 py-2 rounded-lg ".concat(j===t+1?"bg-purple-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>N(e=>Math.min(oe,e+1)),disabled:j===oe,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),"club-share"===n&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-5 border border-slate-700",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Total Tips Collected"}),(0,sa.jsxs)("p",{className:"text-2xl font-bold text-white",children:["\u20b9",Number(me.totalTips||0).toFixed(2)]}),(0,sa.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[me.tipCount||0," tip entries"]})]}),(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-cyan-900/40 to-blue-900/40 rounded-xl p-5 border border-cyan-700/40",children:[(0,sa.jsx)("p",{className:"text-cyan-400 text-sm mb-1",children:"Club Hold (Revenue)"}),(0,sa.jsxs)("p",{className:"text-2xl font-bold text-cyan-300",children:["+\u20b9",Number(me.clubNetRevenue||0).toFixed(2)]}),(0,sa.jsx)("p",{className:"text-xs text-cyan-500 mt-1",children:"Club's share of all tips"})]}),(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-green-900/40 to-emerald-900/40 rounded-xl p-5 border border-green-700/40",children:[(0,sa.jsx)("p",{className:"text-green-400 text-sm mb-1",children:"Total Dealer Share"}),(0,sa.jsxs)("p",{className:"text-2xl font-bold text-green-300",children:["\u20b9",Number(me.totalDealerShare||0).toFixed(2)]}),(0,sa.jsxs)("div",{className:"flex justify-between mt-2 text-xs",children:[(0,sa.jsxs)("span",{className:"text-green-500",children:["Paid: \u20b9",Number(me.totalDealerCashouts||0).toFixed(2)]}),(0,sa.jsxs)("span",{className:"text-yellow-400",children:["Pending: \u20b9",Number(me.pendingDealerPayouts||0).toFixed(2)]})]})]}),(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-purple-900/40 to-indigo-900/40 rounded-xl p-5 border border-purple-700/40",children:[(0,sa.jsx)("p",{className:"text-purple-400 text-sm mb-1",children:"Total Manager Share"}),(0,sa.jsxs)("p",{className:"text-2xl font-bold text-purple-300",children:["\u20b9",Number(me.totalManagerShare||0).toFixed(2)]}),(0,sa.jsxs)("div",{className:"flex justify-between mt-2 text-xs",children:[(0,sa.jsxs)("span",{className:"text-purple-500",children:["Paid: \u20b9",Number(me.totalManagerCashouts||0).toFixed(2)]}),(0,sa.jsxs)("span",{className:"text-yellow-400",children:["Pending: \u20b9",Number(me.pendingManagerPayouts||0).toFixed(2)]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Tip Distribution Summary"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,sa.jsx)("span",{className:"text-cyan-400 font-medium",children:"Club Hold (Revenue)"}),(0,sa.jsxs)("span",{className:"text-cyan-300 font-semibold",children:["+\u20b9",Number(me.clubNetRevenue||0).toFixed(2)]})]}),(0,sa.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-3",children:(0,sa.jsx)("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-3 rounded-full transition-all",style:{width:"".concat(me.totalTips?(Number(me.clubNetRevenue||0)/Number(me.totalTips)*100).toFixed(1):0,"%")}})})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,sa.jsx)("span",{className:"text-green-400 font-medium",children:"Dealer Payouts"}),(0,sa.jsxs)("span",{className:"text-green-300",children:["\u20b9",Number(me.totalDealerCashouts||0).toFixed(2)," paid / \u20b9",Number(me.totalDealerShare||0).toFixed(2)," total"]})]}),(0,sa.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-3",children:(0,sa.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all",style:{width:"".concat(me.totalDealerShare?(Number(me.totalDealerCashouts||0)/Number(me.totalDealerShare)*100).toFixed(1):0,"%")}})})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,sa.jsx)("span",{className:"text-purple-400 font-medium",children:"Manager Payouts"}),(0,sa.jsxs)("span",{className:"text-purple-300",children:["\u20b9",Number(me.totalManagerCashouts||0).toFixed(2)," paid / \u20b9",Number(me.totalManagerShare||0).toFixed(2)," total"]})]}),(0,sa.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-3",children:(0,sa.jsx)("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-500 h-3 rounded-full transition-all",style:{width:"".concat(me.totalManagerShare?(Number(me.totalManagerCashouts||0)/Number(me.totalManagerShare)*100).toFixed(1):0,"%")}})})]})]}),(0,sa.jsx)("div",{className:"mt-6 bg-yellow-900/20 border border-yellow-700/40 rounded-lg p-4",children:(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("span",{className:"text-yellow-400 font-medium",children:"Pending Payouts (Dealers + Managers)"}),(0,sa.jsxs)("span",{className:"text-yellow-300 font-bold text-lg",children:["\u20b9",(Number(me.pendingDealerPayouts||0)+Number(me.pendingManagerPayouts||0)).toFixed(2)]})]})})]})]}),o&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full border border-cyan-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Process Dealer Tips"}),x&&(0,sa.jsxs)("div",{className:"bg-cyan-900/30 border border-cyan-600 rounded-lg p-4 mb-4",children:[(0,sa.jsx)("div",{className:"text-xs text-cyan-400 mb-1",children:"Processing tips for:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold text-xl",children:x.name}),(0,sa.jsx)("p",{className:"text-sm text-cyan-300 mt-1",children:x.email})]}),(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-cyan-900/50 to-blue-900/50 rounded-lg p-6 border border-cyan-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Tip Distribution Settings"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Club Hold Percentage"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-4 py-3 bg-cyan-800/30 border border-cyan-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:T.clubHoldPercentage,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{clubHoldPercentage:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Dealer Share Percentage"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-4 py-3 bg-cyan-800/30 border border-cyan-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:T.dealerSharePercentage,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{dealerSharePercentage:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Floor Manager Share"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-4 py-3 bg-cyan-800/30 border border-cyan-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:T.floorManagerPercentage,onChange:e=>E((0,i.A)((0,i.A)({},T),{},{floorManagerPercentage:e.target.value}))})]}),(0,sa.jsxs)("div",{className:"bg-cyan-800/50 border border-cyan-600 rounded-lg p-4",children:[(0,sa.jsx)("p",{className:"text-white mb-2",children:"Current Distribution:"}),(0,sa.jsxs)("p",{className:"text-white",children:["Club: ",T.clubHoldPercentage,"% | Dealer: ",T.dealerSharePercentage,"% | Floor Manager: ",T.floorManagerPercentage,"%"]}),(0,sa.jsxs)("p",{className:"text-white font-semibold mt-2",children:["Total: ",ce.toFixed(2),"%",Math.abs(ce-100)>.01&&(0,sa.jsx)("span",{className:"text-red-400 ml-2",children:"Must equal 100%"})]})]}),(0,sa.jsx)("button",{onClick:()=>{const e=Number(T.clubHoldPercentage)+Number(T.dealerSharePercentage)+Number(T.floorManagerPercentage);Math.abs(e-100)>.01?wr.error("Percentages must add up to 100%"):G.mutate(T)},disabled:G.isLoading,className:"w-full bg-cyan-600 hover:bg-cyan-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:G.isLoading?"Updating...":"Update Settings"})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-6 border border-slate-600",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Tip Processing"}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Tip Date *"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:I.tipDate,onChange:e=>R((0,i.A)((0,i.A)({},I),{},{tipDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Total Tips (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"\u20b90.00",value:I.totalTips,onChange:e=>R((0,i.A)((0,i.A)({},I),{},{totalTips:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"text-white text-sm mb-1 block",children:["Assign Floor Manager (receives ",T.floorManagerPercentage,"% share)"]}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:I.managerId,onChange:e=>R((0,i.A)((0,i.A)({},I),{},{managerId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"-- Select Manager --"}),ee.filter(e=>null===x||void 0===x||!x.gameType||(!e.gameType||e.gameType===x.gameType)).map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name,e.gameType?" (".concat("rummy"===e.gameType?"Rummy":"poker"===e.gameType?"Poker":"General",")"):""]},e.id))]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"The selected manager will receive the floor manager tip share for this entry"})]}),I.totalTips&&(0,sa.jsxs)("div",{className:"bg-cyan-900/30 border border-cyan-500 rounded-lg p-3",children:[(0,sa.jsx)("p",{className:"text-white text-sm mb-1 font-semibold",children:"Distribution Preview:"}),(0,sa.jsxs)("p",{className:"text-white text-xs",children:["Club: \u20b9",(Number(I.totalTips)*Number(T.clubHoldPercentage)/100).toFixed(2)," ","| Dealer: \u20b9",(Number(I.totalTips)*Number(T.dealerSharePercentage)/100).toFixed(2)," ","| Floor Manager: \u20b9",(Number(I.totalTips)*Number(T.floorManagerPercentage)/100).toFixed(2),I.managerId&&(0,sa.jsxs)("span",{className:"text-purple-300",children:[" ","\u2192 ",(null===(t=ee.find(e=>e.id===I.managerId))||void 0===t?void 0:t.name)||""]})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Notes"}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 h-20",placeholder:"Additional notes...",value:I.notes,onChange:e=>R((0,i.A)((0,i.A)({},I),{},{notes:e.target.value}))})]})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{if(!I.dealerId||!I.totalTips)return void wr.error("Please fill in all required fields");const e={dealerId:I.dealerId,tipDate:I.tipDate,totalTips:Number(I.totalTips),notes:I.notes};I.managerId&&(e.managerId=I.managerId),Y.mutate(e)},disabled:Y.isLoading,className:"flex-1 bg-cyan-600 hover:bg-cyan-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:Y.isLoading?"Processing...":"Process Tips"}),(0,sa.jsx)("button",{onClick:()=>{d(!1),p(null),E({clubHoldPercentage:15,dealerSharePercentage:80,floorManagerPercentage:5})},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),c&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-green-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Process Dealer Cash Out"}),x&&(0,sa.jsxs)("div",{className:"bg-green-900/30 border border-green-600 rounded-lg p-4 mb-4",children:[(0,sa.jsx)("div",{className:"text-xs text-green-400 mb-1",children:"Processing cashout for:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold text-xl",children:x.name}),(0,sa.jsx)("p",{className:"text-sm text-green-300 mt-1",children:x.email})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Cashout Date *"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:D.cashoutDate,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{cashoutDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Cash Out Amount (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",placeholder:"\u20b90.00",value:D.amount,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{amount:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Notes (Optional)"}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500 h-24",placeholder:"Additional notes about the cash out...",value:D.notes,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{notes:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{D.dealerId&&D.amount?$.mutate((0,i.A)((0,i.A)({},D),{},{amount:Number(D.amount)})):wr.error("Please fill in all required fields")},disabled:$.isLoading,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:$.isLoading?"Processing...":"Process Cash Out"}),(0,sa.jsx)("button",{onClick:()=>{u(!1),p(null)},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),m&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-purple-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Process Manager Cash Out"}),b&&(0,sa.jsxs)("div",{className:"bg-purple-900/30 border border-purple-600 rounded-lg p-4 mb-4",children:[(0,sa.jsx)("div",{className:"text-xs text-purple-400 mb-1",children:"Processing cashout for:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold text-xl",children:b.name}),(0,sa.jsx)("p",{className:"text-sm text-purple-300 mt-1",children:b.email}),(0,sa.jsxs)("p",{className:"text-xs text-purple-400 mt-1",children:["Game: ","rummy"===b.gameType?"Rummy":"poker"===b.gameType?"Poker":"General"]})]}),(0,sa.jsxs)("div",{className:"bg-purple-900/20 border border-purple-700/40 rounded-lg p-4 mb-4",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Total Share"}),(0,sa.jsxs)("p",{className:"text-lg font-bold text-purple-300",children:["\u20b9",Number(ue.totalManagerShare||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Already Paid"}),(0,sa.jsxs)("p",{className:"text-lg font-bold text-red-400",children:["\u20b9",Number(ue.totalCashouts||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Available"}),(0,sa.jsxs)("p",{className:"text-lg font-bold text-green-400",children:["\u20b9",Number(ue.availableBalance||0).toFixed(2)]})]})]}),(0,sa.jsxs)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:["Based on ",ue.tipCount||0," assigned tip entries"]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Cashout Date *"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",value:L.cashoutDate,onChange:e=>F((0,i.A)((0,i.A)({},L),{},{cashoutDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Cash Out Amount (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500",placeholder:"\u20b90.00",max:ue.availableBalance||0,value:L.amount,onChange:e=>F((0,i.A)((0,i.A)({},L),{},{amount:e.target.value}))}),L.amount&&Number(L.amount)>Number(ue.availableBalance||0)&&(0,sa.jsxs)("p",{className:"text-red-400 text-xs mt-1",children:["Amount exceeds available balance of \u20b9",Number(ue.availableBalance||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Notes (Optional)"}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 h-24",placeholder:"Additional notes about the cash out...",value:L.notes,onChange:e=>F((0,i.A)((0,i.A)({},L),{},{notes:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{L.managerId&&L.amount?Z.mutate((0,i.A)((0,i.A)({},L),{},{amount:Number(L.amount)})):wr.error("Please fill in all required fields")},disabled:Z.isLoading||Number(L.amount)>Number(ue.availableBalance||0),className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:Z.isLoading?"Processing...":"Process Cash Out"}),(0,sa.jsx)("button",{onClick:()=>{h(!1),g(null)},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}function Sh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("salary");return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Payroll Management"})}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>a("salary"),className:"px-6 py-3 font-semibold transition-all ".concat("salary"===s?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Employee Salary"}),(0,sa.jsx)("button",{onClick:()=>a("dealer"),className:"px-6 py-3 font-semibold transition-all ".concat("dealer"===s?"text-emerald-400 border-b-2 border-emerald-400":"text-gray-400 hover:text-white"),children:"Dealer Tips & Cashouts"})]}),"salary"===s?(0,sa.jsx)(jh,{selectedClubId:t}):(0,sa.jsx)(Nh,{selectedClubId:t})]})}const kh=["Welcome Bonus","Loyalty Bonus","Referral Bonus","Tournament Bonus","Special Event Bonus","Custom"],Ch=["Performance Bonus","Attendance Bonus","Special Achievement","Holiday Bonus","Year-end Bonus","Custom"];function Ah(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("player"),[n,l]=(0,r.useState)("process");return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Bonus Management"})}),(0,sa.jsx)("div",{className:"flex gap-2 border-b border-slate-700",children:(0,sa.jsx)("button",{onClick:()=>{a("player"),l("process")},className:"px-6 py-3 font-semibold transition-colors ".concat("player"===s?"text-white border-b-2 border-orange-500":"text-gray-400 hover:text-white"),children:"Player Bonus"})}),"player"===s&&(0,sa.jsx)(_h,{selectedClubId:t,activeSubTab:n,setActiveSubTab:l}),"staff"===s&&(0,sa.jsx)(Ph,{selectedClubId:t,activeSubTab:n,setActiveSubTab:l})]})}function _h(e){let{selectedClubId:t,activeSubTab:s,setActiveSubTab:a}=e;const n=ra(),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(1),[h,x]=(0,r.useState)(""),[p,b]=(0,r.useState)({search:"",startDate:"",endDate:"",playerId:""}),[g,f]=(0,r.useState)({playerId:"",bonusType:"",customBonusType:"",bonusAmount:"",reason:""}),{data:y}=hn({queryKey:["bonus-players",t,h],queryFn:()=>jr.KG.getPlayersForBonus(t,h||void 0),enabled:!!t}),{data:v,isLoading:w}=hn({queryKey:["player-bonuses",t,u,p],queryFn:()=>jr.KG.getPlayerBonuses(t,(0,i.A)({page:u,limit:10},p)),enabled:!!t&&"history"===s}),j=gn({mutationFn:e=>jr.KG.processPlayerBonus(t,e),onSuccess:()=>{wr.success("Player bonus processed successfully!"),n.invalidateQueries(["player-bonuses",t]),o(!1),c(null),N()},onError:e=>{wr.error(e.message||"Failed to process bonus")}}),N=()=>{f({playerId:"",bonusType:"",customBonusType:"",bonusAmount:"",reason:""})},S=(null===y||void 0===y?void 0:y.players)||[],k=(null===v||void 0===v?void 0:v.bonuses)||[],C=(null===v||void 0===v?void 0:v.totalPages)||1,A=(null===v||void 0===v?void 0:v.total)||0;return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>a("process"),className:"px-6 py-3 font-semibold transition-colors ".concat("process"===s?"text-white border-b-2 border-orange-500":"text-gray-400 hover:text-white"),children:"Process Bonus"}),(0,sa.jsx)("button",{onClick:()=>a("history"),className:"px-6 py-3 font-semibold transition-colors ".concat("history"===s?"text-white border-b-2 border-orange-500":"text-gray-400 hover:text-white"),children:"Bonus History"})]}),"process"===s&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4",children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"\ud83d\udd0d Search Player (Type at least 3 characters)"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"Search by name, email, phone number, or player ID...",value:h,onChange:e=>x(e.target.value)}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Only KYC approved/verified players are shown"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\ud83d\udc64 Click a Player to Process Bonus"}),0===S.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:h.length>=3?"No players found matching your search":h.length>0?"Type at least 3 characters to search":"No KYC approved players found"}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-h-96 overflow-y-auto",children:S.map(e=>(0,sa.jsxs)("button",{onClick:()=>(e=>{c(e),f((0,i.A)((0,i.A)({},g),{},{playerId:e.id})),o(!0)})(e),className:"bg-gradient-to-r from-orange-900/30 to-amber-900/30 border border-orange-700 rounded-lg p-4 hover:from-orange-800/40 hover:to-amber-800/40 transition-all text-left",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold text-lg",children:e.name}),(0,sa.jsx)("p",{className:"text-sm text-orange-400 mt-1",children:e.email}),e.playerId&&(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["ID: ",e.playerId]}),e.phoneNumber&&(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Phone: ",e.phoneNumber]})]},e.id))})]})]}),"history"===s&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"Name, email, or ID...",value:p.search,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",value:p.startDate,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{startDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"End Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",value:p.endDate,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{endDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Player"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",value:p.playerId,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{playerId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Players"}),S.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4",children:["Bonus History (Total: ",A,")"]}),w?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===k.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No bonuses found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Player"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Bonus Type"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Amount"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Reason"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Date"})]})}),(0,sa.jsx)("tbody",{children:k.map(e=>{var t;return(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:null===(t=e.player)||void 0===t?void 0:t.name}),(0,sa.jsx)("td",{className:"text-white p-3",children:e.bonusType}),(0,sa.jsxs)("td",{className:"text-right text-orange-400 font-semibold p-3",children:["\u20b9",Number(e.bonusAmount).toFixed(2)]}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:e.reason||"-"}),(0,sa.jsx)("td",{className:"text-white p-3",children:new Date(e.processedAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]},e.id)})})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(u-1)+1," to ",Math.min(10*u,A)," of ",A," entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>m(e=>Math.max(1,e-1)),disabled:1===u,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(C)].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>m(t+1),className:"px-4 py-2 rounded-lg ".concat(u===t+1?"bg-orange-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>m(e=>Math.min(C,e+1)),disabled:u===C,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),l&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-orange-900/90 to-amber-900/90 rounded-xl p-6 max-w-md w-full border border-orange-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"\ud83d\udcb0 Process Player Bonus"}),d&&(0,sa.jsxs)("div",{className:"bg-orange-900/30 border border-orange-600 rounded-lg p-4 mb-4",children:[(0,sa.jsx)("div",{className:"text-xs text-orange-400 mb-1",children:"Processing bonus for:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold text-xl",children:d.name}),(0,sa.jsx)("p",{className:"text-sm text-orange-300 mt-1",children:d.email})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Bonus Type *"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-orange-800/50 border border-orange-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",value:g.bonusType,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{bonusType:e.target.value,customBonusType:""})),children:[(0,sa.jsx)("option",{value:"",children:"Select Bonus Type"}),kh.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))]})]}),"Custom"===g.bonusType&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Bonus Type Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-orange-800/50 border border-orange-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"Enter custom bonus type name...",value:g.customBonusType,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{customBonusType:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Bonus Amount (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-orange-800/50 border border-orange-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500",placeholder:"\u20b90.00",value:g.bonusAmount,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{bonusAmount:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Reason"}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-orange-800/50 border border-orange-600 rounded-lg text-white focus:ring-2 focus:ring-orange-500 h-20",placeholder:"Bonus reason...",value:g.reason,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{reason:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{g.playerId&&g.bonusType&&g.bonusAmount?"Custom"!==g.bonusType||g.customBonusType?j.mutate({playerId:g.playerId,bonusType:"Custom"===g.bonusType?g.customBonusType:g.bonusType,bonusAmount:Number(g.bonusAmount),reason:g.reason||void 0}):wr.error("Please enter custom bonus type name"):wr.error("Please fill in all required fields")},disabled:j.isLoading,className:"flex-1 bg-gradient-to-r from-orange-600 to-amber-600 hover:from-orange-500 hover:to-amber-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:j.isLoading?"Processing...":"Process Bonus"}),(0,sa.jsx)("button",{onClick:()=>{o(!1),c(null),N()},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}function Ph(e){let{selectedClubId:t,activeSubTab:s,setActiveSubTab:a}=e;const n=ra(),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(1),[h,x]=(0,r.useState)(""),[p,b]=(0,r.useState)({search:"",startDate:"",endDate:"",staffId:""}),[g,f]=(0,r.useState)({staffId:"",bonusType:"",customBonusType:"",bonusAmount:"",reason:""}),{data:y}=hn({queryKey:["bonus-staff",t,h],queryFn:()=>jr.KG.getStaffForBonus(t,h||void 0),enabled:!!t}),{data:v,isLoading:w}=hn({queryKey:["staff-bonuses",t,u,p],queryFn:()=>jr.KG.getStaffBonuses(t,(0,i.A)({page:u,limit:10},p)),enabled:!!t&&"history"===s}),j=gn({mutationFn:e=>jr.KG.processStaffBonus(t,e),onSuccess:()=>{wr.success("Staff bonus processed successfully!"),n.invalidateQueries(["staff-bonuses",t]),o(!1),c(null),N()},onError:e=>{wr.error(e.message||"Failed to process bonus")}}),N=()=>{f({staffId:"",bonusType:"",customBonusType:"",bonusAmount:"",reason:""})},S=(null===y||void 0===y?void 0:y.staff)||[],k=(null===v||void 0===v?void 0:v.bonuses)||[],C=(null===v||void 0===v?void 0:v.totalPages)||1,A=(null===v||void 0===v?void 0:v.total)||0;return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>a("process"),className:"px-6 py-3 font-semibold transition-colors ".concat("process"===s?"text-white border-b-2 border-pink-500":"text-gray-400 hover:text-white"),children:"Process Bonus"}),(0,sa.jsx)("button",{onClick:()=>a("history"),className:"px-6 py-3 font-semibold transition-colors ".concat("history"===s?"text-white border-b-2 border-pink-500":"text-gray-400 hover:text-white"),children:"Bonus History"})]}),"process"===s&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4",children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"\ud83d\udd0d Search Staff Member (Type at least 3 characters)"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",placeholder:"Search by name, email, phone number, or employee ID...",value:h,onChange:e=>x(e.target.value)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\ud83d\udc64 Click a Staff Member to Process Bonus"}),0===S.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:h.length>=3?"No staff members found matching your search":h.length>0?"Type at least 3 characters to search":"No staff members found"}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-h-96 overflow-y-auto",children:S.map(e=>(0,sa.jsxs)("button",{onClick:()=>(e=>{c(e),f((0,i.A)((0,i.A)({},g),{},{staffId:e.id})),o(!0)})(e),className:"bg-gradient-to-r from-pink-900/30 to-rose-900/30 border border-pink-700 rounded-lg p-4 hover:from-pink-800/40 hover:to-rose-800/40 transition-all text-left",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold text-lg",children:e.name}),(0,sa.jsx)("p",{className:"text-sm text-pink-400 mt-1",children:e.email||"No email"}),(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Role: ",e.role]}),e.phone&&(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Phone: ",e.phone]}),e.employeeId&&(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Employee ID: ",e.employeeId]})]},e.id))})]})]}),"history"===s&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",placeholder:"Name, email, or ID...",value:p.search,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",value:p.startDate,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{startDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"End Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",value:p.endDate,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{endDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Staff"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",value:p.staffId,onChange:e=>b((0,i.A)((0,i.A)({},p),{},{staffId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Staff"}),S.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4",children:["Bonus History (Total: ",A,")"]}),w?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===k.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No bonuses found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Staff"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Bonus Type"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Amount"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Reason"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Date"})]})}),(0,sa.jsx)("tbody",{children:k.map(e=>{var t;return(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:null===(t=e.staff)||void 0===t?void 0:t.name}),(0,sa.jsx)("td",{className:"text-white p-3",children:e.bonusType}),(0,sa.jsxs)("td",{className:"text-right text-pink-400 font-semibold p-3",children:["\u20b9",Number(e.bonusAmount).toFixed(2)]}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:e.reason||"-"}),(0,sa.jsx)("td",{className:"text-white p-3",children:new Date(e.processedAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]},e.id)})})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(u-1)+1," to ",Math.min(10*u,A)," of ",A," entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>m(e=>Math.max(1,e-1)),disabled:1===u,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(C)].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>m(t+1),className:"px-4 py-2 rounded-lg ".concat(u===t+1?"bg-pink-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>m(e=>Math.min(C,e+1)),disabled:u===C,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),l&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-pink-900/90 to-rose-900/90 rounded-xl p-6 max-w-md w-full border border-pink-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"\ud83d\udcb0 Process Staff Bonus"}),d&&(0,sa.jsxs)("div",{className:"bg-pink-900/30 border border-pink-600 rounded-lg p-4 mb-4",children:[(0,sa.jsx)("div",{className:"text-xs text-pink-400 mb-1",children:"Processing bonus for:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold text-xl",children:d.name}),(0,sa.jsx)("p",{className:"text-sm text-pink-300 mt-1",children:d.email||"No email"}),(0,sa.jsxs)("p",{className:"text-xs text-pink-400 mt-1",children:["Role: ",d.role]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Bonus Type *"}),(0,sa.jsxs)("select",{className:"w-full px-3 py-2 bg-pink-800/50 border border-pink-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",value:g.bonusType,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{bonusType:e.target.value,customBonusType:""})),children:[(0,sa.jsx)("option",{value:"",children:"Select Bonus Type"}),Ch.map(e=>(0,sa.jsx)("option",{value:e,children:e},e))]})]}),"Custom"===g.bonusType&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Custom Bonus Type Name *"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-pink-800/50 border border-pink-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",placeholder:"Enter custom bonus type name...",value:g.customBonusType,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{customBonusType:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Bonus Amount (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-3 py-2 bg-pink-800/50 border border-pink-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500",placeholder:"\u20b90.00",value:g.bonusAmount,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{bonusAmount:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-1 block",children:"Reason"}),(0,sa.jsx)("textarea",{className:"w-full px-3 py-2 bg-pink-800/50 border border-pink-600 rounded-lg text-white focus:ring-2 focus:ring-pink-500 h-20",placeholder:"Bonus reason...",value:g.reason,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{reason:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{g.staffId&&g.bonusType&&g.bonusAmount?"Custom"!==g.bonusType||g.customBonusType?j.mutate({staffId:g.staffId,bonusType:"Custom"===g.bonusType?g.customBonusType:g.bonusType,bonusAmount:Number(g.bonusAmount),reason:g.reason||void 0}):wr.error("Please enter custom bonus type name"):wr.error("Please fill in all required fields")},disabled:j.isLoading,className:"flex-1 bg-gradient-to-r from-pink-600 to-rose-600 hover:from-pink-500 hover:to-rose-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:j.isLoading?"Processing...":"Process Bonus"}),(0,sa.jsx)("button",{onClick:()=>{o(!1),c(null),N()},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}function Th(e){let{selectedPlayer:t,onSelect:s,clubId:a,placeholder:n="Search by name, ID, or email...",label:l="Search Player"}=e;const[i,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(!1),u=(0,r.useRef)(null),{data:m=[],isLoading:h}=hn({queryKey:["approvedPlayers",a],queryFn:async()=>{if(!a)return[];const e=[];let t=1;let s=!0;for(;s;)try{const r=await jr.Dv.getPlayers(a,{limit:50,page:t}),n=(null===r||void 0===r?void 0:r.players)||[];if(!n||0===n.length){s=!1;break}const l=n.filter(e=>("approved"===e.kycStatus||"verified"===e.kycStatus)&&"Active"===e.status);e.push(...l),n.length<50?s=!1:(t++,t>20&&(s=!1))}catch(r){console.error("Error fetching page ".concat(t,":"),r),s=!1}return e},enabled:!!a}),x=m.filter(e=>{if(!i||i.length<1)return!1;const t=i.toLowerCase();return e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.phoneNumber&&e.phoneNumber.includes(i)||e.playerId&&e.playerId.toLowerCase().includes(t)}).slice(0,10);(0,r.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);return(0,sa.jsxs)("div",{className:"relative",ref:u,children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2",children:[l," ",(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"(KYC Verified Players Only)"})]}),(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsx)("input",{type:"text",value:t?"".concat(t.name," (").concat(t.email,")"):i,onChange:e=>{const a=e.target.value;t&&s(null),o(a),c(!0)},onFocus:()=>{!i&&t||c(!0)},placeholder:n,readOnly:!!t,className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),t&&(0,sa.jsx)("button",{type:"button",onClick:()=>{s(null),o(""),c(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white text-xl leading-none",title:"Clear selection",children:"\xd7"})]}),d&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),(0,sa.jsx)("div",{className:"absolute z-20 w-full mt-2 bg-slate-700 rounded-lg max-h-64 overflow-y-auto shadow-xl border border-slate-600",children:h?(0,sa.jsx)("div",{className:"px-4 py-3 text-gray-400 text-sm",children:(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,sa.jsx)("span",{children:"Loading approved players (searching all pages)..."})]})}):0===x.length?(0,sa.jsx)("div",{className:"px-4 py-3 text-gray-400 text-sm",children:i.length<1?"Start typing to search approved players...":"No approved players found matching your search"}):x.map(e=>(0,sa.jsxs)("button",{type:"button",onClick:()=>(e=>{s(e),o(""),c(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-slate-600 transition-colors border-b border-slate-600 last:border-b-0",children:[(0,sa.jsx)("div",{className:"text-white font-medium",children:e.name}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:e.email}),e.phoneNumber&&(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:e.phoneNumber}),e.playerId&&(0,sa.jsxs)("div",{className:"text-gray-500 text-xs mt-1",children:["ID: ",e.playerId]})]},e.id))})]}),t&&(0,sa.jsxs)("div",{className:"mt-2 p-3 bg-green-500/10 border border-green-500 rounded-lg",children:[(0,sa.jsx)("div",{className:"text-green-400 font-medium",children:t.name}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:t.email}),t.phoneNumber&&(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:t.phoneNumber})]})]})}function Eh(e){var t;let{selectedClubId:s,onBack:a}=e;const n=ra(),[l,o]=(0,r.useState)("pending-requests");(0,r.useEffect)(()=>{if(!s)return;const e=id.channel("club-buyin-requests-".concat(s)).on("postgres_changes",{event:"*",schema:"public",table:"buyin_requests",filter:"club_id=eq.".concat(s)},()=>{n.invalidateQueries({queryKey:["clubBuyInRequests",s]})}).subscribe();return()=>{id.removeChannel(e)}},[s,n]);const{data:d=[],isLoading:c,error:u}=hn({queryKey:["clubBuyInRequests",s],queryFn:()=>jr.Od.getBuyInRequests(s),enabled:!!s,refetchInterval:15e3}),m=gn({mutationFn:e=>{let{requestId:t,amount:a}=e;return jr.Od.approveBuyInRequest(s,t,{amount:a})},onSuccess:()=>{wr.success("Buy-in request approved!"),n.invalidateQueries({queryKey:["clubBuyInRequests",s]})},onError:e=>wr.error(e.message||"Failed to approve")}),h=gn({mutationFn:e=>{let{requestId:t,reason:a}=e;return jr.Od.rejectBuyInRequest(s,t,{reason:a})},onSuccess:()=>{wr.success("Buy-in request rejected"),n.invalidateQueries({queryKey:["clubBuyInRequests",s]})},onError:e=>wr.error(e.message||"Failed to reject")}),[x,p]=(0,r.useState)(1),[b,g]=(0,r.useState)({type:"",gameType:"",playerName:"",startDate:"",endDate:""}),[f,y]=(0,r.useState)(null),[v,w]=(0,r.useState)(""),[j,N]=(0,r.useState)("Cash"),[S,k]=(0,r.useState)(""),[C,A]=(0,r.useState)(""),[_,P]=(0,r.useState)(null),[T,E]=(0,r.useState)(""),[I,R]=(0,r.useState)("1"),[D,O]=(0,r.useState)(""),[L,F]=(0,r.useState)(!1),[M,B]=(0,r.useState)(null),{data:q}=hn({queryKey:["playerBalance",s,null===_||void 0===_?void 0:_.id],queryFn:()=>jr.Dv.getPlayerBalance(s,_.id),enabled:!!s&&!!_}),{data:U=[]}=hn({queryKey:["recentBuyIns",s],queryFn:async()=>(await jr.Dv.getTransactions(s)).filter(e=>"Club Buy In"===e.type||"Deposit"===e.type).slice(0,10),enabled:!!s}),{data:z,isLoading:K}=hn({queryKey:["transactionHistory",s,x,b],queryFn:async()=>{let e=(await jr.Dv.getTransactions(s)).filter(e=>"Club Buy In"===e.type||"Club Buy Out"===e.type||"Deposit"===e.type||"Cashout"===e.type);if(b.type&&(e=e.filter(e=>e.type===b.type)),b.gameType&&(e=e.filter(e=>e.gameType===b.gameType)),b.playerName){const t=b.playerName.toLowerCase();e=e.filter(e=>{var s,a;return(null===(s=e.playerName)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(a=e.playerId)||void 0===a?void 0:a.toLowerCase().includes(t))})}if(b.startDate){const t=new Date(b.startDate);e=e.filter(e=>new Date(e.createdAt)>=t)}if(b.endDate){const t=new Date(b.endDate);t.setHours(23,59,59,999),e=e.filter(e=>new Date(e.createdAt)<=t)}e.sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt));const t=10*(x-1),a=t+10;return{transactions:e.slice(t,a),total:e.length,totalPages:Math.ceil(e.length/10),currentPage:x,perPage:10}},enabled:!!s&&"history"===l}),{data:W=[]}=hn({queryKey:["playersWithBalance",s],queryFn:async()=>{if(!s)return[];const e=[];let t=1;let a=!0;for(;a;)try{const r=await jr.Dv.getPlayers(s,{limit:50,page:t}),n=(null===r||void 0===r?void 0:r.players)||[];if(!n||0===n.length){a=!1;break}const l=n.filter(e=>("approved"===e.kycStatus||"verified"===e.kycStatus)&&"Active"===e.status);e.push(...l),n.length<50?a=!1:(t++,t>20&&(a=!1))}catch(r){console.error("Error fetching page ".concat(t,":"),r),a=!1}return e},enabled:!!s&&"cash-out"===l}),H=gn({mutationFn:async e=>await jr.Dv.createTransaction(s,{type:"Deposit",playerId:e.playerId,playerName:e.playerName,amount:parseFloat(e.amount),notes:e.notes}),onSuccess:()=>{wr.success("Buy-in processed successfully! Player balance updated."),n.invalidateQueries(["recentBuyIns",s]),n.invalidateQueries(["playerBalance"]),n.invalidateQueries(["clubPlayers",s]),y(null),w(""),N("Cash"),k(""),A("")},onError:e=>{wr.error(e.message||"Failed to process buy-in")}}),V=gn({mutationFn:async e=>await jr.Dv.createTransaction(s,{type:"Cashout",playerId:e.playerId,playerName:e.playerName,amount:parseFloat(e.amount),notes:e.notes}),onSuccess:()=>{wr.success("Cash-out processed successfully! Player balance updated."),n.invalidateQueries(["recentBuyIns",s]),n.invalidateQueries(["playerBalance"]),n.invalidateQueries(["clubPlayers",s]),n.invalidateQueries(["playersWithBalance",s]),P(null),E(""),R("1"),O(""),F(!1),B(null)},onError:e=>{wr.error(e.message||"Failed to process cash-out")}});return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Club Buy-In & Cash Out"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Manage player transactions and balance updates"})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-gray-700 overflow-x-auto",children:[(0,sa.jsxs)("button",{onClick:()=>o("pending-requests"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap relative ".concat("pending-requests"===l?"text-white border-b-2 border-orange-500 bg-orange-500/10":"text-gray-400 hover:text-white"),children:["Pending Requests",d.filter(e=>"pending"===e.status).length>0&&(0,sa.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full",children:d.filter(e=>"pending"===e.status).length})]}),(0,sa.jsx)("button",{onClick:()=>o("buy-in"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("buy-in"===l?"text-white border-b-2 border-green-500 bg-green-500/10":"text-gray-400 hover:text-white"),children:"Club Buy-In"}),(0,sa.jsx)("button",{onClick:()=>o("cash-out"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("cash-out"===l?"text-white border-b-2 border-blue-500 bg-blue-500/10":"text-gray-400 hover:text-white"),children:"Cash Out"}),(0,sa.jsx)("button",{onClick:()=>{o("history"),p(1)},className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("history"===l?"text-white border-b-2 border-purple-500 bg-purple-500/10":"text-gray-400 hover:text-white"),children:"Transaction History"})]}),"pending-requests"===l&&(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Player Buy-In Requests"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[d.filter(e=>"pending"===e.status).length," pending"]})]}),c?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"Loading buy-in requests..."}):u?(0,sa.jsxs)("div",{className:"text-center py-8",children:[(0,sa.jsx)("div",{className:"text-red-400 mb-2",children:"Failed to load buy-in requests"}),(0,sa.jsx)("div",{className:"text-gray-500 text-sm",children:u.message}),(0,sa.jsx)("button",{onClick:()=>n.invalidateQueries({queryKey:["clubBuyInRequests",s]}),className:"mt-3 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-sm",children:"Retry"})]}):0===d.filter(e=>"pending"===e.status).length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-5xl mb-4",children:"\ud83d\udccb"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No pending buy-in requests"}),(0,sa.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"When players request a buy-in from their table, it will appear here for approval"})]}):(0,sa.jsx)("div",{className:"space-y-4",children:d.filter(e=>"pending"===e.status).map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-5 border border-slate-600 hover:border-orange-500/50 transition-all",children:[(0,sa.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:e.playerName}),(0,sa.jsx)("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 rounded text-xs font-semibold",children:"PENDING"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Table:"}),(0,sa.jsx)("span",{className:"text-white ml-2 font-medium",children:e.tableNumber?"Table ".concat(e.tableNumber):"N/A"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Seat:"}),(0,sa.jsx)("span",{className:"text-white ml-2 font-medium",children:e.seatNumber?"Seat ".concat(e.seatNumber):"N/A"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Requested Amount:"}),(0,sa.jsxs)("span",{className:"text-green-400 ml-2 font-bold text-lg",children:["\u20b9",Number(e.requestedAmount||0).toLocaleString("en-IN")]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Current Table Balance:"}),(0,sa.jsxs)("span",{className:"text-white ml-2 font-medium",children:["\u20b9",Number(e.currentTableBalance||0).toLocaleString("en-IN")]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Requested At:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:e.requestedAt?new Date(e.requestedAt).toLocaleString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"}):"N/A"})]}),e.playerEmail&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Email:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:e.playerEmail})]})]})]})}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,sa.jsx)("button",{onClick:()=>{window.confirm("Approve buy-in of \u20b9".concat(Number(e.requestedAmount||0).toLocaleString("en-IN")," for ").concat(e.playerName,"?"))&&m.mutate({requestId:e.id,amount:e.requestedAmount||0})},disabled:m.isPending,className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg font-semibold transition-all disabled:opacity-50",children:m.isPending?"Processing...":"Approve"}),(0,sa.jsx)("button",{onClick:()=>{const t=window.prompt("Reason for rejection:");t&&t.trim()&&h.mutate({requestId:e.id,reason:t.trim()})},disabled:h.isPending,className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2.5 rounded-lg font-semibold transition-all disabled:opacity-50",children:"Reject"})]})]},e.id))})]})}),"buy-in"===l&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Club Buy-In - Purchase Chips"}),(0,sa.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!f)return void wr.error("Please select a player");if(!v||parseFloat(v)<=0)return void wr.error("Please enter a valid buy-in amount");const t=parseFloat(v);if(t>1e7)return void wr.error("Amount cannot exceed \u20b910,000,000");const s=[C,"Payment: ".concat(j),S?"Ref: ".concat(S):""].filter(Boolean).join(" | ");H.mutate({playerId:f.id,playerName:f.name,amount:t,notes:s})},children:[(0,sa.jsx)("div",{className:"mb-4",children:(0,sa.jsx)(Th,{selectedPlayer:f,onSelect:y,clubId:s,placeholder:"Search by name, ID, email, or phone...",label:"Search Player"})}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2",children:["Buy-In Amount (\u20b9) ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"number",value:v,onChange:e=>w(e.target.value),placeholder:"\u20b90.00",step:"0.01",min:"0",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm mt-1",children:"Enter the amount in real money (INR)"})]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2",children:["Payment Method ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsxs)("select",{value:j,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,sa.jsx)("option",{value:"Cash",children:"Cash"}),(0,sa.jsx)("option",{value:"Bank Transfer",children:"Bank Transfer"}),(0,sa.jsx)("option",{value:"UPI",children:"UPI"}),(0,sa.jsx)("option",{value:"Credit Card",children:"Credit Card"}),(0,sa.jsx)("option",{value:"Debit Card",children:"Debit Card"}),(0,sa.jsx)("option",{value:"Net Banking",children:"Net Banking"})]})]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2",children:"Reference/Transaction Number"}),(0,sa.jsx)("input",{type:"text",value:S,onChange:e=>k(e.target.value),placeholder:"Enter transaction reference (optional)",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm mt-1",children:"For bank transfers, UPI, cards, etc."})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2",children:"Notes"}),(0,sa.jsx)("textarea",{value:C,onChange:e=>A(e.target.value),placeholder:"Additional notes (optional)",rows:3,className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,sa.jsx)("button",{type:"submit",disabled:H.isPending,className:"w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-lg font-semibold hover:from-green-600 hover:to-green-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:H.isPending?"Processing...":"Process Club Buy-In"})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Recent Club Buy-Ins"}),(0,sa.jsx)("div",{className:"space-y-3",children:0===U.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No recent buy-ins found"}):U.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 p-4 rounded-lg hover:bg-slate-600 transition-colors",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:e.playerName}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:e.playerId})]}),(0,sa.jsxs)("div",{className:"text-right",children:[(0,sa.jsxs)("div",{className:"text-green-400 font-bold",children:["\u20b9",Number(e.amount).toLocaleString()]}),(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Chips: \u20b9",Number(e.amount).toLocaleString()]})]})]}),e.notes&&(0,sa.jsx)("div",{className:"text-gray-400 text-sm mt-2",children:e.notes.split("|").map((e,t)=>(0,sa.jsx)("div",{children:e.trim()},t))}),(0,sa.jsxs)("div",{className:"text-gray-500 text-xs mt-2",children:["Processed ",new Date(e.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]})]},e.id))}),(0,sa.jsxs)("div",{className:"mt-6 p-4 bg-blue-500/10 border border-blue-500 rounded-lg",children:[(0,sa.jsx)("h3",{className:"text-blue-400 font-semibold mb-2",children:"\ud83d\udca1 Buy-In Information"}),(0,sa.jsxs)("ul",{className:"text-gray-300 text-sm space-y-1",children:[(0,sa.jsx)("li",{children:"\u2022 Players purchase chips using real money (INR)"}),(0,sa.jsx)("li",{children:"\u2022 Chips are added to player's available balance"}),(0,sa.jsx)("li",{children:"\u2022 Standard ratio is 1:1 (\u20b91 = 1 chip)"}),(0,sa.jsx)("li",{children:"\u2022 Players can use chips to buy-in at tables"}),(0,sa.jsx)("li",{children:"\u2022 All transactions are recorded for audit"})]})]})]})]}),"cash-out"===l&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Process Cash Out"}),(0,sa.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!_)return void wr.error("Please select a player");if(!T||parseFloat(T)<=0)return void wr.error("Please enter a valid cash-out amount");if(!M)return void wr.error("Please verify balance before processing cash-out");if("error"===M.status)return void wr.error("Cannot process cash-out with insufficient balance");const t=parseFloat(T),s=parseFloat(I)||1,a=t*s,r=[D,"Conversion Rate: \u20b9".concat(s," per chip"),"Cash Given: \u20b9".concat(a.toLocaleString()),"warning"===M.status?"\u26a0\ufe0f FLAGGED FOR VERIFICATION":"\u2713 Verified"].filter(Boolean).join(" | ");V.mutate({playerId:_.id,playerName:_.name,amount:t,notes:r})},children:[(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)(Th,{selectedPlayer:_,onSelect:e=>{P(e),B(null),F(!1)},clubId:s,placeholder:"Search by name, ID, email, or phone...",label:"Search Player"}),_&&q&&(0,sa.jsxs)("div",{className:"mt-2 p-3 bg-blue-500/10 border border-blue-500 rounded-lg",children:[(0,sa.jsx)("div",{className:"text-blue-400 font-medium",children:_.name}),(0,sa.jsx)("div",{className:"text-gray-400 text-sm",children:_.email}),(0,sa.jsxs)("div",{className:"mt-2 pt-2 border-t border-blue-500/30",children:[(0,sa.jsxs)("div",{className:"text-white text-sm",children:["Available Balance: ",(0,sa.jsxs)("span",{className:"font-bold",children:["\u20b9",(null===(t=q.availableBalance)||void 0===t?void 0:t.toLocaleString())||0]})]}),q.tableBalance>0&&(0,sa.jsxs)("div",{className:"text-yellow-400 text-sm",children:["Table Balance: \u20b9",q.tableBalance.toLocaleString()]})]})]})]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2",children:["Cash-Out Amount (Chips) ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"number",value:T,onChange:e=>{E(e.target.value),B(null)},placeholder:"0.00",step:"0.01",min:"0",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2",children:"Conversion Rate (\u20b9 per chip)"}),(0,sa.jsx)("input",{type:"number",value:I,onChange:e=>R(e.target.value),placeholder:"1",step:"0.01",min:"0",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,sa.jsxs)("div",{className:"text-gray-400 text-sm mt-1",children:["Default: 1 chip = \u20b91 \u2022 Cash to give: \u20b9",(parseFloat(T||0)*parseFloat(I||1)).toLocaleString()]})]}),_&&T&&(0,sa.jsx)("button",{type:"button",onClick:async()=>{if(!_||!T)return void wr.error("Please select a player and enter amount");const e=parseFloat(T);if(!q)return void wr.error("Unable to fetch player balance");const t=q.availableBalance||0,s=q.tableBalance||0,a=q.totalBalance||0;Math.abs(e-t)<.01?(B({status:"success",message:"Balance verification successful",availableBalance:t,tableBalance:s,totalBalance:a}),F(!1),wr.success("Balance verified! You can proceed with cash-out.")):e>a?(B({status:"error",message:"Insufficient balance",availableBalance:t,tableBalance:s,totalBalance:a}),F(!0),wr.error("Cash-out amount exceeds player's total balance!")):e>t?(B({status:"warning",message:"Player has chips at table",availableBalance:t,tableBalance:s,totalBalance:a}),F(!0),wr.error("Player has chips at table. Collect table chips first.",{icon:"\u26a0\ufe0f",duration:4e3})):(B({status:"warning",message:"Amount mismatch - flagged for review",availableBalance:t,tableBalance:s,totalBalance:a}),F(!0),wr.error("Balance mismatch detected. Transaction will be flagged for verification.",{icon:"\u26a0\ufe0f",duration:4e3}))},className:"w-full mb-4 bg-yellow-500 text-black py-2 rounded-lg font-semibold hover:bg-yellow-600 transition-all",children:"\ud83d\udd0d Verify Balance Before Cash-Out"}),M&&(0,sa.jsxs)("div",{className:"mb-4 p-4 rounded-lg border ".concat("success"===M.status?"bg-green-500/10 border-green-500":"error"===M.status?"bg-red-500/10 border-red-500":"bg-yellow-500/10 border-yellow-500"),children:[(0,sa.jsxs)("div",{className:"font-semibold mb-2 ".concat("success"===M.status?"text-green-400":"error"===M.status?"text-red-400":"text-yellow-400"),children:["success"===M.status?"\u2713":"\u26a0\ufe0f"," ",M.message]}),(0,sa.jsxs)("div",{className:"text-gray-300 text-sm space-y-1",children:[(0,sa.jsxs)("div",{children:["Available: \u20b9",M.availableBalance.toLocaleString()]}),(0,sa.jsxs)("div",{children:["At Table: \u20b9",M.tableBalance.toLocaleString()]}),(0,sa.jsxs)("div",{children:["Total: \u20b9",M.totalBalance.toLocaleString()]}),(0,sa.jsxs)("div",{children:["Requested: \u20b9",parseFloat(T).toLocaleString()]})]})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2",children:"Notes"}),(0,sa.jsx)("textarea",{value:D,onChange:e=>O(e.target.value),placeholder:"Additional notes (optional)",rows:3,className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,sa.jsx)("button",{type:"submit",disabled:V.isPending||!M,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:V.isPending?"Processing...":"Process Cash Out"})]})]}),(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 shadow-xl",children:[(0,sa.jsx)("h3",{className:"text-blue-400 font-semibold mb-3 flex items-center gap-2",children:"\ud83d\udca1 How Cash Out Works:"}),(0,sa.jsxs)("ul",{className:"text-gray-300 text-sm space-y-2",children:[(0,sa.jsx)("li",{children:"\u2022 Select a player who has chips in their available balance"}),(0,sa.jsx)("li",{children:"\u2022 System validates balance consistency across three sources:"}),(0,sa.jsx)("li",{className:"ml-4",children:"- Player Portal Balance"}),(0,sa.jsx)("li",{className:"ml-4",children:"- Table Buy-Out Balance Records"}),(0,sa.jsx)("li",{className:"ml-4",children:"- Cashier/SuperAdmin View Balance"}),(0,sa.jsx)("li",{children:"\u2022 Enter the amount of chips to convert to real money"}),(0,sa.jsx)("li",{children:"\u2022 Set conversion rate (default: 1 chip = \u20b91)"}),(0,sa.jsx)("li",{children:"\u2022 Chips are deducted from player's balance, real money is paid out"})]})]}),(0,sa.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-yellow-400 font-semibold mb-3 flex items-center gap-2",children:"\u26a0\ufe0f Balance Validation:"}),(0,sa.jsxs)("ul",{className:"text-gray-300 text-sm space-y-2",children:[(0,sa.jsx)("li",{children:"\u2022 System automatically checks if balances match across all sources"}),(0,sa.jsx)("li",{children:"\u2022 If mismatch detected, transaction is flagged with warning"}),(0,sa.jsx)("li",{children:"\u2022 Review flagged transactions carefully before processing"}),(0,sa.jsx)("li",{children:"\u2022 Contact system administrator if balance discrepancies persist"})]})]}),(0,sa.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-blue-400 font-semibold mb-3 flex items-center gap-2",children:"\ud83d\udca1 Important Notes:"}),(0,sa.jsxs)("ul",{className:"text-gray-300 text-sm space-y-2",children:[(0,sa.jsx)("li",{children:"\u2022 Cash out is permanent - chips cannot be recovered"}),(0,sa.jsx)("li",{children:"\u2022 Conversion rate can be adjusted based on club policy"}),(0,sa.jsx)("li",{children:"\u2022 Always verify player identity before processing cash out"}),(0,sa.jsx)("li",{children:"\u2022 Keep transaction records for audit purposes"})]})]}),(0,sa.jsxs)("div",{className:"bg-green-500/10 border border-green-500 rounded-lg p-6",children:[(0,sa.jsx)("h3",{className:"text-green-400 font-semibold mb-3",children:"Players with Available Balance:"}),(0,sa.jsxs)("div",{className:"text-white text-2xl font-bold",children:[W.length," player(s) have chips available for cash out"]})]})]})]}),"history"===l&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Filter Transactions"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 text-sm",children:"Transaction Type"}),(0,sa.jsxs)("select",{value:b.type,onChange:e=>{g((0,i.A)((0,i.A)({},b),{},{type:e.target.value})),p(1)},className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,sa.jsx)("option",{value:"",children:"All Types"}),(0,sa.jsx)("option",{value:"Deposit",children:"Buy-In"}),(0,sa.jsx)("option",{value:"Cashout",children:"Cash-Out"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 text-sm",children:"Game Type"}),(0,sa.jsxs)("select",{value:b.gameType,onChange:e=>{g((0,i.A)((0,i.A)({},b),{},{gameType:e.target.value})),p(1)},className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,sa.jsx)("option",{value:"",children:"All Games"}),(0,sa.jsx)("option",{value:"poker",children:"\u2660 Poker"}),(0,sa.jsx)("option",{value:"rummy",children:"\ud83c\udccf Rummy"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 text-sm",children:"Player Name/ID"}),(0,sa.jsx)("input",{type:"text",value:b.playerName,onChange:e=>{g((0,i.A)((0,i.A)({},b),{},{playerName:e.target.value})),p(1)},placeholder:"Search by name or ID...",className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 text-sm",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:b.startDate,onChange:e=>{g((0,i.A)((0,i.A)({},b),{},{startDate:e.target.value})),p(1)},className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 text-sm",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:b.endDate,onChange:e=>{g((0,i.A)((0,i.A)({},b),{},{endDate:e.target.value})),p(1)},className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(b.type||b.playerName||b.startDate||b.endDate)&&(0,sa.jsx)("button",{onClick:()=>{g({type:"",playerName:"",startDate:"",endDate:""}),p(1)},className:"mt-4 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Clear All Filters"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 shadow-xl",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white",children:"Transaction History"}),z&&(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(x-1)+1," - ",Math.min(10*x,z.total)," of ",z.total," transactions"]})]}),K?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Loading transactions..."})]}):z&&0!==z.transactions.length?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Date & Time"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Type"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Player"}),(0,sa.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-semibold",children:"Amount"}),(0,sa.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-semibold",children:"Notes"})]})}),(0,sa.jsx)("tbody",{children:z.transactions.map(e=>(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700/50 transition-colors",children:[(0,sa.jsxs)("td",{className:"py-4 px-4",children:[(0,sa.jsx)("div",{className:"text-white text-sm",children:new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:new Date(e.createdAt).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata"})})]}),(0,sa.jsx)("td",{className:"py-4 px-4",children:(0,sa.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("Club Buy In"===e.type||"Deposit"===e.type?"bg-green-500/20 text-green-400":"Club Buy Out"===e.type||"Cashout"===e.type?"bg-blue-500/20 text-blue-400":"Table Buy In"===e.type?"bg-yellow-500/20 text-yellow-400":"Table Buy Out"===e.type?"bg-cyan-500/20 text-cyan-400":"bg-gray-500/20 text-gray-400"),children:"Club Buy In"===e.type||"Deposit"===e.type?"Club Buy-In":"Club Buy Out"===e.type||"Cashout"===e.type?"Club Cash-Out":"Table Buy In"===e.type?"Table Buy-In":"Table Buy Out"===e.type?"Table Buy-Out":e.type}),e.gameType&&(0,sa.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider ".concat("poker"===e.gameType?"bg-indigo-500/20 text-indigo-300 border border-indigo-500/30":"bg-amber-500/20 text-amber-300 border border-amber-500/30"),children:"poker"===e.gameType?"\u2660 Poker":"\ud83c\udccf Rummy"}),e.isOverridden&&(0,sa.jsx)("span",{onClick:()=>{e.overrideReason&&alert("Override Reason:\n\n".concat(e.overrideReason))},className:"px-2 py-1 rounded text-xs bg-orange-900/30 text-orange-400 border border-orange-700 cursor-pointer hover:bg-orange-900/50 transition-colors inline-block",title:"Click to view override reason",children:"\u270f\ufe0f Overridden"})]})}),(0,sa.jsxs)("td",{className:"py-4 px-4",children:[(0,sa.jsx)("div",{className:"text-white font-medium",children:e.playerName}),(0,sa.jsx)("div",{className:"text-gray-400 text-xs",children:e.playerId})]}),(0,sa.jsx)("td",{className:"py-4 px-4 text-right",children:(0,sa.jsxs)("div",{className:"flex flex-col items-end",children:[(0,sa.jsxs)("div",{className:"font-bold ".concat("Club Buy In"===e.type||"Deposit"===e.type?"text-green-400":"text-blue-400"),children:["Club Buy In"===e.type||"Deposit"===e.type?"+":"-","\u20b9",Number(e.amount).toLocaleString()]}),e.originalAmount&&(0,sa.jsxs)("div",{className:"text-xs text-gray-400 line-through mt-1",children:["Club Buy In"===e.type||"Deposit"===e.type?"+":"-","\u20b9",Number(e.originalAmount).toLocaleString()]})]})}),(0,sa.jsx)("td",{className:"py-4 px-4",children:e.notes?(0,sa.jsx)("div",{className:"text-gray-400 text-sm max-w-xs",children:e.notes.split("|").map((e,t)=>(0,sa.jsx)("div",{className:"truncate",children:e.trim()},t))}):(0,sa.jsx)("span",{className:"text-gray-500 text-sm",children:"-"})})]},e.id))})]})}),z.totalPages>1&&(0,sa.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,sa.jsx)("button",{onClick:()=>p(e=>Math.max(1,e-1)),disabled:1===x,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:Array.from({length:Math.min(5,z.totalPages)},(e,t)=>{let s;return s=z.totalPages<=5||x<=3?t+1:x>=z.totalPages-2?z.totalPages-4+t:x-2+t,(0,sa.jsx)("button",{onClick:()=>p(s),className:"px-4 py-2 rounded-lg transition-colors ".concat(x===s?"bg-purple-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:s},s)})}),(0,sa.jsx)("button",{onClick:()=>p(e=>Math.min(z.totalPages,e+1)),disabled:x===z.totalPages,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),(0,sa.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{className:"bg-green-500/10 border border-green-500 rounded-lg p-4",children:[(0,sa.jsx)("div",{className:"text-green-400 text-sm mb-1",children:"Total Club Buy-Ins"}),(0,sa.jsxs)("div",{className:"text-white text-2xl font-bold",children:["\u20b9",z.transactions.filter(e=>"Club Buy In"===e.type||"Deposit"===e.type).reduce((e,t)=>e+Number(t.amount),0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500 rounded-lg p-4",children:[(0,sa.jsx)("div",{className:"text-blue-400 text-sm mb-1",children:"Total Cash-Outs"}),(0,sa.jsxs)("div",{className:"text-white text-2xl font-bold",children:["\u20b9",z.transactions.filter(e=>"Cashout"===e.type).reduce((e,t)=>e+Number(t.amount),0).toLocaleString()]})]}),(0,sa.jsxs)("div",{className:"bg-purple-500/10 border border-purple-500 rounded-lg p-4",children:[(0,sa.jsx)("div",{className:"text-purple-400 text-sm mb-1",children:"Net Flow"}),(0,sa.jsxs)("div",{className:"text-white text-2xl font-bold",children:["\u20b9",(z.transactions.filter(e=>"Club Buy In"===e.type||"Deposit"===e.type).reduce((e,t)=>e+Number(t.amount),0)-z.transactions.filter(e=>"Club Buy Out"===e.type||"Cashout"===e.type).reduce((e,t)=>e+Number(t.amount),0)).toLocaleString()]})]})]})]}):(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udcca"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No transactions found"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Try adjusting your filters"})]})]})]})]})}const Ih=10,Rh=e=>{if(!e)return"Unknown";const t={BUY_IN:"Buy In",BUY_OUT:"Buy Out",CLUB_BUY_IN:"Club Buy In",CLUB_BUY_OUT:"Club Buy Out",TABLE_BUY_IN:"Table Buy In",TABLE_BUY_OUT:"Table Buy Out",CREDIT:"Credit",DEBIT:"Debit",DEPOSIT:"Deposit",WITHDRAWAL:"Withdrawal",REFUND:"Refund",RAKE:"Rake",BONUS:"Bonus",SALARY_PAYMENT:"Salary Payment",DEALER_CASHOUT:"Dealer Cashout",MANAGER_CASHOUT:"Manager Cashout"};return t[e]?t[e]:t[e.toUpperCase()]?t[e.toUpperCase()]:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())};function Dh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("players"),[n,l]=(0,r.useState)("dealer-cashout"),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),[x,p]=(0,r.useState)("date"),[b,g]=(0,r.useState)("desc"),[f,y]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[j,N]=(0,r.useState)(""),[S,k]=(0,r.useState)(1),[C,A]=(0,r.useState)({amount:"",reason:""}),[_,P]=(0,r.useState)({reason:""}),T=ra(),{data:E,isLoading:I}=hn({queryKey:["financial-overrides",t,s,n],queryFn:()=>jr.bM.getAllTransactions(t,{category:"players"===s?"player":"staff",subCategory:"staff"===s?n:void 0,page:1,limit:9999}),enabled:!!t}),R=gn({mutationFn:e=>{let{transactionId:s,data:a}=e;return jr.bM.editTransaction(t,s,a)},onSuccess:()=>{wr.success("Transaction edited successfully!"),T.invalidateQueries(["financial-overrides",t]),d(!1),h(null),A({amount:"",reason:""})},onError:e=>{wr.error(e.message||"Failed to edit transaction")}}),D=gn({mutationFn:e=>{let{transactionId:s,data:a}=e;return jr.bM.cancelTransaction(t,s,a)},onSuccess:()=>{wr.success("Transaction cancelled successfully!"),T.invalidateQueries(["financial-overrides",t]),u(!1),h(null),P({reason:""})},onError:e=>{wr.error(e.message||"Failed to cancel transaction")}}),O=(null===E||void 0===E?void 0:E.transactions)||[],L=()=>{y(""),w(""),N(""),p("date"),g("desc"),k(1)},F=(0,r.useMemo)(()=>{let e=[...O];if(f.trim()){const t=f.toLowerCase().trim();e=e.filter(e=>(e.entityName||"").toLowerCase().includes(t))}if(v){const t=new Date(v);t.setHours(0,0,0,0),e=e.filter(e=>new Date(e.date)>=t)}if(j){const t=new Date(j);t.setHours(23,59,59,999),e=e.filter(e=>new Date(e.date)<=t)}return e.sort((e,t)=>{let s,a;switch(x){case"type":s=Rh(e.type).toLowerCase(),a=Rh(t.type).toLowerCase();break;case"game":s=(e.gameType||"general").toLowerCase(),a=(t.gameType||"general").toLowerCase();break;case"name":s=(e.entityName||"").toLowerCase(),a=(t.entityName||"").toLowerCase();break;case"amount":return s=Number(e.amount||0),a=Number(t.amount||0),"asc"===b?s-a:a-s;case"status":s=(e.status||"").toLowerCase(),a=(t.status||"").toLowerCase();break;default:return s=new Date(e.date||0).getTime(),a=new Date(t.date||0).getTime(),"asc"===b?s-a:a-s}return s<a?"asc"===b?-1:1:s>a?"asc"===b?1:-1:0}),e},[O,f,v,j,x,b]),M=F.length,B=(Math.max(1,Math.ceil(M/Ih)),F.slice((S-1)*Ih,S*Ih)),q=(0,r.useMemo)(()=>{const e=O,t=e.reduce((e,t)=>e+Number(t.amount||0),0),s={};e.forEach(e=>{const t=Rh(e.type);s[t]||(s[t]={count:0,amount:0}),s[t].count++,s[t].amount+=Number(e.amount||0)});const a=e.filter(e=>"poker"===e.gameType),r=e.filter(e=>"rummy"===e.gameType),n=e.filter(e=>"poker"!==e.gameType&&"rummy"!==e.gameType),l=e=>{const t=e.reduce((e,t)=>e+Number(t.amount||0),0),s={};return e.forEach(e=>{const t=Rh(e.type);s[t]||(s[t]={count:0,amount:0}),s[t].count++,s[t].amount+=Number(e.amount||0)}),{count:e.length,total:t,byType:s}};return{club:{count:e.length,total:t,byType:s},poker:l(a),rummy:l(r),general:l(n)}},[O]),U=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"completed":case"processed":return"text-green-400";case"pending":return"text-yellow-400";case"cancelled":return"text-red-400";case"failed":return"text-red-500";default:return"text-gray-400"}},z=e=>{const t=(e||"").toLowerCase().replace(/_/g," ");return t.includes("club buy in")?"bg-green-900/40 text-green-400 border-green-600/50":t.includes("club buy out")?"bg-red-900/40 text-red-400 border-red-600/50":t.includes("table buy in")?"bg-cyan-900/40 text-cyan-400 border-cyan-600/50":t.includes("table buy out")?"bg-teal-900/40 text-teal-400 border-teal-600/50":t.includes("buy in")?"bg-emerald-900/40 text-emerald-400 border-emerald-600/50":t.includes("buy out")?"bg-orange-900/40 text-orange-400 border-orange-600/50":t.includes("credit")?"bg-yellow-900/40 text-yellow-400 border-yellow-600/50":t.includes("debit")?"bg-orange-900/40 text-orange-400 border-orange-600/50":t.includes("bonus")?"bg-purple-900/40 text-purple-400 border-purple-600/50":t.includes("deposit")?"bg-blue-900/40 text-blue-400 border-blue-600/50":t.includes("refund")?"bg-indigo-900/40 text-indigo-400 border-indigo-600/50":t.includes("cashout")||t.includes("withdrawal")?"bg-rose-900/40 text-rose-400 border-rose-600/50":t.includes("rake")?"bg-emerald-900/40 text-emerald-400 border-emerald-600/50":t.includes("salary")?"bg-violet-900/40 text-violet-400 border-violet-600/50":"bg-gray-900/40 text-gray-400 border-gray-600/50"},K=e=>{let{field:t,label:s,align:a="left"}=e;const r=x===t;return(0,sa.jsx)("th",{className:"p-3 cursor-pointer select-none hover:bg-slate-700/50 transition-colors text-".concat(a),onClick:()=>(e=>{x===e?g(e=>"asc"===e?"desc":"asc"):(p(e),g("date"===e?"desc":"asc")),k(1)})(t),children:(0,sa.jsxs)("div",{className:"flex items-center gap-1.5 ".concat("right"===a?"justify-end":"center"===a?"justify-center":""),children:[(0,sa.jsx)("span",{className:"text-sm font-semibold ".concat(r?"text-cyan-300":"text-white"),children:s}),(0,sa.jsxs)("span",{className:"flex flex-col text-[10px] leading-none",children:[(0,sa.jsx)("span",{className:r&&"asc"===b?"text-cyan-400":"text-gray-600",children:"\u25b2"}),(0,sa.jsx)("span",{className:r&&"desc"===b?"text-cyan-400":"text-gray-600",children:"\u25bc"})]})]})})},W=e=>{let{total:t,current:s,onChange:a,filteredCount:r}=e;const n=Math.max(1,Math.ceil(r/Ih));if(0===r)return null;const l=(s-1)*Ih+1,i=Math.min(s*Ih,r);return(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4 flex-wrap gap-3",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",l,"\u2013",i," of ",r," entries",r<t&&(0,sa.jsxs)("span",{className:"text-gray-500 ml-1",children:["(",t," total)"]})]}),(0,sa.jsxs)("div",{className:"flex gap-1.5",children:[(0,sa.jsx)("button",{onClick:()=>a(1),disabled:1===s,className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-sm disabled:opacity-40 disabled:cursor-not-allowed",children:"\xab"}),(0,sa.jsx)("button",{onClick:()=>a(Math.max(1,s-1)),disabled:1===s,className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-sm disabled:opacity-40 disabled:cursor-not-allowed",children:"\u2039"}),(()=>{const e=[];let t=Math.max(1,s-Math.floor(2.5)),a=Math.min(n,t+5-1);a-t+1<5&&(t=Math.max(1,a-5+1));for(let s=t;s<=a;s++)e.push(s);return e})().map(e=>(0,sa.jsx)("button",{onClick:()=>a(e),className:"px-3 py-1.5 rounded-lg text-sm font-medium ".concat(s===e?"bg-cyan-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:e},e)),(0,sa.jsx)("button",{onClick:()=>a(Math.min(n,s+1)),disabled:s===n,className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-sm disabled:opacity-40 disabled:cursor-not-allowed",children:"\u203a"}),(0,sa.jsx)("button",{onClick:()=>a(n),disabled:s===n,className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-sm disabled:opacity-40 disabled:cursor-not-allowed",children:"\xbb"})]})]})},H="players"===s?"Player":"Staff";return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Transactions"})}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>{a("players"),L()},className:"px-6 py-3 font-semibold transition-colors ".concat("players"===s?"text-white border-b-2 border-cyan-500 bg-cyan-900/20":"text-gray-400 hover:text-white"),children:"Player Transactions"}),(0,sa.jsx)("button",{onClick:()=>{a("staff"),l("dealer-cashout"),L()},className:"px-6 py-3 font-semibold transition-colors ".concat("staff"===s?"text-white border-b-2 border-purple-500 bg-purple-900/20":"text-gray-400 hover:text-white"),children:"Staff Transactions"})]}),"staff"===s&&(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700 mt-2",children:[(0,sa.jsx)("button",{onClick:()=>{l("dealer-cashout"),L()},className:"px-6 py-2 font-semibold transition-colors text-sm ".concat("dealer-cashout"===n?"text-white border-b-2 border-green-500 bg-green-900/20":"text-gray-400 hover:text-white"),children:"Dealer Cashouts"}),(0,sa.jsx)("button",{onClick:()=>{l("salary-bonus"),L()},className:"px-6 py-2 font-semibold transition-colors text-sm ".concat("salary-bonus"===n?"text-white border-b-2 border-blue-500 bg-blue-900/20":"text-gray-400 hover:text-white"),children:"Salary & Bonuses"})]}),!I&&O.length>0&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,sa.jsxs)("div",{className:"bg-cyan-900/20 border border-cyan-500/30 rounded-xl p-5",children:[(0,sa.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,sa.jsx)("h3",{className:"text-lg font-bold text-cyan-300",children:"Club Total"})}),(0,sa.jsxs)("div",{className:"flex items-baseline gap-2 mb-3",children:[(0,sa.jsx)("span",{className:"text-3xl font-bold text-white",children:q.club.count}),(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"transactions"}),(0,sa.jsxs)("span",{className:"ml-auto text-xl font-bold text-cyan-300",children:["\u20b9",q.club.total.toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),Object.keys(q.club.byType).length>0&&(0,sa.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:Object.entries(q.club.byType).map(e=>{let[t,s]=e;return(0,sa.jsxs)("span",{className:"text-xs bg-cyan-900/40 text-cyan-200 px-2 py-1 rounded border border-cyan-600/30",children:[t,": ",s.count," (\u20b9",s.amount.toLocaleString("en-IN",{minimumFractionDigits:2}),")"]},t)})})]}),(0,sa.jsxs)("div",{className:"bg-indigo-900/20 border border-indigo-500/30 rounded-xl p-5",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,sa.jsx)("span",{className:"text-lg",children:"\u2660"}),(0,sa.jsx)("h3",{className:"text-lg font-bold text-indigo-300",children:"Poker"})]}),(0,sa.jsxs)("div",{className:"flex items-baseline gap-2 mb-3",children:[(0,sa.jsx)("span",{className:"text-3xl font-bold text-white",children:q.poker.count}),(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"transactions"}),(0,sa.jsxs)("span",{className:"ml-auto text-xl font-bold text-indigo-300",children:["\u20b9",q.poker.total.toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),Object.keys(q.poker.byType).length>0&&(0,sa.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:Object.entries(q.poker.byType).map(e=>{let[t,s]=e;return(0,sa.jsxs)("span",{className:"text-xs bg-indigo-900/40 text-indigo-200 px-2 py-1 rounded border border-indigo-600/30",children:[t,": ",s.count," (\u20b9",s.amount.toLocaleString("en-IN",{minimumFractionDigits:2}),")"]},t)})})]}),(0,sa.jsxs)("div",{className:"bg-amber-900/20 border border-amber-500/30 rounded-xl p-5",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,sa.jsx)("span",{className:"text-lg",children:"\ud83c\udccf"}),(0,sa.jsx)("h3",{className:"text-lg font-bold text-amber-300",children:"Rummy"})]}),(0,sa.jsxs)("div",{className:"flex items-baseline gap-2 mb-3",children:[(0,sa.jsx)("span",{className:"text-3xl font-bold text-white",children:q.rummy.count}),(0,sa.jsx)("span",{className:"text-gray-400 text-sm",children:"transactions"}),(0,sa.jsxs)("span",{className:"ml-auto text-xl font-bold text-amber-300",children:["\u20b9",q.rummy.total.toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),Object.keys(q.rummy.byType).length>0?(0,sa.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:Object.entries(q.rummy.byType).map(e=>{let[t,s]=e;return(0,sa.jsxs)("span",{className:"text-xs bg-amber-900/40 text-amber-200 px-2 py-1 rounded border border-amber-600/30",children:[t,": ",s.count," (\u20b9",s.amount.toLocaleString("en-IN",{minimumFractionDigits:2}),")"]},t)})}):(0,sa.jsx)("div",{className:"text-xs text-gray-500",children:"No rummy transactions yet"})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,sa.jsxs)("h3",{className:"text-xl font-semibold text-white",children:["players"===s?"Player Transactions":"dealer-cashout"===n?"Dealer Cashouts":"Salary & Bonuses"," ","(",M,M<O.length?" of ".concat(O.length):"",")"]}),(f||v||j)&&(0,sa.jsx)("button",{onClick:L,className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-gray-300 rounded-lg text-sm border border-slate-600 transition-colors",children:"\u2715 Clear Filters"})]}),(0,sa.jsxs)("div",{className:"flex flex-wrap gap-3 mb-4 items-end",children:[(0,sa.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,sa.jsxs)("label",{className:"text-xs text-gray-400 mb-1 block",children:["Search by ",H," Name"]}),(0,sa.jsx)("input",{type:"text",placeholder:"Search ".concat(H.toLowerCase()," name..."),value:f,onChange:e=>{y(e.target.value),k(1)},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm placeholder-gray-500 focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-xs text-gray-400 mb-1 block",children:"From Date"}),(0,sa.jsx)("input",{type:"date",value:v,onChange:e=>{w(e.target.value),k(1)},className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm focus:ring-2 focus:ring-cyan-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-xs text-gray-400 mb-1 block",children:"To Date"}),(0,sa.jsx)("input",{type:"date",value:j,onChange:e=>{N(e.target.value),k(1)},className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm focus:ring-2 focus:ring-cyan-500"})]})]}),I?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===O.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No transactions found"}):0===F.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No transactions match your filters"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-600 bg-slate-750",children:[(0,sa.jsx)(K,{field:"type",label:"Type"}),(0,sa.jsx)(K,{field:"game",label:"Game",align:"center"}),(0,sa.jsx)(K,{field:"name",label:"".concat(H," Name")}),(0,sa.jsx)(K,{field:"amount",label:"Amount",align:"right"}),(0,sa.jsx)(K,{field:"status",label:"Status",align:"center"}),(0,sa.jsx)(K,{field:"date",label:"Date"}),(0,sa.jsx)("th",{className:"text-center text-white font-semibold p-3 text-sm",children:"Actions"})]})}),(0,sa.jsx)("tbody",{children:B.map(e=>{return(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30 transition-colors",children:[(0,sa.jsxs)("td",{className:"p-3",children:[(0,sa.jsx)("span",{className:"px-2.5 py-1 rounded-md text-xs font-semibold border inline-block ".concat(z(e.type)),children:Rh(e.type)}),e.isOverridden&&(0,sa.jsx)("span",{onClick:()=>{e.overrideReason&&alert("Override Reason:\n\n".concat(e.overrideReason))},className:"ml-2 px-2 py-1 rounded text-xs bg-orange-900/30 text-orange-400 border border-orange-700 cursor-pointer hover:bg-orange-900/50 transition-colors",title:"Click to view override reason",children:"\u270f\ufe0f Overridden"})]}),(0,sa.jsx)("td",{className:"p-3 text-center",children:(t=e.gameType,"rummy"===t?(0,sa.jsxs)("span",{className:"px-2.5 py-1 rounded-md text-xs font-bold bg-amber-500/20 text-amber-300 border border-amber-500/40 inline-flex items-center gap-1",children:[(0,sa.jsx)("span",{children:"\ud83c\udccf"})," Rummy"]}):"poker"===t?(0,sa.jsxs)("span",{className:"px-2.5 py-1 rounded-md text-xs font-bold bg-indigo-500/20 text-indigo-300 border border-indigo-500/40 inline-flex items-center gap-1",children:[(0,sa.jsx)("span",{children:"\u2660"})," Poker"]}):(0,sa.jsxs)("span",{className:"px-2.5 py-1 rounded-md text-xs font-bold bg-slate-500/20 text-slate-300 border border-slate-500/40 inline-flex items-center gap-1",children:[(0,sa.jsx)("span",{children:"\ud83c\udfaf"})," General"]}))}),(0,sa.jsx)("td",{className:"text-white p-3 font-medium",children:e.entityName}),(0,sa.jsx)("td",{className:"text-right p-3",children:(0,sa.jsxs)("div",{className:"flex flex-col items-end",children:[(0,sa.jsxs)("span",{className:"text-white font-semibold",children:["\u20b9",Number(e.amount).toLocaleString("en-IN",{minimumFractionDigits:2})]}),e.originalAmount&&(0,sa.jsxs)("span",{className:"text-xs text-gray-500 line-through",children:["\u20b9",Number(e.originalAmount).toLocaleString("en-IN",{minimumFractionDigits:2})]})]})}),(0,sa.jsx)("td",{className:"text-center p-3",children:(0,sa.jsx)("span",{className:"font-semibold text-sm ".concat(U(e.status)),children:e.status})}),(0,sa.jsx)("td",{className:"text-gray-300 p-3 text-sm",children:new Date(e.date).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",day:"numeric",month:"short",year:"numeric"})}),(0,sa.jsx)("td",{className:"text-center p-3",children:(0,sa.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{h(e),A({amount:e.amount.toString(),reason:""}),d(!0)})(e),disabled:"Cancelled"===e.status,className:"px-3 py-1 bg-blue-900/30 hover:bg-blue-800/50 text-blue-400 rounded-lg text-sm border border-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit"}),(0,sa.jsx)("button",{onClick:()=>(e=>{h(e),P({reason:""}),u(!0)})(e),disabled:"Cancelled"===e.status,className:"px-3 py-1 bg-red-900/30 hover:bg-red-800/50 text-red-400 rounded-lg text-sm border border-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"})]})})]},e.id);var t})})]})}),(0,sa.jsx)(W,{total:O.length,filteredCount:M,current:S,onChange:k})]})]}),o&&m&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-blue-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Edit Transaction"}),(0,sa.jsxs)("div",{className:"bg-blue-900/30 border border-blue-600 rounded-lg p-4 mb-6",children:[(0,sa.jsx)("div",{className:"text-xs text-blue-400 mb-1",children:"Transaction Details:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold",children:Rh(m.type)}),(0,sa.jsxs)("p",{className:"text-sm text-blue-300 mt-1",children:[H,": ",m.entityName]}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Current Amount: \u20b9",Number(m.amount).toLocaleString("en-IN",{minimumFractionDigits:2})]}),m.originalAmount&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Original Amount: \u20b9",Number(m.originalAmount).toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"New Amount (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500",placeholder:"\u20b90.00",value:C.amount,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{amount:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Reason for Override *"}),(0,sa.jsx)("textarea",{className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 h-24",placeholder:"Please provide a reason for this override...",value:C.reason,onChange:e=>A((0,i.A)((0,i.A)({},C),{},{reason:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{!C.amount||parseFloat(C.amount)<=0?wr.error("Please enter a valid amount"):C.reason.trim()?R.mutate({transactionId:m.transactionId||m.id,data:{amount:parseFloat(C.amount),reason:C.reason.trim()}}):wr.error("Please provide a reason for the override")},disabled:R.isLoading,className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:R.isLoading?"Saving...":"Save Changes"}),(0,sa.jsx)("button",{onClick:()=>{d(!1),h(null)},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),c&&m&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-red-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Cancel Transaction"}),(0,sa.jsxs)("div",{className:"bg-red-900/30 border border-red-600 rounded-lg p-4 mb-6",children:[(0,sa.jsx)("div",{className:"text-xs text-red-400 mb-1",children:"Transaction Details:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold",children:Rh(m.type)}),(0,sa.jsxs)("p",{className:"text-sm text-red-300 mt-1",children:[H,": ",m.entityName]}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Amount: \u20b9",Number(m.amount).toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),(0,sa.jsx)("div",{className:"space-y-4",children:(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Reason for Cancellation (Optional)"}),(0,sa.jsx)("textarea",{className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500 h-24",placeholder:"Please provide a reason for cancellation...",value:_.reason,onChange:e=>P((0,i.A)((0,i.A)({},_),{},{reason:e.target.value}))})]})}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{D.mutate({transactionId:m.transactionId||m.id,data:{reason:_.reason.trim()||"Transaction cancelled by admin"}})},disabled:D.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:D.isLoading?"Cancelling...":"Cancel Transaction"}),(0,sa.jsx)("button",{onClick:()=>{u(!1),h(null)},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Close"})]})]})})]})}function Oh(e){let{clubId:t}=e;const s=ra(),[a,n]=(0,r.useState)(null),[l,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)("");(0,r.useEffect)(()=>{if(!t)return;const e=id.channel("buyin-requests-".concat(t)).on("postgres_changes",{event:"INSERT",schema:"public",table:"buyin_requests",filter:"club_id=eq.".concat(t)},e=>{console.log("\ud83d\udd14 [REALTIME] New buy-in request:",e.new),s.invalidateQueries({queryKey:["buyInRequests",t]}),wr("\ud83d\udcb0 New buy-in request received!",{icon:"\ud83d\udd14"})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"buyin_requests",filter:"club_id=eq.".concat(t)},e=>{console.log("\ud83d\udd04 [REALTIME] Buy-in request updated:",e.new),s.invalidateQueries({queryKey:["buyInRequests",t]})}).subscribe(e=>{"SUBSCRIBED"===e&&console.log("\u2705 [REALTIME] Subscribed to buy-in requests for club:",t)});return()=>{id.removeChannel(e)}},[t,s]);const{data:c=[],isLoading:u,error:m,refetch:h}=hn({queryKey:["buyInRequests",t],queryFn:()=>jr.Od.getBuyInRequests(t),enabled:!!t,refetchInterval:15e3}),x=gn({mutationFn:e=>{let{requestId:s,amount:a}=e;return jr.Od.approveBuyInRequest(t,s,{amount:a})},onSuccess:()=>{wr.success("Buy-in request approved and balance updated!"),s.invalidateQueries(["buyInRequests",t]),n(null)},onError:e=>{wr.error(e.message||"Failed to approve buy-in request")}}),p=gn({mutationFn:e=>{let{requestId:s,reason:a}=e;return jr.Od.rejectBuyInRequest(t,s,{reason:a})},onSuccess:()=>{wr.success("Buy-in request rejected!"),s.invalidateQueries(["buyInRequests",t]),n(null),i(!1),d("")},onError:e=>{wr.error(e.message||"Failed to reject buy-in request")}}),b=e=>{if(!e)return"";return new Date(e).toLocaleString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"})},g=c.filter(e=>"pending"===e.status);return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Table Buy-In Requests"}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:[g.length," pending request",1!==g.length?"s":""]})]}),u?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"Loading buy-in requests..."}):m?(0,sa.jsxs)("div",{className:"text-center py-8",children:[(0,sa.jsx)("div",{className:"text-red-400 mb-2",children:"Failed to load buy-in requests"}),(0,sa.jsx)("div",{className:"text-gray-500 text-sm mb-3",children:m.message}),(0,sa.jsx)("button",{onClick:()=>h(),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg text-sm",children:"Retry"})]}):0===g.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No pending buy-in requests"}):(0,sa.jsx)("div",{className:"space-y-4",children:g.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-5 border border-slate-600 hover:border-blue-500 transition-all",children:[(0,sa.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:e.playerName}),(0,sa.jsx)("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 rounded text-xs font-semibold",children:"PENDING"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Table:"}),(0,sa.jsx)("span",{className:"text-white ml-2 font-medium",children:e.tableNumber?"Table ".concat(e.tableNumber):"N/A"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Seat:"}),(0,sa.jsx)("span",{className:"text-white ml-2 font-medium",children:e.seatNumber?"Seat ".concat(e.seatNumber):"N/A"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Requested Amount:"}),(0,sa.jsxs)("span",{className:"text-green-400 ml-2 font-bold",children:["\u20b9",Number(e.requestedAmount||0).toLocaleString("en-IN")]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Current Balance:"}),(0,sa.jsxs)("span",{className:"text-white ml-2 font-medium",children:["\u20b9",Number(e.currentTableBalance||0).toLocaleString("en-IN")]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Requested At:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:b(e.requestedAt)})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Email:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:e.playerEmail||"N/A"})]})]})]})}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{window.confirm("Approve buy-in request for ".concat(e.playerName,"? Amount: \u20b9").concat(Number(e.requestedAmount||0).toLocaleString("en-IN")))&&x.mutate({requestId:e.id,amount:e.requestedAmount||0})})(e),disabled:x.isPending,className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:x.isPending?"Processing...":"\u2713 Approve"}),(0,sa.jsx)("button",{onClick:()=>(e=>{n(e),i(!0)})(e),disabled:p.isPending,className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"\u2717 Reject"})]})]},e.id))})]}),l&&a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Reject Buy-In Request"}),(0,sa.jsxs)("p",{className:"text-gray-300 mb-4",children:["Rejecting buy-in request for ",(0,sa.jsx)("strong",{children:a.playerName})," (\u20b9",Number(a.requestedAmount||0).toLocaleString("en-IN"),")"]}),(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Reason for Rejection ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("textarea",{value:o,onChange:e=>d(e.target.value),placeholder:"Enter reason for rejection...",className:"w-full bg-slate-700 text-white border border-slate-600 rounded-lg p-3 focus:outline-none focus:border-blue-500",rows:4})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{i(!1),d(""),n(null)},className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded-lg font-semibold transition-all",children:"Cancel"}),(0,sa.jsx)("button",{onClick:()=>{o.trim()?p.mutate({requestId:a.id,reason:o}):wr.error("Please provide a reason for rejection")},disabled:!o.trim()||p.isPending,className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:p.isPending?"Rejecting...":"Reject Request"})]})]})})]})}function Lh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(null),[n,l]=(0,r.useState)(!1),[i,o]=(0,r.useState)("tables"),{data:d,isLoading:c}=hn({queryKey:["tables",t],queryFn:()=>jr.rj.getTables(t),enabled:!!t}),u=d||[],m=u.filter(e=>"AVAILABLE"===e.status||"OCCUPIED"===e.status);return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Tables & Waitlist"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"View-only mode: You can only view live tables"}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>o("tables"),className:"px-6 py-3 font-semibold transition-all ".concat("tables"===i?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:"Live Tables"}),(0,sa.jsx)("button",{onClick:()=>o("buyin-requests"),className:"px-6 py-3 font-semibold transition-all ".concat("buyin-requests"===i?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:"Buy-In Requests"})]}),"buyin-requests"===i?(0,sa.jsx)(Oh,{clubId:t}):(0,sa.jsxs)(sa.Fragment,{children:[!t&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view tables."})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold",children:"Live Tables - View Only"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"View live tables and their status."})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 px-4 py-2 rounded-lg",children:[(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Active Tables: ",m.length]}),(0,sa.jsxs)("div",{className:"text-sm text-gray-300",children:["Total Players: ",m.reduce((e,t)=>e+(t.currentSeats||0),0)]})]})]}),c?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading tables..."})]}):0===m.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfb2"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No active tables"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600 hover:border-blue-500 transition-all",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h3",{className:"text-lg font-bold text-white",children:["Table ",e.tableNumber||e.number]}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:e.tableType||"Cash Game"})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("OCCUPIED"===e.status?"bg-green-600/20 text-green-400":"bg-blue-600/20 text-blue-400"),children:e.status})]}),(0,sa.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Stakes:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:["\u20b9",e.minBuyIn||0,"/\u20b9",e.maxBuyIn||0]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Occupied Seats:"}),(0,sa.jsxs)("span",{className:"text-white font-medium",children:[e.currentSeats||0," / ",e.maxSeats||8]})]}),(0,sa.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Available Seats:"}),(0,sa.jsx)("span",{className:"text-green-400 font-medium",children:e.maxSeats-(e.currentSeats||0)})]})]}),(0,sa.jsxs)("button",{onClick:()=>{a(e),l(!0)},className:"w-full bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-500 hover:to-indigo-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83c\udfaf"}),(0,sa.jsx)("span",{children:"View Table Hologram"})]})]},e.id))})]}),n&&s&&(0,sa.jsx)("div",{className:"fixed inset-0 z-50 bg-black/90 overflow-y-auto",children:(0,sa.jsx)(sh,{tableId:s.id,onClose:()=>{l(!1),a(null)},isManagerMode:!0,isViewOnly:!0,tables:u})})]})]})}function Fh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(null),{data:n,isLoading:l}=hn({queryKey:["tournaments",t],queryFn:()=>jr.Re.getTournaments(t),enabled:!!t}),i=Array.isArray(n)?n:(null===n||void 0===n?void 0:n.tournaments)||(null===n||void 0===n?void 0:n.data)||[],o=Array.isArray(i)?i:[];return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Tournaments"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"View-only mode: You can only view tournament information"}),!t&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view tournaments."})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Tournament List - View Only"}),l?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading tournaments..."})]}):0===o.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfc6"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No tournaments found"})]}):(0,sa.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,sa.jsx)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:e.name||"Tournament"}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Status: ",e.status||"Unknown"]}),e.buyIn&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Buy-In: \u20b9",e.buyIn]}),e.startTime&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Start: ",new Date(e.startTime).toLocaleString()]}),e.prizePool&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Prize Pool: \u20b9",e.prizePool]})]}),(0,sa.jsxs)("button",{onClick:()=>a(e),className:"bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-500 hover:to-indigo-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udc41\ufe0f"}),(0,sa.jsx)("span",{children:"View Details"})]})]})},e.id))})]}),s&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-2xl w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:s.name||"Tournament"}),(0,sa.jsx)("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Status"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:s.status||"Unknown"})]}),s.buyIn&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Buy-In"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.buyIn]})]}),s.prizePool&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Prize Pool"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.prizePool]})]}),s.startTime&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Start Time"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:new Date(s.startTime).toLocaleString()})]}),s.description&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Description"}),(0,sa.jsx)("p",{className:"text-white",children:s.description})]})]})]})})]})}function Mh(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(null),{data:n,isLoading:l}=hn({queryKey:["rummy-tournaments",t],queryFn:()=>jr.Re.getTournaments(t),enabled:!!t,select:e=>Array.isArray(e)?e.filter(e=>"RUMMY"===e.tableType):[]}),i=n||[];return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Rummy Tournaments"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"View-only mode: You can only view rummy tournament details"})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"All Rummy Tournaments"}),l?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading rummy tournaments..."})]}):0===i.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udccf"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No rummy tournaments found"})]}):(0,sa.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,sa.jsx)("div",{className:"bg-slate-700 rounded-xl p-5 border border-slate-600",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:e.name||"Rummy Tournament"}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Status: ",e.status||"Unknown"]}),(0,sa.jsxs)("p",{className:"text-sm text-emerald-400",children:["Variant: ",e.rummyVariant||"Points Rummy"]}),e.buyIn&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Buy-In: \u20b9",e.buyIn]}),e.startTime&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Start: ",new Date(e.startTime).toLocaleString()]}),e.prizePool&&(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Prize Pool: \u20b9",e.prizePool]})]}),(0,sa.jsxs)("button",{onClick:()=>a(e),className:"bg-gradient-to-r from-emerald-600 to-teal-700 hover:from-emerald-500 hover:to-teal-600 text-white px-4 py-2 rounded-lg font-semibold transition-all flex items-center gap-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udc41\ufe0f"}),(0,sa.jsx)("span",{children:"View Details"})]})]})},e.id))})]}),s&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-2xl w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:s.name||"Rummy Tournament"}),(0,sa.jsx)("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-white transition-colors",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Status"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:s.status||"Unknown"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Rummy Variant"}),(0,sa.jsx)("p",{className:"text-emerald-400 font-semibold",children:s.rummyVariant||"Points Rummy"})]}),s.buyIn&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Buy-In"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.buyIn]})]}),s.prizePool&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Prize Pool"}),(0,sa.jsxs)("p",{className:"text-white font-semibold",children:["\u20b9",s.prizePool]})]}),s.startTime&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Start Time"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:new Date(s.startTime).toLocaleString()})]}),s.description&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Description"}),(0,sa.jsx)("p",{className:"text-white",children:s.description})]})]})]})})]})}function Bh(){var e,t,s,a,n,l,o,d;const c=me(),[u,m]=(ra(),(0,r.useState)("Dashboard")),[h,x]=(0,r.useState)(null),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)(!1),[y,v]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{const e=localStorage.getItem("clubId");e?x(e):c("/login")},[c]);const{data:w,isLoading:j}=hn({queryKey:["club",h],queryFn:()=>jr.Od.getClub(h),enabled:!!h});(0,r.useEffect)(()=>{w&&b(w)},[w]),(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("cashieruser")||"{}");e.id||t.userId?(e.mustResetPassword||t.mustResetPassword)&&f(!0):c("/login")},[c]);const{data:N,isLoading:S}=hn({queryKey:["clubRevenue",h],queryFn:()=>jr.Od.getClubRevenue(h),enabled:!!h}),k=e=>"\u20b9".concat((e||0).toLocaleString("en-IN")),C=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("cashieruser")||"{}");t.mustResetPassword=!1,localStorage.setItem("cashieruser",JSON.stringify(t)),f(!1),v({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),A=g&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("cashieruser")||"{}"),a=t.email||s.email;a?y.currentPassword&&y.newPassword&&y.confirmPassword?y.newPassword===y.confirmPassword?y.newPassword.length<8?wr.error("Password must be at least 8 characters"):C.mutate({email:a,currentPassword:y.currentPassword,newPassword:y.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:y.currentPassword,onChange:e=>v((0,i.A)((0,i.A)({},y),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:y.newPassword,onChange:e=>v((0,i.A)((0,i.A)({},y),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:y.confirmPassword,onChange:e=>v((0,i.A)((0,i.A)({},y),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:C.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:C.isLoading?"Resetting...":"Reset Password"})]})]})});if(j||!h)return(0,sa.jsxs)(sa.Fragment,{children:[A,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900 flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-white text-center",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-xl",children:"Loading club data..."})]})})]});const _=["Dashboard","Notifications","Payroll Management","Bonus Management","Tables & Waitlist","Club Buy-In","Push Notifications","Tournaments","Chat","Transactions","Leave Management"],P=null!==w&&void 0!==w&&w.rummyEnabled?[..._,"Rummy"]:_;return(0,sa.jsxs)(sa.Fragment,{children:[A,(0,sa.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900",children:[(0,sa.jsx)(wh,{activeItem:u,setActiveItem:m,menuItems:P,onSignOut:()=>{localStorage.clear(),sessionStorage.clear(),c("/login")}}),(0,sa.jsxs)("main",{className:"flex-1 p-8 overflow-y-auto",children:["Dashboard"===u&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsxs)("h1",{className:"text-3xl font-bold text-white",children:["Dashboard - ",(null===p||void 0===p?void 0:p.name)||(null===w||void 0===w?void 0:w.name)||"Loading..."]})}),h&&(0,sa.jsx)(fm,{selectedClubId:h}),S?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading revenue data..."})]}):(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:k((null===N||void 0===N||null===(e=N.previousDay)||void 0===e?void 0:e.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===N||void 0===N||null===(t=N.previousDay)||void 0===t?void 0:t.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-emerald-600",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-emerald-400",children:k((null===N||void 0===N||null===(s=N.currentDay)||void 0===s?void 0:s.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===N||void 0===N||null===(a=N.currentDay)||void 0===a?void 0:a.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:k((null===N||void 0===N||null===(n=N.currentDay)||void 0===n?void 0:n.rake)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"10% of revenue"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:k((null===N||void 0===N||null===(l=N.previousDay)||void 0===l?void 0:l.rake)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:k((null===N||void 0===N||null===(o=N.previousDay)||void 0===o?void 0:o.tips)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:k((null===N||void 0===N||null===(d=N.currentDay)||void 0===d?void 0:d.tips)||0)})]})]})]}),"Payroll Management"===u&&(0,sa.jsx)(Sh,{selectedClubId:h}),"Bonus Management"===u&&(0,sa.jsx)(Ah,{selectedClubId:h}),"Tables & Waitlist"===u&&(0,sa.jsx)(Lh,{selectedClubId:h}),"Club Buy-In"===u&&(0,sa.jsx)(Eh,{selectedClubId:h,onBack:()=>m("Dashboard")}),"Push Notifications"===u&&(0,sa.jsx)(Md,{selectedClubId:h}),"Tournaments"===u&&(0,sa.jsx)(Fh,{selectedClubId:h}),"Chat"===u&&h&&(0,sa.jsx)($u,{clubId:h}),"Transactions"===u&&(0,sa.jsx)(Dh,{selectedClubId:h}),"Leave Management"===u&&h&&(0,sa.jsx)(nh,{clubId:h,userRole:"CASHIER"}),"Rummy"===u&&(0,sa.jsx)(Mh,{selectedClubId:h}),"Notifications"===u&&h&&(0,sa.jsx)(bm,{selectedClubId:h,recipientType:"staff"}),!["Dashboard","Payroll Management","Bonus Management","Tables & Waitlist","Club Buy-In","Push Notifications","Tournaments","Chat","Transactions","Rummy","Notifications"].includes(u)&&(0,sa.jsx)("div",{className:"text-white",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold mb-6",children:u})})]})]})]})}function qh(e){let{clubId:t}=e;const[s,a]=(0,r.useState)("menu"),[n,l]=(0,r.useState)([]),[i,o]=(0,r.useState)([]),[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{"menu"===s?(y(),v()):w()},[t,s]);const y=async()=>{try{m(!0);const e=await jr.Zl.getMenu(t);l(e)}catch(e){console.error("Error loading menu items:",e),alert("Failed to load menu items")}finally{m(!1)}},v=async()=>{try{const e=await jr.Zl.getAllMenuCategories(t);o(e)}catch(e){console.error("Error loading categories:",e)}},w=async()=>{try{m(!0);const e=await jr.Zl.getInventory(t);c(e)}catch(e){console.error("Error loading inventory:",e),alert("Failed to load inventory")}finally{m(!1)}};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex space-x-4",children:[(0,sa.jsx)("button",{onClick:()=>a("menu"),className:"px-6 py-3 rounded-lg font-semibold ".concat("menu"===s?"bg-orange-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:"Menu Management"}),(0,sa.jsx)("button",{onClick:()=>a("inventory"),className:"px-6 py-3 rounded-lg font-semibold ".concat("inventory"===s?"bg-orange-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:"Inventory Management"})]}),"menu"===s&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsxs)("div",{className:"flex space-x-4",children:[(0,sa.jsxs)("button",{onClick:()=>x(!0),className:"bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:"\u2795"}),(0,sa.jsx)("span",{children:"Add Menu Item"})]}),(0,sa.jsxs)("button",{onClick:()=>b(!0),className:"bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udcc1"}),(0,sa.jsx)("span",{children:"Add Category"})]})]})}),u?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-4",children:"Loading menu items..."})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>(0,sa.jsx)(Uh,{item:e,onEdit:()=>{f(e),x(!0)},onDelete:async()=>{if(window.confirm("Delete this menu item?"))try{await jr.Zl.deleteMenuItem(t,e.id),y()}catch(s){alert("Failed to delete item")}}},e.id))}),0===n.length&&!u&&(0,sa.jsxs)("div",{className:"text-center py-12 bg-slate-800 rounded-xl",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-lg",children:"No menu items yet"}),(0,sa.jsx)("button",{onClick:()=>x(!0),className:"mt-4 text-orange-500 hover:text-orange-400",children:"Add your first menu item"})]})]}),"inventory"===s&&(0,sa.jsx)(Wh,{clubId:t,inventory:d,loading:u,onUpdate:w}),h&&(0,sa.jsx)(zh,{clubId:t,categories:i,item:g,onClose:()=>{x(!1),f(null)},onSave:()=>{x(!1),f(null),y()}}),p&&(0,sa.jsx)(Kh,{clubId:t,onClose:()=>b(!1),onSave:()=>{b(!1),v()}})]})}function Uh(e){let{item:t,onEdit:s,onDelete:a}=e;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl overflow-hidden border border-slate-700 hover:border-orange-500 transition-all",children:[(0,sa.jsxs)("div",{className:"h-48 bg-slate-900 flex overflow-x-auto",children:[t.imageUrl1&&(0,sa.jsx)("img",{src:t.imageUrl1,alt:t.name,className:"h-full w-full object-cover flex-shrink-0"}),t.imageUrl2&&(0,sa.jsx)("img",{src:t.imageUrl2,alt:t.name,className:"h-full w-full object-cover flex-shrink-0"}),t.imageUrl3&&(0,sa.jsx)("img",{src:t.imageUrl3,alt:t.name,className:"h-full w-full object-cover flex-shrink-0"}),!t.imageUrl1&&!t.imageUrl2&&!t.imageUrl3&&(0,sa.jsx)("div",{className:"h-full w-full flex items-center justify-center text-gray-500",children:(0,sa.jsx)("span",{className:"text-6xl",children:"\ud83c\udf7d\ufe0f"})})]}),(0,sa.jsxs)("div",{className:"p-4 space-y-3",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:t.name}),(e=>{const t={available:{bg:"bg-green-500",text:"Available"},limited:{bg:"bg-yellow-500",text:"Limited"},out_of_stock:{bg:"bg-red-500",text:"Out of Stock"}},s=t[e]||t.available;return(0,sa.jsx)("span",{className:"".concat(s.bg," text-white px-3 py-1 rounded-full text-xs font-semibold"),children:s.text})})(t.availability)]}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm line-clamp-2",children:t.description||"No description"}),(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("p",{className:"text-2xl font-bold text-orange-500",children:["\u20b9",t.price]}),(0,sa.jsx)("p",{className:"text-xs text-gray-500",children:t.category})]}),(0,sa.jsx)("div",{className:"text-right",children:(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Stock: ",t.stock]})})]}),(0,sa.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,sa.jsx)("button",{onClick:s,className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"Edit"}),(0,sa.jsx)("button",{onClick:a,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"Delete"})]})]})]})}function zh(e){let{clubId:t,categories:s,item:a,onClose:n,onSave:l}=e;const[o,d]=(0,r.useState)({name:(null===a||void 0===a?void 0:a.name)||"",category:(null===a||void 0===a?void 0:a.category)||"",isCustomCategory:(null===a||void 0===a?void 0:a.isCustomCategory)||!1,price:(null===a||void 0===a?void 0:a.price)||0,stock:(null===a||void 0===a?void 0:a.stock)||0,description:(null===a||void 0===a?void 0:a.description)||"",availability:(null===a||void 0===a?void 0:a.availability)||"available",imageUrl1:(null===a||void 0===a?void 0:a.imageUrl1)||"",imageUrl2:(null===a||void 0===a?void 0:a.imageUrl2)||"",imageUrl3:(null===a||void 0===a?void 0:a.imageUrl3)||""}),[c,u]=(0,r.useState)({img1:!1,img2:!1,img3:!1}),[m,h]=(0,r.useState)(!1);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:a?"Edit Menu Item":"Add Menu Item"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{h(!0);const e=(0,i.A)((0,i.A)({},o),{},{price:parseFloat(o.price)||0,stock:parseInt(o.stock)||0});a?await jr.Zl.updateMenuItem(t,a.id,e):await jr.Zl.createMenuItem(t,e),l()}catch(s){alert("Failed to save menu item")}finally{h(!1)}},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Item Name *"}),(0,sa.jsx)("input",{type:"text",required:!0,value:o.name,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Chicken Biryani"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Category *"}),(0,sa.jsxs)("select",{value:o.category,onChange:e=>{const t="Custom"===e.target.value;d((0,i.A)((0,i.A)({},o),{},{category:t?"":e.target.value,isCustomCategory:t}))},className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"",children:"Select Category"}),s.map(e=>(0,sa.jsx)("option",{value:e.categoryName,children:e.categoryName},e.id)),(0,sa.jsx)("option",{value:"Custom",children:"Custom..."})]}),o.isCustomCategory&&(0,sa.jsx)("input",{type:"text",required:!0,value:o.category,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{category:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg mt-2",placeholder:"Enter custom category name"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Price (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",required:!0,min:"0",step:"0.01",value:o.price,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{price:parseFloat(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Stock"}),(0,sa.jsx)("input",{type:"number",min:"0",value:o.stock,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{stock:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Availability *"}),(0,sa.jsxs)("select",{value:o.availability,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{availability:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"available",children:"Available"}),(0,sa.jsx)("option",{value:"limited",children:"Limited"}),(0,sa.jsx)("option",{value:"out_of_stock",children:"Out of Stock"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Description"}),(0,sa.jsx)("textarea",{value:o.description,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{description:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",rows:"3",placeholder:"Describe the item..."})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Images (up to 3)"}),(0,sa.jsx)("div",{className:"grid grid-cols-3 gap-4",children:[1,2,3].map(e=>(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsx)("div",{className:"h-32 bg-slate-700 rounded-lg flex items-center justify-center overflow-hidden",children:o["imageUrl".concat(e)]?(0,sa.jsx)("img",{src:o["imageUrl".concat(e)],alt:"Preview ".concat(e),className:"w-full h-full object-cover"}):(0,sa.jsx)("span",{className:"text-gray-500 text-4xl",children:"\ud83d\udcf7"})}),(0,sa.jsx)("input",{type:"file",accept:"image/*",onChange:s=>s.target.files[0]&&(async(e,s)=>{try{u((0,i.A)((0,i.A)({},c),{},{["img".concat(s)]:!0}));const a=await uh(e,t,"menu-items");d((0,i.A)((0,i.A)({},o),{},{["imageUrl".concat(s)]:a}))}catch(a){console.error("Image upload error:",a),alert("Failed to upload image: "+(a.message||"Unknown error"))}finally{u((0,i.A)((0,i.A)({},c),{},{["img".concat(s)]:!1}))}})(s.target.files[0],e),disabled:c["img".concat(e)],className:"w-full text-sm text-gray-400"}),c["img".concat(e)]&&(0,sa.jsx)("p",{className:"text-xs text-orange-500",children:"Uploading..."})]},e))})]}),(0,sa.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:m,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:m?"Saving...":a?"Update Item":"Add Item"}),(0,sa.jsx)("button",{type:"button",onClick:n,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function Kh(e){let{clubId:t,onClose:s,onSave:a}=e;const[n,l]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Add Custom Category"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{o(!0),await jr.Zl.createMenuCategory(t,n),a()}catch(s){alert("Failed to create category")}finally{o(!1)}},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Category Name *"}),(0,sa.jsx)("input",{type:"text",required:!0,value:n,onChange:e=>l(e.target.value),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Special Items"})]}),(0,sa.jsxs)("div",{className:"flex space-x-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:i,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:i?"Adding...":"Add Category"}),(0,sa.jsx)("button",{type:"button",onClick:s,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function Wh(e){let{clubId:t,inventory:s,loading:a,onUpdate:n}=e;const[l,i]=(0,r.useState)(null),[o,d]=(0,r.useState)(!1);return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 p-4 rounded-lg flex justify-between items-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-white font-semibold",children:"End of Day Stock Update"}),(0,sa.jsx)("p",{className:"text-white/80 text-sm",children:"Update inventory levels after service"})]}),(0,sa.jsx)("button",{onClick:()=>d(!0),className:"bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-semibold",children:"+ Add Inventory Item"})]}),a?(0,sa.jsx)("div",{className:"text-center py-12",children:(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"})}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(e=>{const t=(s=e.currentStock,a=e.minStock,0===s?{color:"text-red-500",label:"Out of Stock",bg:"bg-red-500/20"}:s<=a?{color:"text-yellow-500",label:"Critical",bg:"bg-yellow-500/20"}:s<=2*a?{color:"text-orange-500",label:"Low",bg:"bg-orange-500/20"}:{color:"text-green-500",label:"Good",bg:"bg-green-500/20"});var s,a;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700 ".concat(t.bg),children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,sa.jsx)("h4",{className:"text-white font-bold",children:e.name}),(0,sa.jsx)("span",{className:"text-xs font-semibold ".concat(t.color),children:t.label})]}),(0,sa.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Current Stock:"}),(0,sa.jsxs)("span",{className:"font-bold ".concat(t.color),children:[e.currentStock," ",e.unit]})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Min Stock:"}),(0,sa.jsxs)("span",{className:"text-white",children:[e.minStock," ",e.unit]})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Cost:"}),(0,sa.jsxs)("span",{className:"text-white",children:["\u20b9",e.cost||0]})]})]}),(0,sa.jsx)("button",{onClick:()=>i(e),className:"w-full mt-4 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"Update Stock"})]},e.id)})}),l&&(0,sa.jsx)(Hh,{clubId:t,item:l,onClose:()=>i(null),onSave:()=>{i(null),n()}}),o&&(0,sa.jsx)(Vh,{clubId:t,onClose:()=>d(!1),onSave:()=>{d(!1),n()}})]})}function Hh(e){let{clubId:t,item:s,onClose:a,onSave:n}=e;const[l,i]=(0,r.useState)(s.currentStock),[o,d]=(0,r.useState)(!1);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Update Stock"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{d(!0),await jr.Zl.updateInventory(t,s.id,{currentStock:l}),n()}catch(a){alert("Failed to update stock")}finally{d(!1)}},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("p",{className:"text-gray-400 mb-4",children:["Item: ",(0,sa.jsx)("span",{className:"text-white font-bold",children:s.name})]}),(0,sa.jsxs)("label",{className:"block text-white mb-2",children:["Current Stock (",s.unit,")"]}),(0,sa.jsx)("input",{type:"number",required:!0,min:"0",step:"0.01",value:l,onChange:e=>i(parseFloat(e.target.value)||0),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"}),(0,sa.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Minimum: ",s.minStock," ",s.unit]})]}),(0,sa.jsxs)("div",{className:"flex space-x-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:o,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:o?"Updating...":"Update"}),(0,sa.jsx)("button",{type:"button",onClick:a,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function Vh(e){let{clubId:t,onClose:s,onSave:a}=e;const[n,l]=(0,r.useState)({name:"",category:"",currentStock:0,minStock:0,supplier:"",cost:0,unit:"units"}),[o,d]=(0,r.useState)(!1);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Add Inventory Item"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{d(!0),await jr.Zl.createInventoryItem(t,n),a()}catch(s){console.error("Error creating inventory item:",s),alert("Failed to create inventory item")}finally{d(!1)}},className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Item Name *"}),(0,sa.jsx)("input",{type:"text",required:!0,value:n.name,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Tomatoes, Flour, etc."})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Category *"}),(0,sa.jsx)("input",{type:"text",required:!0,value:n.category,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{category:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Vegetables, Dry Goods, etc."})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Current Stock *"}),(0,sa.jsx)("input",{type:"number",required:!0,min:"0",step:"0.01",value:n.currentStock,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{currentStock:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Minimum Stock *"}),(0,sa.jsx)("input",{type:"number",required:!0,min:"0",step:"0.01",value:n.minStock,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{minStock:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Unit"}),(0,sa.jsxs)("select",{value:n.unit,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{unit:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"units",children:"Units"}),(0,sa.jsx)("option",{value:"kg",children:"Kilograms (kg)"}),(0,sa.jsx)("option",{value:"g",children:"Grams (g)"}),(0,sa.jsx)("option",{value:"L",children:"Liters (L)"}),(0,sa.jsx)("option",{value:"ml",children:"Milliliters (ml)"}),(0,sa.jsx)("option",{value:"pieces",children:"Pieces"}),(0,sa.jsx)("option",{value:"boxes",children:"Boxes"}),(0,sa.jsx)("option",{value:"packets",children:"Packets"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Cost (\u20b9)"}),(0,sa.jsx)("input",{type:"number",min:"0",step:"0.01",value:n.cost,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{cost:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"0.00"})]}),(0,sa.jsxs)("div",{className:"col-span-2",children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Supplier (Optional)"}),(0,sa.jsx)("input",{type:"text",value:n.supplier,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{supplier:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"Supplier name"})]})]}),(0,sa.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:o,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:o?"Creating...":"Create Item"}),(0,sa.jsx)("button",{type:"button",onClick:s,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function Jh(e){let{clubId:t}=e;const[s,a]=(0,r.useState)([]),[n,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(1),[u,m]=(0,r.useState)(1),[h,x]=(0,r.useState)("all"),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)(!1),[y,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{w(),j()},[t,h,d]),(0,r.useEffect)(()=>{if(!t)return;const e=id.channel("fnb-orders-".concat(t)).on("postgres_changes",{event:"INSERT",schema:"public",table:"fnb_orders",filter:"club_id=eq.".concat(t)},e=>{console.log("\ud83c\udf54 [REALTIME] New FNB order:",e.new),w(),wr("\ud83c\udf54 New FNB order received!",{icon:"\ud83d\udd14"})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"fnb_orders",filter:"club_id=eq.".concat(t)},e=>{var t;console.log("\ud83c\udf54 [REALTIME] FNB order updated:",null===(t=e.new)||void 0===t?void 0:t.status),w()}).subscribe(e=>{"SUBSCRIBED"===e&&console.log("\u2705 [REALTIME] Subscribed to FNB orders for club:",t)});return()=>{id.removeChannel(e)}},[t]);const w=async()=>{try{o(!0);const e="all"===h?void 0:h,s=await jr.Zl.getOrders(t,e,d,10);s&&Array.isArray(s.orders)?(a(s.orders),m(s.totalPages||1)):Array.isArray(s)?a(s):a([])}catch(e){console.error("Error loading orders:",e),alert("Failed to load orders"),a([])}finally{o(!1)}},j=async()=>{try{const e=await jr.Zl.getKitchenStations(t,!0);l(e)}catch(e){console.error("Error loading stations:",e)}},N=s||[];return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4 flex justify-between items-center",children:[(0,sa.jsx)("div",{className:"flex space-x-2",children:["all","pending","processing","ready","delivered","cancelled"].map(e=>(0,sa.jsx)("button",{onClick:()=>{x(e),c(1)},className:"px-4 py-2 rounded-lg font-semibold text-sm ".concat(h===e?"bg-orange-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,sa.jsx)("button",{onClick:w,className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold",children:"\ud83d\udd04 Refresh"})]}),(0,sa.jsxs)("div",{className:"bg-blue-600/20 border border-blue-500 rounded-xl p-4",children:[(0,sa.jsx)("h3",{className:"text-white font-bold mb-2",children:"\ud83d\udccb Order Processing Workflow"}),(0,sa.jsx)("p",{className:"text-blue-200 text-sm",children:"1. Player places order \u2192 2. FNB Manager processes & sends to Chef \u2192 3. Chef prepares food \u2192 4. Status updates visible in Player Portal"})]}),i?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-4",children:"Loading orders..."})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-4",children:N.map(e=>(0,sa.jsx)(Qh,{order:e,onAccept:()=>{b(e),f(!0)},onReject:()=>{b(e),v(!0)},onMarkReady:()=>(async e=>{try{await jr.Zl.markOrderReady(t,e),alert("Order marked as ready!"),w()}catch(s){alert("Failed to mark order as ready")}})(e.id),onMarkDelivered:()=>(async e=>{try{await jr.Zl.markOrderDelivered(t,e),alert("Order delivered! Invoice generated."),w()}catch(s){alert("Failed to mark order as delivered")}})(e.id)},e.id))}),0===N.length&&(0,sa.jsx)("div",{className:"text-center py-12 bg-slate-800 rounded-xl",children:(0,sa.jsx)("p",{className:"text-gray-400 text-lg",children:"No orders found"})}),u>1&&(0,sa.jsxs)("div",{className:"flex justify-center items-center space-x-4",children:[(0,sa.jsx)("button",{onClick:()=>c(e=>Math.max(1,e-1)),disabled:1===d,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-white",children:["Page ",d," of ",u]}),(0,sa.jsx)("button",{onClick:()=>c(e=>Math.min(u,e+1)),disabled:d===u,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Next"})]})]}),g&&p&&(0,sa.jsx)(Gh,{order:p,stations:n,onAccept:async(e,s)=>{try{await jr.Zl.acceptOrder(t,e,s),alert("Order accepted successfully!"),f(!1),w()}catch(a){alert("Failed to accept order")}},onClose:()=>{f(!1),b(null)}}),y&&p&&(0,sa.jsx)(Yh,{order:p,onReject:async(e,s)=>{try{await jr.Zl.rejectOrder(t,e,s),alert("Order rejected"),v(!1),w()}catch(a){alert("Failed to reject order")}},onClose:()=>{v(!1),b(null)}})]})}function Qh(e){let{order:t,onAccept:s,onReject:a,onMarkReady:r,onMarkDelivered:n}=e;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[t.orderNumber?(0,sa.jsx)("h3",{className:"text-2xl font-bold text-orange-500",children:t.orderNumber}):(0,sa.jsx)("h3",{className:"text-2xl font-bold text-gray-500",children:"No Order # (Not Accepted)"}),(()=>{const e={pending:{bg:"bg-yellow-500",text:"\u23f3 Pending",icon:"\u23f3"},processing:{bg:"bg-blue-500",text:"\ud83d\udc68\u200d\ud83c\udf73 Processing",icon:"\ud83d\udc68\u200d\ud83c\udf73"},ready:{bg:"bg-green-500",text:"\u2705 Ready",icon:"\u2705"},delivered:{bg:"bg-emerald-500",text:"\ud83c\udf89 Delivered",icon:"\ud83c\udf89"},cancelled:{bg:"bg-red-500",text:"\u274c Cancelled",icon:"\u274c"}},s=e[t.status]||e.pending;return(0,sa.jsx)("span",{className:"".concat(s.bg," text-white px-4 py-2 rounded-full text-sm font-semibold"),children:s.text})})(t.status)]}),(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Player:"})," ",t.playerName]}),(0,sa.jsxs)("p",{className:"text-gray-400",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Table:"})," ",t.tableNumber]}),t.stationName&&(0,sa.jsxs)("p",{className:"text-blue-400",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Station:"})," ",t.stationName]})]}),(0,sa.jsxs)("div",{className:"text-right",children:[(0,sa.jsxs)("p",{className:"text-3xl font-bold text-orange-500",children:["\u20b9",t.totalAmount]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}),t.invoiceNumber&&(0,sa.jsxs)("p",{className:"text-sm text-green-400 mt-1",children:["Invoice: ",t.invoiceNumber]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 mb-4",children:[(0,sa.jsx)("h4",{className:"text-white font-semibold mb-2",children:"Order Items:"}),(0,sa.jsx)("ul",{className:"space-y-1",children:t.items.map((e,t)=>(0,sa.jsxs)("li",{className:"text-gray-300 flex justify-between",children:[(0,sa.jsxs)("span",{children:[e.quantity,"x ",e.name]}),(0,sa.jsxs)("span",{className:"text-orange-400",children:["\u20b9",e.price*e.quantity]})]},t))}),t.specialInstructions&&(0,sa.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-700",children:(0,sa.jsxs)("p",{className:"text-yellow-400 text-sm",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Special Instructions:"})," ",t.specialInstructions]})})]}),(0,sa.jsxs)("div",{className:"flex space-x-2",children:["pending"===t.status&&null===t.isAccepted&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:s,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg font-semibold",children:"\u2705 Accept Order"}),(0,sa.jsx)("button",{onClick:a,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg font-semibold",children:"\u274c Reject Order"})]}),"processing"===t.status&&(0,sa.jsx)("button",{onClick:r,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg font-semibold",children:"\u2705 Mark as Ready"}),"ready"===t.status&&(0,sa.jsx)("button",{onClick:n,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg font-semibold",children:"\ud83c\udf89 Mark as Delivered"}),"cancelled"===t.status&&t.rejectedReason&&(0,sa.jsxs)("div",{className:"flex-1 bg-red-600/20 border border-red-500 text-red-400 px-4 py-2 rounded-lg",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Rejected:"})," ",t.rejectedReason]})]})]})}function Gh(e){let{order:t,stations:s,onAccept:a,onClose:n}=e;const[l,i]=(0,r.useState)(""),[o,d]=(0,r.useState)(!1);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-lg w-full",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Accept Order"}),(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 mb-6",children:[(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Player:"})," ",t.playerName]}),(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Table:"})," ",t.tableNumber]}),(0,sa.jsxs)("p",{className:"text-orange-500 text-2xl font-bold mt-2",children:["\u20b9",t.totalAmount]})]}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l?(d(!0),await a(t.id,l),d(!1)):alert("Please select a station")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Select Kitchen Station *"}),(0,sa.jsxs)("select",{value:l,onChange:e=>i(e.target.value),required:!0,className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"",children:"-- Select Station --"}),s.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.stationName," (Chef: ",e.chefName||"Unassigned",") - ",e.ordersPending," pending"]},e.id))]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Order will be assigned to this station for preparation"})]}),(0,sa.jsx)("div",{className:"bg-green-600/20 border border-green-500 rounded-lg p-3",children:(0,sa.jsx)("p",{className:"text-green-400 text-sm",children:"\u2705 Accepting will assign an order number and send to kitchen"})}),(0,sa.jsxs)("div",{className:"flex space-x-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:o,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:o?"Accepting...":"\u2705 Accept & Send to Kitchen"}),(0,sa.jsx)("button",{type:"button",onClick:n,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function Yh(e){let{order:t,onReject:s,onClose:a}=e;const[n,l]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-lg w-full",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Reject Order"}),(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 mb-6",children:[(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Player:"})," ",t.playerName]}),(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"font-semibold",children:"Table:"})," ",t.tableNumber]}),(0,sa.jsxs)("p",{className:"text-orange-500 text-2xl font-bold mt-2",children:["\u20b9",t.totalAmount]})]}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),n.trim()?(o(!0),await s(t.id,n),o(!1)):alert("Please provide a rejection reason")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2 font-semibold",children:"Rejection Reason *"}),(0,sa.jsx)("textarea",{value:n,onChange:e=>l(e.target.value),required:!0,rows:"3",className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Out of stock, Kitchen closed, etc."})]}),(0,sa.jsx)("div",{className:"bg-red-600/20 border border-red-500 rounded-lg p-3",children:(0,sa.jsx)("p",{className:"text-red-400 text-sm",children:"\u26a0\ufe0f Rejecting will cancel the order (no order number assigned)"})}),(0,sa.jsxs)("div",{className:"flex space-x-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:i,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:i?"Rejecting...":"\u274c Reject Order"}),(0,sa.jsx)("button",{type:"button",onClick:a,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}const $h=[{value:"meat_poultry",label:"Meat & Poultry"},{value:"vegetables",label:"Vegetables"},{value:"spices",label:"Spices"},{value:"dairy",label:"Dairy"},{value:"beverages",label:"Beverages"}];function Zh(e){let{clubId:t}=e;const[s,a]=(0,r.useState)([]),[n,l]=(0,r.useState)(!1),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{u()},[t]);const u=async()=>{try{l(!0);const e=await jr.Zl.getSuppliers(t,!1);a(e)}catch(e){console.error("Error loading suppliers:",e),alert("Failed to load suppliers")}finally{l(!1)}};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Supplier Management"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Manage your food & beverage suppliers"})]}),(0,sa.jsxs)("button",{onClick:()=>{c(null),o(!0)},className:"bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:"\u2795"}),(0,sa.jsx)("span",{children:"Add Supplier"})]})]}),n?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-4",children:"Loading suppliers..."})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,sa.jsx)(Xh,{supplier:e,onEdit:()=>{c(e),o(!0)},onDelete:async()=>{if(window.confirm('Delete supplier "'.concat(e.name,'"?')))try{await jr.Zl.deleteSupplier(t,e.id),u()}catch(s){alert("Failed to delete supplier")}}},e.id))}),0===s.length&&!n&&(0,sa.jsxs)("div",{className:"text-center py-12 bg-slate-800 rounded-xl",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-lg",children:"No suppliers yet"}),(0,sa.jsx)("button",{onClick:()=>o(!0),className:"mt-4 text-orange-500 hover:text-orange-400",children:"Add your first supplier"})]}),i&&(0,sa.jsx)(ex,{clubId:t,supplier:d,onClose:()=>{o(!1),c(null)},onSave:()=>{o(!1),c(null),u()}})]})}function Xh(e){let{supplier:t,onEdit:s,onDelete:a}=e;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border ".concat(t.isActive?"border-green-500":"border-slate-700"),children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-1",children:t.name}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:t.contact||"No contact person"})]}),(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat(t.isActive?"bg-green-500 text-white":"bg-gray-500 text-white"),children:t.isActive?"Active":"Inactive"})]}),(0,sa.jsxs)("div",{className:"space-y-2 mb-4",children:[t.phone&&(0,sa.jsxs)("p",{className:"text-gray-300 text-sm flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udcde"}),(0,sa.jsx)("span",{children:t.phone})]}),t.email&&(0,sa.jsxs)("p",{className:"text-gray-300 text-sm flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udce7"}),(0,sa.jsx)("span",{children:t.email})]}),t.address&&(0,sa.jsxs)("p",{className:"text-gray-400 text-xs flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:"\ud83d\udccd"}),(0,sa.jsx)("span",{className:"line-clamp-2",children:t.address})]})]}),t.rating&&(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("p",{className:"text-yellow-400 text-lg",children:(e=>{const t=[],s=Math.floor(e||0),a=(e||0)%1>=.5;for(let r=0;r<5;r++)r<s||r===s&&a?t.push("\u2b50"):t.push("\u2606");return t.join("")})(t.rating)}),(0,sa.jsxs)("p",{className:"text-xs text-gray-400",children:[t.rating,"/5.0"]})]}),t.specializations&&t.specializations.length>0&&(0,sa.jsxs)("div",{className:"mb-4",children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Specializations:"}),(0,sa.jsx)("div",{className:"flex flex-wrap gap-2",children:t.specializations.map((e,t)=>(0,sa.jsx)("span",{className:"bg-blue-600/30 text-blue-300 px-2 py-1 rounded text-xs",children:e.replace("_"," & ")},t))})]}),(0,sa.jsxs)("div",{className:"flex space-x-2 pt-4 border-t border-slate-700",children:[(0,sa.jsx)("button",{onClick:s,className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"Edit"}),(0,sa.jsx)("button",{onClick:a,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"Delete"})]})]})}function ex(e){var t;let{clubId:s,supplier:a,onClose:n,onSave:l}=e;const[o,d]=(0,r.useState)({name:(null===a||void 0===a?void 0:a.name)||"",contact:(null===a||void 0===a?void 0:a.contact)||"",phone:(null===a||void 0===a?void 0:a.phone)||"",email:(null===a||void 0===a?void 0:a.email)||"",address:(null===a||void 0===a?void 0:a.address)||"",rating:(null===a||void 0===a?void 0:a.rating)||0,isActive:null===(t=null===a||void 0===a?void 0:a.isActive)||void 0===t||t,specializations:(null===a||void 0===a?void 0:a.specializations)||[]}),[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(!1),x=()=>{c.trim()&&!o.specializations.includes(c.trim())&&(d((0,i.A)((0,i.A)({},o),{},{specializations:[...o.specializations,c.trim()]})),u(""))};return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:a?"Edit Supplier":"Add Supplier"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{h(!0),a?await jr.Zl.updateSupplier(s,a.id,o):await jr.Zl.createSupplier(s,o),l()}catch(t){alert("Failed to save supplier")}finally{h(!1)}},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Supplier Name *"}),(0,sa.jsx)("input",{type:"text",required:!0,value:o.name,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Fresh Foods Ltd."})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Contact Person"}),(0,sa.jsx)("input",{type:"text",value:o.contact,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{contact:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., John Smith"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Phone"}),(0,sa.jsx)("input",{type:"tel",value:o.phone,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{phone:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"+91 98765 43210"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Email"}),(0,sa.jsx)("input",{type:"email",value:o.email,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{email:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"supplier@example.com"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Address"}),(0,sa.jsx)("textarea",{value:o.address,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{address:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",rows:"2",placeholder:"Full address..."})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Specializations"}),(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsx)("div",{className:"grid grid-cols-2 gap-2",children:$h.map(e=>(0,sa.jsxs)("label",{className:"flex items-center space-x-2 bg-slate-700 p-3 rounded-lg cursor-pointer hover:bg-slate-600",children:[(0,sa.jsx)("input",{type:"checkbox",checked:o.specializations.includes(e.value),onChange:()=>(e=>{o.specializations.includes(e)?d((0,i.A)((0,i.A)({},o),{},{specializations:o.specializations.filter(t=>t!==e)})):d((0,i.A)((0,i.A)({},o),{},{specializations:[...o.specializations,e]}))})(e.value),className:"w-4 h-4"}),(0,sa.jsx)("span",{className:"text-white",children:e.label})]},e.value))}),(0,sa.jsxs)("div",{className:"flex space-x-2",children:[(0,sa.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),className:"flex-1 px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"Add custom specialization...",onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),x())}),(0,sa.jsx)("button",{type:"button",onClick:x,className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg",children:"Add"})]}),o.specializations.filter(e=>!$h.some(t=>t.value===e)).length>0&&(0,sa.jsx)("div",{className:"flex flex-wrap gap-2",children:o.specializations.filter(e=>!$h.some(t=>t.value===e)).map(e=>(0,sa.jsxs)("span",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-sm flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:e}),(0,sa.jsx)("button",{type:"button",onClick:()=>(e=>{d((0,i.A)((0,i.A)({},o),{},{specializations:o.specializations.filter(t=>t!==e)}))})(e),className:"text-white hover:text-red-300",children:"\xd7"})]},e))})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Rating (0-5)"}),(0,sa.jsx)("input",{type:"number",min:"0",max:"5",step:"0.1",value:o.rating,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{rating:parseFloat(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Status"}),(0,sa.jsxs)("select",{value:o.isActive?"active":"inactive",onChange:e=>d((0,i.A)((0,i.A)({},o),{},{isActive:"active"===e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"active",children:"Active"}),(0,sa.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,sa.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:m,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:m?"Saving...":a?"Update Supplier":"Add Supplier"}),(0,sa.jsx)("button",{type:"button",onClick:n,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function tx(e){let{clubId:t}=e;const[s,a]=(0,r.useState)([]),[n,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),[h,x]=(0,r.useState)(!1),[p,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{g(),f()},[t]);const g=async()=>{try{o(!0);const e=await jr.Zl.getKitchenStations(t,!1);a(e)}catch(e){console.error("Error loading stations:",e),alert("Failed to load kitchen stations")}finally{o(!1)}},f=async()=>{try{const e=await jr.staffAPI.getAllStaffMembers(t),s=(null===e||void 0===e?void 0:e.staff)||e||[],a=Array.isArray(s)?s.filter(e=>{const t="Active"===e.status||!e.status,s="FNB"===e.role,a="Staff"===e.role&&e.customRoleName;return t&&(s||a)}):[];l(a)}catch(e){console.error("Error loading chefs:",e),l([])}};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Kitchen Operations"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Manage kitchen stations and track progress"})]}),(0,sa.jsxs)("button",{onClick:()=>{m(null),c(!0)},className:"bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2",children:[(0,sa.jsx)("span",{children:"\u2795"}),(0,sa.jsx)("span",{children:"Create Station"})]})]}),(0,sa.jsxs)("div",{className:"bg-blue-600/20 border border-blue-500 rounded-xl p-4",children:[(0,sa.jsx)("h3",{className:"text-white font-bold mb-2",children:"\ud83c\udfe0 Kitchen Station Management"}),(0,sa.jsx)("p",{className:"text-blue-200 text-sm",children:"Create multiple stations for different food categories. Each station tracks pending and completed orders in real-time."})]}),i?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-4",children:"Loading stations..."})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,sa.jsx)(sx,{station:e,onEdit:()=>{m(e),c(!0)},onViewStats:()=>(async e=>{try{const s=await jr.Zl.getStationStatistics(t,e);b(s),x(!0)}catch(s){alert("Failed to load station statistics")}})(e.id),onDelete:async()=>{if(window.confirm('Delete station "'.concat(e.stationName,'"?')))try{await jr.Zl.deleteKitchenStation(t,e.id),g()}catch(s){alert(s.message||"Failed to delete station")}},onToggleStatus:async()=>{try{await jr.Zl.updateKitchenStation(t,e.id,{isActive:!e.isActive}),g()}catch(s){alert("Failed to update station status")}}},e.id))}),0===s.length&&!i&&(0,sa.jsxs)("div",{className:"text-center py-12 bg-slate-800 rounded-xl",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-lg mb-2",children:"No kitchen stations yet"}),(0,sa.jsx)("p",{className:"text-gray-500 text-sm mb-4",children:'Create stations like "Station 1 - Quick Snacks", "Station 2 - Main Meals", etc.'}),(0,sa.jsx)("button",{onClick:()=>c(!0),className:"text-orange-500 hover:text-orange-400 font-semibold",children:"Create your first station"})]}),d&&(0,sa.jsx)(ax,{clubId:t,station:u,chefs:n,onClose:()=>{c(!1),m(null)},onSave:()=>{c(!1),m(null),g()}}),h&&p&&(0,sa.jsx)(rx,{stats:p,onClose:()=>{x(!1),b(null)}})]})}function sx(e){let{station:t,onEdit:s,onViewStats:a,onDelete:r,onToggleStatus:n}=e;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border-2 ".concat(t.isActive?"border-green-500":"border-gray-600"),children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,sa.jsx)("span",{className:"text-3xl",children:"\ud83d\udc68\u200d\ud83c\udf73"}),(0,sa.jsxs)("span",{className:"bg-orange-600 text-white px-3 py-1 rounded-full text-sm font-bold",children:["#",t.stationNumber]})]}),(0,sa.jsx)("h3",{className:"text-xl font-bold text-white",children:t.stationName})]}),(0,sa.jsx)("button",{onClick:n,className:"px-3 py-1 rounded-full text-xs font-semibold ".concat(t.isActive?"bg-green-500 text-white":"bg-gray-500 text-white"),children:t.isActive?"Active":"Inactive"})]}),(0,sa.jsxs)("div",{className:"mb-4 pb-4 border-b border-slate-700",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Chef:"}),(0,sa.jsx)("p",{className:"text-white font-semibold",children:t.chefName||"Unassigned"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,sa.jsxs)("div",{className:"bg-yellow-600/20 rounded-lg p-3",children:[(0,sa.jsx)("p",{className:"text-yellow-400 text-2xl font-bold",children:t.ordersPending}),(0,sa.jsx)("p",{className:"text-yellow-300 text-xs",children:"Pending Orders"})]}),(0,sa.jsxs)("div",{className:"bg-green-600/20 rounded-lg p-3",children:[(0,sa.jsx)("p",{className:"text-green-400 text-2xl font-bold",children:t.ordersCompleted}),(0,sa.jsx)("p",{className:"text-green-300 text-xs",children:"Completed"})]})]}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsx)("button",{onClick:a,className:"w-full bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"\ud83d\udcca View Statistics"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,sa.jsx)("button",{onClick:s,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"Edit"}),(0,sa.jsx)("button",{onClick:r,className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-semibold",children:"Delete"})]})]})]})}function ax(e){var t;let{clubId:s,station:a,chefs:n,onClose:l,onSave:o}=e;const[d,c]=(0,r.useState)({stationName:(null===a||void 0===a?void 0:a.stationName)||"",stationNumber:(null===a||void 0===a?void 0:a.stationNumber)||"",chefName:(null===a||void 0===a?void 0:a.chefName)||"",chefId:(null===a||void 0===a?void 0:a.chefId)||"",isActive:null===(t=null===a||void 0===a?void 0:a.isActive)||void 0===t||t}),[u,m]=(0,r.useState)(!1);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-lg w-full",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:a?"Edit Kitchen Station":"Create Kitchen Station"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{m(!0),a?await jr.Zl.updateKitchenStation(s,a.id,d):await jr.Zl.createKitchenStation(s,d),o()}catch(t){alert(t.message||"Failed to save station")}finally{m(!1)}},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Station Name *"}),(0,sa.jsx)("input",{type:"text",required:!0,value:d.stationName,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{stationName:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Station 1 - Quick Snacks"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Station Number *"}),(0,sa.jsx)("input",{type:"number",required:!0,min:"1",value:d.stationNumber,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{stationNumber:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"1, 2, 3..."}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Unique number for this station"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Chef Name"}),(0,sa.jsx)("input",{type:"text",value:d.chefName,onChange:e=>c((0,i.A)((0,i.A)({},d),{},{chefName:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",placeholder:"e.g., Chef Raj"})]}),n.length>0&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Or Select from Staff"}),(0,sa.jsxs)("select",{value:d.chefId||"",onChange:e=>{const t=n.find(t=>t.id===e.target.value);c((0,i.A)((0,i.A)({},d),{},{chefId:e.target.value,chefName:(null===t||void 0===t?void 0:t.name)||d.chefName}))},className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"",children:"-- Optional --"}),n.map(e=>{const t="Staff"===e.role&&e.customRoleName?"".concat(e.customRoleName," (Custom)"):e.role;return(0,sa.jsxs)("option",{value:e.id,children:[e.name," ",t?"- ".concat(t):""]},e.id)})]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Showing all active staff members including custom roles"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Status"}),(0,sa.jsxs)("select",{value:d.isActive?"active":"inactive",onChange:e=>c((0,i.A)((0,i.A)({},d),{},{isActive:"active"===e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"active",children:"Active"}),(0,sa.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,sa.jsx)("div",{className:"bg-blue-600/20 border border-blue-500 rounded-lg p-3",children:(0,sa.jsx)("p",{className:"text-blue-300 text-sm",children:"\ud83d\udca1 Orders will be assigned to this station by the FNB manager"})}),(0,sa.jsxs)("div",{className:"flex space-x-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:u,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50",children:u?"Saving...":a?"Update Station":"Create Station"}),(0,sa.jsx)("button",{type:"button",onClick:l,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Cancel"})]})]})]})})}function rx(e){let{stats:t,onClose:s}=e;return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Station Statistics"}),(0,sa.jsx)("div",{className:"bg-slate-900 rounded-lg p-4 mb-6",children:(0,sa.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,sa.jsx)("span",{className:"text-4xl",children:"\ud83d\udc68\u200d\ud83c\udf73"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white",children:t.station.name}),(0,sa.jsxs)("p",{className:"text-gray-400",children:["Station #",t.station.number]}),(0,sa.jsxs)("p",{className:"text-gray-400",children:["Chef: ",t.station.chefName||"Unassigned"]})]})]})}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,sa.jsxs)("div",{className:"bg-yellow-600/20 rounded-lg p-6",children:[(0,sa.jsx)("p",{className:"text-yellow-400 text-4xl font-bold mb-2",children:t.statistics.todayCompleted}),(0,sa.jsx)("p",{className:"text-yellow-300 text-sm",children:"Completed Today"})]}),(0,sa.jsxs)("div",{className:"bg-blue-600/20 rounded-lg p-6",children:[(0,sa.jsx)("p",{className:"text-blue-400 text-4xl font-bold mb-2",children:t.statistics.todayPending}),(0,sa.jsx)("p",{className:"text-blue-300 text-sm",children:"Pending Today"})]}),(0,sa.jsxs)("div",{className:"bg-green-600/20 rounded-lg p-6",children:[(0,sa.jsx)("p",{className:"text-green-400 text-4xl font-bold mb-2",children:t.statistics.allTimeCompleted}),(0,sa.jsx)("p",{className:"text-green-300 text-sm",children:"All-Time Completed"})]}),(0,sa.jsxs)("div",{className:"bg-purple-600/20 rounded-lg p-6",children:[(0,sa.jsx)("p",{className:"text-purple-400 text-4xl font-bold mb-2",children:t.statistics.storedPending}),(0,sa.jsx)("p",{className:"text-purple-300 text-sm",children:"Currently Pending"})]})]}),(0,sa.jsx)("div",{className:"bg-slate-900 rounded-lg p-4 mb-6",children:(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Station Status:"}),(0,sa.jsx)("span",{className:"px-4 py-2 rounded-full font-semibold ".concat(t.station.isActive?"bg-green-500 text-white":"bg-gray-500 text-white"),children:t.station.isActive?"\u2705 Active":"\u2b55 Inactive"})]})}),(0,sa.jsx)("button",{onClick:s,className:"w-full bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold",children:"Close"})]})})}function nx(e){let{activeItem:t,setActiveItem:s,menuItems:a=[],onSignOut:n=null}=e;const[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(window.innerWidth<1024),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),p=(0,r.useRef)(null),b=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useRef)(null),y=localStorage.getItem("clubId");od(y);const{data:v}=hn({queryKey:["unreadNotificationCount",y,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(y,"staff"),enabled:!!y}),{data:w}=hn({queryKey:["myApprovedLeaves",y],queryFn:()=>jr.ie.getMyLeaveApplications(y,{status:"Approved"}),enabled:!!y}),j=(null===w||void 0===w?void 0:w.total)||0,{data:N}=hn({queryKey:["unreadChatCounts",y],queryFn:()=>jr.h2.getUnreadCounts(y),enabled:!!y}),S=((null===N||void 0===N?void 0:N.staffChats)||0)+((null===N||void 0===N?void 0:N.playerChats)||0);(0,r.useEffect)(()=>{const e=(null===v||void 0===v?void 0:v.unreadCount)||0;if(null!==p.current&&e>p.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}p.current=e},[null===v||void 0===v?void 0:v.unreadCount]),(0,r.useEffect)(()=>{if(null!==b.current&&j>b.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e)),wr.success("\ud83c\udf89 Your leave request has been approved!",{duration:5e3})}b.current=j},[j]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.staffChats)||0;if(null!==g.current&&e>g.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}g.current=e},[null===N||void 0===N?void 0:N.staffChats]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.playerChats)||0;if(null!==f.current&&e>f.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}f.current=e},[null===N||void 0===N?void 0:N.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;c(e),e||o(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(l&&d){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[l,d]);const{data:k}=hn({queryKey:["club",y],queryFn:()=>jr.Od.getClub(y),enabled:!!y}),C=JSON.parse(localStorage.getItem("user")||"{}"),A=C.email||"fnb@pokerroom.com",_=C.displayName||"FNB Manager",P=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e)),m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}});return(0,sa.jsxs)(sa.Fragment,{children:[d&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-orange-500 to-red-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),d&&l&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>o(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] bg-gradient-to-b from-orange-500/20 via-red-600/30 to-pink-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(d?l?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-red-300 to-pink-400 drop-shadow-lg mb-6",children:"FNB Portal"}),(0,sa.jsxs)("div",{onClick:()=>m(!0),className:"flex items-center text-white min-w-0 cursor-pointer hover:opacity-90 transition-opacity p-2 -m-2 rounded-lg",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:(0,sa.jsx)("span",{className:"text-gray-900 font-bold text-sm",children:"F"})}),(0,sa.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold truncate",children:_}),(0,sa.jsx)("div",{className:"text-sm opacity-80 truncate",children:A})]})]}),u&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]",onClick:()=>m(!1),children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full mx-4 border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Enter your current and new password"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),A?h.currentPassword&&h.newPassword&&h.confirmPassword?h.newPassword===h.confirmPassword?h.newPassword.length<8?wr.error("Password must be at least 8 characters"):P.mutate({email:A,currentPassword:h.currentPassword,newPassword:h.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:h.currentPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:h.newPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:h.confirmPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:P.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:P.isLoading?"Resetting...":"Reset Password"})]})]})]})}),document.body),k&&k.code&&(0,sa.jsx)("div",{className:"mb-6",children:(0,sa.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-300 font-semibold mb-1",children:"\ud83c\udfae Club Code"}),(0,sa.jsx)("div",{className:"text-emerald-100 font-mono text-lg font-bold tracking-wider text-center",children:k.code}),(0,sa.jsx)("div",{className:"text-xs text-emerald-400 mt-1 text-center",children:"Players use this to sign up"})]})})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:a.map((e,a)=>(0,sa.jsx)("button",{onClick:()=>{s(e),d&&o(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-orange-400 to-red-600 text-gray-900 font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-orange-400/20 hover:to-red-500/20 text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between",children:[(0,sa.jsx)("span",{className:"block truncate",children:e}),"Notifications"===e&&(null===v||void 0===v?void 0:v.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:v.unreadCount>9?"9+":v.unreadCount}),"Chat"===e&&S>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:S>9?"9+":S})]})},a))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})})]})}function lx(){const[e,t]=(0,r.useState)("Menu & Inventory"),s=me(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[d,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=localStorage.getItem("clubId");e&&c(e)},[]),(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("fnb_staffuser")||"{}");(e.mustResetPassword||t.mustResetPassword)&&n(!0)},[]);const u=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("fnb_staffuser")||"{}");t.userId&&(t.mustResetPassword=!1,localStorage.setItem("fnb_staffuser",JSON.stringify(t))),n(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),m=a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("fnb_staffuser")||"{}"),a=t.email||s.email||s.userEmail;a?l.currentPassword&&l.newPassword&&l.confirmPassword?l.newPassword===l.confirmPassword?l.newPassword.length<8?wr.error("Password must be at least 8 characters"):u.mutate({email:a,currentPassword:l.currentPassword,newPassword:l.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:l.currentPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:l.newPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:l.confirmPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:u.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:u.isLoading?"Resetting...":"Reset Password"})]})]})}),h=()=>{localStorage.clear(),s("/login")};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white font-sans",children:[(0,sa.jsxs)("div",{className:"flex",children:[(0,sa.jsx)(nx,{activeItem:e,setActiveItem:t,menuItems:["Menu & Inventory","Notifications","Order Management","Supplier Management","Kitchen Operations","Leave Management","Chat"],onSignOut:h}),(0,sa.jsx)("main",{className:"flex-1 lg:ml-0 min-w-0",children:(0,sa.jsxs)("div",{className:"mx-auto max-w-[1400px] px-4 sm:px-6 py-6 sm:py-10 space-y-8",children:[(0,sa.jsxs)("header",{className:"bg-gradient-to-r from-orange-600 via-red-500 to-pink-400 p-6 rounded-xl shadow-md flex justify-between items-center mt-16 lg:mt-0",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h1",{className:"text-2xl font-bold text-white",children:["FNB Portal - ",e]}),(0,sa.jsx)("p",{className:"text-gray-200 mt-1",children:"Manage poker club F&B service, menu, and player orders"})]}),(0,sa.jsx)("button",{onClick:h,className:"bg-red-600 hover:bg-red-500 text-white font-semibold px-4 py-2 rounded-lg shadow",children:"Sign Out"})]}),!d&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view FNB management."})}),"Menu & Inventory"===e&&d&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)(fm,{selectedClubId:d}),(0,sa.jsx)(qh,{clubId:d})]}),"Order Management"===e&&d&&(0,sa.jsx)(Jh,{clubId:d}),"Supplier Management"===e&&d&&(0,sa.jsx)(Zh,{clubId:d}),"Kitchen Operations"===e&&d&&(0,sa.jsx)(tx,{clubId:d}),"Chat"===e&&d&&(0,sa.jsx)($u,{clubId:d}),"Notifications"===e&&d&&(0,sa.jsx)(bm,{selectedClubId:d,recipientType:"staff"}),"Leave Management"===e&&d&&(0,sa.jsx)(nh,{clubId:d,userRole:"FNB"})]})})]}),m]})}function ix(e){let{activeItem:t,setActiveItem:s,menuItems:a=[],onSignOut:n=null,customRoleName:l="Staff"}=e;const[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(window.innerWidth<1024),u=(0,r.useRef)(null),m=(0,r.useRef)(null),h=(0,r.useRef)(null),x=(0,r.useRef)(null),p=localStorage.getItem("clubId");od(p);const{data:b}=hn({queryKey:["unreadNotificationCount",p,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(p,"staff"),enabled:!!p}),{data:g}=hn({queryKey:["myApprovedLeaves",p],queryFn:()=>jr.ie.getMyLeaveApplications(p,{status:"Approved"}),enabled:!!p}),f=(null===g||void 0===g?void 0:g.total)||0,{data:y}=hn({queryKey:["unreadChatCounts",p],queryFn:()=>jr.h2.getUnreadCounts(p),enabled:!!p}),v=((null===y||void 0===y?void 0:y.staffChats)||0)+((null===y||void 0===y?void 0:y.playerChats)||0);(0,r.useEffect)(()=>{const e=(null===b||void 0===b?void 0:b.unreadCount)||0;if(null!==u.current&&e>u.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}u.current=e},[null===b||void 0===b?void 0:b.unreadCount]),(0,r.useEffect)(()=>{if(null!==m.current&&f>m.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e)),wr.success("\ud83c\udf89 Your leave request has been approved!",{duration:5e3})}m.current=f},[f]),(0,r.useEffect)(()=>{const e=(null===y||void 0===y?void 0:y.staffChats)||0;if(null!==h.current&&e>h.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}h.current=e},[null===y||void 0===y?void 0:y.staffChats]),(0,r.useEffect)(()=>{const e=(null===y||void 0===y?void 0:y.playerChats)||0;if(null!==x.current&&e>x.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}x.current=e},[null===y||void 0===y?void 0:y.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;c(e),e||o(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(i&&d){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[i,d]);const{data:w}=hn({queryKey:["club",p],queryFn:()=>jr.Od.getClub(p),enabled:!!p}),j=JSON.parse(localStorage.getItem("user")||"{}"),N=j.email||"",S=j.displayName||"Staff Member";return(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>o(!i),className:"lg:hidden fixed top-4 left-4 z-50 bg-slate-800 p-2 rounded-lg text-white",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,sa.jsx)("aside",{className:"sidebar-container fixed h-screen overflow-y-auto lg:static inset-y-0 left-0 z-40 w-64 bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 border-r border-slate-700 transform ".concat(i?"translate-x-0":"-translate-x-full"," lg:translate-x-0 transition-transform duration-300 ease-in-out"),children:(0,sa.jsxs)("div",{className:"flex flex-col h-full",children:[(0,sa.jsxs)("div",{className:"p-6 border-b border-slate-700",children:[(0,sa.jsx)("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:l}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Staff Portal"})]}),(0,sa.jsxs)("div",{className:"p-4 border-b border-slate-700",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4 cursor-pointer hover:bg-slate-700 transition-colors",children:[(0,sa.jsx)("p",{className:"text-white font-semibold truncate",children:S}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm truncate",children:N})]}),w&&(0,sa.jsxs)("div",{className:"mt-4 bg-green-900/30 border border-green-500/50 rounded-lg p-3",children:[(0,sa.jsx)("p",{className:"text-green-400 text-xs font-semibold mb-1",children:"Club Code"}),(0,sa.jsx)("p",{className:"text-green-300 text-lg font-bold",children:w.code||"N/A"}),(0,sa.jsx)("p",{className:"text-green-400/70 text-xs mt-1",children:"Players use this to sign up"})]})]}),(0,sa.jsx)("nav",{className:"flex-1 overflow-y-auto p-4",children:(0,sa.jsx)("ul",{className:"space-y-2",children:a.map(e=>(0,sa.jsx)("li",{children:(0,sa.jsx)("button",{onClick:()=>{s(e),d&&o(!1)},className:"w-full text-left px-4 py-3 rounded-lg transition-colors ".concat(t===e?"bg-purple-600 text-white":"text-gray-300 hover:bg-slate-700"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between w-full",children:[(0,sa.jsx)("span",{children:e}),"Notifications"===e&&(null===b||void 0===b?void 0:b.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:b.unreadCount>9?"9+":b.unreadCount}),"Chat"===e&&v>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:v>9?"9+":v})]})})},e))})}),n&&(0,sa.jsx)("div",{className:"p-4 border-t border-slate-700",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white font-semibold px-4 py-2 rounded-lg transition-colors",children:"Sign Out"})})]})}),i&&d&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/50 z-30 lg:hidden",onClick:()=>o(!1)})]})}function ox(){const[e,t]=(0,r.useState)("Chat"),s=me(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),d=localStorage.getItem("clubId"),c=JSON.parse(localStorage.getItem("user")||"{}"),u=JSON.parse(localStorage.getItem("staffuser")||"{}"),[m,h]=(0,r.useState)(c.customRoleName||u.customRoleName||"Staff"),[x,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(d&&c.email)try{const e=await jr.staffAPI.getAllStaffMembers(d),t=((null===e||void 0===e?void 0:e.staff)||e||[]).find(e=>e.email===c.email);if(t&&(p(t.id),t.customRoleName)){h(t.customRoleName);const e=(0,i.A)((0,i.A)({},c),{},{customRoleName:t.customRoleName});localStorage.setItem("user",JSON.stringify(e))}}catch(e){console.error("Error fetching staff data:",e)}})()},[d,c.email]),(0,r.useEffect)(()=>{(c.mustResetPassword||u.mustResetPassword)&&n(!0)},[]);const b=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=(0,i.A)((0,i.A)({},c),{},{mustResetPassword:!1});localStorage.setItem("user",JSON.stringify(e));const t=(0,i.A)((0,i.A)({},u),{},{mustResetPassword:!1});localStorage.setItem("staffuser",JSON.stringify(t)),n(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),g=a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=c.email||u.email;t?l.currentPassword&&l.newPassword&&l.confirmPassword?l.newPassword===l.confirmPassword?l.newPassword.length<8?wr.error("Password must be at least 8 characters"):b.mutate({email:t,currentPassword:l.currentPassword,newPassword:l.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:l.currentPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:l.newPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:l.confirmPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:b.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:b.isLoading?"Resetting...":"Reset Password"})]})]})}),f=()=>{localStorage.clear(),s("/login")};return(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white font-sans",children:[(0,sa.jsxs)("div",{className:"flex",children:[(0,sa.jsx)(ix,{activeItem:e,setActiveItem:t,menuItems:["Notifications","Chat","Salary History","Bonus History","Leave Management"],onSignOut:f,customRoleName:m}),(0,sa.jsx)("main",{className:"flex-1 lg:ml-0 min-w-0 h-screen overflow-y-auto",children:(0,sa.jsxs)("div",{className:"mx-auto max-w-[1400px] px-4 sm:px-6 py-6 sm:py-10 space-y-8",children:[(0,sa.jsxs)("header",{className:"bg-gradient-to-r from-purple-600 via-blue-500 to-indigo-400 p-6 rounded-xl shadow-md flex justify-between items-center mt-16 lg:mt-0",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h1",{className:"text-2xl font-bold text-white",children:[m," Portal - ",e]}),(0,sa.jsx)("p",{className:"text-gray-200 mt-1",children:"Staff communication and financial records"})]}),(0,sa.jsx)("button",{onClick:f,className:"bg-red-600 hover:bg-red-500 text-white font-semibold px-4 py-2 rounded-lg shadow",children:"Sign Out"})]}),!d&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view your information."})}),"Chat"===e&&d&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)(fm,{selectedClubId:d}),(0,sa.jsx)($u,{clubId:d,hidePlayerChat:!0})]}),"Salary History"===e&&d&&x&&(0,sa.jsx)(dx,{clubId:d,staffId:x}),"Notifications"===e&&d&&(0,sa.jsx)(bm,{selectedClubId:d,recipientType:"staff"}),"Bonus History"===e&&d&&x&&(0,sa.jsx)(cx,{clubId:d,staffId:x}),"Leave Management"===e&&d&&(0,sa.jsx)(nh,{clubId:d,userRole:"STAFF"})]})})]}),g]})}function dx(e){let{clubId:t,staffId:s}=e;const[a,n]=(0,r.useState)(1),[l,o]=(0,r.useState)({startDate:"",endDate:""}),{data:d,isLoading:c}=hn({queryKey:["salary-payments",t,s,a,l],queryFn:async()=>await jr.oA.getSalaryPayments(t,(0,i.A)({page:a,limit:10,staffId:s},l)),enabled:!!t&&!!s}),u=(null===d||void 0===d?void 0:d.payments)||[],m=(null===d||void 0===d?void 0:d.totalPages)||1,h=(null===d||void 0===d?void 0:d.total)||0,x=e=>"\u20b9".concat((e||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})),p=e=>e?new Date(e).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-";return c?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-4",children:"Loading salary history..."})]}):(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Your Salary History"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:l.startDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:l.endDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{endDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]})]}),(0,sa.jsx)("div",{className:"bg-slate-900 rounded-lg p-4 mb-6",children:(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Total Records"}),(0,sa.jsx)("p",{className:"text-white text-2xl font-bold",children:h})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Total Paid"}),(0,sa.jsx)("p",{className:"text-green-400 text-2xl font-bold",children:x(u.reduce((e,t)=>e+(t.amount||0),0))})]})]})}),(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full text-left",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Payment Date"}),(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Amount"}),(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Period"}),(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Status"})]})}),(0,sa.jsx)("tbody",{children:0===u.length?(0,sa.jsx)("tr",{children:(0,sa.jsx)("td",{colSpan:"4",className:"py-8 text-center text-gray-400",children:"No salary payments found"})}):u.map(e=>(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30",children:[(0,sa.jsx)("td",{className:"py-3 text-white",children:p(e.paymentDate)}),(0,sa.jsx)("td",{className:"py-3 text-green-400 font-semibold",children:x(e.amount)}),(0,sa.jsx)("td",{className:"py-3 text-gray-300",children:e.periodStart&&e.periodEnd?"".concat(p(e.periodStart)," - ").concat(p(e.periodEnd)):"-"}),(0,sa.jsx)("td",{className:"py-3",children:(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("Paid"===e.status?"bg-green-900/30 text-green-400":"bg-yellow-900/30 text-yellow-400"),children:e.status||"Paid"})})]},e.id))})]})}),m>1&&(0,sa.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>n(e=>Math.max(1,e-1)),disabled:1===a,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-gray-300",children:["Page ",a," of ",m]}),(0,sa.jsx)("button",{onClick:()=>n(e=>Math.min(m,e+1)),disabled:a===m,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50",children:"Next"})]})]})})}function cx(e){let{clubId:t,staffId:s}=e;const[a,n]=(0,r.useState)(1),[l,o]=(0,r.useState)({startDate:"",endDate:""}),{data:d,isLoading:c}=hn({queryKey:["staff-bonuses",t,s,a,l],queryFn:async()=>await jr.KG.getStaffBonuses(t,(0,i.A)({page:a,limit:10,staffId:s},l)),enabled:!!t&&!!s}),u=(null===d||void 0===d?void 0:d.bonuses)||[],m=(null===d||void 0===d?void 0:d.totalPages)||1,h=(null===d||void 0===d?void 0:d.total)||0,x=e=>"\u20b9".concat((e||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}));return c?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-4",children:"Loading bonus history..."})]}):(0,sa.jsx)("div",{className:"space-y-6",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Your Bonus History"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:l.startDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:l.endDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{endDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]})]}),(0,sa.jsx)("div",{className:"bg-slate-900 rounded-lg p-4 mb-6",children:(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Total Bonuses"}),(0,sa.jsx)("p",{className:"text-white text-2xl font-bold",children:h})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Total Bonus Amount"}),(0,sa.jsx)("p",{className:"text-green-400 text-2xl font-bold",children:x(u.reduce((e,t)=>e+(t.bonusAmount||0),0))})]})]})}),(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full text-left",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Date"}),(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Bonus Type"}),(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Amount"}),(0,sa.jsx)("th",{className:"pb-3 text-gray-300 font-semibold",children:"Reason"})]})}),(0,sa.jsx)("tbody",{children:0===u.length?(0,sa.jsx)("tr",{children:(0,sa.jsx)("td",{colSpan:"4",className:"py-8 text-center text-gray-400",children:"No bonuses found"})}):u.map(e=>{return(0,sa.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30",children:[(0,sa.jsx)("td",{className:"py-3 text-white",children:(t=e.createdAt,t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-")}),(0,sa.jsx)("td",{className:"py-3 text-gray-300",children:e.bonusType||e.customBonusType||"-"}),(0,sa.jsx)("td",{className:"py-3 text-green-400 font-semibold",children:x(e.bonusAmount)}),(0,sa.jsx)("td",{className:"py-3 text-gray-400",children:e.reason||"-"})]},e.id);var t})})]})}),m>1&&(0,sa.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>n(e=>Math.max(1,e-1)),disabled:1===a,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-gray-300",children:["Page ",a," of ",m]}),(0,sa.jsx)("button",{onClick:()=>n(e=>Math.min(m,e+1)),disabled:a===m,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50",children:"Next"})]})]})})}const ux={ADMIN:"/admin",GRE:"/gre",CASHIER:"/cashier",HR:"/hr",FNB:"/fnb",MANAGER:"/manager",STAFF:"/staff",DEALER:"/dealer",AFFILIATE:"/affiliate"};function mx(){var e,t;const[a,n]=(0,r.useState)({email:"",password:""}),[l,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(!1),u=me();null===(e=de().state)||void 0===e||null===(t=e.from)||void 0===t||t.pathname;(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("adminuser")||"{}"),s=JSON.parse(localStorage.getItem("superadminuser")||"{}"),a=JSON.parse(localStorage.getItem("masteradminuser")||"{}");if(e.id||t.userId||s.userId||a.userId){const r=e.role||t.role||s.role||a.role;"SUPER_ADMIN"===r||s.userId?u("/super-admin",{replace:!0}):e.isMasterAdmin||a.userId?u("/master-admin",{replace:!0}):r&&ux[r]&&u(ux[r],{replace:!0})}},[u]);const m=e=>{n((0,i.A)((0,i.A)({},a),{},{[e.target.name]:e.target.value}))};return(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black flex items-center justify-center p-4",children:(0,sa.jsxs)("div",{className:"max-w-md w-full",children:[(0,sa.jsxs)("div",{className:"text-center mb-8",children:[(0,sa.jsx)("div",{className:"text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 drop-shadow-lg mb-4",children:"Staff Portal"}),(0,sa.jsx)("p",{className:"text-gray-300",children:"Sign in to access your dashboard"})]}),(0,sa.jsx)("div",{className:"bg-gradient-to-br from-gray-800 via-gray-900 to-black rounded-2xl p-8 shadow-2xl border border-gray-700",children:(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),o(""),c(!0);try{var t,r,n,i,d,m,h,x,p,b,g,f;const e=await jr.R2.login(a.email,a.password);if(console.log("Login response:",e),null!==(t=e.user)&&void 0!==t&&t.isMasterAdmin&&(!e.clubRoles||0===e.clubRoles.length))throw new Error("Master Admin should use /master-admin/signin");const o=null===(r=e.tenantRoles)||void 0===r?void 0:r.some(e=>"SUPER_ADMIN"===e.role),c=e.clubRoles&&e.clubRoles.length>0;if(o&&!c)throw new Error("Super Admin should use /super-admin/signin");const y=null===(n=e.clubRoles)||void 0===n||null===(i=n[0])||void 0===i?void 0:i.role,v=null===(d=e.tenantRoles)||void 0===d||null===(m=d[0])||void 0===m?void 0:m.role,w=y||v;if(console.log("Detected role:",w,"clubRoles:",e.clubRoles,"tenantRoles:",e.tenantRoles),!w)throw new Error("No role assigned. Please contact administrator.");let j=null;if("STAFF"===w&&null!==(h=e.clubRoles)&&void 0!==h&&null!==(x=h[0])&&void 0!==x&&null!==(p=x.club)&&void 0!==p&&p.id)try{const{staffAPI:t}=await Promise.resolve().then(s.bind(s,980)),r=e.clubRoles[0].club.id,n=await t.getAllStaffMembers(r),l=((null===n||void 0===n?void 0:n.staff)||n||[]).find(e=>e.email===a.email);null!==l&&void 0!==l&&l.customRoleName&&(j=l.customRoleName)}catch(l){console.error("Error fetching custom role name:",l)}const N={id:e.user.id,email:a.email,displayName:e.user.displayName,role:w,mustResetPassword:e.user.mustResetPassword||!1,customRoleName:j},S="".concat(w.toLowerCase(),"user");localStorage.setItem(S,JSON.stringify({email:a.email,role:w,userId:e.user.id,displayName:e.user.displayName,mustResetPassword:e.user.mustResetPassword||!1,customRoleName:j})),localStorage.setItem("user",JSON.stringify(N)),null!==(b=e.clubRoles)&&void 0!==b&&null!==(g=b[0])&&void 0!==g&&null!==(f=g.club)&&void 0!==f&&f.id&&localStorage.setItem("clubId",e.clubRoles[0].club.id);u(ux[w]||"/",{replace:!0})}catch(Gx){console.error("Login error:",Gx),o(Gx.message||"Invalid email or password. Please try again.")}finally{c(!1)}},className:"space-y-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),(0,sa.jsx)("input",{id:"email",name:"email",type:"email",required:!0,value:a.email,onChange:m,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"Enter your email",autoComplete:"email"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),(0,sa.jsx)("input",{id:"password",name:"password",type:"password",required:!0,value:a.password,onChange:m,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"Enter your password",autoComplete:"current-password"})]}),l&&(0,sa.jsx)("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-3 text-red-300 text-sm",children:l}),(0,sa.jsx)("button",{type:"submit",disabled:d,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-semibold py-3 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,sa.jsxs)("span",{className:"flex items-center justify-center",children:[(0,sa.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,sa.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,sa.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign In"})]})})]})})}const hx=["Dashboard","Notifications","Player Management","Staff Management","Payroll Management","Affiliates","Tables & Waitlist","VIP Store","Push Notifications","Tournaments","Bonus Management","FNB","Chat","Reports & Analytics","System Control","Leave Management"];function xx(e){let{activeItem:t,setActiveItem:s,menuItems:a=hx,onSignOut:n=null,clubInfo:l=null}=e;const[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(window.innerWidth<1024),[m,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),b=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useRef)(null),y=(0,r.useRef)(null),v=(null===l||void 0===l?void 0:l.rummyEnabled)||!1,w=!1!==(null===l||void 0===l?void 0:l.pokerEnabled);let j=a.filter(e=>!(!w&&["Tables & Waitlist","Tournaments"].includes(e)));v&&(j=[...j,"Rummy"]);const N=localStorage.getItem("clubId");od(N);const{data:S}=hn({queryKey:["unreadNotificationCount",N,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(N,"staff"),enabled:!!N}),{data:k}=hn({queryKey:["unreadChatCounts",N],queryFn:()=>jr.h2.getUnreadCounts(N),enabled:!!N}),C=((null===k||void 0===k?void 0:k.staffChats)||0)+((null===k||void 0===k?void 0:k.playerChats)||0),{data:A=[]}=hn({queryKey:["pendingLeaveApplications",N],queryFn:()=>jr.ie.getPendingLeaveApplications(N),enabled:!!N}),_=(null===A||void 0===A?void 0:A.length)||0;(0,r.useEffect)(()=>{const e=(null===S||void 0===S?void 0:S.unreadCount)||0;if(null!==b.current&&e>b.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}b.current=e},[null===S||void 0===S?void 0:S.unreadCount]),(0,r.useEffect)(()=>{const e=_;if(null!==g.current&&e>g.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}g.current=e},[_]),(0,r.useEffect)(()=>{const e=(null===k||void 0===k?void 0:k.staffChats)||0;if(null!==f.current&&e>f.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}f.current=e},[null===k||void 0===k?void 0:k.staffChats]),(0,r.useEffect)(()=>{const e=(null===k||void 0===k?void 0:k.playerChats)||0;if(null!==y.current&&e>y.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}y.current=e},[null===k||void 0===k?void 0:k.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;u(e),e||d(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(o&&c){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[o,c]);const P=JSON.parse(localStorage.getItem("user")||"{}"),T=JSON.parse(localStorage.getItem("adminuser")||"{}"),E=P.email||T.email||"admin@pokerroom.com",I=P.displayName||T.displayName||"Admin",{data:R}=(P.role||T.role,hn({queryKey:["club",N],queryFn:()=>jr.Od.getClub(N),enabled:!!N})),D=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("adminuser")||"{}");t.mustResetPassword=!1,localStorage.setItem("adminuser",JSON.stringify(t)),h(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}});return(0,sa.jsxs)(sa.Fragment,{children:[c&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-red-500 to-purple-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>d(!o),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),c&&o&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>d(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] bg-gradient-to-b from-red-500/20 via-purple-600/30 to-indigo-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(c?o?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-purple-300 to-indigo-400 drop-shadow-lg mb-6",children:"Admin"}),(0,sa.jsxs)("div",{onClick:()=>h(!0),className:"bg-white/10 rounded-xl p-4 mb-6 text-white shadow-inner cursor-pointer hover:bg-white/15 transition-colors",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold",children:I}),(0,sa.jsx)("div",{className:"text-sm opacity-80",children:E})]}),m&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]",onClick:()=>h(!1),children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full mx-4 border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Enter your current and new password"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("adminuser")||"{}"),a=t.email||s.email;a?x.currentPassword&&x.newPassword&&x.confirmPassword?x.newPassword===x.confirmPassword?x.newPassword.length<8?wr.error("Password must be at least 8 characters"):D.mutate({email:a,currentPassword:x.currentPassword,newPassword:x.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:x.currentPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:x.newPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:x.confirmPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{h(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:D.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:D.isLoading?"Resetting...":"Reset Password"})]})]})]})}),document.body),R&&R.code&&(0,sa.jsx)("div",{className:"mb-6",children:(0,sa.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-300 font-semibold mb-1",children:"\ud83c\udfae Club Code"}),(0,sa.jsx)("div",{className:"text-emerald-100 font-mono text-lg font-bold tracking-wider text-center",children:R.code}),(0,sa.jsx)("div",{className:"text-xs text-emerald-400 mt-1 text-center",children:"Players use this to sign up"})]})})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:j.map(e=>(0,sa.jsx)("button",{onClick:()=>{s(e),c&&d(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-red-400 to-purple-600 text-white font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-red-400/20 hover:to-purple-500/20 text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between",children:[(0,sa.jsx)("span",{className:"block truncate",children:e}),"Notifications"===e&&(null===S||void 0===S?void 0:S.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:S.unreadCount>9?"9+":S.unreadCount}),"Chat"===e&&C>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:C>9?"9+":C}),"Staff Management"===e&&_>0&&(0,sa.jsx)("span",{className:"ml-2 bg-amber-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:_>9?"9+":_}),"Leave Management"===e&&_>0&&(0,sa.jsx)("span",{className:"ml-2 bg-amber-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:_>9?"9+":_})]})},e))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})})]})}function px(e){let{selectedClubId:t}=e;const s=ra(),[a,n]=(0,r.useState)("products"),[l,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[m,h]=(0,r.useState)(1),[x,p]=(0,r.useState)({title:"",points:"",description:"",stock:"",images:["","",""],imageFiles:[null,null,null],isActive:!0}),{data:b=[],isLoading:g}=hn({queryKey:["vipProducts",t],queryFn:()=>jr.Dv.getVipProducts(t),enabled:!!t}),{data:f,isLoading:y}=hn({queryKey:["vipPurchases",t,m],queryFn:()=>jr.Dv.getVipPurchases(t,m,10),enabled:!!t&&"purchases"===a}),v=gn({mutationFn:async e=>{const s=[];for(let r=0;r<3;r++)if(e.imageFiles[r])try{const a=await uh(e.imageFiles[r],t,"vip-store");s.push({url:a})}catch(a){console.error("Failed to upload image ".concat(r+1,":"),a),wr.error("Failed to upload image ".concat(r+1))}else e.images[r]&&""!==e.images[r].trim()&&s.push({url:e.images[r]});return await jr.Dv.createVipProduct(t,{title:e.title,points:parseInt(e.points),description:e.description,stock:parseInt(e.stock)||0,images:s,isActive:e.isActive})},onSuccess:()=>{wr.success("Product created successfully!"),s.invalidateQueries(["vipProducts",t]),i(!1),N()},onError:e=>{wr.error(e.message||"Failed to create product")}}),w=gn({mutationFn:async e=>{let{productId:s,data:a}=e;const r=[];for(let l=0;l<3;l++)if(a.imageFiles[l])try{const e=await uh(a.imageFiles[l],t,"vip-store");r.push({url:e})}catch(n){console.error("Failed to upload image ".concat(l+1,":"),n),wr.error("Failed to upload image ".concat(l+1))}else a.images[l]&&""!==a.images[l].trim()&&r.push({url:a.images[l]});return await jr.Dv.updateVipProduct(t,s,{title:a.title,points:parseInt(a.points),description:a.description,stock:parseInt(a.stock)||0,images:r,isActive:a.isActive})},onSuccess:()=>{wr.success("Product updated successfully!"),s.invalidateQueries(["vipProducts",t]),d(!1),u(null),N()},onError:e=>{wr.error(e.message||"Failed to update product")}}),j=gn({mutationFn:async e=>await jr.Dv.deleteVipProduct(t,e),onSuccess:()=>{wr.success("Product deleted successfully!"),s.invalidateQueries(["vipProducts",t])},onError:e=>{wr.error(e.message||"Failed to delete product")}}),N=()=>{p({title:"",points:"",description:"",stock:"",images:["","",""],imageFiles:[null,null,null],isActive:!0})};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"VIP Store Management"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Manage products that players can redeem with VIP points"})]}),(0,sa.jsx)("div",{className:"flex gap-3",children:"products"===a&&(0,sa.jsx)("button",{onClick:()=>{N(),i(!0)},className:"px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold rounded-lg transition-all shadow-lg",children:"+ Add New Product"})})]}),(0,sa.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,sa.jsxs)("button",{onClick:()=>n("products"),className:"px-5 py-2.5 rounded-lg font-semibold transition-all ".concat("products"===a?"bg-purple-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:["Products (",b.length,")"]}),(0,sa.jsxs)("button",{onClick:()=>n("purchases"),className:"px-5 py-2.5 rounded-lg font-semibold transition-all ".concat("purchases"===a?"bg-purple-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:["Player Purchases ",null!==f&&void 0!==f&&f.total?"(".concat(f.total,")"):""]})]}),"purchases"===a&&(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full text-sm",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"bg-slate-700/50 text-gray-300 text-left",children:[(0,sa.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Player"}),(0,sa.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Product"}),(0,sa.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Points Spent"}),(0,sa.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Status"}),(0,sa.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Date"})]})}),(0,sa.jsx)("tbody",{children:y?(0,sa.jsx)("tr",{children:(0,sa.jsx)("td",{colSpan:5,className:"text-center py-8 text-gray-400",children:"Loading purchases..."})}):0===((null===f||void 0===f?void 0:f.purchases)||[]).length?(0,sa.jsx)("tr",{children:(0,sa.jsx)("td",{colSpan:5,className:"text-center py-8 text-gray-400",children:"No VIP purchases yet"})}):((null===f||void 0===f?void 0:f.purchases)||[]).map(e=>{return(0,sa.jsxs)("tr",{className:"border-t border-slate-700 hover:bg-slate-700/30",children:[(0,sa.jsxs)("td",{className:"px-4 py-3",children:[(0,sa.jsx)("div",{className:"text-white font-medium",children:e.player_name}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:e.player_phone})]}),(0,sa.jsx)("td",{className:"px-4 py-3 text-gray-300",children:e.product_title}),(0,sa.jsx)("td",{className:"px-4 py-3",children:(0,sa.jsxs)("span",{className:"text-yellow-400 font-semibold",children:[e.points_spent," pts"]})}),(0,sa.jsx)("td",{className:"px-4 py-3",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat("completed"===e.status?"bg-green-600/20 text-green-400 border border-green-500/30":"bg-gray-600/20 text-gray-400"),children:(e.status||"completed").charAt(0).toUpperCase()+(e.status||"completed").slice(1)})}),(0,sa.jsx)("td",{className:"px-4 py-3 text-gray-400 text-xs",children:(t=e.created_at,t?new Date(t).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"}):"")})]},e.id);var t})})]})}),(null===f||void 0===f?void 0:f.total)>10&&(0,sa.jsxs)("div",{className:"flex justify-between items-center px-4 py-3 border-t border-slate-700",children:[(0,sa.jsxs)("span",{className:"text-sm text-gray-400",children:["Page ",m," of ",Math.ceil(((null===f||void 0===f?void 0:f.total)||0)/10)]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>h(Math.max(1,m-1)),disabled:1===m,className:"px-3 py-1 bg-slate-700 text-white rounded disabled:opacity-50",children:"Prev"}),(0,sa.jsx)("button",{onClick:()=>h(m+1),disabled:m>=Math.ceil(((null===f||void 0===f?void 0:f.total)||0)/10),className:"px-3 py-1 bg-slate-700 text-white rounded disabled:opacity-50",children:"Next"})]})]})]}),"products"===a&&(g?(0,sa.jsx)("div",{className:"text-center text-gray-400 py-12",children:"Loading products..."}):0===b.length?(0,sa.jsxs)("div",{className:"text-center py-12",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-lg mb-4",children:"No products in the VIP Store yet"}),(0,sa.jsx)("button",{onClick:()=>{N(),i(!0)},className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-lg transition-colors",children:"Create Your First Product"})]}):(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(e=>{var t,s;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg overflow-hidden border border-slate-700 hover:border-purple-500 transition-all shadow-lg",children:[(0,sa.jsxs)("div",{className:"relative h-48 bg-slate-700",children:[e.images&&e.images.length>0&&null!==(t=e.images[0])&&void 0!==t&&t.url?(0,sa.jsx)("img",{src:e.images[0].url,alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,(0,sa.jsx)("div",{className:"absolute inset-0 flex items-center justify-center ".concat(e.images&&e.images.length>0&&null!==(s=e.images[0])&&void 0!==s&&s.url?"hidden":"flex"),children:(0,sa.jsx)("div",{className:"text-6xl text-gray-600",children:"\ud83c\udf81"})}),(0,sa.jsx)("div",{className:"absolute top-2 right-2",children:(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat(e.isActive?"bg-green-600 text-white":"bg-gray-600 text-gray-300"),children:e.isActive?"Active":"Inactive"})})]}),(0,sa.jsxs)("div",{className:"p-4",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:e.title}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm mb-3 line-clamp-2",children:e.description||"No description"}),(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("div",{className:"text-yellow-400 font-bold text-lg",children:[e.points.toLocaleString()," Points"]}),(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Stock: ",e.stock||0]})]}),e.images&&e.images.length>1&&(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["+",e.images.length-1," more ",2===e.images.length?"image":"images"]})]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{var t,s,a,r,n,l,i;u(e),p({title:e.title,points:e.points.toString(),description:e.description||"",stock:(null===(t=e.stock)||void 0===t?void 0:t.toString())||"0",images:[(null===(s=e.images)||void 0===s||null===(a=s[0])||void 0===a?void 0:a.url)||"",(null===(r=e.images)||void 0===r||null===(n=r[1])||void 0===n?void 0:n.url)||"",(null===(l=e.images)||void 0===l||null===(i=l[2])||void 0===i?void 0:i.url)||""],imageFiles:[null,null,null],isActive:void 0===e.isActive||e.isActive}),d(!0)})(e),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-semibold transition-colors",children:"Edit"}),(0,sa.jsx)("button",{onClick:()=>{return t=e.id,s=e.title,void(window.confirm('Are you sure you want to delete "'.concat(s,'"?'))&&j.mutate(t));var t,s},disabled:j.isPending,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-semibold transition-colors disabled:opacity-50",children:"Delete"})]})]})]},e.id)})})),l&&(0,sa.jsx)(bx,{title:"Create New Product",form:x,setForm:p,onSubmit:e=>{e.preventDefault(),x.title.trim()?!x.points||parseInt(x.points)<=0?wr.error("Valid points value is required"):v.mutate(x):wr.error("Product title is required")},onClose:()=>{i(!1),N()},isLoading:v.isPending}),o&&c&&(0,sa.jsx)(bx,{title:"Edit Product",form:x,setForm:p,onSubmit:e=>{e.preventDefault(),x.title.trim()?!x.points||parseInt(x.points)<=0?wr.error("Valid points value is required"):w.mutate({productId:c.id,data:x}):wr.error("Product title is required")},onClose:()=>{d(!1),u(null),N()},isLoading:w.isPending})]})}function bx(e){let{title:t,form:s,setForm:a,onSubmit:r,onClose:n,isLoading:l}=e;return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-2xl w-full my-8 border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:t}),(0,sa.jsxs)("form",{onSubmit:r,className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2 font-semibold",children:["Product Title ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"text",value:s.title,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{title:e.target.value})),placeholder:"e.g., Premium Poker Chips Set",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2 font-semibold",children:["VIP Points ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"number",value:s.points,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{points:e.target.value})),placeholder:"e.g., 5000",min:"1",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Stock Quantity"}),(0,sa.jsx)("input",{type:"number",value:s.stock,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{stock:e.target.value})),placeholder:"e.g., 50",min:"0",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Description"}),(0,sa.jsx)("textarea",{value:s.description,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{description:e.target.value})),placeholder:"Describe your product...",rows:3,className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Product Images (Up to 3)"}),[0,1,2].map(e=>(0,sa.jsxs)("div",{className:"mb-3",children:[(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsxs)("label",{className:"flex-shrink-0 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold cursor-pointer transition-colors",children:[(0,sa.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:t=>{var r;const n=null===(r=t.target.files)||void 0===r?void 0:r[0];if(n){if(n.size>5242880)return void wr.error("Image must be less than 5MB");const t=[...s.imageFiles];t[e]=n,a((0,i.A)((0,i.A)({},s),{},{imageFiles:t}))}}}),s.imageFiles[e]?"\u2713 File Selected":"Choose File"]}),(0,sa.jsx)("input",{type:"url",value:s.images[e],onChange:t=>{const r=[...s.images];r[e]=t.target.value,a((0,i.A)((0,i.A)({},s),{},{images:r}))},placeholder:"Or paste URL ".concat(e+1).concat(0===e?" (Primary)":" (Optional)"),disabled:!!s.imageFiles[e],className:"flex-1 px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:opacity-50"}),(s.imageFiles[e]||s.images[e])&&(0,sa.jsx)("button",{type:"button",onClick:()=>{const t=[...s.imageFiles],r=[...s.images];t[e]=null,r[e]="",a((0,i.A)((0,i.A)({},s),{},{imageFiles:t,images:r}))},className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"\xd7"})]}),s.imageFiles[e]&&(0,sa.jsxs)("p",{className:"text-green-400 text-xs mt-1",children:["\ud83d\udcc1 ",s.imageFiles[e].name," (",(s.imageFiles[e].size/1024).toFixed(1)," KB)"]})]},e)),(0,sa.jsx)("p",{className:"text-gray-500 text-xs mt-2",children:"Upload image files (max 5MB each) or paste direct URLs"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("input",{type:"checkbox",id:"isActive",checked:s.isActive,onChange:e=>a((0,i.A)((0,i.A)({},s),{},{isActive:e.target.checked})),className:"w-5 h-5 text-purple-600 bg-slate-700 border-gray-600 rounded focus:ring-purple-500"}),(0,sa.jsx)("label",{htmlFor:"isActive",className:"text-gray-300 font-semibold",children:"Product is Active (Available for redemption)"})]}),(0,sa.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,sa.jsx)("button",{type:"submit",disabled:l,className:"flex-1 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:l?"Saving...":"Create New Product"===t?"Create Product":"Update Product"}),(0,sa.jsx)("button",{type:"button",onClick:n,className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Cancel"})]})]})]})})}function gx(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)("salary");return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Payroll Management"})}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>a("salary"),className:"px-6 py-3 font-semibold transition-colors ".concat("salary"===s?"text-white border-b-2 border-purple-500":"text-gray-400 hover:text-white"),children:"Employee Salary"}),(0,sa.jsx)("button",{onClick:()=>a("tips"),className:"px-6 py-3 font-semibold transition-colors ".concat("tips"===s?"text-white border-b-2 border-purple-500":"text-gray-400 hover:text-white"),children:"Dealer Tips"})]}),"salary"===s&&(0,sa.jsx)(jh,{selectedClubId:t}),"tips"===s&&(0,sa.jsx)(Nh,{selectedClubId:t})]})}function fx(e){var t,s,a,n;let{selectedClubId:l}=e;const[o,d]=(0,r.useState)("list"),[c,u]=(0,r.useState)(1),[m,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)(!1),[b,g]=(0,r.useState)(null),[f,y]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[j,N]=(0,r.useState)({search:"",status:""}),[S,k]=(0,r.useState)({search:"",startDate:"",endDate:"",affiliateId:""}),[C,A]=(0,r.useState)(1),[_,P]=(0,r.useState)(!1),[T,E]=(0,r.useState)(null),[I,R]=(0,r.useState)({amount:"",reason:""}),[D,O]=(0,r.useState)({affiliateId:"",amount:"",transactionType:"payment",description:"",notes:""}),L=ra(),{data:F,isLoading:M}=hn({queryKey:["affiliates",l,c,j],queryFn:()=>jr.Yt.getAffiliates(l,(0,i.A)({page:c,limit:10},j)),enabled:!!l&&"list"===o}),{data:B,isLoading:q}=hn({queryKey:["affiliate-referrals",null===b||void 0===b?void 0:b.id,f,v],queryFn:()=>jr.Yt.getAffiliateReferrals(l,null===b||void 0===b?void 0:b.id,{search:f,kycStatus:v}),enabled:!(null===b||void 0===b||!b.id)&&m}),{data:U,isLoading:z}=hn({queryKey:["affiliate-transactions",l,C,S],queryFn:()=>jr.Yt.getAffiliateTransactions(l,(0,i.A)({page:C,limit:10},S)),enabled:!!l&&"payments"===o}),K=gn({mutationFn:e=>jr.Yt.processAffiliatePayment(l,e),onSuccess:()=>{wr.success("Payment processed successfully!"),L.invalidateQueries(["affiliate-transactions",l]),L.invalidateQueries(["affiliates",l]),p(!1),g(null),O({affiliateId:"",amount:"",transactionType:"payment",description:"",notes:""})},onError:e=>{wr.error(e.message||"Failed to process payment")}}),W=(null===F||void 0===F?void 0:F.affiliates)||[],H=(null===F||void 0===F?void 0:F.totalPages)||1,V=(null===F||void 0===F?void 0:F.total)||0,J=(null===B||void 0===B?void 0:B.players)||[],Q=(null===U||void 0===U?void 0:U.transactions)||[],G=(null===U||void 0===U?void 0:U.totalPages)||1,Y=(null===U||void 0===U?void 0:U.total)||0,$=gn({mutationFn:e=>jr.Yt.overrideAffiliateTransaction(l,e.id,{amount:e.amount,reason:e.reason}),onSuccess:()=>{wr.success("Affiliate transaction overridden successfully"),L.invalidateQueries(["affiliate-transactions",l]),P(!1),E(null),R({amount:"",reason:""})},onError:e=>{wr.error(e.message||"Failed to override transaction")}}),Z=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"active":return"text-green-400";case"inactive":default:return"text-gray-400";case"suspended":return"text-red-400"}},X=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"approved":case"verified":return"bg-green-900/30 text-green-400 border-green-700";case"pending":return"bg-yellow-900/30 text-yellow-400 border-yellow-700";case"rejected":return"bg-red-900/30 text-red-400 border-red-700";default:return"bg-gray-900/30 text-gray-400 border-gray-700"}};return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Affiliate Management"})}),(0,sa.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,sa.jsx)("button",{onClick:()=>d("list"),className:"px-6 py-3 font-semibold transition-colors ".concat("list"===o?"text-white border-b-2 border-yellow-500 bg-yellow-900/20":"text-gray-400 hover:text-white"),children:"\ud83d\udccb Affiliates List"}),(0,sa.jsx)("button",{onClick:()=>d("payments"),className:"px-6 py-3 font-semibold transition-colors ".concat("payments"===o?"text-white border-b-2 border-green-500 bg-green-900/20":"text-gray-400 hover:text-white"),children:"\ud83d\udcb0 Payments & Transactions"})]}),"list"===o&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-yellow-500",placeholder:"Search by name, code, or email...",value:j.search,onChange:e=>N((0,i.A)((0,i.A)({},j),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Status"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-yellow-500",value:j.status,onChange:e=>N((0,i.A)((0,i.A)({},j),{},{status:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Status"}),(0,sa.jsx)("option",{value:"Active",children:"Active"}),(0,sa.jsx)("option",{value:"Inactive",children:"Inactive"}),(0,sa.jsx)("option",{value:"Suspended",children:"Suspended"})]})]})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,sa.jsxs)("h3",{className:"text-xl font-semibold text-white",children:["Affiliates (",V,")"]})}),M?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===W.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No affiliates found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Name"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Email"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Code"}),(0,sa.jsx)("th",{className:"text-center text-white font-semibold p-3",children:"Referrals"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Earnings"}),(0,sa.jsx)("th",{className:"text-center text-white font-semibold p-3",children:"Status"}),(0,sa.jsx)("th",{className:"text-center text-white font-semibold p-3",children:"Actions"})]})}),(0,sa.jsx)("tbody",{children:W.map(e=>(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:e.name||"N/A"}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:e.email}),(0,sa.jsx)("td",{className:"p-3",children:(0,sa.jsx)("span",{className:"px-3 py-1 bg-yellow-900/30 text-yellow-400 rounded-lg font-mono text-sm border border-yellow-700",children:e.code})}),(0,sa.jsxs)("td",{className:"text-center p-3",children:[(0,sa.jsx)("div",{className:"text-cyan-400 font-semibold",children:e.totalReferrals}),(0,sa.jsxs)("div",{className:"text-xs text-gray-400",children:["(",e.verifiedReferrals," verified)"]})]}),(0,sa.jsxs)("td",{className:"text-right text-green-400 font-semibold p-3",children:["\u20b9",Number(e.totalCommission||0).toFixed(2)]}),(0,sa.jsx)("td",{className:"text-center p-3",children:(0,sa.jsx)("span",{className:"font-semibold ".concat(Z(e.status)),children:e.status})}),(0,sa.jsx)("td",{className:"text-center p-3",children:(0,sa.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,sa.jsx)("button",{onClick:()=>(e=>{g(e),h(!0),y(""),w("")})(e),className:"px-3 py-1 bg-cyan-900/30 hover:bg-cyan-800/50 text-cyan-400 rounded-lg text-sm border border-cyan-700 transition-colors",children:"View Players"}),(0,sa.jsx)("button",{onClick:()=>(e=>{g(e),O((0,i.A)((0,i.A)({},D),{},{affiliateId:e.id})),p(!0)})(e),className:"px-3 py-1 bg-green-900/30 hover:bg-green-800/50 text-green-400 rounded-lg text-sm border border-green-700 transition-colors",children:"Send Money"})]})})]},e.id))})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(c-1)+1," to ",Math.min(10*c,V)," of ",V," entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>u(e=>Math.max(1,e-1)),disabled:1===c,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(H)].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>u(t+1),className:"px-4 py-2 rounded-lg ".concat(c===t+1?"bg-yellow-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>u(e=>Math.min(H,e+1)),disabled:c===H,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),"payments"===o&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-4",children:(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Search"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",placeholder:"Search by name, code, email...",value:S.search,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{search:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:S.startDate,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{startDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"End Date"}),(0,sa.jsx)("input",{type:"date",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:S.endDate,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{endDate:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Affiliate"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:S.affiliateId,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{affiliateId:e.target.value})),children:[(0,sa.jsx)("option",{value:"",children:"All Affiliates"}),W.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name||e.email," (",e.code,")"]},e.id))]})]})]})}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6",children:[(0,sa.jsxs)("h3",{className:"text-xl font-semibold text-white mb-4",children:["Transaction History (",Y,")"]}),z?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===Q.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No transactions found"}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Date"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Affiliate"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Code"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Type"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Amount"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Description"}),(0,sa.jsx)("th",{className:"text-center text-white font-semibold p-3",children:"Actions"})]})}),(0,sa.jsx)("tbody",{children:Q.map(e=>{var t,s,a,r;return(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:new Date(e.processedAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("td",{className:"text-white p-3",children:(null===(t=e.affiliate)||void 0===t?void 0:t.name)||(null===(s=e.affiliate)||void 0===s||null===(a=s.user)||void 0===a?void 0:a.email)||"N/A"}),(0,sa.jsx)("td",{className:"p-3",children:(0,sa.jsx)("span",{className:"px-2 py-1 bg-yellow-900/30 text-yellow-400 rounded text-xs font-mono border border-yellow-700",children:null===(r=e.affiliate)||void 0===r?void 0:r.code})}),(0,sa.jsx)("td",{className:"p-3",children:(0,sa.jsx)("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 rounded text-xs capitalize border border-blue-700",children:e.transactionType})}),(0,sa.jsxs)("td",{className:"text-right text-green-400 font-semibold p-3",children:["\u20b9",Number(e.amount).toFixed(2),e.isOverridden&&null!=e.originalAmount&&(0,sa.jsxs)("div",{className:"text-xs text-yellow-400 mt-1",children:["(Was \u20b9",Number(e.originalAmount).toFixed(2),")"]})]}),(0,sa.jsxs)("td",{className:"text-gray-400 p-3 text-sm",children:[e.description||e.notes||"-",e.isOverridden&&e.overrideReason&&(0,sa.jsxs)("div",{className:"text-xs text-yellow-400 mt-1",children:["Override: ",e.overrideReason]})]}),(0,sa.jsx)("td",{className:"text-center p-3",children:(0,sa.jsx)("button",{onClick:()=>(e=>{E(e),R({amount:Number(e.amount||0).toFixed(2),reason:e.overrideReason||""}),P(!0)})(e),className:"px-3 py-1 bg-red-900/40 hover:bg-red-800/60 text-red-300 rounded-lg text-xs border border-red-700 transition-colors",children:"Override"})})]},e.id)})})]})}),(0,sa.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing ",10*(C-1)+1," to"," ",Math.min(10*C,Y)," of ",Y," entries"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>A(e=>Math.max(1,e-1)),disabled:1===C,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,sa.jsx)("div",{className:"flex gap-2",children:[...Array(G)].map((e,t)=>(0,sa.jsx)("button",{onClick:()=>A(t+1),className:"px-4 py-2 rounded-lg ".concat(C===t+1?"bg-green-600 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),children:t+1},t+1))}),(0,sa.jsx)("button",{onClick:()=>A(e=>Math.min(G,e+1)),disabled:C===G,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]}),m&&b&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-5xl w-full border border-cyan-600 max-h-[90vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Referral Players"}),(0,sa.jsxs)("p",{className:"text-cyan-400 mt-1",children:["Affiliate: ",b.name||b.email," (",b.code,")"]})]}),(0,sa.jsx)("button",{onClick:()=>{h(!1),g(null)},className:"text-gray-400 hover:text-white text-2xl",children:"\xd7"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Search Player"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Search by name, email, or phone...",value:f,onChange:e=>y(e.target.value)})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"KYC Status"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",value:v,onChange:e=>w(e.target.value),children:[(0,sa.jsx)("option",{value:"",children:"All Status"}),(0,sa.jsx)("option",{value:"approved",children:"Approved"}),(0,sa.jsx)("option",{value:"verified",children:"Verified"}),(0,sa.jsx)("option",{value:"pending",children:"Pending"}),(0,sa.jsx)("option",{value:"rejected",children:"Rejected"})]})]})]}),q?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading..."}):0===J.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No referral players found"}):(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{children:(0,sa.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Name"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Email"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Phone"}),(0,sa.jsx)("th",{className:"text-center text-white font-semibold p-3",children:"KYC Status"}),(0,sa.jsx)("th",{className:"text-center text-white font-semibold p-3",children:"Status"}),(0,sa.jsx)("th",{className:"text-right text-white font-semibold p-3",children:"Total Spent"}),(0,sa.jsx)("th",{className:"text-left text-white font-semibold p-3",children:"Joined"})]})}),(0,sa.jsx)("tbody",{children:J.map(e=>(0,sa.jsxs)("tr",{className:"border-b border-slate-700 hover:bg-slate-700",children:[(0,sa.jsx)("td",{className:"text-white p-3",children:e.name}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:e.email}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:e.phoneNumber||"N/A"}),(0,sa.jsx)("td",{className:"text-center p-3",children:(0,sa.jsx)("span",{className:"px-2 py-1 rounded text-xs capitalize border ".concat(X(e.kycStatus)),children:e.kycStatus})}),(0,sa.jsx)("td",{className:"text-center p-3",children:(0,sa.jsx)("span",{className:"font-semibold ".concat(Z(e.status)),children:e.status})}),(0,sa.jsxs)("td",{className:"text-right text-cyan-400 font-semibold p-3",children:["\u20b9",Number(e.totalSpent||0).toFixed(2)]}),(0,sa.jsx)("td",{className:"text-gray-400 p-3 text-sm",children:new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]},e.id))})]})})]})}),x&&b&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-green-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"\ud83d\udcb0 Send Money to Affiliate"}),(0,sa.jsxs)("div",{className:"bg-green-900/30 border border-green-600 rounded-lg p-4 mb-6",children:[(0,sa.jsx)("div",{className:"text-xs text-green-400 mb-1",children:"Sending to:"}),(0,sa.jsx)("h3",{className:"text-white font-semibold text-xl",children:b.name||b.email}),(0,sa.jsxs)("p",{className:"text-sm text-green-300 mt-1",children:["Code: ",b.code]}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Current Earnings: \u20b9",Number(b.totalCommission||0).toFixed(2)]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Amount (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",placeholder:"\u20b90.00",value:D.amount,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{amount:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Transaction Type"}),(0,sa.jsxs)("select",{className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",value:D.transactionType,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{transactionType:e.target.value})),children:[(0,sa.jsx)("option",{value:"payment",children:"Payment"}),(0,sa.jsx)("option",{value:"bonus",children:"Bonus"}),(0,sa.jsx)("option",{value:"adjustment",children:"Adjustment"}),(0,sa.jsx)("option",{value:"commission",children:"Commission"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Description"}),(0,sa.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500",placeholder:"Brief description...",value:D.description,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{description:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Notes (Optional)"}),(0,sa.jsx)("textarea",{className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-green-500 h-24",placeholder:"Additional notes...",value:D.notes,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{notes:e.target.value}))})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{!D.amount||parseFloat(D.amount)<=0?wr.error("Please enter a valid amount"):K.mutate((0,i.A)((0,i.A)({},D),{},{amount:parseFloat(D.amount)}))},disabled:K.isLoading,className:"flex-1 bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:K.isLoading?"Processing...":"Process Payment"}),(0,sa.jsx)("button",{onClick:()=>{p(!1),g(null)},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),_&&T&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-red-600 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"\ud83d\udee0 Override Affiliate Transaction"}),(0,sa.jsxs)("div",{className:"bg-slate-900/60 border border-slate-700 rounded-lg p-4 mb-6 text-sm text-gray-300",children:[(0,sa.jsxs)("div",{className:"mb-1",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Affiliate:"})," ",(0,sa.jsx)("span",{className:"text-white",children:(null===(t=T.affiliate)||void 0===t?void 0:t.name)||(null===(s=T.affiliate)||void 0===s||null===(a=s.user)||void 0===a?void 0:a.email)||"N/A"})]}),(0,sa.jsxs)("div",{className:"mb-1",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Code:"})," ",(0,sa.jsx)("span",{className:"text-yellow-400 font-mono",children:null===(n=T.affiliate)||void 0===n?void 0:n.code})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Current Amount:"})," ",(0,sa.jsxs)("span",{className:"text-green-400 font-semibold",children:["\u20b9",Number(T.amount||0).toFixed(2)]})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"New Amount (\u20b9) *"}),(0,sa.jsx)("input",{type:"number",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500",placeholder:"\u20b90.00",value:I.amount,onChange:e=>R((0,i.A)((0,i.A)({},I),{},{amount:e.target.value}))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block",children:"Override Reason *"}),(0,sa.jsx)("textarea",{className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500 h-24",placeholder:"Explain why you are overriding this transaction...",value:I.reason,onChange:e=>R((0,i.A)((0,i.A)({},I),{},{reason:e.target.value}))})]}),(0,sa.jsx)("p",{className:"text-xs text-yellow-400 bg-yellow-900/20 border border-yellow-700 rounded-lg p-3",children:"This action will update the transaction amount and adjust the affiliate's total commission. A full audit log entry will be recorded."})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,sa.jsx)("button",{onClick:()=>{!I.amount||parseFloat(I.amount)<=0?wr.error("Please enter a valid amount"):!I.reason||I.reason.trim().length<5?wr.error("Please enter a clear override reason (min 5 characters)"):$.mutate({id:T.id,amount:parseFloat(I.amount),reason:I.reason.trim()})},disabled:$.isLoading,className:"flex-1 bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:$.isLoading?"Saving...":"Save Override"}),(0,sa.jsx)("button",{onClick:()=>{P(!1),E(null)},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}function yx(e){let{clubId:t}=e;const[s,a]=(0,r.useState)("menu-inventory");return(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-orange-600 via-red-500 to-pink-500 p-6 rounded-xl shadow-lg",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Food & Beverage Management"}),(0,sa.jsx)("p",{className:"text-white/90",children:"Complete F&B management system for your poker club"})]}),(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl p-2 shadow-lg",children:(0,sa.jsx)("div",{className:"flex space-x-2 overflow-x-auto",children:[{id:"menu-inventory",label:"Menu & Inventory",icon:"\ud83d\udccb"},{id:"order-management",label:"Order Management",icon:"\ud83c\udf7d\ufe0f"},{id:"supplier-management",label:"Supplier Management",icon:"\ud83d\ude9a"},{id:"kitchen-operations",label:"Kitchen Operations",icon:"\ud83d\udc68\u200d\ud83c\udf73"}].map(e=>(0,sa.jsxs)("button",{onClick:()=>a(e.id),className:"flex items-center space-x-2 px-6 py-3 rounded-lg font-semibold transition-all whitespace-nowrap ".concat(s===e.id?"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-slate-700"),children:[(0,sa.jsx)("span",{className:"text-xl",children:e.icon}),(0,sa.jsx)("span",{children:e.label})]},e.id))})}),(0,sa.jsxs)("div",{className:"min-h-[600px]",children:["menu-inventory"===s&&(0,sa.jsx)(qh,{clubId:t}),"order-management"===s&&(0,sa.jsx)(Jh,{clubId:t}),"supplier-management"===s&&(0,sa.jsx)(Zh,{clubId:t}),"kitchen-operations"===s&&(0,sa.jsx)(tx,{clubId:t})]})]})}function vx(e){let{clubId:t}=e;const[s,a]=(0,r.useState)(null),n=[{id:"individual_player",name:"Individual Player Report",icon:(0,sa.jsx)(Sc,{className:"text-5xl"}),color:"from-blue-500 to-cyan-500",description:"Detailed report for a specific player"},{id:"cumulative_player",name:"Cumulative Player Report",icon:(0,sa.jsx)(tc,{className:"text-5xl"}),color:"from-purple-500 to-pink-500",description:"Overall statistics for all players"},{id:"daily_transactions",name:"Daily Transactions Report",icon:(0,sa.jsx)(lc,{className:"text-5xl"}),color:"from-yellow-500 to-orange-500",description:"All transactions for a date range"},{id:"daily_rake",name:"Daily Rake Report",icon:(0,sa.jsx)(ac,{className:"text-5xl"}),color:"from-red-500 to-pink-500",description:"Rake collected per day"},{id:"per_table_transactions",name:"Per Table Transactions Report",icon:(0,sa.jsx)(yc,{className:"text-5xl"}),color:"from-green-500 to-teal-500",description:"Transactions by table"},{id:"credit_transactions",name:"Credit Transactions Report",icon:(0,sa.jsx)(nc,{className:"text-5xl"}),color:"from-indigo-500 to-purple-500",description:"Credit requests and approvals"},{id:"expenses",name:"Expenses Report",icon:(0,sa.jsx)(gc,{className:"text-5xl"}),color:"from-orange-500 to-red-500",description:"Salaries, tips, and other expenses"},{id:"bonus",name:"Bonus Report",icon:(0,sa.jsx)(hc,{className:"text-5xl"}),color:"from-pink-500 to-rose-500",description:"Player and staff bonuses"},{id:"custom",name:"Custom Report",icon:(0,sa.jsx)(kc,{className:"text-5xl"}),color:"from-gray-500 to-slate-500",description:"Compile multiple reports"}];return(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6",children:(0,sa.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 p-6 rounded-lg mb-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Reports & Analytics"}),(0,sa.jsx)("p",{className:"text-white/80 mt-2",children:"Generate comprehensive reports with real-time data"})]}),(0,sa.jsxs)("div",{className:"mb-8",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Available Report Types"}),(0,sa.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>(0,sa.jsx)("button",{onClick:()=>a(e),className:"bg-gradient-to-br ".concat(e.color," p-6 rounded-xl shadow-lg hover:shadow-2xl transform hover:scale-105 transition-all duration-300 text-white"),children:(0,sa.jsxs)("div",{className:"flex flex-col items-center text-center space-y-4",children:[(0,sa.jsx)("div",{className:"p-4 bg-white/20 rounded-full",children:e.icon}),(0,sa.jsx)("h3",{className:"text-xl font-bold",children:e.name}),(0,sa.jsx)("p",{className:"text-sm text-white/80",children:e.description})]})},e.id))})]}),s&&(0,sa.jsx)(wx,{report:s,clubId:t,onClose:()=>a(null)})]})})}function wx(e){let{report:t,clubId:s,onClose:a}=e;const[n,l]=(0,r.useState)({startDate:(new Date).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0],format:"excel",playerId:"",playerSearch:"",tableNumber:"",customReportTypes:[]}),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)([]),[m,h]=(0,r.useState)([]);return(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-8 max-w-2xl w-full my-8",children:[(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white mb-6",children:"Report Configuration"}),(0,sa.jsxs)("div",{className:"bg-gradient-to-r ".concat(t.color," p-4 rounded-lg mb-6 flex items-center gap-4"),children:[(0,sa.jsx)("div",{className:"text-white text-3xl",children:t.icon}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white",children:t.name}),(0,sa.jsx)("p",{className:"text-white/80 text-sm",children:t.description})]})]}),"individual_player"===t.id&&(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsxs)("label",{className:"block text-white mb-2 font-semibold",children:["Search Player ",(0,sa.jsx)("span",{className:"text-red-400",children:"(Type at least 3 characters)"})]}),(0,sa.jsx)("input",{type:"text",value:n.playerSearch,onChange:e=>{l((0,i.A)((0,i.A)({},n),{},{playerSearch:e.target.value})),(async e=>{if(e.length<3)h([]);else try{h([{id:"1",name:"John Doe",email:"john@example.com"},{id:"2",name:"Jane Smith",email:"jane@example.com"}])}catch(t){console.error("Error searching players:",t)}})(e.target.value)},placeholder:"Search by name, ID, or email...",className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg"}),m.length>0&&(0,sa.jsx)("div",{className:"mt-2 bg-slate-700 rounded-lg max-h-48 overflow-y-auto",children:m.map(e=>(0,sa.jsxs)("button",{onClick:()=>{l((0,i.A)((0,i.A)({},n),{},{playerId:e.id,playerSearch:e.name})),h([])},className:"w-full text-left px-4 py-3 text-white hover:bg-slate-600 transition-colors",children:[(0,sa.jsx)("div",{className:"font-semibold",children:e.name}),(0,sa.jsx)("div",{className:"text-sm text-white/60",children:e.email})]},e.id))})]}),"per_table_transactions"===t.id&&(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsxs)("label",{className:"block text-white mb-2 font-semibold",children:["Table Number ",(0,sa.jsx)("span",{className:"text-white/60 text-sm",children:"(Optional - leave blank for all tables)"})]}),(0,sa.jsx)("input",{type:"text",value:n.tableNumber,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{tableNumber:e.target.value})),placeholder:"e.g., Table 1, T-5",className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg"})]}),"custom"===t.id&&(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("label",{className:"block text-white mb-3 font-semibold",children:"Select Multiple Report Types to Compile"}),(0,sa.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["cumulative_player","daily_transactions","daily_rake","credit_transactions","expenses","bonus"].map(e=>(0,sa.jsxs)("label",{className:"flex items-center gap-2 bg-slate-700 p-3 rounded-lg cursor-pointer hover:bg-slate-600",children:[(0,sa.jsx)("input",{type:"checkbox",checked:n.customReportTypes.includes(e),onChange:t=>{t.target.checked?l((0,i.A)((0,i.A)({},n),{},{customReportTypes:[...n.customReportTypes,e]})):l((0,i.A)((0,i.A)({},n),{},{customReportTypes:n.customReportTypes.filter(t=>t!==e)}))},className:"w-4 h-4"}),(0,sa.jsx)("span",{className:"text-white text-sm capitalize",children:e.replace(/_/g," ")})]},e))})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-3",children:"Date Range"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:n.startDate,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{startDate:e.target.value})),className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:n.endDate,onChange:e=>l((0,i.A)((0,i.A)({},n),{},{endDate:e.target.value})),className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg"})]})]})]}),(0,sa.jsxs)("div",{className:"mb-8",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-3",children:"Download Format"}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,sa.jsxs)("button",{onClick:()=>l((0,i.A)((0,i.A)({},n),{},{format:"excel"})),className:"p-4 rounded-lg border-2 transition-all ".concat("excel"===n.format?"bg-green-600 border-green-400 text-white":"bg-slate-700 border-slate-600 text-white/70 hover:border-slate-500"),children:[(0,sa.jsx)(cc,{className:"text-4xl mx-auto mb-2"}),(0,sa.jsx)("div",{className:"font-semibold",children:"Excel (.xlsx)"})]}),(0,sa.jsxs)("button",{onClick:()=>l((0,i.A)((0,i.A)({},n),{},{format:"pdf"})),className:"p-4 rounded-lg border-2 transition-all ".concat("pdf"===n.format?"bg-red-600 border-red-400 text-white":"bg-slate-700 border-slate-600 text-white/70 hover:border-slate-500"),children:[(0,sa.jsx)(uc,{className:"text-4xl mx-auto mb-2"}),(0,sa.jsx)("div",{className:"font-semibold",children:"PDF (.pdf)"})]})]})]}),(0,sa.jsxs)("div",{className:"flex gap-4",children:[(0,sa.jsxs)("button",{onClick:async()=>{try{d(!0);const e=(0,i.A)((0,i.A)((0,i.A)({reportType:t.id,startDate:n.startDate,endDate:n.endDate,format:n.format},"individual_player"===t.id&&{playerId:n.playerId}),"per_table_transactions"===t.id&&{tableNumber:n.tableNumber}),"custom"===t.id&&{customReportTypes:n.customReportTypes}),r="http://localhost:3333/api",l=await fetch("".concat(r,"/clubs/").concat(s,"/reports/generate"),{method:"POST",headers:(0,jr.z5)(),body:JSON.stringify(e)});if(!l.ok)throw new Error("Failed to generate report");const o=await l.blob(),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download="".concat(t.id,"_report_").concat(n.startDate,".").concat("excel"===n.format?"xlsx":"pdf"),document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(c),alert("Report generated successfully!"),a()}catch(e){console.error("Error generating report:",e),alert("Failed to generate report")}finally{d(!1)}},disabled:o||"individual_player"===t.id&&!n.playerId||"custom"===t.id&&0===n.customReportTypes.length,className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white px-6 py-4 rounded-lg font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[(0,sa.jsx)(ic,{}),o?"Generating...":"Generate Report"]}),(0,sa.jsx)("button",{onClick:a,className:"px-6 py-4 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold",children:"Cancel"})]})]})})}function jx(e){let{clubId:t}=e;const[s,a]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!1),[i,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),h=gn({mutationFn:async e=>{let{password:s,confirmationText:a}=e;return await(0,jr.AT)("/clubs/".concat(t,"/system/factory-reset"),{method:"POST",body:JSON.stringify({password:s,confirmationText:a})})},onSuccess:()=>{alert("Factory reset completed successfully. All club data has been wiped. Please refresh the page."),window.location.reload()},onError:e=>{m(e.message||"Failed to perform factory reset")}}),x=()=>{a(!1),l(!1),o(""),c(""),m("")};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:[(0,sa.jsxs)("div",{className:"mb-8",children:[(0,sa.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"System Control"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Dangerous operations that affect the entire club"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-xl p-8 border border-red-500/30",children:[(0,sa.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[(0,sa.jsx)("div",{className:"bg-red-500/20 p-4 rounded-xl",children:(0,sa.jsx)(jc,{className:"text-3xl text-red-500"})}),(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Factory Reset"}),(0,sa.jsx)("p",{className:"text-gray-300 mb-4",children:"Factory Reset clears local data and resets the UI. Use with caution."}),(0,sa.jsx)("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-4 mb-4",children:(0,sa.jsxs)("div",{className:"flex items-start gap-3",children:[(0,sa.jsx)(dc,{className:"text-red-400 text-xl mt-0.5 flex-shrink-0"}),(0,sa.jsxs)("div",{className:"text-red-200 text-sm",children:[(0,sa.jsx)("p",{className:"font-semibold mb-2",children:"\u26a0\ufe0f WARNING: This action is irreversible!"}),(0,sa.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[(0,sa.jsx)("li",{children:"All players will be permanently deleted"}),(0,sa.jsx)("li",{children:"All staff (except Super Admin & Admin) will be removed"}),(0,sa.jsx)("li",{children:"All financial records will be wiped"}),(0,sa.jsx)("li",{children:"All transactions, bonuses, and credit data will be lost"}),(0,sa.jsx)("li",{children:"All tables, waitlists, and tournaments will be deleted"}),(0,sa.jsx)("li",{children:"All FNB orders, inventory, and suppliers will be removed"}),(0,sa.jsx)("li",{children:"All chat history will be erased"}),(0,sa.jsx)("li",{children:"The club will be reset to a fresh state"})]}),(0,sa.jsx)("p",{className:"mt-3 font-semibold text-green-300",children:"\u2713 Super Admin and Admin accounts will be preserved!"}),(0,sa.jsx)("p",{className:"mt-2 font-semibold text-red-300",children:"This operation cannot be undone. All other data will be permanently lost!"})]})]})})]})]}),(0,sa.jsx)("button",{onClick:()=>{m(""),o(""),c(""),a(!0)},disabled:h.isPending,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-white px-8 py-4 rounded-lg font-bold text-lg transition-all shadow-lg hover:shadow-xl",children:h.isPending?"Processing...":"Factory Reset"})]}),s&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-2xl p-8 max-w-md w-full border border-slate-700 shadow-2xl",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,sa.jsx)("div",{className:"bg-red-500/20 p-3 rounded-xl",children:(0,sa.jsx)(xc,{className:"text-2xl text-red-500"})}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white",children:"Verify Password"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"Enter your password to continue"})]})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i?(a(!1),l(!0)):m("Please enter your password")},children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("label",{className:"block text-white font-medium mb-2",children:"Password"}),(0,sa.jsx)("input",{type:"password",value:i,onChange:e=>o(e.target.value),placeholder:"Enter your password",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0})]}),u&&(0,sa.jsx)("div",{className:"mb-4 bg-red-900/30 border border-red-500/50 rounded-lg p-3 text-red-200 text-sm",children:u}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:x,className:"flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-lg font-medium transition-all",children:"Continue"})]})]})]})}),n&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-2xl p-8 max-w-md w-full border border-red-500 shadow-2xl",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,sa.jsx)("div",{className:"bg-red-500/20 p-3 rounded-xl",children:(0,sa.jsx)(dc,{className:"text-2xl text-red-500"})}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white",children:"Final Confirmation"}),(0,sa.jsx)("p",{className:"text-gray-400 text-sm",children:"This action cannot be undone!"})]})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-4 mb-4",children:(0,sa.jsx)("p",{className:"text-red-200 text-sm font-semibold",children:"You are about to permanently delete ALL club data!"})}),(0,sa.jsxs)("p",{className:"text-white mb-4",children:["To confirm, type ",(0,sa.jsx)("span",{className:"font-bold text-red-400",children:"DELETE ALL DATA"})," below:"]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"DELETE ALL DATA"===d?(h.mutate({password:i,confirmationText:d}),l(!1)):m('Please type "DELETE ALL DATA" exactly to confirm')},children:[(0,sa.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),placeholder:"Type: DELETE ALL DATA",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-red-500 focus:border-transparent mb-4",autoFocus:!0}),u&&(0,sa.jsx)("div",{className:"mb-4 bg-red-900/30 border border-red-500/50 rounded-lg p-3 text-red-200 text-sm",children:u}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:x,className:"flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:h.isPending||"DELETE ALL DATA"!==d,className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-all",children:h.isPending?"Deleting...":"Delete Everything"})]})]})]})]})})]})}function Nx(){var e,t,s,a,n,l,o,d,c;const u=me(),m=ra(),[h,x]=(0,r.useState)("Dashboard"),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{const e=localStorage.getItem("clubId");e?b(e):u("/login")},[u]);const{data:N,isLoading:S}=hn({queryKey:["club",p],queryFn:()=>jr.Od.getClub(p),enabled:!!p});(0,r.useEffect)(()=>{N&&f(N)},[N]),(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("adminuser")||"{}"),s=jr.R2.getCurrentUser();if(!e.id&&!t.userId)return void u("/login");const a="ADMIN"===e.role||t.userId||"ADMIN"===t.role||"ADMIN"===(null===s||void 0===s?void 0:s.role),r="SUPER_ADMIN"===e.role||"SUPER_ADMIN"===(null===s||void 0===s?void 0:s.role),n=e.isMasterAdmin||(null===s||void 0===s?void 0:s.isMasterAdmin);if(!a&&!r&&!n){const a=(null===s||void 0===s?void 0:s.role)||e.role||t.role,r={MASTER_ADMIN:"/master-admin",SUPER_ADMIN:"/super-admin",MANAGER:"/manager",GRE:"/gre",CASHIER:"/cashier",HR:"/hr",FNB:"/fnb",STAFF:"/staff",DEALER:"/dealer",AFFILIATE:"/affiliate"},n=a&&r[a]?r[a]:"/login";return void u(n,{replace:!0})}(e.mustResetPassword||t.mustResetPassword)&&v(!0)},[u]);const{data:k,isLoading:C}=hn({queryKey:["clubRevenue",p],queryFn:()=>jr.Od.getClubRevenue(p),enabled:!!p}),{data:A,isLoading:_}=hn({queryKey:["clubPlayers",p],queryFn:()=>jr.bS.getPlayers(p,{limit:100}),enabled:!!p}),{data:P=[],isLoading:T}=hn({queryKey:["pendingPlayers",p],queryFn:()=>jr.bS.getPendingApprovalPlayers(p),enabled:!!p}),{data:E=[],isLoading:I}=hn({queryKey:["suspendedPlayers",p],queryFn:()=>jr.bS.getSuspendedPlayers(p),enabled:!!p}),R=e=>"\u20b9".concat((e||0).toLocaleString("en-IN")),D=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("adminuser")||"{}");t.mustResetPassword=!1,localStorage.setItem("adminuser",JSON.stringify(t)),v(!1),j({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),O=y&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("adminuser")||"{}"),a=t.email||s.email;a?w.currentPassword&&w.newPassword&&w.confirmPassword?w.newPassword===w.confirmPassword?w.newPassword.length<8?wr.error("Password must be at least 8 characters"):D.mutate({email:a,currentPassword:w.currentPassword,newPassword:w.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:w.currentPassword,onChange:e=>j((0,i.A)((0,i.A)({},w),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:w.newPassword,onChange:e=>j((0,i.A)((0,i.A)({},w),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:w.confirmPassword,onChange:e=>j((0,i.A)((0,i.A)({},w),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:D.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:D.isLoading?"Resetting...":"Reset Password"})]})]})});if(S||!p)return(0,sa.jsxs)(sa.Fragment,{children:[O,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900 flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-white text-center",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-xl",children:"Loading club data..."})]})})]});return(0,sa.jsxs)(sa.Fragment,{children:[O,(0,sa.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900",children:[(0,sa.jsx)(xx,{activeItem:h,setActiveItem:x,menuItems:["Dashboard","Notifications","Player Management","Staff Management","Payroll Management","Affiliates","Tables & Waitlist","VIP Store","Push Notifications","Tournaments","Bonus Management","FNB","Chat","Reports & Analytics","System Control"],onSignOut:()=>{localStorage.clear(),sessionStorage.clear(),u("/login")},clubInfo:g||N}),(0,sa.jsxs)("main",{className:"flex-1 p-8 overflow-y-auto",children:["Notifications"===h&&(0,sa.jsx)(bm,{selectedClubId:p,recipientType:"staff"}),"Dashboard"===h&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsxs)("h1",{className:"text-3xl font-bold text-white",children:["Dashboard - ",(null===g||void 0===g?void 0:g.name)||(null===N||void 0===N?void 0:N.name)||"Loading..."]})}),C?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading revenue data..."})]}):(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(e=k.previousDay)||void 0===e?void 0:e.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===k||void 0===k||null===(t=k.previousDay)||void 0===t?void 0:t.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-emerald-600",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-emerald-400",children:R((null===k||void 0===k||null===(s=k.currentDay)||void 0===s?void 0:s.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===k||void 0===k||null===(a=k.currentDay)||void 0===a?void 0:a.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(n=k.currentDay)||void 0===n?void 0:n.rake)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"10% of revenue"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(l=k.previousDay)||void 0===l?void 0:l.rake)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(o=k.previousDay)||void 0===o?void 0:o.tips)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:R((null===k||void 0===k||null===(d=k.currentDay)||void 0===d?void 0:d.tips)||0)})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Players"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Total Players"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:_?"...":(null===A||void 0===A||null===(c=A.players)||void 0===c?void 0:c.length)||0})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Pending Approval"}),(0,sa.jsx)("span",{className:"text-yellow-400 font-semibold",children:T?"...":P.length})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Suspended"}),(0,sa.jsx)("span",{className:"text-red-400 font-semibold",children:I?"...":E.length})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Quick Actions"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsx)("button",{onClick:()=>x("Player Management"),className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white py-2 rounded-lg transition-colors",children:"Manage Players"}),(0,sa.jsxs)("button",{onClick:()=>x("Player Approval"),className:"w-full bg-blue-600 hover:bg-blue-500 text-white py-2 rounded-lg transition-colors",children:["Review Approvals (",T?"...":P.length,")"]}),(0,sa.jsxs)("button",{onClick:()=>x("Player Suspension"),className:"w-full bg-orange-600 hover:bg-orange-500 text-white py-2 rounded-lg transition-colors",children:["Suspended Players (",I?"...":E.length,")"]})]})]})]})]}),"Player Management"===h&&(0,sa.jsx)(ud,{selectedClubId:p,playersData:A,playersLoading:_,pendingPlayers:P,pendingLoading:T,suspendedPlayers:E,suspendedLoading:I,onRefresh:()=>{m.invalidateQueries(["pendingPlayers",p]),m.invalidateQueries(["clubPlayers",p]),m.invalidateQueries(["suspendedPlayers",p])}}),"Tables & Waitlist"===h&&(0,sa.jsx)(xd,{selectedClubId:p}),"VIP Store"===h&&(0,sa.jsx)(px,{selectedClubId:p}),"Push Notifications"===h&&(0,sa.jsx)(Md,{selectedClubId:p}),"Tournaments"===h&&(0,sa.jsx)(zd,{selectedClubId:p}),"Staff Management"===h&&(0,sa.jsx)(ph,{selectedClubId:p}),"Payroll Management"===h&&(0,sa.jsx)(gx,{selectedClubId:p}),"Bonus Management"===h&&(0,sa.jsx)(Ah,{selectedClubId:p}),"Affiliates"===h&&(0,sa.jsx)(fx,{selectedClubId:p}),"FNB"===h&&p&&(0,sa.jsx)(yx,{clubId:p}),"Chat"===h&&p&&(0,sa.jsx)($u,{clubId:p}),"Reports & Analytics"===h&&p&&(0,sa.jsx)(vx,{clubId:p}),"System Control"===h&&p&&(0,sa.jsx)(jx,{clubId:p}),"Rummy"===h&&p&&(0,sa.jsx)(mm,{selectedClubId:p}),"Notifications"===h&&p&&(0,sa.jsx)(bm,{selectedClubId:p,recipientType:"staff"}),!["Dashboard","Player Management","Tables & Waitlist","VIP Store","Push Notifications","Tournaments","Staff Management","Payroll Management","Bonus Management","Affiliates","FNB","Chat","Reports & Analytics","System Control","Rummy","Notifications"].includes(h)&&(0,sa.jsx)("div",{className:"text-white",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold mb-6",children:h})})]})]})]})}function Sx(){return(0,sa.jsx)(ch,{role:"MASTER_ADMIN",roleDisplayName:"Master Admin",redirectPath:"/master-admin",gradientFrom:"from-indigo-400",gradientTo:"to-purple-600",description:"System-wide Administration"})}function kx(e){let{title:t,subtitle:s}=e;const[a,n]=r.useState(!1);return(0,sa.jsx)("header",{className:"bg-gradient-to-r from-emerald-600 via-green-500 to-yellow-400 p-6 rounded-xl shadow-md flex items-center justify-between",children:(0,sa.jsxs)("div",{className:"flex items-center gap-4",children:[(0,sa.jsx)("div",{className:"w-12 h-12 rounded-lg bg-white/20 flex items-center justify-center overflow-hidden border border-white/30",children:a?(0,sa.jsx)("div",{className:"text-white font-bold",children:"WL"}):(0,sa.jsx)("img",{src:"/branding/logo.png",alt:"Brand Logo",className:"w-full h-full object-contain",onError:()=>n(!0)})}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h1",{className:"text-2xl font-bold text-white",children:t}),s&&(0,sa.jsx)("p",{className:"text-gray-200 mt-1",children:s})]})]})})}function Cx(e){let{activeItem:t,setActiveItem:s,menuItems:a=[],onSignOut:n=null,userEmail:l=null,userName:o=null}=e;const[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(window.innerWidth<1024),[h,x]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[y,v]=(0,r.useState)(""),[w,j]=(0,r.useState)(""),[N,S]=(0,r.useState)(!1),[k,C]=(0,r.useState)(!1),[A,_]=(0,r.useState)(!1),[P,T]=(0,r.useState)(!1),E=(0,r.useRef)(null),I=(0,r.useRef)(null),R=localStorage.getItem("clubId");od(R);const{data:D}=hn({queryKey:["unreadChatCounts",R],queryFn:()=>jr.h2.getUnreadCounts(R),enabled:!!R});null===D||void 0===D||D.staffChats,null===D||void 0===D||D.playerChats;return(0,r.useEffect)(()=>{const e=(null===D||void 0===D?void 0:D.staffChats)||0;if(null!==E.current&&e>E.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}E.current=e},[null===D||void 0===D?void 0:D.staffChats]),(0,r.useEffect)(()=>{const e=(null===D||void 0===D?void 0:D.playerChats)||0;if(null!==I.current&&e>I.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}I.current=e},[null===D||void 0===D?void 0:D.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;m(e),e||c(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(d&&u){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[d,u]),(0,sa.jsxs)(sa.Fragment,{children:[u&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-emerald-500 to-teal-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>c(!d),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),u&&d&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>c(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] bg-gradient-to-b from-emerald-500/20 via-teal-600/30 to-cyan-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(u?d?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 drop-shadow-lg mb-6",children:"Master Admin"}),(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsxs)("button",{onClick:()=>x(!h),className:"flex items-center text-white min-w-0 w-full hover:bg-white/10 p-2 rounded-lg transition-colors",children:[(0,sa.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-emerald-400 to-cyan-500 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:(0,sa.jsx)("span",{className:"text-gray-900 font-bold text-sm",children:o?o.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"MA"})}),(0,sa.jsxs)("div",{className:"min-w-0 flex-1 text-left",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold truncate",children:o||"Master Admin"}),(0,sa.jsx)("div",{className:"text-sm opacity-80 truncate",children:l||"No email"})]}),(0,sa.jsx)("svg",{className:"w-4 h-4 ml-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&(0,sa.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 rounded-lg shadow-xl border border-gray-700 z-50 overflow-hidden",children:[(0,sa.jsxs)("div",{className:"p-3 border-b border-gray-700",children:[(0,sa.jsx)("div",{className:"text-white font-semibold text-sm mb-1",children:"Profile"}),(0,sa.jsx)("div",{className:"text-gray-400 text-xs truncate",children:l||"No email"})]}),(0,sa.jsxs)("button",{onClick:()=>{b(!0),x(!1)},className:"w-full text-left px-4 py-3 text-white hover:bg-white/10 transition-colors flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Change Password"]})]})]})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:a.map(e=>(0,sa.jsx)("button",{onClick:()=>{s(e),u&&c(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-emerald-400 to-cyan-600 text-gray-900 font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-emerald-400/20 hover:to-cyan-500/20 text-white"),children:(0,sa.jsx)("span",{className:"block truncate",children:e})},e))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})}),p&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-gray-900 rounded-xl shadow-2xl w-full max-w-md border border-gray-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white",children:"Change Password"}),(0,sa.jsx)("button",{onClick:()=>{b(!1),f({currentPassword:"",newPassword:"",confirmPassword:""}),v(""),j("")},className:"text-gray-400 hover:text-white transition",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,sa.jsxs)("div",{className:"p-6 space-y-4",children:[y&&(0,sa.jsx)("div",{className:"bg-red-500/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg text-sm",children:y}),w&&(0,sa.jsx)("div",{className:"bg-green-500/20 border border-green-500 text-green-400 px-4 py-3 rounded-lg text-sm",children:w}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-sm font-medium mb-2",children:"Current Password"}),(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsx)("input",{type:k?"text":"password",value:g.currentPassword,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{currentPassword:e.target.value})),className:"w-full px-4 py-3 pr-12 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",disabled:N}),(0,sa.jsx)("button",{type:"button",onClick:()=>C(!k),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white transition",children:k?(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):(0,sa.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-sm font-medium mb-2",children:"New Password"}),(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsx)("input",{type:A?"text":"password",value:g.newPassword,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{newPassword:e.target.value})),className:"w-full px-4 py-3 pr-12 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",disabled:N}),(0,sa.jsx)("button",{type:"button",onClick:()=>_(!A),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white transition",children:A?(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):(0,sa.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-white text-sm font-medium mb-2",children:"Confirm New Password"}),(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsx)("input",{type:P?"text":"password",value:g.confirmPassword,onChange:e=>f((0,i.A)((0,i.A)({},g),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-3 pr-12 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",disabled:N}),(0,sa.jsx)("button",{type:"button",onClick:()=>T(!P),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white transition",children:P?(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):(0,sa.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,sa.jsx)("button",{onClick:()=>{b(!1),f({currentPassword:"",newPassword:"",confirmPassword:""}),v(""),j("")},className:"flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition",disabled:N,children:"Cancel"}),(0,sa.jsx)("button",{onClick:async()=>{if(v(""),j(""),g.currentPassword&&g.newPassword&&g.confirmPassword)if(g.newPassword.length<6)v("New password must be at least 6 characters");else if(g.newPassword===g.confirmPassword)try{S(!0);const e=await fetch("".concat("http://localhost:3333/api","/auth/change-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,currentPassword:g.currentPassword,newPassword:g.newPassword})}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to change password");j("Password changed successfully!"),f({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{b(!1),j("")},2e3)}catch(e){v(e.message||"Failed to change password")}finally{S(!1)}else v("New passwords do not match");else v("All fields are required")},className:"flex-1 px-4 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white rounded-lg font-medium transition disabled:opacity-50 disabled:cursor-not-allowed",disabled:N,children:N?"Changing...":"Change Password"})]})]})]})})]})}function Ax(){var e,t;const[s,a]=(0,r.useState)("Dashboard"),[n,l]=(0,r.useState)(!0),[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(""),[x,p]=(0,r.useState)(null),[b,g]=(0,r.useState)([]),[f,y]=(0,r.useState)([]),[v,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[S,k]=(0,r.useState)("all"),[C,A]=(0,r.useState)("name"),[_,P]=(0,r.useState)("name"),[T,E]=(0,r.useState)("price"),[I,R]=(0,r.useState)(null),[D,O]=(0,r.useState)({}),[L,F]=(0,r.useState)(!1),[M,B]=(0,r.useState)(!1),[q,U]=(0,r.useState)(null),[z,K]=(0,r.useState)({tenantName:"",superAdminName:"",superAdminEmail:""}),[W,H]=(0,r.useState)({clubName:"",clubDescription:"",skinColor:"#10b981",gradient:"emerald-green-teal",logoUrl:"",videoUrl:"",tenantId:"",createNewTenant:!1,newTenantName:"",newSuperAdminName:"",newSuperAdminEmail:"",pokerEnabled:!0,rummyEnabled:!1}),[V,J]=(0,r.useState)(null),[Q,G]=(0,r.useState)(!1),[Y,$]=(0,r.useState)(!1),[Z,X]=(0,r.useState)(null),[ee,te]=(0,r.useState)(""),[se,ae]=(0,r.useState)(""),[re,ne]=(0,r.useState)({termsText:"",publicUrl:""}),le=me();(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("masteradminuser")||"{}"),s=jr.R2.getCurrentUser();if(!(e.isMasterAdmin||t.userId||(null===s||void 0===s?void 0:s.isMasterAdmin))){const a=(null===s||void 0===s?void 0:s.role)||e.role||t.role,r={SUPER_ADMIN:"/super-admin",ADMIN:"/admin",MANAGER:"/manager",GRE:"/gre",CASHIER:"/cashier",HR:"/hr",FNB:"/fnb",STAFF:"/staff",DEALER:"/dealer",AFFILIATE:"/affiliate"},n=a&&r[a]?r[a]:"/login";le(n,{replace:!0})}},[le]);const ie=[{value:"emerald-green-teal",label:"Emerald \u2192 Green \u2192 Teal",class:"from-emerald-600 via-green-500 to-teal-500"},{value:"teal-cyan-blue",label:"Teal \u2192 Cyan \u2192 Blue",class:"from-teal-500 via-cyan-500 to-blue-500"},{value:"cyan-blue-indigo",label:"Cyan \u2192 Blue \u2192 Indigo",class:"from-cyan-500 via-blue-500 to-indigo-600"},{value:"blue-indigo-purple",label:"Blue \u2192 Indigo \u2192 Purple",class:"from-blue-600 via-indigo-500 to-purple-600"},{value:"purple-pink-rose",label:"Purple \u2192 Pink \u2192 Rose",class:"from-purple-600 via-pink-500 to-rose-500"},{value:"pink-red-orange",label:"Pink \u2192 Red \u2192 Orange",class:"from-pink-500 via-red-500 to-orange-500"},{value:"red-orange-yellow",label:"Red \u2192 Orange \u2192 Yellow",class:"from-red-600 via-orange-500 to-yellow-500"},{value:"orange-yellow-lime",label:"Orange \u2192 Yellow \u2192 Lime",class:"from-orange-500 via-yellow-500 to-lime-500"},{value:"yellow-lime-green",label:"Yellow \u2192 Lime \u2192 Green",class:"from-yellow-500 via-lime-500 to-green-500"},{value:"indigo-purple-pink",label:"Indigo \u2192 Purple \u2192 Pink",class:"from-indigo-600 via-purple-500 to-pink-500"},{value:"gray-slate-zinc",label:"Gray \u2192 Slate \u2192 Zinc",class:"from-gray-600 via-slate-500 to-zinc-500"},{value:"slate-gray-neutral",label:"Slate \u2192 Gray \u2192 Neutral",class:"from-slate-600 via-gray-500 to-neutral-500"}];(0,r.useEffect)(()=>{(async()=>{const e=localStorage.getItem("user"),t=localStorage.getItem("userEmail");if(e)try{const s=JSON.parse(e);return u(s.email||t||""),void h(s.displayName||s.name||"Master Admin")}catch(ia){console.error("Failed to parse user data:",ia)}if(t)return u(t),void h("Master Admin");t&&(u(t),h("Master Admin"));if(localStorage.getItem("userId")&&!e)try{const e=await jr.o_.getCurrentUser();e&&e.email&&(u(e.email),h(e.displayName||"Master Admin"),localStorage.setItem("user",JSON.stringify({id:e.id,email:e.email,name:e.displayName||e.email,displayName:e.displayName})))}catch(Gx){console.error("Failed to fetch user info:",Gx),t&&(u(t),h("Master Admin"))}})()},[]),(0,r.useEffect)(()=>{oe()},[]);const oe=async()=>{l(!0),d("");try{const e=await jr.o_.getDashboardStats();p(e),g(e.clubs||[]),y(e.tenants||[]),e.clubs&&e.clubs.length>0&&N(e.clubs[0].id)}catch(Gx){console.error("Failed to load dashboard data:",Gx),d("Failed to load dashboard data: "+Gx.message)}finally{l(!1)}},de=()=>{jr.R2.logout(),le("/master-admin/signin")},ce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";te(e),ae(t),setTimeout(()=>{te(""),ae("")},5e3)},ue=async(e,t,s)=>{if(confirm("Are you sure you want to ".concat(t," this club?\n\n").concat(s?"Reason: "+s:"")))try{await jr.o_.updateClubStatus(e,t,s),alert("\u2705 Club status updated to: ".concat(t)),oe()}catch(Gx){alert("Failed to update club status: "+Gx.message)}},he=()=>{R(null),O({})},xe=async e=>{if(e&&e.preventDefault(),j)if(re.termsText&&""!==re.termsText.trim())try{await jr.o_.updateClubTerms(j,re.termsText),alert("\u2705 Terms & Conditions updated successfully!"),oe();const e=b.find(e=>e.id===j);e&&ne((0,i.A)((0,i.A)({},re),{},{termsText:e.termsAndConditions||re.termsText}))}catch(Gx){alert("Failed to update Terms & Conditions: "+Gx.message)}else alert("Terms & Conditions text cannot be empty");else alert("Please select a club first")},pe=async(e,t)=>{const s=Object.entries(t).map(e=>{let[t,s]=e;const a="pokerEnabled"===t?"Poker":"rummyEnabled"===t?"Rummy":"Tournaments";return"".concat(s?"enable":"disable"," ").concat(a)}).join(", ");try{await jr.o_.updateClubGameAccess(e,t),ce("\u2705 Game access updated: ".concat(s),"success"),oe()}catch(Gx){ce("Failed to update game access: "+Gx.message,"error")}},be=b.filter(e=>"all"===S||e.status===S).sort((e,t)=>"name"===C?e.name.localeCompare(t.name):"status"===C?e.status.localeCompare(t.status):"subscription"===C?parseFloat(t.subscriptionPrice)-parseFloat(e.subscriptionPrice):0),ge=[...f].sort((e,t)=>{if("name"===_)return e.name.localeCompare(t.name);if("clubs"===_){const s=b.filter(t=>t.tenant.id===e.id).length,a=b.filter(e=>e.tenant.id===t.id).length;return a-s}return 0}),fe=j?b.find(e=>e.id===j):null;return n?(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-center",children:[(0,sa.jsx)("div",{className:"w-16 h-16 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-xl font-medium",children:"Loading Master Admin Dashboard..."}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Fetching data from backend..."})]})}):o?(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"max-w-md text-center",children:[(0,sa.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"\u26a0\ufe0f"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Error Loading Dashboard"}),(0,sa.jsx)("p",{className:"text-gray-400 mb-6",children:o}),(0,sa.jsx)("button",{onClick:oe,className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-lg font-medium",children:"Retry"})]})}):(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white font-sans",children:[(0,sa.jsxs)("div",{className:"flex",children:[(0,sa.jsx)(Cx,{activeItem:s,setActiveItem:a,menuItems:["Dashboard","Tenants Management","Clubs Management","Game Settings","Terms & Conditions","Subscriptions","Reports"],onSignOut:de,userEmail:c,userName:m}),(0,sa.jsx)("main",{className:"flex-1 lg:ml-0 min-w-0",children:(0,sa.jsxs)("div",{className:"mx-auto max-w-[1400px] px-4 sm:px-6 py-6 sm:py-10 space-y-8",children:[(0,sa.jsx)("div",{className:"mt-16 lg:mt-0",children:(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)(kx,{title:"Master Admin - ".concat(s),subtitle:"White-label control center"}),(0,sa.jsx)("button",{onClick:de,className:"bg-red-600 hover:bg-red-500 text-white font-semibold px-4 py-2 rounded-lg shadow",children:"Sign Out"})]})}),"Dashboard"===s&&x&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[(0,sa.jsxs)("div",{className:"p-6 rounded-xl bg-gradient-to-br from-emerald-400 via-teal-500 to-cyan-500 text-gray-900 shadow-lg",children:[(0,sa.jsx)("div",{className:"text-sm opacity-90 text-white/90",children:"Total Tenants"}),(0,sa.jsx)("div",{className:"text-3xl font-bold mt-2 text-white",children:x.totalTenants}),(0,sa.jsx)("div",{className:"text-xs mt-1 text-white/70",children:"Organization groups"})]}),(0,sa.jsxs)("div",{className:"p-6 rounded-xl bg-gradient-to-br from-blue-400 via-indigo-500 to-purple-500 text-gray-900 shadow-lg",children:[(0,sa.jsx)("div",{className:"text-sm opacity-90 text-white/90",children:"Total Clubs"}),(0,sa.jsx)("div",{className:"text-3xl font-bold mt-2 text-white",children:x.totalClubs}),(0,sa.jsx)("div",{className:"text-xs mt-1 text-white/70",children:"All poker clubs"})]}),(0,sa.jsxs)("div",{className:"p-6 rounded-xl bg-gradient-to-br from-green-400 via-emerald-500 to-teal-500 text-gray-900 shadow-lg",children:[(0,sa.jsx)("div",{className:"text-sm opacity-90 text-white/90",children:"Active Clubs"}),(0,sa.jsx)("div",{className:"text-3xl font-bold mt-2 text-white",children:x.activeClubs}),(0,sa.jsxs)("div",{className:"text-xs mt-1 text-white/70",children:[x.suspendedClubs>0&&"".concat(x.suspendedClubs," suspended, "),x.killedClubs>0&&"".concat(x.killedClubs," killed")]})]}),(0,sa.jsxs)("div",{className:"p-6 rounded-xl bg-gradient-to-br from-yellow-400 via-orange-500 to-red-500 text-gray-900 shadow-lg",children:[(0,sa.jsx)("div",{className:"text-sm opacity-90 text-white/90",children:"Monthly Revenue"}),(0,sa.jsxs)("div",{className:"text-3xl font-bold mt-2 text-white",children:["\u20b9",x.monthlyRevenue.toLocaleString("en-IN")]}),(0,sa.jsx)("div",{className:"text-xs mt-1 text-white/70",children:"From subscriptions"})]})]}),(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Quick Actions"}),(0,sa.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,sa.jsx)("button",{onClick:()=>F(!0),className:"bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-400 hover:to-teal-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg",children:"+ Create Tenant"}),(0,sa.jsx)("button",{onClick:()=>B(!0),className:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-400 hover:to-indigo-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg",children:"+ Create Club"}),(0,sa.jsx)("button",{onClick:()=>a("Reports"),className:"bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-400 hover:to-pink-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg",children:"View Reports"})]})]}),(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Recent Clubs"}),(0,sa.jsx)("div",{className:"space-y-4",children:b.slice(0,5).map(e=>(0,sa.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 flex justify-between items-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-bold text-white",children:e.name}),(0,sa.jsxs)("div",{className:"text-sm text-gray-400",children:["Code: ",e.code," | Tenant: ",e.tenant.name]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-500/20 text-green-300":"suspended"===e.status?"bg-yellow-500/20 text-yellow-300":"bg-red-500/20 text-red-300"),children:e.status}),(0,sa.jsxs)("span",{className:"text-emerald-400 font-medium",children:["\u20b9",e.subscriptionPrice,"/mo"]})]})]},e.id))})]})]}),"Tenants Management"===s&&(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white",children:["Tenants (",f.length,")"]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsxs)("select",{value:_,onChange:e=>P(e.target.value),className:"px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white text-sm",children:[(0,sa.jsx)("option",{value:"name",children:"Sort by Name"}),(0,sa.jsx)("option",{value:"clubs",children:"Sort by Club Count"})]}),(0,sa.jsx)("button",{onClick:()=>F(!0),className:"bg-emerald-600 hover:bg-emerald-500 px-4 py-2 rounded-lg font-medium",children:"+ Create Tenant"})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[ge.map(e=>{const t=b.filter(t=>t.tenant.id===e.id),s=v===e.id;return(0,sa.jsxs)("div",{className:"p-6 bg-slate-800/50 rounded-lg border ".concat(s?"border-emerald-500":"border-slate-700"," cursor-pointer transition-all hover:border-emerald-500/50"),children:[(0,sa.jsx)("div",{onClick:()=>w(s?null:e.id),children:(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white",children:e.name}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Created: ",new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})]})]}),(0,sa.jsxs)("div",{className:"text-right",children:[(0,sa.jsx)("div",{className:"text-2xl font-bold text-emerald-400",children:t.length}),(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:"Clubs"})]})]})}),s&&t.length>0&&(0,sa.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-700 space-y-2",children:[(0,sa.jsx)("div",{className:"text-sm font-medium text-gray-300 mb-3",children:"Clubs:"}),t.map(e=>(0,sa.jsx)("div",{className:"p-3 bg-slate-900/50 rounded border border-slate-700",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("div",{className:"font-medium text-white",children:e.name}),(0,sa.jsxs)("div",{className:"text-xs text-gray-400 font-mono",children:["Code: ",e.code]})]}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-500/20 text-green-300":"suspended"===e.status?"bg-yellow-500/20 text-yellow-300":"bg-red-500/20 text-red-300"),children:e.status})]})},e.id))]}),s&&0===t.length&&(0,sa.jsx)("div",{className:"mt-4 pt-4 border-t border-slate-700 text-center text-gray-400 text-sm",children:"No clubs yet"})]},e.id)}),0===f.length&&(0,sa.jsx)("div",{className:"col-span-full text-center py-12 text-gray-400",children:(0,sa.jsx)("p",{children:"No tenants found. Create your first tenant to get started!"})})]})]}),"Clubs Management"===s&&(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white",children:["All Clubs (",be.length,")"]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsxs)("select",{value:S,onChange:e=>k(e.target.value),className:"px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white text-sm",children:[(0,sa.jsx)("option",{value:"all",children:"All Status"}),(0,sa.jsx)("option",{value:"active",children:"Active"}),(0,sa.jsx)("option",{value:"suspended",children:"Suspended"}),(0,sa.jsx)("option",{value:"killed",children:"Killed"})]}),(0,sa.jsxs)("select",{value:C,onChange:e=>A(e.target.value),className:"px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white text-sm",children:[(0,sa.jsx)("option",{value:"name",children:"Sort by Name"}),(0,sa.jsx)("option",{value:"status",children:"Sort by Status"}),(0,sa.jsx)("option",{value:"subscription",children:"Sort by Subscription"})]}),(0,sa.jsx)("button",{onClick:()=>B(!0),className:"bg-emerald-600 hover:bg-emerald-500 px-4 py-2 rounded-lg font-medium",children:"+ Create Club"})]})]}),(0,sa.jsxs)("div",{className:"grid gap-4",children:[be.map(e=>(0,sa.jsx)("div",{className:"p-6 bg-slate-800/50 rounded-lg border border-slate-700",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white",children:e.name}),(0,sa.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-500/20 text-green-300":"suspended"===e.status?"bg-yellow-500/20 text-yellow-300":"bg-red-500/20 text-red-300"),children:e.status})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Club Code:"}),(0,sa.jsx)("span",{className:"text-white font-mono ml-2",children:e.code})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Tenant:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:e.tenant.name})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Subscription:"}),(0,sa.jsxs)("span",{className:"text-emerald-400 ml-2 font-medium",children:["\u20b9",e.subscriptionPrice,"/month"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Sub Status:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:e.subscriptionStatus})]})]}),e.description&&(0,sa.jsx)("p",{className:"text-gray-400 mt-3 text-sm",children:e.description})]}),(0,sa.jsxs)("div",{className:"flex flex-col gap-2 ml-4",children:["active"===e.status&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>ue(e.id,"suspended","Temporary suspension"),className:"bg-yellow-600 hover:bg-yellow-500 px-3 py-1 rounded text-sm",children:"Suspend"}),(0,sa.jsx)("button",{onClick:()=>ue(e.id,"killed","Permanent closure"),className:"bg-red-600 hover:bg-red-500 px-3 py-1 rounded text-sm",children:"Kill"})]}),"suspended"===e.status&&(0,sa.jsx)("button",{onClick:()=>ue(e.id,"active","Reactivated"),className:"bg-green-600 hover:bg-green-500 px-3 py-1 rounded text-sm",children:"Reactivate"}),"killed"===e.status&&(0,sa.jsx)("button",{onClick:()=>ue(e.id,"active","Restored from killed status"),className:"bg-blue-600 hover:bg-blue-500 px-3 py-1 rounded text-sm",children:"Restore"}),(0,sa.jsx)("button",{onClick:()=>{U(e),a("Subscriptions")},className:"bg-purple-600 hover:bg-purple-500 px-3 py-1 rounded text-sm",children:"Edit Sub"}),(0,sa.jsx)("button",{onClick:()=>{U(e),N(e.id),a("Terms & Conditions")},className:"bg-indigo-600 hover:bg-indigo-500 px-3 py-1 rounded text-sm",children:"Terms"})]})]})},e.id)),0===be.length&&(0,sa.jsx)("div",{className:"text-center py-12 text-gray-400",children:(0,sa.jsx)("p",{children:"No clubs found with the selected filters."})})]})]}),"Game Settings"===s&&(()=>{const e=b.find(e=>e.id===j);return(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Game Settings"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Club Selection"}),(0,sa.jsxs)("select",{value:j||"",onChange:e=>N(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"Choose a club..."}),b.map(e=>(0,sa.jsxs)("option",{value:e.id,children:[e.name," (",e.code,")"]},e.id))]})]}),e&&(0,sa.jsxs)("div",{className:"p-6 bg-slate-800/70 rounded-lg border border-slate-600",children:[(0,sa.jsxs)("h4",{className:"font-bold text-lg mb-4 text-emerald-400",children:["Game Access Control for ",e.name]}),(0,sa.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Control which game types this club can access. Staff can only create tables and tournaments for enabled game types."}),(0,sa.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700/50 rounded-lg border border-slate-600 mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:"\u2660\ufe0f Poker"}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:"Poker tables and poker tournaments"})]}),(0,sa.jsx)("button",{onClick:()=>pe(e.id,{pokerEnabled:!e.pokerEnabled}),className:"relative w-14 h-7 rounded-full transition-colors ".concat(!1!==e.pokerEnabled?"bg-emerald-600":"bg-gray-600"),children:(0,sa.jsx)("span",{className:"absolute top-0.5 left-0.5 w-6 h-6 bg-white rounded-full transition-transform ".concat(!1!==e.pokerEnabled?"translate-x-7":"")})})]}),(0,sa.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700/50 rounded-lg border border-slate-600 mb-3",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-semibold text-white",children:"\ud83c\udccf Rummy"}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:"Rummy tables and rummy tournaments"})]}),(0,sa.jsx)("button",{onClick:()=>pe(e.id,{rummyEnabled:!e.rummyEnabled}),className:"relative w-14 h-7 rounded-full transition-colors ".concat(e.rummyEnabled?"bg-emerald-600":"bg-gray-600"),children:(0,sa.jsx)("span",{className:"absolute top-0.5 left-0.5 w-6 h-6 bg-white rounded-full transition-transform ".concat(e.rummyEnabled?"translate-x-7":"")})})]}),(0,sa.jsx)("p",{className:"text-xs text-gray-500 mt-3",children:"Note: Each game type includes its own tables and tournaments. Disabling a game type prevents staff from creating new tables/tournaments of that type. Existing active sessions are not affected."})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Club Game Access Status"}),(0,sa.jsx)("div",{className:"space-y-3",children:b.map(e=>(0,sa.jsxs)("div",{className:"p-4 bg-slate-800/70 rounded-lg border border-slate-600",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,sa.jsx)("div",{className:"font-medium text-white",children:e.name})}),(0,sa.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,sa.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(!1!==e.pokerEnabled?"bg-emerald-500/20 text-emerald-300":"bg-red-500/20 text-red-300"),children:["\u2660\ufe0f Poker: ",!1!==e.pokerEnabled?"ON":"OFF"]}),(0,sa.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(e.rummyEnabled?"bg-emerald-500/20 text-emerald-300":"bg-gray-500/20 text-gray-300"),children:["\ud83c\udccf Rummy: ",e.rummyEnabled?"ON":"OFF"]})]})]},e.id))})]})]})]})})(),"Terms & Conditions"===s&&(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Terms & Conditions (Per Club)"}),(0,sa.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,sa.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,sa.jsxs)("select",{value:j||"",onChange:e=>{const t=e.target.value;N(t);const s=b.find(e=>e.id===t);ne(s?{termsText:s.termsAndConditions||"",publicUrl:""}:{termsText:"",publicUrl:""})},className:"flex-1 px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"",children:"Choose a club..."}),b.map(e=>{var t;return(0,sa.jsxs)("option",{value:e.id,children:[e.name," (",e.code,") - ",(null===(t=e.tenant)||void 0===t?void 0:t.name)||"No Tenant"]},e.id)})]}),(0,sa.jsx)("input",{type:"text",placeholder:"Optional public URL",value:re.publicUrl,onChange:e=>ne((0,i.A)((0,i.A)({},re),{},{publicUrl:e.target.value})),className:"flex-1 px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-gray-500"}),(0,sa.jsx)("button",{onClick:xe,disabled:!j,className:"bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-600 disabled:cursor-not-allowed px-8 py-3 rounded-lg font-medium text-white whitespace-nowrap",children:"Upload / Save"})]}),fe?(0,sa.jsxs)("form",{onSubmit:xe,className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,sa.jsxs)("h3",{className:"text-lg font-semibold text-white",children:["Editing T&C for: ",(0,sa.jsx)("span",{className:"text-emerald-400",children:fe.name})]}),(0,sa.jsxs)("span",{className:"text-xs text-gray-400",children:["Club Code: ",(0,sa.jsx)("span",{className:"font-mono text-emerald-400",children:fe.code})]})]}),(0,sa.jsxs)("p",{className:"text-sm text-gray-400",children:["Tenant: ",(null===(e=fe.tenant)||void 0===e?void 0:e.name)||"N/A"]})]}),(0,sa.jsx)("textarea",{name:"terms",value:re.termsText,onChange:e=>ne((0,i.A)((0,i.A)({},re),{},{termsText:e.target.value})),rows:15,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white font-mono text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Paste Terms & Conditions here... Each club can have different T&C stored separately in the database."}),(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"\u26a0\ufe0f Only Master Admin can manage club T&C. Each club's T&C is stored separately in the database."}),(0,sa.jsx)("button",{type:"submit",className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-2 rounded-lg font-medium text-white transition-colors",children:"Save Terms & Conditions"})]})]}):(0,sa.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,sa.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcc4"}),(0,sa.jsx)("p",{className:"text-lg mb-2",children:"Select a club from the dropdown above"}),(0,sa.jsx)("p",{className:"text-sm",children:"to edit terms & conditions for that specific club."}),(0,sa.jsx)("p",{className:"text-xs mt-4 text-gray-500",children:"Each club can have different Terms & Conditions stored separately in the database."})]})]})]}),"Subscriptions"===s&&(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsxs)("h2",{className:"text-2xl font-bold text-white",children:["Subscription Management (",b.length,")"]}),(0,sa.jsxs)("select",{value:T,onChange:e=>E(e.target.value),className:"px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white text-sm",children:[(0,sa.jsx)("option",{value:"price",children:"Sort by Price"}),(0,sa.jsx)("option",{value:"name",children:"Sort by Club Name"}),(0,sa.jsx)("option",{value:"tenant",children:"Sort by Tenant Name"}),(0,sa.jsx)("option",{value:"date",children:"Sort by Date Created"})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[[...b].sort((e,t)=>"price"===T?parseFloat(t.subscriptionPrice)-parseFloat(e.subscriptionPrice):"name"===T?e.name.localeCompare(t.name):"tenant"===T?e.tenant.name.localeCompare(t.tenant.name):"date"===T?new Date(t.createdAt)-new Date(e.createdAt):0).map(e=>(0,sa.jsx)("div",{className:"p-6 bg-slate-800/50 rounded-lg border border-slate-700",children:I===e.id?(0,sa.jsxs)("form",{onSubmit:t=>{t.preventDefault(),(async(e,t)=>{try{await jr.o_.updateClubSubscription(e,t),alert("\u2705 Subscription updated successfully!"),R(null),O({}),oe()}catch(Gx){alert("Failed to update subscription: "+Gx.message)}})(e.id,{subscriptionPrice:parseFloat(D.price),subscriptionStatus:D.status,subscriptionNotes:D.notes})},className:"space-y-4",children:[(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"Club Name"}),(0,sa.jsxs)("div",{className:"px-4 py-2 bg-slate-900 rounded-lg text-white",children:[e.name," (",e.code,")"]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"Tenant"}),(0,sa.jsx)("div",{className:"px-4 py-2 bg-slate-900 rounded-lg text-white",children:e.tenant.name})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"Monthly Price (\u20b9)"}),(0,sa.jsx)("input",{type:"number",step:"0.01",value:D.price,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{price:e.target.value})),className:"w-full px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"Status"}),(0,sa.jsxs)("select",{value:D.status,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{status:e.target.value})),className:"w-full px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white",children:[(0,sa.jsx)("option",{value:"active",children:"Active"}),(0,sa.jsx)("option",{value:"paused",children:"Paused"}),(0,sa.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"Notes"}),(0,sa.jsx)("textarea",{value:D.notes,onChange:e=>O((0,i.A)((0,i.A)({},D),{},{notes:e.target.value})),rows:3,className:"w-full px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white",placeholder:"Payment notes, reminders, etc."})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"submit",className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-2 rounded-lg font-medium",children:"Save Changes"}),(0,sa.jsx)("button",{type:"button",onClick:he,className:"bg-slate-600 hover:bg-slate-500 px-6 py-2 rounded-lg font-medium",children:"Cancel"})]})]}):(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,sa.jsx)("h3",{className:"text-xl font-bold text-white",children:e.name}),(0,sa.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-slate-700 text-gray-300",children:e.code})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4 text-sm",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Tenant:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:e.tenant.name})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Created:"}),(0,sa.jsx)("span",{className:"text-white ml-2",children:new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Monthly Price:"}),(0,sa.jsxs)("span",{className:"text-emerald-400 ml-2 font-bold text-lg",children:["\u20b9",e.subscriptionPrice]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,sa.jsx)("span",{className:"ml-2 px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.subscriptionStatus?"bg-green-500/20 text-green-300":"paused"===e.subscriptionStatus?"bg-yellow-500/20 text-yellow-300":"bg-red-500/20 text-red-300"),children:e.subscriptionStatus})]})]}),e.subscriptionNotes&&(0,sa.jsxs)("div",{className:"mt-3 text-sm text-gray-400",children:[(0,sa.jsx)("span",{className:"font-medium",children:"Notes:"})," ",e.subscriptionNotes]})]}),(0,sa.jsx)("button",{onClick:()=>(e=>{R(e.id),O({price:e.subscriptionPrice,status:e.subscriptionStatus,notes:e.subscriptionNotes||""})})(e),className:"ml-4 bg-purple-600 hover:bg-purple-500 px-4 py-2 rounded-lg font-medium text-sm whitespace-nowrap",children:"Edit Subscription"})]})},e.id)),0===b.length&&(0,sa.jsx)("div",{className:"text-center py-12 text-gray-400",children:(0,sa.jsx)("p",{children:"No clubs found."})})]})]}),"Reports"===s&&(0,sa.jsxs)("section",{className:"p-6 bg-gradient-to-r from-slate-800/50 via-slate-900/50 to-black/50 rounded-xl border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Revenue Reports"}),(0,sa.jsx)("button",{onClick:()=>{const e=b.map(e=>[e.name,e.code,e.tenant.name,e.subscriptionPrice,e.status,e.subscriptionStatus,new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})]),t=[["Club Name","Club Code","Tenant Name","Monthly Price (\u20b9)","Status","Subscription Status","Created Date"].join(","),...e.map(e=>e.map(e=>'"'.concat(e,'"')).join(","))].join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(s);a.setAttribute("href",r),a.setAttribute("download","revenue-report-".concat((new Date).toISOString().split("T")[0],".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-2 rounded-lg font-medium text-white",children:"Export CSV"})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,sa.jsxs)("div",{className:"p-6 bg-gradient-to-br from-emerald-500/20 to-teal-500/20 rounded-lg border border-emerald-500/30",children:[(0,sa.jsx)("div",{className:"text-sm text-gray-300",children:"Total Monthly Revenue"}),(0,sa.jsxs)("div",{className:"text-3xl font-bold text-emerald-400 mt-2",children:["\u20b9",null===x||void 0===x?void 0:x.monthlyRevenue.toLocaleString("en-IN")]})]}),(0,sa.jsxs)("div",{className:"p-6 bg-gradient-to-br from-blue-500/20 to-indigo-500/20 rounded-lg border border-blue-500/30",children:[(0,sa.jsx)("div",{className:"text-sm text-gray-300",children:"Active Subscriptions"}),(0,sa.jsx)("div",{className:"text-3xl font-bold text-blue-400 mt-2",children:b.filter(e=>"active"===e.subscriptionStatus).length})]}),(0,sa.jsxs)("div",{className:"p-6 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-lg border border-purple-500/30",children:[(0,sa.jsx)("div",{className:"text-sm text-gray-300",children:"Avg. Subscription"}),(0,sa.jsxs)("div",{className:"text-3xl font-bold text-purple-400 mt-2",children:["\u20b9",b.length>0?Math.round((null===x||void 0===x?void 0:x.monthlyRevenue)/b.length).toLocaleString("en-IN"):0]})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-bold text-white",children:"Club Revenue Breakdown"}),b.map(e=>(0,sa.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 flex justify-between items-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"font-medium text-white",children:e.name}),(0,sa.jsx)("div",{className:"text-sm text-gray-400",children:e.tenant.name})]}),(0,sa.jsxs)("div",{className:"text-right",children:[(0,sa.jsxs)("div",{className:"text-xl font-bold text-emerald-400",children:["\u20b9",e.subscriptionPrice,"/mo"]}),(0,sa.jsx)("div",{className:"text-xs text-gray-400",children:e.subscriptionStatus})]})]},e.id))]})]})]})})]}),L&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Create Tenant + Super Admin"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await jr.Ox.createTenant({name:z.tenantName,superAdminName:z.superAdminName,superAdminEmail:z.superAdminEmail});X({type:"tenant",tenantName:e.tenant.name,superAdminEmail:e.superAdmin.email,tempPassword:e.superAdmin.tempPassword}),$(!0),F(!1),K({tenantName:"",superAdminName:"",superAdminEmail:""}),oe()}catch(Gx){const t=Gx.message||"Unknown error";t.includes("already exists")||t.includes("already used")||t.includes("Tenant name")?ce(t,"error"):ce("Failed to create tenant: "+t,"error")}},className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-emerald-400",children:"Tenant Information"}),(0,sa.jsx)("input",{type:"text",placeholder:"Tenant Name (e.g., Poker Group India)",value:z.tenantName,onChange:e=>K((0,i.A)((0,i.A)({},z),{},{tenantName:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:!0})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-blue-400",children:"Super Admin"}),(0,sa.jsx)("input",{type:"text",placeholder:"Super Admin Name",value:z.superAdminName,onChange:e=>K((0,i.A)((0,i.A)({},z),{},{superAdminName:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:!0}),(0,sa.jsx)("input",{type:"email",placeholder:"Super Admin Email",value:z.superAdminEmail,onChange:e=>K((0,i.A)((0,i.A)({},z),{},{superAdminEmail:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:!0}),(0,sa.jsx)("p",{className:"text-sm text-gray-400",children:"A temporary password will be generated automatically"})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"submit",className:"flex-1 bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-lg font-medium text-white",children:"Create Tenant"}),(0,sa.jsx)("button",{type:"button",onClick:()=>F(!1),className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg font-medium text-white",children:"Cancel"})]})]})]})}),M&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-900 rounded-xl p-8 max-w-6xl w-full my-8 border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Create Club with Branding"}),(0,sa.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),G(!0);try{var t;let e,a=W.logoUrl;const r=(null===(t=ie.find(e=>e.value===W.gradient))||void 0===t?void 0:t.class)||W.gradient;if(W.createNewTenant){if(e=await jr.o_.createTenantWithClub({tenantName:W.newTenantName,superAdminName:W.newSuperAdminName,superAdminEmail:W.newSuperAdminEmail,clubName:W.clubName,clubDescription:W.clubDescription,skinColor:W.skinColor,gradient:r,logoUrl:W.logoUrl||void 0,videoUrl:W.videoUrl||void 0,pokerEnabled:W.pokerEnabled,rummyEnabled:W.rummyEnabled}),V&&e.club&&e.tenant)try{const t=e.tenant.id,s=e.club.id,r=await jr.Ox.getLogoUploadUrl(t,s);await jr.Ox.uploadLogo(r.signedUrl,V),a=await jr.Ox.getLogoPublicUrl(t,s)}catch(s){console.error("Logo upload failed:",s),ce("Club created but logo upload failed","error")}X({type:"tenant-club",tenant:e.tenant,superAdmin:e.superAdmin,club:e.club,logoUrl:a}),$(!0)}else{if(e=await jr.Ox.createClubWithBranding(W.tenantId,{name:W.clubName,description:W.clubDescription||void 0,skinColor:W.skinColor||void 0,gradient:r||void 0,logoUrl:W.logoUrl||void 0,videoUrl:W.videoUrl||void 0,pokerEnabled:W.pokerEnabled,rummyEnabled:W.rummyEnabled}),V&&e.id)try{const t=W.tenantId,s=e.id,r=await jr.Ox.getLogoUploadUrl(t,s);await jr.Ox.uploadLogo(r.signedUrl,V),a=await jr.Ox.getLogoPublicUrl(t,s)}catch(s){console.error("Logo upload failed:",s),ce("Club created but logo upload failed","error")}X({type:"club",club:e,logoUrl:a}),$(!0)}B(!1),H({clubName:"",clubDescription:"",skinColor:"#10b981",gradient:"emerald-green-teal",logoUrl:"",videoUrl:"",tenantId:"",createNewTenant:!1,newTenantName:"",newSuperAdminName:"",newSuperAdminEmail:"",pokerEnabled:!0,rummyEnabled:!1}),J(null),oe()}catch(Gx){const t=Gx.message||"Unknown error";t.includes("already exists")||t.includes("already used")?ce(t,"error"):ce("Failed to create club: "+t,"error")}finally{G(!1)}},children:[(0,sa.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-purple-400",children:"Club Information"}),(0,sa.jsx)("input",{type:"text",placeholder:"Club Name (e.g., Emerald Poker Mumbai)",value:W.clubName,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{clubName:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:!0}),(0,sa.jsx)("textarea",{placeholder:"Club Description",value:W.clubDescription,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{clubDescription:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",rows:3})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-amber-400",children:"Game Access"}),(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Select which game types this club can access. You can change this later."}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,sa.jsxs)("label",{className:"flex items-center justify-between bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 cursor-pointer hover:border-slate-500 transition-colors",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-2xl",children:"\u2660\ufe0f"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-white font-medium",children:"Poker"}),(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Poker tables and poker tournaments"})]})]}),(0,sa.jsx)("div",{onClick:()=>H((0,i.A)((0,i.A)({},W),{},{pokerEnabled:!W.pokerEnabled})),className:"relative w-12 h-6 rounded-full transition-colors cursor-pointer ".concat(W.pokerEnabled?"bg-emerald-500":"bg-slate-600"),children:(0,sa.jsx)("div",{className:"absolute top-0.5 w-5 h-5 rounded-full bg-white shadow transition-transform ".concat(W.pokerEnabled?"translate-x-6":"translate-x-0.5")})})]}),(0,sa.jsxs)("label",{className:"flex items-center justify-between bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 cursor-pointer hover:border-slate-500 transition-colors",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:[(0,sa.jsx)("span",{className:"text-2xl",children:"\ud83c\udccf"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-white font-medium",children:"Rummy"}),(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Rummy tables and rummy tournaments"})]})]}),(0,sa.jsx)("div",{onClick:()=>H((0,i.A)((0,i.A)({},W),{},{rummyEnabled:!W.rummyEnabled})),className:"relative w-12 h-6 rounded-full transition-colors cursor-pointer ".concat(W.rummyEnabled?"bg-emerald-500":"bg-slate-600"),children:(0,sa.jsx)("div",{className:"absolute top-0.5 w-5 h-5 rounded-full bg-white shadow transition-transform ".concat(W.rummyEnabled?"translate-x-6":"translate-x-0.5")})})]})]}),!W.pokerEnabled&&!W.rummyEnabled&&(0,sa.jsx)("p",{className:"text-xs text-red-400",children:"\u26a0 At least one game type should be enabled"})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-pink-400",children:"Club Branding"}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm mb-2 text-gray-300",children:"Club Logo (PNG)"}),(0,sa.jsx)("input",{type:"file",accept:"image/png",onChange:e=>{const t=e.target.files[0];if(t){if(t.size>5242880)return ce("Logo file size must be less than 5MB","error"),void(e.target.value="");if(!t.type.includes("png"))return ce("Logo must be a PNG image","error"),void(e.target.value="");J(t)}},className:"w-full px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-emerald-600 file:text-white hover:file:bg-emerald-500 file:cursor-pointer"}),V&&(0,sa.jsxs)("p",{className:"text-xs text-emerald-400 mt-2",children:["\u2713 ",V.name," selected (will upload when club is created)"]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Logo will be uploaded to Supabase when you create the club (max 5MB)"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm mb-2 text-gray-300",children:"Promo Video URL (mp4) - Optional"}),(0,sa.jsx)("input",{type:"text",placeholder:"Promo Video URL (mp4)",value:W.videoUrl,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{videoUrl:e.target.value})),className:"w-full px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-gray-500"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm mb-2 text-gray-300",children:"Skin Color"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("input",{type:"color",value:W.skinColor,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{skinColor:e.target.value})),className:"w-16 h-12 bg-slate-800 border border-slate-600 rounded-lg cursor-pointer"}),(0,sa.jsx)("input",{type:"text",value:W.skinColor,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{skinColor:e.target.value})),className:"flex-1 px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white font-mono"})]}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Primary theme color for the club"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm mb-2 text-gray-300",children:"Gradient Selection"}),(0,sa.jsx)("select",{value:W.gradient,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{gradient:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",children:ie.map(e=>(0,sa.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,sa.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Gradient theme for club branding"})]})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-cyan-400",children:"Tenant Assignment"}),(0,sa.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,sa.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,sa.jsx)("input",{type:"radio",checked:!W.createNewTenant,onChange:()=>H((0,i.A)((0,i.A)({},W),{},{createNewTenant:!1})),className:"w-4 h-4"}),(0,sa.jsx)("span",{children:"Assign to Existing Tenant"})]}),(0,sa.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,sa.jsx)("input",{type:"radio",checked:W.createNewTenant,onChange:()=>H((0,i.A)((0,i.A)({},W),{},{createNewTenant:!0})),className:"w-4 h-4"}),(0,sa.jsx)("span",{children:"Create New Tenant"})]})]}),W.createNewTenant?(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h4",{className:"text-sm font-medium text-emerald-400",children:"New Tenant Details"}),(0,sa.jsx)("input",{type:"text",placeholder:"Tenant Name",value:W.newTenantName,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{newTenantName:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:W.createNewTenant}),(0,sa.jsx)("input",{type:"text",placeholder:"Super Admin Name",value:W.newSuperAdminName,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{newSuperAdminName:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:W.createNewTenant}),(0,sa.jsx)("input",{type:"email",placeholder:"Super Admin Email",value:W.newSuperAdminEmail,onChange:e=>H((0,i.A)((0,i.A)({},W),{},{newSuperAdminEmail:e.target.value})),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:W.createNewTenant})]}):(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm mb-2",children:"Select Tenant"}),(0,sa.jsxs)("select",{value:W.tenantId,onChange:async e=>{const t=e.target.value;if(H((0,i.A)((0,i.A)({},W),{},{tenantId:t})),t)try{const e=await jr.Ox.getTenant(t);e&&e.superAdmin&&console.log("\u2705 Tenant has super admin:",e.superAdmin.email)}catch(Gx){console.error("Failed to fetch tenant info:",Gx)}},className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg text-white",required:!W.createNewTenant,children:[(0,sa.jsx)("option",{value:"",children:"Choose a tenant..."}),f.map(e=>(0,sa.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,sa.jsx)("p",{className:"text-sm text-gray-400 text-center",children:"A unique 6-digit club code will be generated automatically"})]}),(0,sa.jsxs)("div",{className:"space-y-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-medium text-white",children:"Live Preview"}),(0,sa.jsx)("div",{className:"p-8 rounded-xl bg-gradient-to-br ".concat((e=>{const t=ie.find(t=>t.value===e);return t?t.class:e})(W.gradient)," min-h-[500px]"),children:(0,sa.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,sa.jsx)("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center text-white font-bold text-xs overflow-hidden",style:{backgroundColor:W.skinColor},children:V?(0,sa.jsx)("img",{src:URL.createObjectURL(V),alt:"Logo Preview",className:"w-full h-full object-cover rounded-lg"}):W.logoUrl?(0,sa.jsx)("img",{src:W.logoUrl,alt:"Logo",className:"w-full h-full object-contain rounded-lg",onError:e=>e.target.style.display="none"}):"LOGO"}),(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("h4",{className:"text-2xl font-bold text-white",children:W.clubName||"Club Name"}),(0,sa.jsx)("p",{className:"text-white/80 text-sm",children:W.clubDescription||"Club description will appear here"})]})]}),(0,sa.jsxs)("div",{className:"space-y-3 text-white",children:[(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"font-medium",children:"Logo:"}),(0,sa.jsx)("span",{className:"text-white/80",children:V?"".concat(V.name," (").concat((V.size/1024).toFixed(1),"KB)"):W.logoUrl?"Set via URL":"Not set"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"font-medium",children:"Video:"}),(0,sa.jsx)("span",{className:"text-white/80",children:W.videoUrl?"Set":"Not set"})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"font-medium",children:"Skin Color:"}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("div",{className:"w-6 h-6 rounded border-2 border-white",style:{backgroundColor:W.skinColor}}),(0,sa.jsx)("span",{className:"text-white/80 font-mono text-sm",children:W.skinColor})]})]}),(0,sa.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sa.jsx)("span",{className:"font-medium",children:"Gradient:"}),(0,sa.jsx)("span",{className:"text-white/80 text-sm",children:(null===(t=ie.find(e=>e.value===W.gradient))||void 0===t?void 0:t.label)||W.gradient})]})]}),(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/20",children:(0,sa.jsx)("p",{className:"text-white/70 text-sm",children:"This preview shows how the branding will appear in the player portal and club dashboards."})})]})})]})]}),(0,sa.jsxs)("div",{className:"flex gap-3 mt-8",children:[(0,sa.jsx)("button",{type:"submit",disabled:Q,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-600 disabled:cursor-not-allowed px-6 py-3 rounded-lg font-medium text-white",children:Q?"Uploading Logo...":"Create Club"}),(0,sa.jsx)("button",{type:"button",onClick:()=>{B(!1),J(null)},disabled:Q,className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 disabled:bg-slate-800 disabled:cursor-not-allowed rounded-lg font-medium text-white",children:"Cancel"})]})]})]})}),ee&&(0,sa.jsx)("div",{className:"fixed top-4 right-4 z-[100] px-6 py-4 rounded-lg shadow-2xl border-2 ".concat("error"===se?"bg-red-900 border-red-500 text-red-100":"bg-emerald-900 border-emerald-500 text-emerald-100"),children:(0,sa.jsxs)("div",{className:"flex items-center gap-3",children:["error"===se?(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}):(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,sa.jsx)("p",{className:"font-medium",children:ee})]})}),Y&&Z&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-8 max-w-2xl w-full border-2 border-emerald-500 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-500 rounded-full mb-4",children:(0,sa.jsx)("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white mb-2",children:"tenant"===Z.type?"\ud83c\udf89 Tenant Created!":"tenant-club"===Z.type?"\ud83c\udf89 Tenant & Club Created!":"\ud83c\udf89 Club Created!"}),(0,sa.jsx)("p",{className:"text-emerald-400 text-sm",children:"Save these credentials securely!"})]}),(0,sa.jsxs)("div",{className:"space-y-6",children:["tenant"===Z.type&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-purple-500/30",children:[(0,sa.jsxs)("h3",{className:"text-purple-400 font-semibold mb-3 flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{d:"M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"})}),"Tenant Details"]}),(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Name:"})," ",Z.tenantName]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-blue-500/30",children:[(0,sa.jsxs)("h3",{className:"text-blue-400 font-semibold mb-3 flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Super Admin Login"]}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Email:"})," ",Z.superAdminEmail]}),(0,sa.jsxs)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-3 mt-2",children:[(0,sa.jsx)("p",{className:"text-yellow-400 text-sm font-medium mb-1",children:"\u26a0\ufe0f Temporary Password"}),(0,sa.jsx)("p",{className:"text-yellow-100 font-mono text-lg font-bold",children:Z.tempPassword})]})]})]})]}),"tenant-club"===Z.type&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-purple-500/30",children:[(0,sa.jsxs)("h3",{className:"text-purple-400 font-semibold mb-3 flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{d:"M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"})}),"Tenant Details"]}),(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Name:"})," ",Z.tenant.name]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-blue-500/30",children:[(0,sa.jsxs)("h3",{className:"text-blue-400 font-semibold mb-3 flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Super Admin Login"]}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Name:"})," ",Z.superAdmin.displayName||Z.superAdmin.email]}),(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Email:"})," ",Z.superAdmin.email]}),(0,sa.jsxs)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-3 mt-2",children:[(0,sa.jsx)("p",{className:"text-yellow-400 text-sm font-medium mb-1",children:"\u26a0\ufe0f Temporary Password"}),(0,sa.jsx)("p",{className:"text-yellow-100 font-mono text-lg font-bold",children:Z.superAdmin.tempPassword})]})]})]})]}),("tenant-club"===Z.type||"club"===Z.type)&&(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-emerald-500/30",children:[(0,sa.jsxs)("h3",{className:"text-emerald-400 font-semibold mb-3 flex items-center gap-2",children:[(0,sa.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,sa.jsx)("path",{d:"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"})}),"Club Details"]}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("p",{className:"text-white",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Club Name:"})," ",Z.club.name]}),(0,sa.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3 mt-2",children:[(0,sa.jsx)("p",{className:"text-emerald-400 text-sm font-medium mb-1",children:"\ud83c\udfae Unique Club Code"}),(0,sa.jsx)("p",{className:"text-emerald-100 font-mono text-2xl font-bold tracking-wider",children:Z.club.code}),(0,sa.jsx)("p",{className:"text-emerald-300 text-xs mt-1",children:"Players use this code to sign up"})]}),Z.logoUrl&&(0,sa.jsx)("p",{className:"text-emerald-400 text-sm mt-2",children:"\u2705 Logo uploaded successfully"}),(0,sa.jsxs)("div",{className:"mt-3 pt-3 border-t border-slate-700",children:[(0,sa.jsx)("p",{className:"text-gray-400 text-sm font-medium mb-2",children:"Game Access:"}),(0,sa.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,sa.jsxs)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(!1!==Z.club.pokerEnabled?"bg-emerald-900/50 text-emerald-400":"bg-slate-700 text-gray-500"),children:["\u2660\ufe0f Poker ",!1!==Z.club.pokerEnabled?"ON":"OFF"]}),(0,sa.jsxs)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(Z.club.rummyEnabled?"bg-emerald-900/50 text-emerald-400":"bg-slate-700 text-gray-500"),children:["\ud83c\udccf Rummy ",Z.club.rummyEnabled?"ON":"OFF"]})]})]})]})]})]}),(0,sa.jsx)("button",{onClick:()=>{$(!1),X(null)},className:"w-full mt-6 bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-lg font-bold text-white text-lg transition-colors",children:"Got it! Close"})]})})]})}function _x(){return(0,sa.jsx)(ch,{role:"SUPER_ADMIN",roleDisplayName:"Super Admin",redirectPath:"/super-admin",gradientFrom:"from-blue-400",gradientTo:"to-indigo-600",description:"Tenant-level Administration"})}const Px=["Dashboard","Notifications","Player Management","Staff Management","Payroll Management","Affiliates","Tables & Waitlist","Club Buy-In","Credit Management","VIP Store","Push Notifications","Tournaments","Bonus Management","FNB","Chat","Transactions","Player Feedback","Reports & Analytics","Audit Logs","System Control"];function Tx(e){let{activeItem:t,setActiveItem:s,menuItems:a=Px,onSignOut:n=null,clubs:l=[],selectedClubId:o=null,onClubChange:d=null}=e;const[c,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(window.innerWidth<1024),[x,p]=(0,r.useState)(!1),[b,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),v=(0,r.useRef)(null),w=(0,r.useRef)(null),j=(0,r.useRef)(null),N=(0,r.useRef)(null),S=(0,r.useRef)(null),k=o||localStorage.getItem("clubId");od(k);const{data:C}=hn({queryKey:["unreadNotificationCount",k,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(k,"staff"),enabled:!!k}),{data:A}=hn({queryKey:["unreadChatCounts",k],queryFn:()=>jr.h2.getUnreadCounts(k),enabled:!!k}),_=((null===A||void 0===A?void 0:A.staffChats)||0)+((null===A||void 0===A?void 0:A.playerChats)||0),{data:P=[]}=hn({queryKey:["pendingLeaveApplications",k],queryFn:()=>jr.ie.getPendingLeaveApplications(k),enabled:!!k}),T=(null===P||void 0===P?void 0:P.length)||0,{data:E=[]}=hn({queryKey:["creditRequests",k],queryFn:()=>jr.Dv.getCreditRequests(k,"Pending"),enabled:!!k}),I=(null===E||void 0===E?void 0:E.length)||0;(0,r.useEffect)(()=>{const e=(null===C||void 0===C?void 0:C.unreadCount)||0;if(null!==v.current&&e>v.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}v.current=e},[null===C||void 0===C?void 0:C.unreadCount]),(0,r.useEffect)(()=>{const e=T;if(null!==w.current&&e>w.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}w.current=e},[T]),(0,r.useEffect)(()=>{const e=(null===A||void 0===A?void 0:A.staffChats)||0;if(null!==j.current&&e>j.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}j.current=e},[null===A||void 0===A?void 0:A.staffChats]),(0,r.useEffect)(()=>{const e=(null===A||void 0===A?void 0:A.playerChats)||0;if(null!==N.current&&e>N.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}N.current=e},[null===A||void 0===A?void 0:A.playerChats]),(0,r.useEffect)(()=>{if(null!==S.current&&I>S.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.6,e.play().catch(e=>console.log("Audio play failed:",e))}S.current=I},[I]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;h(e),e||u(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(c&&m){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[c,m]);const R=l.find(e=>e.clubId===o)||l[0],D=(null===R||void 0===R?void 0:R.rummyEnabled)||!1,O=!1!==(null===R||void 0===R?void 0:R.pokerEnabled),L=JSON.parse(localStorage.getItem("user")||"{}"),F=JSON.parse(localStorage.getItem("superadminuser")||"{}"),M=L.email||F.email||"super@admin.com",B=L.displayName||F.displayName||"Root Administrator";L.role||F.role;let q=a.filter(e=>!(!O&&["Tables & Waitlist","Tournaments"].includes(e)));D&&(q=[...q,"Rummy"]);const U=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("superadminuser")||"{}");t.mustResetPassword=!1,localStorage.setItem("superadminuser",JSON.stringify(t)),g(!1),y({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}});return(0,sa.jsxs)(sa.Fragment,{children:[m&&(0,sa.jsx)("button",{className:"sidebar-toggle fixed top-4 left-4 z-50 bg-gradient-to-r from-red-500 to-purple-600 text-white p-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 lg:hidden",onClick:()=>u(!c),"aria-label":"Toggle sidebar",children:(0,sa.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),m&&c&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity duration-300 lg:hidden",onClick:()=>u(!1)}),(0,sa.jsx)("aside",{className:"sidebar-container fixed lg:sticky top-0 left-0 h-screen z-40 w-80 max-w-[90vw] bg-gradient-to-b from-red-500/20 via-purple-600/30 to-indigo-700/30 border-r border-gray-800 shadow-2xl transition-transform duration-300 ease-in-out overflow-y-auto overflow-x-hidden hide-scrollbar ".concat(m?c?"translate-x-0":"-translate-x-full":"translate-x-0"),children:(0,sa.jsxs)("div",{className:"p-5 h-full flex flex-col min-w-0",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("div",{className:"pt-11 lg:pt-0 text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-purple-300 to-indigo-400 drop-shadow-lg mb-6",children:"Super Admin"}),(0,sa.jsxs)("div",{onClick:()=>g(!0),className:"bg-white/10 rounded-xl p-4 mb-6 text-white shadow-inner cursor-pointer hover:bg-white/15 transition-colors",children:[(0,sa.jsx)("div",{className:"text-lg font-semibold",children:B}),(0,sa.jsx)("div",{className:"text-sm opacity-80",children:M})]}),b&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[9999]",onClick:()=>g(!1),children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full mx-4 border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Enter your current and new password"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("superadminuser")||"{}"),a=t.email||s.email;a?f.currentPassword&&f.newPassword&&f.confirmPassword?f.newPassword===f.confirmPassword?f.newPassword.length<8?wr.error("Password must be at least 8 characters"):U.mutate({email:a,currentPassword:f.currentPassword,newPassword:f.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:f.currentPassword,onChange:e=>y((0,i.A)((0,i.A)({},f),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter current password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:f.newPassword,onChange:e=>y((0,i.A)((0,i.A)({},f),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:f.confirmPassword,onChange:e=>y((0,i.A)((0,i.A)({},f),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{type:"button",onClick:()=>{g(!1),y({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white font-medium py-3 rounded-lg transition-colors",children:"Cancel"}),(0,sa.jsx)("button",{type:"submit",disabled:U.isLoading,className:"flex-1 bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:U.isLoading?"Resetting...":"Reset Password"})]})]})]})}),document.body),l.length>0&&d&&(0,sa.jsxs)("div",{className:"mb-6 relative min-w-0",children:[(0,sa.jsx)("label",{className:"text-white text-sm mb-2 block font-semibold",children:"\ud83d\udccd Select Club"}),(0,sa.jsxs)("div",{className:"relative min-w-0",children:[(0,sa.jsxs)("button",{type:"button",onClick:()=>p(!x),className:"w-full px-4 py-3 bg-gradient-to-r from-emerald-600/20 to-teal-600/20 border border-emerald-500/40 rounded-lg text-white text-left flex items-center justify-between hover:from-emerald-600/30 hover:to-teal-600/30 transition-all overflow-hidden min-w-0 shadow-md",children:[(0,sa.jsx)("span",{className:"truncate min-w-0 flex-1 font-medium",children:(null===R||void 0===R?void 0:R.clubName)||"Select Club"}),(0,sa.jsx)("svg",{className:"w-5 h-5 ml-2 transition-transform ".concat(x?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),x&&(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>p(!1)}),(0,sa.jsx)("div",{className:"absolute z-20 w-full mt-2 bg-slate-800 border border-emerald-500/40 rounded-lg shadow-2xl max-h-64 overflow-y-auto overflow-x-hidden hide-scrollbar",children:l.map(e=>(0,sa.jsxs)("button",{type:"button",onClick:()=>{d(e.clubId),p(!1)},className:"w-full px-4 py-3 text-left text-white hover:bg-emerald-600/30 transition-colors overflow-hidden border-b border-slate-700 last:border-b-0 ".concat(o===e.clubId?"bg-emerald-600/40 font-semibold":""),children:[(0,sa.jsx)("span",{className:"block truncate",children:e.clubName}),(0,sa.jsx)("span",{className:"block text-xs text-gray-400 truncate mt-0.5",children:e.tenantName})]},e.clubId))})]})]}),(0,sa.jsxs)("p",{className:"text-xs text-emerald-400 mt-2 font-medium",children:["\ud83d\udcca ",l.length," ",1===l.length?"Club":"Clubs"," Available"]}),R&&R.code&&(0,sa.jsxs)("div",{className:"mt-3 bg-emerald-900/30 border border-emerald-500/50 rounded-lg p-3",children:[(0,sa.jsx)("div",{className:"text-xs text-emerald-300 font-semibold mb-1",children:"\ud83c\udfae Club Code"}),(0,sa.jsx)("div",{className:"text-emerald-100 font-mono text-lg font-bold tracking-wider text-center",children:R.code}),(0,sa.jsx)("div",{className:"text-xs text-emerald-400 mt-1 text-center",children:"Players use this to sign up"})]})]})]}),(0,sa.jsx)("nav",{className:"space-y-3 flex-1 overflow-y-auto overflow-x-hidden hide-scrollbar min-w-0",children:q.map(e=>(0,sa.jsx)("button",{onClick:()=>{s(e),m&&u(!1)},className:"w-full text-left rounded-xl px-4 py-3 font-medium transition-all duration-300 shadow-md overflow-hidden ".concat(t===e?"bg-gradient-to-r from-red-400 to-purple-600 text-white font-bold shadow-lg scale-[1.02]":"bg-white/5 hover:bg-gradient-to-r hover:from-red-400/20 hover:to-purple-500/20 text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between",children:[(0,sa.jsx)("span",{className:"block truncate",children:e}),"Notifications"===e&&(null===C||void 0===C?void 0:C.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:C.unreadCount>9?"9+":C.unreadCount}),"Chat"===e&&_>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:_>9?"9+":_}),"Staff Management"===e&&T>0&&(0,sa.jsx)("span",{className:"ml-2 bg-amber-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:T>9?"9+":T}),"Credit Management"===e&&I>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:I>9?"9+":I})]})},e))}),n&&(0,sa.jsx)("div",{className:"mt-6 pt-6 border-t border-white/10",children:(0,sa.jsx)("button",{onClick:n,className:"w-full bg-red-600 hover:bg-red-500 text-white px-4 py-3 rounded-lg font-semibold shadow transition",children:"Sign Out"})})]})})]})}function Ex(e){let{selectedClubId:t}=e;const s=ra(),[a,n]=(0,r.useState)("players-list"),[l,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[m,h]=(0,r.useState)(""),[x,p]=(0,r.useState)(!1),[b,g]=(0,r.useState)(null),[f,y]=(0,r.useState)(""),{data:v=[],isLoading:w}=hn({queryKey:["creditPlayers",t],queryFn:async()=>{if(!t)return[];const e=[];let s=1;let a=!0;for(;a;)try{const r=await jr.Dv.getPlayers(t,{limit:50,page:s}),n=(null===r||void 0===r?void 0:r.players)||[];if(!n||0===n.length){a=!1;break}const l=n.filter(e=>("approved"===e.kycStatus||"verified"===e.kycStatus)&&"Active"===e.status);e.push(...l),n.length<50?a=!1:(s++,s>20&&(a=!1))}catch(r){console.error("Error fetching page ".concat(s,":"),r),a=!1}return e},enabled:!!t}),{data:j=[],isLoading:N}=hn({queryKey:["creditRequests",t],queryFn:()=>jr.Dv.getCreditRequests(t,"Pending"),enabled:!!t&&"credit-requests"===a}),S=gn({mutationFn:async e=>{let{playerId:s,limit:a}=e;return await jr.Dv.unlockCredit(t,s,{creditLimit:parseFloat(a)})},onSuccess:async()=>{wr.success("Credit feature unlocked successfully!"),await s.refetchQueries(["creditPlayers",t]),i(!1),u(null),h("")},onError:e=>{wr.error(e.message||"Failed to unlock credit feature")}}),k=gn({mutationFn:async e=>{let{playerId:s,limit:a}=e;return await jr.Dv.updateCreditLimit(t,s,{creditLimit:parseFloat(a)})},onSuccess:async()=>{wr.success("Credit limit updated successfully!"),await s.refetchQueries(["creditPlayers",t]),d(!1),u(null),h("")},onError:e=>{wr.error(e.message||"Failed to update credit limit")}}),C=gn({mutationFn:async e=>{let{requestId:s,playerId:a}=e;return await jr.Dv.approveCreditRequest(t,s)},onSuccess:()=>{wr.success("Credit request approved!"),s.invalidateQueries(["creditRequests",t]),s.invalidateQueries(["creditPlayers",t])},onError:e=>{wr.error(e.message||"Failed to approve credit request")}}),A=gn({mutationFn:async e=>{let{requestId:s,reason:a}=e;return await jr.Dv.rejectCreditRequest(t,s,{reason:a})},onSuccess:()=>{wr.success("Credit request rejected"),s.invalidateQueries(["creditRequests",t]),p(!1),g(null),y("")},onError:e=>{wr.error(e.message||"Failed to reject credit request")}});return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6",children:[(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Credit Feature Management"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Ultimate control: players, staff, credit, overrides and more"})]}),(0,sa.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,sa.jsx)("button",{onClick:()=>n("players-list"),className:"px-6 py-3 font-semibold rounded-t-lg transition-colors ".concat("players-list"===a?"bg-gradient-to-r from-amber-600 to-amber-500 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:"Players List & Credit Management"}),(0,sa.jsx)("button",{onClick:()=>n("credit-requests"),className:"px-6 py-3 font-semibold rounded-t-lg transition-colors ".concat("credit-requests"===a?"bg-gradient-to-r from-amber-600 to-amber-500 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:"Credit Approval Requests"})]}),(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-amber-900/30 to-orange-900/30 rounded-lg p-6",children:["players-list"===a&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"All Players - Credit Management"}),w?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"Loading players..."}):0===v.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No players found"}):(0,sa.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,sa.jsx)("div",{className:"bg-slate-800/50 rounded-lg p-5 border border-slate-700",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-white font-semibold text-lg",children:e.name}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["ID: ",e.playerId||e.id]}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Email: ",e.email]}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Balance: ",(0,sa.jsxs)("span",{className:"font-bold ".concat((e.balance||0)<0?"text-red-400":"text-green-400"),children:["\u20b9",Number(e.balance||0).toLocaleString()]})]}),e.creditEnabled&&(0,sa.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,sa.jsxs)("p",{className:"text-blue-400 text-sm",children:["Credit Limit: ",(0,sa.jsxs)("span",{className:"font-bold",children:["\u20b9",Number(e.creditLimit||0).toLocaleString()]})]}),(0,sa.jsxs)("p",{className:"text-yellow-400 text-sm",children:["Credit Used: ",(0,sa.jsxs)("span",{className:"font-bold",children:["\u20b9",Number(e.creditUsed||0).toLocaleString()]})]}),(0,sa.jsxs)("p",{className:"text-green-400 text-sm",children:["Remaining Credit: ",(0,sa.jsxs)("span",{className:"font-bold",children:["\u20b9",Number((e.creditLimit||0)-(e.creditUsed||0)).toLocaleString()]})]})]})]}),(0,sa.jsx)("div",{className:"flex flex-col gap-2",children:e.creditEnabled?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("button",{onClick:()=>{var t;u(e),h((null===(t=e.creditLimit)||void 0===t?void 0:t.toString())||""),d(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors",children:"Edit Limit"}),(0,sa.jsx)("span",{className:"px-4 py-2 bg-green-600 text-white text-center rounded-lg font-semibold",children:"Credit Enabled"})]}):(0,sa.jsx)("button",{onClick:()=>{u(e),i(!0)},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors",children:"Unlock Credit"})})]})},e.id))})]}),"credit-requests"===a&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Credit Approval Requests"}),N?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"Loading requests..."}):0===j.length?(0,sa.jsx)("div",{className:"text-gray-400 text-center py-8",children:"No pending credit requests"}):(0,sa.jsx)("div",{className:"space-y-4",children:j.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("h3",{className:"text-white font-semibold text-xl",children:e.playerName}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Player ID: ",e.playerId]}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Requested Amount: ",(0,sa.jsxs)("span",{className:"font-bold text-yellow-400",children:["\u20b9",Number(e.amount).toLocaleString()]})]}),e.limit&&e.limit>0&&(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Approved Amount: ",(0,sa.jsxs)("span",{className:"font-bold text-green-400",children:["\u20b9",Number(e.limit).toLocaleString()]})]}),(0,sa.jsxs)("p",{className:"text-gray-400 text-sm",children:["Requested: ",new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})]}),e.notes&&(0,sa.jsxs)("p",{className:"text-gray-300 text-sm mt-2",children:["Notes: ",e.notes]})]}),(0,sa.jsx)("span",{className:"px-3 py-1 bg-yellow-600 text-white text-sm font-semibold rounded",children:"Pending"})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>C.mutate({requestId:e.id,playerId:e.playerId}),disabled:C.isPending,className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:C.isPending?"Approving...":"Approve Credit"}),(0,sa.jsx)("button",{onClick:()=>{g(e),p(!0)},disabled:A.isPending,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-semibold transition-colors disabled:opacity-50",children:"Reject"})]})]},e.id))})]})]}),l&&c&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white mb-4",children:"Unlock Credit Feature"}),(0,sa.jsxs)("p",{className:"text-gray-300 mb-4",children:["Do you want to unlock the credit feature for ",(0,sa.jsx)("span",{className:"font-semibold text-white",children:c.name}),"?"]}),(0,sa.jsx)("div",{className:"mb-4 p-3 bg-blue-500/10 border border-blue-500 rounded-lg",children:(0,sa.jsxs)("p",{className:"text-blue-400 text-sm",children:["Current Balance: \u20b9",Number(c.balance||0).toLocaleString()]})}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2 font-semibold",children:["Set Credit Limit (\u20b9) ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"number",value:m,onChange:e=>h(e.target.value),placeholder:"Enter credit limit",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{!m||parseFloat(m)<=0?wr.error("Please enter a valid credit limit"):S.mutate({playerId:c.id,limit:m})},disabled:S.isPending,className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg font-semibold transition-colors disabled:opacity-50",children:S.isPending?"Unlocking...":"Unlock & Set Limit"}),(0,sa.jsx)("button",{onClick:()=>{i(!1),u(null),h("")},className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white py-2 rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),o&&c&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white mb-4",children:"Edit Credit Limit"}),(0,sa.jsxs)("p",{className:"text-gray-300 mb-4",children:["Update credit limit for ",(0,sa.jsx)("span",{className:"font-semibold text-white",children:c.name})]}),(0,sa.jsxs)("div",{className:"mb-4 p-3 bg-blue-500/10 border border-blue-500 rounded-lg",children:[(0,sa.jsxs)("p",{className:"text-blue-400 text-sm",children:["Current Limit: \u20b9",c.creditLimit||0]}),(0,sa.jsxs)("p",{className:"text-blue-400 text-sm",children:["Credit Used: \u20b9",c.creditUsed||0]})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2 font-semibold",children:["New Credit Limit (\u20b9) ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("input",{type:"number",value:m,onChange:e=>h(e.target.value),placeholder:"Enter new credit limit",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{!m||parseFloat(m)<=0?wr.error("Please enter a valid credit limit"):k.mutate({playerId:c.id,limit:m})},disabled:k.isPending,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-semibold transition-colors disabled:opacity-50",children:k.isPending?"Updating...":"Update Limit"}),(0,sa.jsx)("button",{onClick:()=>{d(!1),u(null),h("")},className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white py-2 rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),x&&b&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-slate-700 max-h-[85vh] overflow-y-auto",children:[(0,sa.jsx)("h3",{className:"text-2xl font-bold text-white mb-4",children:"Reject Credit Request"}),(0,sa.jsxs)("p",{className:"text-gray-300 mb-4",children:["Rejecting request from ",(0,sa.jsx)("span",{className:"font-semibold text-white",children:b.playerName})]}),(0,sa.jsxs)("div",{className:"mb-6",children:[(0,sa.jsxs)("label",{className:"block text-gray-300 mb-2 font-semibold",children:["Rejection Reason ",(0,sa.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,sa.jsx)("textarea",{value:f,onChange:e=>y(e.target.value),placeholder:"Enter reason for rejection...",rows:4,className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]}),(0,sa.jsxs)("div",{className:"flex gap-3",children:[(0,sa.jsx)("button",{onClick:()=>{f.trim()?A.mutate({requestId:b.id,reason:f}):wr.error("Please provide a reason for rejection")},disabled:A.isPending,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-semibold transition-colors disabled:opacity-50",children:A.isPending?"Rejecting...":"Confirm Rejection"}),(0,sa.jsx)("button",{onClick:()=>{p(!1),g(null),y("")},className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white py-2 rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})})]})}function Ix(e){var t,s;let{clubId:a}=e;const[n,l]=(0,r.useState)(1),[o,d]=(0,r.useState)({search:"",category:"",staffRole:"",startDate:"",endDate:""}),[c,u]=(0,r.useState)({}),[m,h]=(0,r.useState)(!1),{data:x,isLoading:p,refetch:b}=hn({queryKey:["auditLogs",a,n,c],queryFn:async()=>{const e=new URLSearchParams((0,i.A)({page:n.toString(),limit:"10"},c));return await(0,jr.AT)("/clubs/".concat(a,"/audit-logs?").concat(e))},enabled:!!a}),{data:g}=hn({queryKey:["auditLogStats",a],queryFn:async()=>await(0,jr.AT)("/clubs/".concat(a,"/audit-logs/statistics?days=30")),enabled:!!a}),f=e=>{const t=new Date(e);return new Intl.DateTimeFormat("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"}).format(t)};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:[(0,sa.jsxs)("div",{className:"mb-8",children:[(0,sa.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Audit Logs & Backups"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Track all staff activities and system events"})]}),g&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white",children:[(0,sa.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,sa.jsx)(tc,{className:"text-3xl opacity-75"})}),(0,sa.jsx)("div",{className:"text-3xl font-bold mb-1",children:g.totalActions}),(0,sa.jsx)("div",{className:"text-sm opacity-90",children:"Total Actions (30 days)"})]}),Object.entries(g.byCategory||{}).slice(0,3).map((e,t)=>{let[s,a]=e;return(0,sa.jsxs)("div",{className:"bg-gradient-to-br ".concat(0===t?"from-green-500 to-green-600":1===t?"from-orange-500 to-orange-600":"from-purple-500 to-purple-600"," rounded-xl p-6 text-white"),children:[(0,sa.jsx)("div",{className:"text-2xl font-bold mb-1",children:a}),(0,sa.jsx)("div",{className:"text-sm opacity-90 capitalize",children:s.replace(/_/g," ")})]},s)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-xl p-6 mb-6 border border-slate-700",children:[(0,sa.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,sa.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),(0,sa.jsxs)("div",{className:"relative",children:[(0,sa.jsx)(fc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,sa.jsx)("input",{type:"text",value:o.search,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{search:e.target.value})),placeholder:"Search by name or description...",className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:o.startDate,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{startDate:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:o.endDate,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{endDate:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),(0,sa.jsxs)("button",{onClick:()=>h(!m),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg flex items-center gap-2 transition-colors",children:[(0,sa.jsx)(mc,{}),"More Filters"]}),(0,sa.jsx)("button",{onClick:()=>{const e={};o.search&&(e.search=o.search),o.category&&(e.category=o.category),o.staffRole&&(e.staffRole=o.staffRole),o.startDate&&(e.startDate=o.startDate),o.endDate&&(e.endDate=o.endDate),u(e),l(1),h(!1)},className:"px-6 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white rounded-lg font-medium transition-colors",children:"Apply Filters"}),Object.keys(c).length>0&&(0,sa.jsx)("button",{onClick:()=>{d({search:"",category:"",staffRole:"",startDate:"",endDate:""}),u({}),l(1)},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Clear"})]}),m&&(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pt-4 border-t border-slate-700",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),(0,sa.jsx)("select",{value:o.category,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{category:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[{value:"",label:"All Categories"},{value:"player_management",label:"Player Management"},{value:"financial",label:"Financial"},{value:"table_management",label:"Table Management"},{value:"staff_management",label:"Staff Management"},{value:"tournament",label:"Tournament"},{value:"bonus",label:"Bonus"},{value:"credit",label:"Credit"},{value:"fnb",label:"FNB"},{value:"shift",label:"Shift"},{value:"payroll",label:"Payroll"},{value:"override",label:"Override"},{value:"system",label:"System"}].map(e=>(0,sa.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Staff Role"}),(0,sa.jsx)("select",{value:o.staffRole,onChange:e=>d((0,i.A)((0,i.A)({},o),{},{staffRole:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[{value:"",label:"All Roles"},{value:"SUPER_ADMIN",label:"Super Admin"},{value:"ADMIN",label:"Admin"},{value:"MANAGER",label:"Manager"},{value:"HR",label:"HR"},{value:"GRE",label:"GRE"},{value:"CASHIER",label:"Cashier"},{value:"DEALER",label:"Dealer"},{value:"KITCHEN_STAFF",label:"Kitchen Staff"},{value:"AFFILIATE",label:"Affiliate"}].map(e=>(0,sa.jsx)("option",{value:e.value,children:e.label},e.value))})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Audit Log"}),p?(0,sa.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):0===(null===x||void 0===x||null===(t=x.logs)||void 0===t?void 0:t.length)?(0,sa.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,sa.jsx)("p",{className:"text-lg",children:"No audit logs found"}),(0,sa.jsx)("p",{className:"text-sm mt-2",children:"Try adjusting your filters"})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"space-y-3 mb-6",children:null===x||void 0===x||null===(s=x.logs)||void 0===s?void 0:s.map(e=>(0,sa.jsx)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4 hover:bg-slate-700 transition-colors",children:(0,sa.jsxs)("div",{className:"flex justify-between items-start",children:[(0,sa.jsxs)("div",{className:"flex-1",children:[(0,sa.jsx)("p",{className:"text-white font-medium mb-1",children:e.description}),(0,sa.jsxs)("div",{className:"flex flex-wrap gap-3 text-sm text-gray-400",children:[(0,sa.jsxs)("span",{className:"flex items-center gap-1",children:[(0,sa.jsx)("span",{className:"font-medium text-purple-400",children:e.staffName}),(0,sa.jsxs)("span",{children:["(",e.staffRole.replace(/_/g," "),")"]})]}),e.targetName&&(0,sa.jsxs)("span",{children:["\u2192 ",(0,sa.jsx)("span",{className:"font-medium text-blue-400",children:e.targetName})]}),(0,sa.jsx)("span",{className:"text-gray-500",children:"\u2022"}),(0,sa.jsx)("span",{className:"capitalize text-green-400",children:e.actionCategory.replace(/_/g," ")})]})]}),(0,sa.jsx)("div",{className:"text-right text-sm text-gray-400 ml-4",children:f(e.createdAt)})]})},e.id))}),x&&x.totalPages>1&&(0,sa.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-slate-700",children:[(0,sa.jsxs)("div",{className:"text-gray-400 text-sm",children:["Showing page ",n," of ",x.totalPages," (",x.total," total logs)"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>l(e=>Math.max(1,e-1)),disabled:1===n,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Previous"}),(0,sa.jsx)("button",{onClick:()=>l(e=>Math.min(x.totalPages,e+1)),disabled:n===x.totalPages,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Next"})]})]})]})]})]})}function Rx(){var e,t,s,a,n,l,o,d,c;const u=me(),m=ra(),[h,x]=(0,r.useState)("Dashboard"),[p,b]=(0,r.useState)(null),[g,f]=(0,r.useState)(!1),[y,v]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=JSON.parse(localStorage.getItem("superadminuser")||"{}");e.id||t.userId?(e.mustResetPassword||t.mustResetPassword)&&f(!0):u("/super-admin/signin")},[u]);const{data:w=[],isLoading:j,error:N}=hn({queryKey:["superAdminClubs"],queryFn:jr.Dv.getClubs});(0,r.useEffect)(()=>{w&&w.length>0&&!p&&b(w[0].clubId)},[w,p]);const{data:S,isLoading:k}=hn({queryKey:["clubRevenue",p],queryFn:()=>jr.Dv.getClubRevenue(p),enabled:!!p}),{data:C,isLoading:A}=hn({queryKey:["clubPlayers",p],queryFn:()=>jr.Dv.getAllPlayers(p,{limit:100}),enabled:!!p}),{data:_=[],isLoading:P}=hn({queryKey:["pendingPlayers",p],queryFn:()=>jr.Dv.getPendingApprovalPlayers(p),enabled:!!p}),{data:T=[],isLoading:E}=hn({queryKey:["suspendedPlayers",p],queryFn:()=>jr.Dv.getSuspendedPlayers(p),enabled:!!p}),I=w.find(e=>e.clubId===p),R="suspended"===(null===I||void 0===I?void 0:I.status),D="killed"===(null===I||void 0===I?void 0:I.status),O=()=>{localStorage.clear(),sessionStorage.clear(),u("/super-admin/signin")},L=e=>"\u20b9".concat((e||0).toLocaleString("en-IN")),F=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("superadminuser")||"{}");t.mustResetPassword=!1,localStorage.setItem("superadminuser",JSON.stringify(t)),f(!1),v({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),M=g&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=JSON.parse(localStorage.getItem("user")||"{}"),s=JSON.parse(localStorage.getItem("superadminuser")||"{}"),a=t.email||s.email;a?y.currentPassword&&y.newPassword&&y.confirmPassword?y.newPassword===y.confirmPassword?y.newPassword.length<8?wr.error("Password must be at least 8 characters"):F.mutate({email:a,currentPassword:y.currentPassword,newPassword:y.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:y.currentPassword,onChange:e=>v((0,i.A)((0,i.A)({},y),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:y.newPassword,onChange:e=>v((0,i.A)((0,i.A)({},y),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:y.confirmPassword,onChange:e=>v((0,i.A)((0,i.A)({},y),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:F.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:F.isLoading?"Resetting...":"Reset Password"})]})]})});return j?(0,sa.jsxs)(sa.Fragment,{children:[M,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900 flex items-center justify-center",children:(0,sa.jsxs)("div",{className:"text-white text-center",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-xl",children:"Loading clubs..."})]})})]}):N?(0,sa.jsxs)(sa.Fragment,{children:[M,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900 flex items-center justify-center p-8",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 text-center border border-red-600 max-w-2xl w-full",children:[(0,sa.jsx)("div",{className:"text-red-400 text-6xl mb-4",children:"\u26a0\ufe0f"}),(0,sa.jsx)("p",{className:"text-xl text-red-400 mb-2",children:"Error loading clubs"}),(0,sa.jsx)("p",{className:"text-gray-400 mb-8",children:N.message}),(0,sa.jsx)("button",{onClick:O,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:"Sign Out"})]})})]}):w&&0!==w.length?D?(0,sa.jsxs)(sa.Fragment,{children:[M,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-red-900 flex items-center justify-center p-8",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 text-center border border-red-600 max-w-2xl w-full",children:[(0,sa.jsx)("div",{className:"text-red-400 text-6xl mb-4",children:"\ud83d\udeab"}),(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-4",children:"Club Not Found"}),(0,sa.jsx)("p",{className:"text-gray-400 mb-8",children:"This club has been removed by Master Admin."}),(0,sa.jsx)("button",{onClick:O,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:"Sign Out"})]})})]}):R?(0,sa.jsxs)(sa.Fragment,{children:[M,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-orange-900 flex items-center justify-center p-8",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 text-center border border-orange-600 max-w-2xl w-full",children:[(0,sa.jsx)("div",{className:"text-orange-400 text-6xl mb-4",children:"\ud83d\udd12"}),(0,sa.jsx)("h1",{className:"text-3xl font-bold text-white mb-4",children:"Club Suspended"}),(0,sa.jsx)("p",{className:"text-gray-400 mb-4",children:"This club has been temporarily suspended by Master Admin."}),(null===I||void 0===I?void 0:I.subscriptionNotes)&&(0,sa.jsxs)("div",{className:"bg-orange-900/30 border border-orange-700 rounded-lg p-4 mb-8",children:[(0,sa.jsx)("p",{className:"text-sm text-orange-300 font-semibold mb-2",children:"Suspension Reason:"}),(0,sa.jsx)("p",{className:"text-gray-300",children:I.subscriptionNotes})]}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mb-8",children:"Please contact Master Admin for more information."}),(0,sa.jsx)("button",{onClick:O,className:"bg-orange-600 hover:bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:"Sign Out"})]})})]}):(0,sa.jsxs)(sa.Fragment,{children:[M,(0,sa.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900",children:[(0,sa.jsx)(Tx,{activeItem:h,setActiveItem:x,clubs:w,selectedClubId:p,onClubChange:b,onSignOut:O}),(0,sa.jsxs)("main",{className:"flex-1 p-8 overflow-y-auto",children:["Dashboard"===h&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)("div",{className:"flex justify-between items-center",children:(0,sa.jsxs)("h1",{className:"text-3xl font-bold text-white",children:["Dashboard - ",(null===I||void 0===I?void 0:I.clubName)||"Loading..."]})}),k?(0,sa.jsxs)("div",{className:"text-white text-center py-12",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{children:"Loading revenue data..."})]}):(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:L((null===S||void 0===S||null===(e=S.previousDay)||void 0===e?void 0:e.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===S||void 0===S||null===(t=S.previousDay)||void 0===t?void 0:t.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-emerald-600",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Revenue"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-emerald-400",children:L((null===S||void 0===S||null===(s=S.currentDay)||void 0===s?void 0:s.revenue)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:(null===S||void 0===S||null===(a=S.currentDay)||void 0===a?void 0:a.date)||"-"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:L((null===S||void 0===S||null===(n=S.currentDay)||void 0===n?void 0:n.rake)||0)}),(0,sa.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"10% of revenue"})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Rake"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:L((null===S||void 0===S||null===(l=S.previousDay)||void 0===l?void 0:l.rake)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Previous Day Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:L((null===S||void 0===S||null===(o=S.previousDay)||void 0===o?void 0:o.tips)||0)})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-gray-400 text-sm mb-2",children:"Today's Tips"}),(0,sa.jsx)("p",{className:"text-3xl font-bold text-white",children:L((null===S||void 0===S||null===(d=S.currentDay)||void 0===d?void 0:d.tips)||0)})]})]}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Players"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Total Players"}),(0,sa.jsx)("span",{className:"text-white font-semibold",children:A?"...":(null===C||void 0===C||null===(c=C.players)||void 0===c?void 0:c.length)||0})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Pending Approval"}),(0,sa.jsx)("span",{className:"text-yellow-400 font-semibold",children:P?"...":_.length})]}),(0,sa.jsxs)("div",{className:"flex justify-between",children:[(0,sa.jsx)("span",{className:"text-gray-400",children:"Suspended"}),(0,sa.jsx)("span",{className:"text-red-400 font-semibold",children:E?"...":T.length})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,sa.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Quick Actions"}),(0,sa.jsxs)("div",{className:"space-y-2",children:[(0,sa.jsx)("button",{onClick:()=>x("Player Management"),className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white py-2 rounded-lg transition-colors",children:"Manage Players"}),(0,sa.jsxs)("button",{onClick:()=>x("Player Approval"),className:"w-full bg-blue-600 hover:bg-blue-500 text-white py-2 rounded-lg transition-colors",children:["Review Approvals (",P?"...":_.length,")"]}),(0,sa.jsxs)("button",{onClick:()=>x("Player Suspension"),className:"w-full bg-orange-600 hover:bg-orange-500 text-white py-2 rounded-lg transition-colors",children:["Suspended Players (",E?"...":T.length,")"]})]})]})]})]}),"Player Management"===h&&(0,sa.jsx)(ud,{selectedClubId:p,playersData:C,playersLoading:A,pendingPlayers:_,pendingLoading:P,suspendedPlayers:T,suspendedLoading:E,onRefresh:()=>{m.invalidateQueries(["pendingPlayers",p]),m.invalidateQueries(["clubPlayers",p]),m.invalidateQueries(["suspendedPlayers",p])}}),"Tables & Waitlist"===h&&(0,sa.jsx)(xd,{selectedClubId:p}),"Club Buy-In"===h&&(0,sa.jsx)(Eh,{selectedClubId:p}),"Credit Management"===h&&(0,sa.jsx)(Ex,{selectedClubId:p}),"VIP Store"===h&&(0,sa.jsx)(px,{selectedClubId:p}),"Push Notifications"===h&&(0,sa.jsx)(Md,{selectedClubId:p}),"Tournaments"===h&&(0,sa.jsx)(zd,{selectedClubId:p}),"Staff Management"===h&&(0,sa.jsx)(ph,{selectedClubId:p}),"Payroll Management"===h&&(0,sa.jsx)(gx,{selectedClubId:p}),"Bonus Management"===h&&(0,sa.jsx)(Ah,{selectedClubId:p}),"Affiliates"===h&&(0,sa.jsx)(fx,{selectedClubId:p}),"Transactions"===h&&(0,sa.jsx)(Dh,{selectedClubId:p}),"FNB"===h&&p&&(0,sa.jsx)(yx,{clubId:p}),"Chat"===h&&p&&(0,sa.jsx)($u,{clubId:p}),"Reports & Analytics"===h&&p&&(0,sa.jsx)(vx,{clubId:p}),"Audit Logs"===h&&p&&(0,sa.jsx)(Ix,{clubId:p}),"Rummy"===h&&p&&(0,sa.jsx)(mm,{selectedClubId:p}),"Notifications"===h&&p&&(0,sa.jsx)(bm,{selectedClubId:p,recipientType:"staff"}),"System Control"===h&&p&&(0,sa.jsx)(jx,{clubId:p}),"Player Feedback"===h&&p&&(0,sa.jsx)(Dx,{selectedClubId:p}),!["Dashboard","Player Management","Tables & Waitlist","Club Buy-In","Credit Management","VIP Store","Push Notifications","Tournaments","Staff Management","Payroll Management","Bonus Management","Affiliates","Transactions","Player Feedback","FNB","Chat","Reports & Analytics","Audit Logs","Rummy","System Control","Notifications"].includes(h)&&(0,sa.jsx)("div",{className:"text-white",children:(0,sa.jsx)("h1",{className:"text-3xl font-bold mb-6",children:h})})]})]})]}):(0,sa.jsxs)(sa.Fragment,{children:[M,(0,sa.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900 flex items-center justify-center p-8",children:(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-12 text-center border border-slate-700 max-w-2xl w-full",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-6xl mb-6",children:"\ud83c\udfe2"}),(0,sa.jsx)("h2",{className:"text-3xl font-bold text-white mb-4",children:"No Clubs Created Yet"}),(0,sa.jsx)("p",{className:"text-gray-400 text-lg mb-8",children:"You don't have any clubs assigned to you. Please contact the Master Admin to create a club for your tenant."}),(0,sa.jsx)("div",{className:"bg-slate-700 rounded-lg p-6 border border-slate-600 mb-8",children:(0,sa.jsx)("p",{className:"text-sm text-gray-300",children:"\ud83d\udcde Need help? Contact Master Admin to set up your first club and start managing players, tables, and tournaments."})}),(0,sa.jsx)("button",{onClick:O,className:"w-full max-w-xs mx-auto bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg font-semibold transition-colors shadow-lg",children:"Sign Out"})]})})]})}function Dx(e){let{selectedClubId:t}=e;const[s,a]=(0,r.useState)(1),[n,l]=(0,r.useState)("date"),[i,o]=(0,r.useState)("desc"),{data:d,isLoading:c}=hn({queryKey:["playerFeedback",t,s,10],queryFn:()=>jr.Dv.getPlayerFeedback(t,s,10),enabled:!!t,keepPreviousData:!0}),u=(null===d||void 0===d?void 0:d.feedback)||[],m=(null===d||void 0===d?void 0:d.pagination)||{total:0,page:1,totalPages:1},h=[...u].sort((e,t)=>{const s="asc"===i?1:-1;return"date"===n?s*(new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()):"player"===n?s*((null===(a=e.player)||void 0===a?void 0:a.name)||"").localeCompare((null===(r=t.player)||void 0===r?void 0:r.name)||""):0;var a,r}),x=e=>{n===e?o("asc"===i?"desc":"asc"):(l(e),o("desc"))};return(0,sa.jsxs)("div",{className:"text-white space-y-6",children:[(0,sa.jsxs)("div",{className:"flex items-center justify-between",children:[(0,sa.jsx)("h1",{className:"text-3xl font-bold",children:"Player Feedback"}),(0,sa.jsxs)("span",{className:"text-sm text-gray-400",children:[m.total," total feedback",1!==m.total?"s":""]})]}),c?(0,sa.jsxs)("div",{className:"text-center py-16",children:[(0,sa.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),(0,sa.jsx)("p",{className:"text-gray-400",children:"Loading feedback..."})]}):0===u.length?(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-16 border border-slate-700 text-center",children:[(0,sa.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udcac"}),(0,sa.jsx)("p",{className:"text-xl text-gray-300",children:"No feedback submitted yet"}),(0,sa.jsx)("p",{className:"text-gray-500 mt-2",children:"Player feedback will appear here once submitted."})]}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:(0,sa.jsxs)("table",{className:"w-full",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:(0,sa.jsxs)("button",{onClick:()=>x("player"),className:"flex items-center gap-1 hover:text-white transition-colors",children:["Player Name","player"===n&&(0,sa.jsx)("span",{children:"asc"===i?"\u2191":"\u2193"})]})}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Email"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Feedback"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Rating"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:(0,sa.jsxs)("button",{onClick:()=>x("date"),className:"flex items-center gap-1 hover:text-white transition-colors",children:["Date","date"===n&&(0,sa.jsx)("span",{children:"asc"===i?"\u2191":"\u2193"})]})})]})}),(0,sa.jsx)("tbody",{className:"divide-y divide-slate-700",children:h.map(e=>{var t,s;return(0,sa.jsxs)("tr",{className:"hover:bg-slate-700/50 transition-colors",children:[(0,sa.jsx)("td",{className:"px-6 py-4",children:(0,sa.jsx)("span",{className:"font-medium text-white",children:(null===(t=e.player)||void 0===t?void 0:t.name)||"Unknown"})}),(0,sa.jsx)("td",{className:"px-6 py-4 text-sm text-gray-400",children:(null===(s=e.player)||void 0===s?void 0:s.email)||"\u2014"}),(0,sa.jsx)("td",{className:"px-6 py-4 text-sm text-gray-300 max-w-md",children:(0,sa.jsx)("p",{className:"line-clamp-3",children:e.message})}),(0,sa.jsx)("td",{className:"px-6 py-4 text-sm",children:e.rating?(0,sa.jsxs)("span",{className:"text-yellow-400",children:["\u2605".repeat(e.rating),"\u2606".repeat(5-e.rating)]}):(0,sa.jsx)("span",{className:"text-gray-500",children:"\u2014"})}),(0,sa.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-400 whitespace-nowrap",children:[new Date(e.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",day:"2-digit",month:"short",year:"numeric"}),(0,sa.jsx)("br",{}),(0,sa.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour:"2-digit",minute:"2-digit"})})]})]},e.id)})})]})}),m.totalPages>1&&(0,sa.jsxs)("div",{className:"flex items-center justify-between bg-slate-800 rounded-xl p-4 border border-slate-700",children:[(0,sa.jsxs)("span",{className:"text-sm text-gray-400",children:["Page ",m.page," of ",m.totalPages," (",m.total," total)"]}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>a(Math.max(1,s-1)),disabled:s<=1,className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 disabled:opacity-40 disabled:cursor-not-allowed transition-colors text-sm",children:"Previous"}),Array.from({length:Math.min(5,m.totalPages)},(e,t)=>{let r;return r=m.totalPages<=5||s<=3?t+1:s>=m.totalPages-2?m.totalPages-4+t:s-2+t,(0,sa.jsx)("button",{onClick:()=>a(r),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat(s===r?"bg-gradient-to-r from-red-400 to-purple-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600"),children:r},r)}),(0,sa.jsx)("button",{onClick:()=>a(Math.min(m.totalPages,s+1)),disabled:s>=m.totalPages,className:"px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 disabled:opacity-40 disabled:cursor-not-allowed transition-colors text-sm",children:"Next"})]})]})]})]})}function Ox(e){let{activeItem:t,setActiveItem:s,menuItems:a=[],onSignOut:n=null,affiliateCode:l=null}=e;const[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(window.innerWidth<1024),[m,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;u(e),e||d(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(o&&c){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[o,c]);const b=localStorage.getItem("clubId"),{data:g}=hn({queryKey:["club",b],queryFn:()=>jr.Od.getClub(b),enabled:!!b}),f=JSON.parse(localStorage.getItem("user")||"{}"),y=JSON.parse(localStorage.getItem("staffuser")||"{}"),v=f.email||y.email||"affiliate@pokerroom.com",w=f.displayName||y.displayName||"Affiliate",j=l||f.affiliateCode,N=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("staffuser")||"{}");t.userId&&(t.mustResetPassword=!1,localStorage.setItem("staffuser",JSON.stringify(t))),h(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),S=m&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v?x.currentPassword&&x.newPassword&&x.confirmPassword?x.newPassword===x.confirmPassword?x.newPassword.length<8?wr.error("Password must be at least 8 characters"):N.mutate({email:v,currentPassword:x.currentPassword,newPassword:x.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:x.currentPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:x.newPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:x.confirmPassword,onChange:e=>p((0,i.A)((0,i.A)({},x),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:N.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:N.isLoading?"Resetting...":"Reset Password"})]})]})}),document.body);return(0,sa.jsxs)(sa.Fragment,{children:[c&&(0,sa.jsx)("button",{onClick:()=>d(!o),className:"sidebar-toggle fixed top-4 left-4 z-[100] p-2 rounded-md text-white bg-slate-700 lg:hidden",children:(0,sa.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:o?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),(0,sa.jsx)("aside",{className:"sidebar-container fixed inset-y-0 left-0 z-50 w-64 bg-gradient-to-br from-gray-800 to-gray-900 text-white shadow-lg transform ".concat(c&&!o?"-translate-x-full":"translate-x-0"," lg:translate-x-0 transition-transform duration-300 ease-in-out"),children:(0,sa.jsxs)("div",{className:"flex h-full flex-col justify-between",children:[(0,sa.jsxs)("div",{className:"px-6 py-8",children:[(0,sa.jsx)("div",{className:"text-center mb-10",children:(0,sa.jsx)("h1",{className:"text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Affiliate Portal"})}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-4 mb-8 shadow-inner border border-slate-600 cursor-pointer hover:bg-slate-600 transition-colors",onClick:()=>h(!0),children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,sa.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center text-lg font-bold",children:w.charAt(0).toUpperCase()}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"font-semibold text-white",children:w}),(0,sa.jsx)("p",{className:"text-sm text-gray-300",children:"Affiliate"})]})]}),b&&(0,sa.jsxs)("div",{className:"mt-3 pt-3 border-t border-slate-600 space-y-2",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Club Code:"}),(0,sa.jsx)("p",{className:"font-mono text-sm text-yellow-400",children:(null===g||void 0===g?void 0:g.code)||"N/A"})]}),j&&(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Affiliate Code:"}),(0,sa.jsx)("p",{className:"font-mono text-sm text-purple-400",children:j})]})]})]}),(0,sa.jsx)("nav",{className:"space-y-2",children:a.map(e=>(0,sa.jsx)("button",{onClick:()=>{s(e),c&&d(!1)},className:"flex items-center w-full px-4 py-3 rounded-lg text-left font-medium transition-colors duration-200\n                    ".concat(t===e?"bg-purple-600 text-white shadow-md":"text-gray-300 hover:bg-slate-700 hover:text-white"),children:e},e))})]}),(0,sa.jsx)("div",{className:"px-6 pb-8",children:(0,sa.jsxs)("button",{onClick:n,className:"flex items-center justify-center w-full px-4 py-3 rounded-lg font-medium text-red-400 bg-red-900/20 hover:bg-red-900/40 transition-colors duration-200",children:[(0,sa.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})})]})}),S]})}function Lx(){const[e,t]=(0,r.useState)("Referral Players"),s=me(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),d=localStorage.getItem("clubId"),c=JSON.parse(localStorage.getItem("user")||"{}"),u=JSON.parse(localStorage.getItem("staffuser")||"{}"),m=JSON.parse(localStorage.getItem("affiliateuser")||"{}"),[h,x]=(0,r.useState)(null),[p,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(!d)return;const e=c.id||c.userId||u.userId||m.userId;if(e)try{const t=await jr.Yt.getAffiliates(d),s=(null===t||void 0===t?void 0:t.affiliates)||t||[],a=s.find(t=>{var s;if(t.userId===e)return!0;if(t.user_id===e)return!0;if((null===(s=t.user)||void 0===s?void 0:s.id)===e)return!0;if(t.user&&"object"===typeof t.user&&t.user.id===e)return!0;const a=c.email||u.email||m.email;return!(!a||t.email!==a)});if(a){x(a.id),b(a.code);const e=(0,i.A)((0,i.A)({},c),{},{affiliateCode:a.code,affiliateId:a.id});localStorage.setItem("user",JSON.stringify(e))}else if(1===s.length){const e=s[0];x(e.id),b(e.code);const t=(0,i.A)((0,i.A)({},c),{},{affiliateCode:e.code,affiliateId:e.id});localStorage.setItem("user",JSON.stringify(t))}else console.error("Affiliate not found for userId:",e),console.error("Available affiliates:",s.map(e=>({id:e.id,userId:e.userId,user_id:e.user_id,user:e.user?{id:e.user.id,email:e.user.email}:null,code:e.code})))}catch(t){console.error("Error fetching affiliate data:",t)}else console.error("No user ID found")})()},[d,c.id,c.userId,u.userId,m.userId]),(0,r.useEffect)(()=>{(c.mustResetPassword||u.mustResetPassword)&&n(!0)},[]);const g=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=(0,i.A)((0,i.A)({},c),{},{mustResetPassword:!1});localStorage.setItem("user",JSON.stringify(e));const t=(0,i.A)((0,i.A)({},u),{},{mustResetPassword:!1});localStorage.setItem("staffuser",JSON.stringify(t)),n(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),f=a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=c.email||u.email;t?l.currentPassword&&l.newPassword&&l.confirmPassword?l.newPassword===l.confirmPassword?l.newPassword.length<8?wr.error("Password must be at least 8 characters"):g.mutate({email:t,currentPassword:l.currentPassword,newPassword:l.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:l.currentPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:l.newPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:l.confirmPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:g.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:g.isLoading?"Resetting...":"Reset Password"})]})]})}),y=()=>{localStorage.clear(),s("/login")};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white font-sans",children:[(0,sa.jsxs)("div",{className:"flex",children:[(0,sa.jsx)(Ox,{activeItem:e,setActiveItem:t,menuItems:["Referral Players","Transactions"],onSignOut:y,affiliateCode:p}),(0,sa.jsx)("main",{className:"flex-1 lg:ml-0 min-w-0",children:(0,sa.jsxs)("div",{className:"mx-auto max-w-[1400px] px-4 sm:px-6 py-6 sm:py-10 space-y-8",children:[(0,sa.jsxs)("header",{className:"bg-gradient-to-r from-purple-600 via-blue-500 to-indigo-400 p-6 rounded-xl shadow-md flex justify-between items-center mt-16 lg:mt-0",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h1",{className:"text-2xl font-bold text-white",children:["Affiliate Portal - ",e]}),(0,sa.jsx)("p",{className:"text-gray-200 mt-1",children:"Manage your referrals and transactions"})]}),(0,sa.jsx)("button",{onClick:y,className:"bg-red-600 hover:bg-red-500 text-white font-semibold px-4 py-2 rounded-lg shadow",children:"Sign Out"})]}),!d&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view your information."})}),d&&!h&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Loading affiliate information..."})}),"Referral Players"===e&&d&&h&&(0,sa.jsx)(Fx,{clubId:d,affiliateId:h}),"Transactions"===e&&d&&h&&(0,sa.jsx)(Mx,{clubId:d,affiliateId:h})]})})]}),f]})}function Fx(e){let{clubId:t,affiliateId:s}=e;const[a,n]=(0,r.useState)(1),[l,o]=(0,r.useState)({search:"",kycStatus:"",startDate:"",endDate:""}),{data:d,isLoading:c}=hn({queryKey:["affiliate-referrals",t,s,a,l],queryFn:()=>jr.Yt.getAffiliateReferrals(t,s,{search:l.search,kycStatus:l.kycStatus,startDate:l.startDate,endDate:l.endDate}),enabled:!!t&&!!s}),u=e=>"\u20b9".concat((e||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})),m=e=>{const t={pending:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Pending"},approved:{bg:"bg-green-100",text:"text-green-800",label:"Approved"},rejected:{bg:"bg-red-100",text:"text-red-800",label:"Rejected"},verified:{bg:"bg-blue-100",text:"text-blue-800",label:"Verified"}}[null===e||void 0===e?void 0:e.toLowerCase()]||{bg:"bg-gray-100",text:"text-gray-800",label:e||"Unknown"};return(0,sa.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(t.bg," ").concat(t.text),children:t.label})};if(c)return(0,sa.jsx)("div",{className:"text-center py-8",children:"Loading referral players..."});const h=(null===d||void 0===d?void 0:d.players)||[],x=Math.ceil(h.length/10),p=h.slice(10*(a-1),10*a);return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"My Referral Players"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Search by Name/Email"}),(0,sa.jsx)("input",{type:"text",value:l.search,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{search:e.target.value})),placeholder:"Search...",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"KYC Status"}),(0,sa.jsxs)("select",{value:l.kycStatus,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{kycStatus:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"",children:"All"}),(0,sa.jsx)("option",{value:"pending",children:"Pending"}),(0,sa.jsx)("option",{value:"approved",children:"Approved"}),(0,sa.jsx)("option",{value:"rejected",children:"Rejected"}),(0,sa.jsx)("option",{value:"verified",children:"Verified"})]})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"From Date"}),(0,sa.jsx)("input",{type:"date",value:l.startDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"To Date"}),(0,sa.jsx)("input",{type:"date",value:l.endDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{endDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]})]}),(0,sa.jsx)("div",{className:"mb-4 flex justify-end",children:(0,sa.jsx)("button",{onClick:()=>o({search:"",kycStatus:"",startDate:"",endDate:""}),className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg font-semibold",children:"Clear Filters"})}),p.length>0?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"min-w-full divide-y divide-slate-700",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Name"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Email"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Phone"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"KYC Status"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Total Spent"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Commission"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Created"})]})}),(0,sa.jsx)("tbody",{className:"bg-slate-800 divide-y divide-slate-700",children:p.map(e=>{return(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:e.name}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:e.email}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:e.phoneNumber||"-"}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:m(e.kycStatus)}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:u(e.totalSpent||0)}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-semibold",children:u(e.totalCommission||0)}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(t=e.createdAt,t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-")})]},e.id);var t})})]})}),(0,sa.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,sa.jsx)("button",{onClick:()=>n(e=>Math.max(1,e-1)),disabled:1===a,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-gray-300",children:["Page ",a," of ",x||1," (Showing ",p.length," of ",h.length," players)"]}),(0,sa.jsx)("button",{onClick:()=>n(e=>Math.min(x||1,e+1)),disabled:a===(x||1),className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Next"})]})]}):(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No referral players found."})]})}function Mx(e){let{clubId:t,affiliateId:s}=e;const[a,n]=(0,r.useState)(1),[l,o]=(0,r.useState)({search:"",startDate:"",endDate:""}),{data:d,isLoading:c}=hn({queryKey:["affiliate-transactions",t,s,a,l],queryFn:()=>jr.Yt.getAffiliateTransactions(t,(0,i.A)({page:a,limit:10,affiliateId:s},l)),enabled:!!t&&!!s}),u=e=>"\u20b9".concat((e||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}));if(c)return(0,sa.jsx)("div",{className:"text-center py-8",children:"Loading transactions..."});const m=(null===d||void 0===d?void 0:d.transactions)||[],h=(null===d||void 0===d?void 0:d.totalPages)||1;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"My Transactions"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Search"}),(0,sa.jsx)("input",{type:"text",value:l.search,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{search:e.target.value})),placeholder:"Search...",className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:l.startDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:l.endDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{endDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]})]}),(0,sa.jsx)("div",{className:"mb-4 flex justify-end",children:(0,sa.jsx)("button",{onClick:()=>o({search:"",startDate:"",endDate:""}),className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg font-semibold",children:"Clear Filters"})}),m.length>0?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"min-w-full divide-y divide-slate-700",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Type"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Amount"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Notes"})]})}),(0,sa.jsx)("tbody",{className:"bg-slate-800 divide-y divide-slate-700",children:m.map(e=>{return(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:e.type||"Payment"}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-semibold",children:u(e.amount||0)}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(t=e.date||e.createdAt,t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-")}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,sa.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("Completed"===e.status||"Paid"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.status||"Pending"})}),(0,sa.jsx)("td",{className:"px-6 py-4 text-sm text-gray-300",children:e.notes||e.description||"-"})]},e.id);var t})})]})}),(0,sa.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,sa.jsx)("button",{onClick:()=>n(e=>Math.max(1,e-1)),disabled:1===a,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-gray-300",children:["Page ",a," of ",h]}),(0,sa.jsx)("button",{onClick:()=>n(e=>Math.min(h,e+1)),disabled:a===h,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Next"})]})]}):(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No transactions found."})]})}function Bx(e){let{activeItem:t,setActiveItem:s,menuItems:a=[],onSignOut:n=null}=e;const[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(window.innerWidth<1024),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),p=(0,r.useRef)(null),b=(0,r.useRef)(null),g=(0,r.useRef)(null),f=(0,r.useRef)(null),y=localStorage.getItem("clubId");od(y);const{data:v}=hn({queryKey:["unreadNotificationCount",y,"staff"],queryFn:()=>jr.Dv.getUnreadNotificationCount(y,"staff"),enabled:!!y}),{data:w}=hn({queryKey:["myApprovedLeaves",y],queryFn:()=>jr.ie.getMyLeaveApplications(y,{status:"Approved"}),enabled:!!y}),j=(null===w||void 0===w?void 0:w.total)||0,{data:N}=hn({queryKey:["unreadChatCounts",y],queryFn:()=>jr.h2.getUnreadCounts(y),enabled:!!y}),S=((null===N||void 0===N?void 0:N.staffChats)||0)+((null===N||void 0===N?void 0:N.playerChats)||0);(0,r.useEffect)(()=>{const e=(null===v||void 0===v?void 0:v.unreadCount)||0;if(null!==p.current&&e>p.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}p.current=e},[null===v||void 0===v?void 0:v.unreadCount]),(0,r.useEffect)(()=>{if(null!==b.current&&j>b.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e)),wr.success("\ud83c\udf89 Your leave request has been approved!",{duration:5e3})}b.current=j},[j]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.staffChats)||0;if(null!==g.current&&e>g.current){const e=new Audio("/audio/popup-alert.mp3");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}g.current=e},[null===N||void 0===N?void 0:N.staffChats]),(0,r.useEffect)(()=>{const e=(null===N||void 0===N?void 0:N.playerChats)||0;if(null!==f.current&&e>f.current){const e=new Audio("/audio/notification-alert-2.wav");e.volume=.5,e.play().catch(e=>console.log("Audio play failed:",e))}f.current=e},[null===N||void 0===N?void 0:N.playerChats]),(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth<1024;c(e),e||o(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(l&&d){const e=e=>{e.target.closest(".sidebar-container")||e.target.closest(".sidebar-toggle")||o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[l,d]);const{data:k}=hn({queryKey:["club",y],queryFn:()=>jr.Od.getClub(y),enabled:!!y}),C=JSON.parse(localStorage.getItem("user")||"{}"),A=JSON.parse(localStorage.getItem("staffuser")||"{}"),_=C.email||A.email||"dealer@pokerroom.com",P=C.displayName||A.displayName||"Dealer",T=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=JSON.parse(localStorage.getItem("user")||"{}");e.mustResetPassword=!1,localStorage.setItem("user",JSON.stringify(e));const t=JSON.parse(localStorage.getItem("staffuser")||"{}");t.userId&&(t.mustResetPassword=!1,localStorage.setItem("staffuser",JSON.stringify(t))),m(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),E=u&&(0,fn.createPortal)((0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault(),_?h.currentPassword&&h.newPassword&&h.confirmPassword?h.newPassword===h.confirmPassword?h.newPassword.length<8?wr.error("Password must be at least 8 characters"):T.mutate({email:_,currentPassword:h.currentPassword,newPassword:h.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:h.currentPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:h.newPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:h.confirmPassword,onChange:e=>x((0,i.A)((0,i.A)({},h),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:T.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:T.isLoading?"Resetting...":"Reset Password"})]})]})}),document.body);return(0,sa.jsxs)(sa.Fragment,{children:[d&&(0,sa.jsx)("button",{onClick:()=>o(!l),className:"sidebar-toggle fixed top-4 left-4 z-[100] p-2 rounded-md text-white bg-slate-700 lg:hidden",children:(0,sa.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:l?(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"}):(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),(0,sa.jsx)("aside",{className:"sidebar-container fixed inset-y-0 left-0 z-50 w-64 bg-gradient-to-br from-gray-800 to-gray-900 text-white shadow-lg transform ".concat(d&&!l?"-translate-x-full":"translate-x-0"," lg:translate-x-0 transition-transform duration-300 ease-in-out"),children:(0,sa.jsxs)("div",{className:"flex h-full flex-col justify-between",children:[(0,sa.jsxs)("div",{className:"px-6 py-8",children:[(0,sa.jsx)("div",{className:"text-center mb-10",children:(0,sa.jsx)("h1",{className:"text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Dealer Portal"})}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-xl p-4 mb-8 shadow-inner border border-slate-600 cursor-pointer hover:bg-slate-600 transition-colors",onClick:()=>m(!0),children:[(0,sa.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,sa.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center text-lg font-bold",children:P.charAt(0).toUpperCase()}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("p",{className:"font-semibold text-white",children:P}),(0,sa.jsx)("p",{className:"text-sm text-gray-300",children:"Dealer"})]})]}),y&&(0,sa.jsxs)("div",{className:"mt-3 pt-3 border-t border-slate-600",children:[(0,sa.jsx)("p",{className:"text-xs text-gray-400",children:"Club Code:"}),(0,sa.jsx)("p",{className:"font-mono text-sm text-yellow-400",children:(null===k||void 0===k?void 0:k.code)||"N/A"})]})]}),(0,sa.jsx)("nav",{className:"space-y-2",children:a.map(e=>(0,sa.jsx)("button",{onClick:()=>{s(e),d&&o(!1)},className:"flex items-center w-full px-4 py-3 rounded-lg text-left font-medium transition-colors duration-200\n                    ".concat(t===e?"bg-purple-600 text-white shadow-md":"text-gray-300 hover:bg-slate-700 hover:text-white"),children:(0,sa.jsxs)("span",{className:"flex items-center justify-between w-full",children:[(0,sa.jsx)("span",{children:e}),"Notifications"===e&&(null===v||void 0===v?void 0:v.unreadCount)>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:v.unreadCount>9?"9+":v.unreadCount}),"Chat"===e&&S>0&&(0,sa.jsx)("span",{className:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse flex-shrink-0",children:S>9?"9+":S})]})},e))})]}),(0,sa.jsx)("div",{className:"px-6 pb-8",children:(0,sa.jsxs)("button",{onClick:n,className:"flex items-center justify-center w-full px-4 py-3 rounded-lg font-medium text-red-400 bg-red-900/20 hover:bg-red-900/40 transition-colors duration-200",children:[(0,sa.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,sa.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})})]})}),E]})}function qx(){const[e,t]=(0,r.useState)("Shift Timings"),s=me(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),d=localStorage.getItem("clubId"),c=JSON.parse(localStorage.getItem("user")||"{}"),u=JSON.parse(localStorage.getItem("staffuser")||"{}"),[m,h]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(d&&c.email)try{const e=await jr.staffAPI.getAllStaffMembers(d),t=((null===e||void 0===e?void 0:e.staff)||e||[]).find(e=>e.email===c.email&&"Dealer"===e.role);t&&h(t.id)}catch(e){console.error("Error fetching dealer data:",e)}})()},[d,c.email]),(0,r.useEffect)(()=>{(c.mustResetPassword||u.mustResetPassword)&&n(!0)},[]);const x=gn({mutationFn:async e=>{const t=await fetch("".concat("http://localhost:3333/api","/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to reset password")}return t.json()},onSuccess:()=>{wr.success("Password reset successfully!");const e=(0,i.A)((0,i.A)({},c),{},{mustResetPassword:!1});localStorage.setItem("user",JSON.stringify(e));const t=(0,i.A)((0,i.A)({},u),{},{mustResetPassword:!1});localStorage.setItem("staffuser",JSON.stringify(t)),n(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})},onError:e=>{wr.error(e.message||"Failed to reset password")}}),p=a&&(0,sa.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200]",children:(0,sa.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-8 max-w-md w-full border border-emerald-600 shadow-2xl max-h-[85vh] overflow-y-auto",children:[(0,sa.jsxs)("div",{className:"text-center mb-6",children:[(0,sa.jsx)("div",{className:"text-yellow-400 text-5xl mb-3",children:"\ud83d\udd12"}),(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Password Reset Required"}),(0,sa.jsx)("p",{className:"text-gray-400 mt-2",children:"Please set a new password to continue"})]}),(0,sa.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=c.email||u.email;t?l.currentPassword&&l.newPassword&&l.confirmPassword?l.newPassword===l.confirmPassword?l.newPassword.length<8?wr.error("Password must be at least 8 characters"):x.mutate({email:t,currentPassword:l.currentPassword,newPassword:l.newPassword}):wr.error("New passwords do not match"):wr.error("All fields are required"):wr.error("User email not found. Please login again.")},className:"space-y-4",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Password"}),(0,sa.jsx)("input",{type:"password",value:l.currentPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{currentPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter temporary password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,sa.jsx)("input",{type:"password",value:l.newPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{newPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter new password",required:!0})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,sa.jsx)("input",{type:"password",value:l.confirmPassword,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{confirmPassword:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Confirm new password",required:!0})]}),(0,sa.jsx)("button",{type:"submit",disabled:x.isLoading,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50",children:x.isLoading?"Resetting...":"Reset Password"})]})]})}),b=()=>{localStorage.clear(),s("/login")};return(0,sa.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white font-sans",children:[(0,sa.jsxs)("div",{className:"flex",children:[(0,sa.jsx)(Bx,{activeItem:e,setActiveItem:t,menuItems:["Shift Timings","Notifications","Transactions","Tips","Tip Settings","Leave Management","Chat"],onSignOut:b}),(0,sa.jsx)("main",{className:"flex-1 lg:ml-0 min-w-0",children:(0,sa.jsxs)("div",{className:"mx-auto max-w-[1400px] px-4 sm:px-6 py-6 sm:py-10 space-y-8",children:[(0,sa.jsxs)("header",{className:"bg-gradient-to-r from-purple-600 via-blue-500 to-indigo-400 p-6 rounded-xl shadow-md flex justify-between items-center mt-16 lg:mt-0",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsxs)("h1",{className:"text-2xl font-bold text-white",children:["Dealer Portal - ",e]}),(0,sa.jsx)("p",{className:"text-gray-200 mt-1",children:"Manage your shifts, tips, and transactions"})]}),(0,sa.jsx)("button",{onClick:b,className:"bg-red-600 hover:bg-red-500 text-white font-semibold px-4 py-2 rounded-lg shadow",children:"Sign Out"})]}),!d&&(0,sa.jsx)("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-yellow-100",children:(0,sa.jsx)("p",{className:"font-medium",children:"Please select a club to view your information."})}),"Shift Timings"===e&&d&&m&&(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsx)(fm,{selectedClubId:d}),(0,sa.jsx)(Ux,{clubId:d,dealerId:m})]}),"Transactions"===e&&d&&m&&(0,sa.jsx)(zx,{clubId:d,dealerId:m}),"Tips"===e&&d&&m&&(0,sa.jsx)(Kx,{clubId:d,dealerId:m}),"Tip Settings"===e&&d&&m&&(0,sa.jsx)(Wx,{clubId:d,dealerId:m}),"Chat"===e&&d&&(0,sa.jsx)($u,{clubId:d,hidePlayerChat:!0}),"Notifications"===e&&d&&(0,sa.jsx)(bm,{selectedClubId:d,recipientType:"staff"}),"Leave Management"===e&&d&&(0,sa.jsx)(nh,{clubId:d,userRole:"DEALER"})]})})]}),p]})}function Ux(e){let{clubId:t,dealerId:s}=e;const[a,n]=(0,r.useState)(new Date),[l,i]=(0,r.useState)("week"),o=()=>{const e=new Date(a),t=new Date(a);if("week"===l){const s=e.getDay(),a=e.getDate()-s+(0===s?-6:1);e.setDate(a),t.setDate(e.getDate()+6)}else e.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0);return{startDate:e.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0]}},{data:d,isLoading:c}=hn({queryKey:["shifts",t,s,a,l],queryFn:()=>{const{startDate:e,endDate:a}=o();return jr.iw.getShifts(t,{startDate:e,endDate:a,staffId:s})},enabled:!!t&&!!s}),u=e=>{const t=new Date(a);"week"===l?t.setDate(t.getDate()+7*e):t.setMonth(t.getMonth()+e),n(t)},m=(null===d||void 0===d?void 0:d.shifts)||[],h=()=>{const e=[],{startDate:t}=o(),s=new Date(t);for(let a=0;a<7;a++){const t=new Date(s);t.setDate(s.getDate()+a),e.push(t)}return e},x=e=>new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"}),p=e=>e.toLocaleDateString("en-IN",{weekday:"short",month:"short",day:"numeric",timeZone:"Asia/Kolkata"});return c?(0,sa.jsx)("div",{className:"text-white text-center py-8",children:"Loading shifts..."}):(0,sa.jsxs)("div",{className:"space-y-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4 flex items-center justify-between",children:[(0,sa.jsx)("button",{onClick:()=>u(-1),className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"\u2190 Previous"}),(0,sa.jsxs)("div",{className:"flex items-center gap-4",children:[(0,sa.jsx)("h2",{className:"text-xl font-bold text-white",children:a.toLocaleDateString("en-IN",{month:"long",year:"numeric",timeZone:"Asia/Kolkata"})}),(0,sa.jsx)("button",{onClick:()=>n(new Date),className:"bg-slate-700 hover:bg-slate-600 text-white px-3 py-1 rounded-lg text-sm transition-colors",children:"Today"}),(0,sa.jsxs)("div",{className:"flex gap-2",children:[(0,sa.jsx)("button",{onClick:()=>i("week"),className:"px-4 py-2 rounded-lg text-sm font-semibold transition-colors ".concat("week"===l?"bg-purple-600 text-white":"bg-slate-700 text-gray-300"),children:"Week"}),(0,sa.jsx)("button",{onClick:()=>i("month"),className:"px-4 py-2 rounded-lg text-sm font-semibold transition-colors ".concat("month"===l?"bg-purple-600 text-white":"bg-slate-700 text-gray-300"),children:"Month"})]})]}),(0,sa.jsx)("button",{onClick:()=>u(1),className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Next \u2192"})]}),"week"===l?(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg overflow-hidden",children:(0,sa.jsxs)("div",{className:"grid grid-cols-8 gap-px bg-slate-700",children:[(0,sa.jsx)("div",{className:"bg-slate-900 p-3 text-white font-semibold",children:"Date"}),h().map(e=>(0,sa.jsx)("div",{className:"bg-slate-900 p-3 text-white font-semibold text-center",children:p(e)},e.toISOString())),(0,sa.jsx)("div",{className:"bg-slate-800 p-3 text-gray-300",children:"Shifts"}),h().map(e=>{const t=(e=>{const t=e.toISOString().split("T")[0];return m.filter(e=>new Date(e.shiftDate).toISOString().split("T")[0]===t)})(e);return(0,sa.jsx)("div",{className:"bg-slate-800 p-3 min-h-[100px]",children:t.length>0?(0,sa.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,sa.jsxs)("div",{className:"bg-purple-600/20 border border-purple-500/50 rounded p-2 text-sm",children:[(0,sa.jsxs)("div",{className:"text-purple-300 font-semibold",children:[x(e.shiftStartTime)," - ",x(e.shiftEndTime)]}),e.isOffDay&&(0,sa.jsx)("div",{className:"text-gray-400 text-xs mt-1",children:"Off Day"}),e.notes&&(0,sa.jsx)("div",{className:"text-gray-400 text-xs mt-1",children:e.notes})]},e.id))}):(0,sa.jsx)("div",{className:"text-gray-500 text-sm text-center",children:"No shifts"})},e.toISOString())})]})}):(0,sa.jsx)("div",{className:"bg-slate-800 rounded-lg p-6",children:(0,sa.jsxs)("div",{className:"space-y-4",children:[m.map(e=>(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4 flex justify-between items-center",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("div",{className:"text-white font-semibold",children:new Date(e.shiftDate).toLocaleDateString("en-IN",{weekday:"long",timeZone:"Asia/Kolkata",year:"numeric",month:"long",day:"numeric"})}),(0,sa.jsxs)("div",{className:"text-gray-300 text-sm mt-1",children:[x(e.shiftStartTime)," - ",x(e.shiftEndTime)]}),e.notes&&(0,sa.jsx)("div",{className:"text-gray-400 text-xs mt-1",children:e.notes})]}),e.isOffDay&&(0,sa.jsx)("span",{className:"bg-yellow-600 text-white px-3 py-1 rounded-full text-xs font-semibold",children:"Off Day"})]},e.id)),0===m.length&&(0,sa.jsx)("div",{className:"text-center text-gray-400 py-8",children:"No shifts scheduled for this period"})]})})]})}function zx(e){let{clubId:t,dealerId:s}=e;const[a,n]=(0,r.useState)(1),[l,o]=(0,r.useState)({startDate:"",endDate:""}),{data:d,isLoading:c}=hn({queryKey:["dealer-transactions",t,s,a,l],queryFn:async()=>{const e=await jr.bM.getAllTransactions(t,{category:"staff",subCategory:"dealer-cashout",page:a,limit:10}),r=await jr.oA.getSalaryPayments(t,(0,i.A)({page:a,limit:10,staffId:s},l)),n=await jr.KG.getStaffBonuses(t,(0,i.A)({page:a,limit:10,staffId:s},l)),o=[...e.transactions||[],...(r.payments||[]).map(e=>({id:e.id,type:"Salary Payment",amount:e.netAmount,date:e.paymentDate||e.createdAt,status:e.status,notes:e.notes})),...(n.bonuses||[]).map(e=>({id:e.id,type:"Staff Bonus",amount:e.bonusAmount,date:e.processedAt||e.createdAt,status:"Completed",notes:e.reason}))].sort((e,t)=>new Date(t.date)-new Date(e.date));return{transactions:o.slice(10*(a-1),10*a),total:o.length,totalPages:Math.ceil(o.length/10)}},enabled:!!t&&!!s}),u=e=>"\u20b9".concat((e||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}));if(c)return(0,sa.jsx)("div",{className:"text-center py-8",children:"Loading transactions..."});const m=(null===d||void 0===d?void 0:d.transactions)||[],h=(null===d||void 0===d?void 0:d.totalPages)||1;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"My Transactions"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:l.startDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:l.endDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{endDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsx)("div",{className:"flex items-end",children:(0,sa.jsx)("button",{onClick:()=>o({startDate:"",endDate:""}),className:"w-full bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg font-semibold",children:"Clear Filters"})})]}),m.length>0?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"min-w-full divide-y divide-slate-700",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Type"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Amount"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Notes"})]})}),(0,sa.jsx)("tbody",{className:"bg-slate-800 divide-y divide-slate-700",children:m.map(e=>{return(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:e.type}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-semibold",children:u(e.amount)}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(t=e.date,t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-")}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,sa.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("Completed"===e.status||"PROCESSED"===e.status||"Paid"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.status})}),(0,sa.jsx)("td",{className:"px-6 py-4 text-sm text-gray-300",children:e.notes||"-"})]},e.id);var t})})]})}),(0,sa.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,sa.jsx)("button",{onClick:()=>n(e=>Math.max(1,e-1)),disabled:1===a,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-gray-300",children:["Page ",a," of ",h]}),(0,sa.jsx)("button",{onClick:()=>n(e=>Math.min(h,e+1)),disabled:a===h,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Next"})]})]}):(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No transactions found."})]})}function Kx(e){let{clubId:t,dealerId:s}=e;const[a,n]=(0,r.useState)(1),[l,o]=(0,r.useState)({startDate:"",endDate:"",status:""}),{data:d,isLoading:c}=hn({queryKey:["dealer-tips",t,s,a,l],queryFn:()=>jr.oA.getDealerTips(t,(0,i.A)({page:a,limit:10,dealerId:s},l)),enabled:!!t&&!!s}),u=e=>"\u20b9".concat((e||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}));if(c)return(0,sa.jsx)("div",{className:"text-center py-8",children:"Loading tips..."});const m=(null===d||void 0===d?void 0:d.tips)||[],h=(null===d||void 0===d?void 0:d.totalPages)||1;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"My Tips"}),(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),(0,sa.jsx)("input",{type:"date",value:l.startDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{startDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),(0,sa.jsx)("input",{type:"date",value:l.endDate,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{endDate:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg"})]}),(0,sa.jsxs)("div",{children:[(0,sa.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),(0,sa.jsxs)("select",{value:l.status,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{status:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg",children:[(0,sa.jsx)("option",{value:"",children:"All"}),(0,sa.jsx)("option",{value:"Pending",children:"Pending"}),(0,sa.jsx)("option",{value:"Processed",children:"Processed"}),(0,sa.jsx)("option",{value:"Paid",children:"Paid"})]})]}),(0,sa.jsx)("div",{className:"flex items-end",children:(0,sa.jsx)("button",{onClick:()=>o({startDate:"",endDate:"",status:""}),className:"w-full bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg font-semibold",children:"Clear Filters"})})]}),m.length>0?(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("div",{className:"overflow-x-auto",children:(0,sa.jsxs)("table",{className:"min-w-full divide-y divide-slate-700",children:[(0,sa.jsx)("thead",{className:"bg-slate-700",children:(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Date"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Total Tips"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"My Share"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Share %"}),(0,sa.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Status"})]})}),(0,sa.jsx)("tbody",{className:"bg-slate-800 divide-y divide-slate-700",children:m.map(e=>{return(0,sa.jsxs)("tr",{children:[(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(t=e.tipDate,t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"Asia/Kolkata"}):"-")}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-semibold",children:u(e.totalTips)}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-semibold",children:u(e.dealerShareAmount)}),(0,sa.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:[e.dealerSharePercentage,"%"]}),(0,sa.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,sa.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("Paid"===e.status?"bg-green-100 text-green-800":"Processed"===e.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:e.status})})]},e.id);var t})})]})}),(0,sa.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,sa.jsx)("button",{onClick:()=>n(e=>Math.max(1,e-1)),disabled:1===a,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Previous"}),(0,sa.jsxs)("span",{className:"text-gray-300",children:["Page ",a," of ",h]}),(0,sa.jsx)("button",{onClick:()=>n(e=>Math.min(h,e+1)),disabled:a===h,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg disabled:opacity-50",children:"Next"})]})]}):(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No tips found."})]})}function Wx(e){let{clubId:t,dealerId:s}=e;const{data:a,isLoading:r}=hn({queryKey:["tip-settings",t,s],queryFn:()=>jr.oA.getTipSettings(t,s),enabled:!!t&&!!s});if(r)return(0,sa.jsx)("div",{className:"text-center py-8",children:"Loading tip settings..."});const n=(null===a||void 0===a?void 0:a.settings)||a;return(0,sa.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 shadow-xl",children:[(0,sa.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"My Tip Settings"}),(0,sa.jsx)("div",{className:"bg-blue-900/20 border border-blue-500/50 rounded-lg p-4 mb-6",children:(0,sa.jsx)("p",{className:"text-blue-300 text-sm",children:"\ud83d\udca1 These settings are configured by the administrator. Contact your manager if you need changes."})}),n?(0,sa.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Tip Distribution"}),(0,sa.jsxs)("div",{className:"space-y-3",children:[(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Club Hold:"}),(0,sa.jsxs)("span",{className:"text-white font-semibold",children:[n.clubHoldPercentage||15,"%"]})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"My Share:"}),(0,sa.jsxs)("span",{className:"text-green-400 font-semibold",children:[n.dealerSharePercentage||85,"%"]})]}),(0,sa.jsxs)("div",{className:"flex justify-between items-center",children:[(0,sa.jsx)("span",{className:"text-gray-300",children:"Floor Manager:"}),(0,sa.jsxs)("span",{className:"text-white font-semibold",children:[n.floorManagerPercentage||5,"%"]})]})]})]}),(0,sa.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4",children:[(0,sa.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Settings Info"}),(0,sa.jsx)("div",{className:"space-y-3",children:(0,sa.jsxs)("div",{children:[(0,sa.jsx)("span",{className:"text-gray-300 text-sm",children:"Last Updated:"}),(0,sa.jsx)("p",{className:"text-white",children:n.updatedAt?new Date(n.updatedAt).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata"}):"N/A"})]})})]})]}):(0,sa.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No tip settings found."})]})}function Hx(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).join(" ")}const Vx=r.forwardRef((e,t)=>{let{id:s,name:a,value:n,defaultValue:l,onChange:o,options:d=[],placeholder:c="Select an option",disabled:u=!1,className:m="",dropdownPlacement:h,size:x="md",fullWidth:p=!0,renderValue:b,renderOption:g,ariaLabel:f,ariaDescribedBy:y,allowSearch:v=!1,searchPlaceholder:w="Search\u2026",emptyState:j="No matches found",children:N}=e;const S=(0,r.useRef)(null),k=(0,r.useRef)(null),C=(0,r.useRef)(null),[A,_]=(0,r.useState)(!1),[P,T]=(0,r.useState)(!1),[E,I]=(0,r.useState)(""),R=void 0!==n,[D,O]=(0,r.useState)(null!==l&&void 0!==l?l:""),L=R?n:D,F=(0,r.useMemo)(()=>N?r.Children.toArray(N).filter(e=>r.isValidElement(e)&&("option"===e.type||"optgroup"===e.type)).flatMap((e,t)=>{var s,a,n,l,i,o,d,c,u;if("optgroup"===e.type){const s=e.props.label;return r.Children.toArray(e.props.children||[]).map((e,a)=>{var r,n,l,i,o,d,c,u,m;return{group:s,value:null!==(r=null!==(n=null===(l=e.props)||void 0===l?void 0:l.value)&&void 0!==n?n:null===(i=e.props)||void 0===i?void 0:i.children)&&void 0!==r?r:"option-".concat(t,"-").concat(a),label:null!==(o=null!==(d=null===(c=e.props)||void 0===c?void 0:c.children)&&void 0!==d?d:null===(u=e.props)||void 0===u?void 0:u.value)&&void 0!==o?o:"",disabled:null===(m=e.props)||void 0===m?void 0:m.disabled}})}return{value:null!==(s=null!==(a=null===(n=e.props)||void 0===n?void 0:n.value)&&void 0!==a?a:null===(l=e.props)||void 0===l?void 0:l.children)&&void 0!==s?s:"option-".concat(t),label:null!==(i=null!==(o=null===(d=e.props)||void 0===d?void 0:d.children)&&void 0!==o?o:null===(c=e.props)||void 0===c?void 0:c.value)&&void 0!==i?i:"",disabled:null===(u=e.props)||void 0===u?void 0:u.disabled}}):[],[N]),M=(0,r.useMemo)(()=>(d.length?d:F).map((e,t)=>{var s,a,r,n,l;return(0,i.A)((0,i.A)({},e),{},{key:null!==(s=e.value)&&void 0!==s?s:t.toString(),label:null!==(a=null!==(r=e.label)&&void 0!==r?r:e.value)&&void 0!==a?a:"",value:null!==(n=null!==(l=e.value)&&void 0!==l?l:e.label)&&void 0!==n?n:"option-".concat(t)})}),[d,F]),B=(0,r.useMemo)(()=>{if(!v||!E.trim())return M;const e=E.toLowerCase();return M.filter(t=>{var s,a,r;const n=String(null!==(s=t.label)&&void 0!==s?s:""),l=String(null!==(a=t.value)&&void 0!==a?a:""),i=String(null!==(r=t.description)&&void 0!==r?r:"");return n.toLowerCase().includes(e)||l.toLowerCase().includes(e)||i.toLowerCase().includes(e)})},[M,v,E]),q=M.find(e=>e.value===L),U=null!==h&&void 0!==h?h:"bottom";(0,r.useEffect)(()=>{function e(e){S.current&&!S.current.contains(e.target)&&_(!1)}return A?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[A]),(0,r.useEffect)(()=>{!A&&v&&I("")},[A,v]);const z=e=>{var t;if(!e.disabled){if(R||O(e.value),o){const t={target:{value:e.value,name:a},currentTarget:{value:e.value,name:a},value:e.value,option:e,preventDefault:()=>{},stopPropagation:()=>{}};o(t,e)}_(!1),null===(t=k.current)||void 0===t||t.focus()}};return(0,sa.jsxs)("div",{ref:S,className:Hx("relative select-none text-white",p&&"w-full",m),children:[(0,sa.jsxs)("button",{id:s,ref:k,name:a,type:"button",className:Hx("flex items-center justify-between gap-3 rounded-lg border bg-white/5 px-3 py-2 transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","sm"===x?"py-1.5 text-sm":"py-2 text-sm",u?"cursor-not-allowed border-white/10 text-white/40":P?"border-white/40 bg-white/10":"border-white/15 hover:border-white/35 hover:bg-white/10"),"aria-haspopup":"listbox","aria-expanded":A,"aria-label":f,"aria-describedby":y,disabled:u,onClick:()=>_(e=>!e),onKeyDown:e=>{if(!u)switch(e.key){case" ":case"Enter":case"ArrowUp":case"ArrowDown":if(e.preventDefault(),A){if("ArrowUp"===e.key||"ArrowDown"===e.key){const t=B.findIndex(e=>e.value===L);let s="ArrowDown"===e.key?Math.min(t+1,B.length-1):Math.max(t-1,0);-1===t&&(s="ArrowDown"===e.key?0:B.length-1);const a=B[s];a&&!a.disabled&&z(a)}}else _(!0);break;case"Escape":A&&(e.preventDefault(),_(!1))}},onFocus:()=>T(!0),onBlur:()=>T(!1),children:[(0,sa.jsx)("div",{className:"flex-1 text-left truncate",children:q?b?b(q):(0,sa.jsx)("span",{className:"font-medium text-white",children:q.label}):(0,sa.jsx)("span",{className:"text-gray-400",children:c})}),(0,sa.jsx)("svg",{className:Hx("h-4 w-4 flex-shrink-0 text-gray-300 transition-transform",A?"rotate-180":"rotate-0"),viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,sa.jsx)("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z",clipRule:"evenodd"})})]}),A&&(0,sa.jsxs)("div",{ref:C,role:"listbox",tabIndex:-1,className:Hx("absolute z-40 mt-1 max-h-56 overflow-y-auto rounded-lg border border-white/10 bg-gray-900/95 shadow-xl backdrop-blur-sm","top"===U?"bottom-full mb-2":"top-full"),children:[v&&(0,sa.jsx)("div",{className:"p-3 border-b border-white/10",children:(0,sa.jsx)("input",{autoFocus:!0,type:"text",value:E,onChange:e=>I(e.target.value),placeholder:w,className:"w-full rounded-md border border-white/15 bg-white/5 px-3 py-2 text-sm text-white placeholder:text-gray-500 focus:border-white/40 focus:outline-none focus:ring-0"})}),(0,sa.jsxs)("ul",{className:"py-1",children:[0===B.length&&(0,sa.jsx)("li",{className:"px-3 py-6 text-center text-sm text-gray-400",children:j}),B.map(e=>{const t=e.value===L,s=Hx("flex flex-col gap-1 px-3 py-2 cursor-pointer transition text-sm",e.disabled?"cursor-not-allowed text-gray-500":t?"bg-white/15 border-l-2 border-emerald-400 text-white":"text-gray-200 hover:bg-white/10");return(0,sa.jsx)("li",{role:"option","aria-selected":t,className:s,onClick:()=>z(e),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),z(e))},children:g?g(e,{isSelected:t}):(0,sa.jsxs)(sa.Fragment,{children:[(0,sa.jsx)("span",{className:"font-medium",children:e.label}),e.description&&(0,sa.jsx)("span",{className:"text-xs text-gray-400",children:e.description})]})},e.key)})]})]})]})});Vx.displayName="CustomSelect";const Jx=new ta({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:3e5}}});const Qx=function(){return(0,sa.jsx)(na,{client:Jx,children:(0,sa.jsx)(ut,{children:(0,sa.jsxs)("div",{className:"App",children:[(0,sa.jsx)(vr,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#1e293b",color:"#fff",border:"1px solid #334155"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}}),(0,sa.jsxs)(Ie,{children:[(0,sa.jsx)(Te,{path:"/login",element:(0,sa.jsx)(mx,{})}),(0,sa.jsx)(Te,{path:"/master-admin/signin",element:(0,sa.jsx)(Sx,{})}),(0,sa.jsx)(Te,{path:"/super-admin/signin",element:(0,sa.jsx)(_x,{})}),(0,sa.jsx)(Te,{path:"/gre/signin",element:(0,sa.jsx)(Pe,{to:"/login",replace:!0})}),(0,sa.jsx)(Te,{path:"/hr/signin",element:(0,sa.jsx)(Pe,{to:"/login",replace:!0})}),(0,sa.jsx)(Te,{path:"/cashier/signin",element:(0,sa.jsx)(Pe,{to:"/login",replace:!0})}),(0,sa.jsx)(Te,{path:"/fnb/signin",element:(0,sa.jsx)(Pe,{to:"/login",replace:!0})}),(0,sa.jsx)(Te,{path:"/admin/signin",element:(0,sa.jsx)(Pe,{to:"/login",replace:!0})}),(0,sa.jsx)(Te,{path:"/gre",element:(0,sa.jsx)(Sr,{requiredRole:"GRE",children:(0,sa.jsx)(dh,{})})}),(0,sa.jsx)(Te,{path:"/hr",element:(0,sa.jsx)(Sr,{requiredRole:"HR",children:(0,sa.jsx)(yh,{})})}),(0,sa.jsx)(Te,{path:"/cashier",element:(0,sa.jsx)(Sr,{requiredRole:"CASHIER",children:(0,sa.jsx)(Bh,{})})}),(0,sa.jsx)(Te,{path:"/fnb",element:(0,sa.jsx)(Sr,{requiredRole:"FNB",children:(0,sa.jsx)(lx,{})})}),(0,sa.jsx)(Te,{path:"/admin",element:(0,sa.jsx)(Sr,{requiredRole:"ADMIN",children:(0,sa.jsx)(Nx,{})})}),(0,sa.jsx)(Te,{path:"/master-admin",element:(0,sa.jsx)(Sr,{requiredRole:"MASTER_ADMIN",children:(0,sa.jsx)(Ax,{})})}),(0,sa.jsx)(Te,{path:"/super-admin",element:(0,sa.jsx)(Sr,{requiredRole:"SUPER_ADMIN",children:(0,sa.jsx)(Rx,{})})}),(0,sa.jsx)(Te,{path:"/manager",element:(0,sa.jsx)(Sr,{requiredRole:"MANAGER",children:(0,sa.jsx)(ym,{})})}),(0,sa.jsx)(Te,{path:"/staff",element:(0,sa.jsx)(Sr,{requiredRole:"STAFF",children:(0,sa.jsx)(ox,{})})}),(0,sa.jsx)(Te,{path:"/dealer",element:(0,sa.jsx)(Sr,{requiredRole:"DEALER",children:(0,sa.jsx)(qx,{})})}),(0,sa.jsx)(Te,{path:"/affiliate",element:(0,sa.jsx)(Sr,{requiredRole:"AFFILIATE",children:(0,sa.jsx)(Lx,{})})}),(0,sa.jsx)(Te,{path:"/404",element:(0,sa.jsx)(kr,{})}),(0,sa.jsx)(Te,{path:"/",element:(0,sa.jsx)(Pe,{to:"/manager",replace:!0})}),(0,sa.jsx)(Te,{path:"*",element:(0,sa.jsx)(kr,{})})]})]})})})};n.createRoot(document.getElementById("root")).render((0,sa.jsx)(r.StrictMode,{children:(0,sa.jsx)(Qx,{})}))})();
//# sourceMappingURL=main.b9fac32a.js.map